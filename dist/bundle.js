!function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=140)}([function(t,e,i){var n=i(4),r=i(24),a=i(15),o=i(16),s=i(21),l=function(t,e,i){var h,c,u,p,d=t&l.F,f=t&l.G,m=t&l.S,g=t&l.P,v=t&l.B,y=f?n:m?n[e]||(n[e]={}):(n[e]||{}).prototype,b=f?r:r[e]||(r[e]={}),x=b.prototype||(b.prototype={});f&&(i=e);for(h in i)c=!d&&y&&void 0!==y[h],u=(c?y:i)[h],p=v&&c?s(u,n):g&&"function"==typeof u?s(Function.call,u):u,y&&o(y,h,u,t&l.U),b[h]!=u&&a(b,h,p),g&&x[h]!=u&&(x[h]=u)};n.core=r,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},function(module,exports,__webpack_require__){(function(global){var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(){var t;if(t=new Date("2018/01/31").getTime()){var e=(new Date).getTime();if(t<=e)alert("This license has expired!"),console.error("This license has expired!");else{var i=Math.round((t-e)/864e5);i<3&&(alert("This trial license expires in "+i+" days!"),console.log("WARNING: This trial license expires in "+i+" days!"))}}}(),function(t,e){"function"==typeof define&&define.amd?define([],e):"object"===_typeof(exports)?module.exports=e():e(t)}(this,function(_exports){var __drawing_=function(t){var e=t.CIQ,i=t.timezoneJS;return e.Drawing=function(){this.chartsOnly=!1,this.penDown=!1},e.Drawing.getDrawingParameters=function(t,i){var n;try{n=new e.Drawing[i]}catch(t){}if(!n)return null;n.stx=t,n.copyConfig();for(var r={},a=n.configs,o=0;o<a.length;o++)r[a[o]]=n[a[o]];return r},e.Drawing.prototype.copyConfig=function(){e.Drawing.copyConfig(this)},e.Drawing.copyConfig=function(t){for(var i=t.configs,n=0;n<i.length;n++){var r=i[n],a=t.stx.currentVectorParameters;"color"==r?t.color=a.currentColor:"parameters"==r?t.parameters=a.fibonacci:"font"==r?t.font=e.clone(a.annotation.font):t[r]=a[r]}},e.Drawing.prototype.dragToDraw=!1,e.Drawing.prototype.abort=function(t){},e.Drawing.prototype.measure=function(){},e.Drawing.prototype.construct=function(t,e){this.stx=t,this.panelName=e.name},e.Drawing.prototype.render=function(t){alert("must implement render function!")},e.Drawing.prototype.click=function(t,e,i){alert("must implement click function!")},e.Drawing.prototype.move=function(t,e,i){alert("must implement move function!")},e.Drawing.prototype.reposition=function(t,e,i,n){},e.Drawing.prototype.intersected=function(t,e,i){alert("must implement intersected function!")},e.Drawing.prototype.reconstruct=function(t,e){alert("must implement reconstruct function!")},e.Drawing.prototype.serialize=function(){alert("must implement serialize function!")},e.Drawing.prototype.adjust=function(){alert("must implement adjust function!")},e.Drawing.prototype.highlight=function(t){return t&&!this.highlighted?this.highlighted=t:!t&&this.highlighted&&(this.highlighted=t),this.highlighted},e.Drawing.prototype.littleCircleRadius=function(){return 6},e.Drawing.prototype.littleCircle=function(t,i,n,r){var a=this.stx.defaultColor,o=e.chooseForegroundColor(a);t.beginPath(),t.lineWidth=1,t.arc(i,n,this.littleCircleRadius(),0,2*Math.PI,!1),t.fillStyle=r?a:o,t.strokeStyle=a,t.fill(),t.stroke(),t.closePath()},e.Drawing.prototype.rotator=function(t,e,i,n){var r=this.littleCircleRadius(),a=this.stx.defaultColor;t.beginPath(),t.lineWidth=2,n||(t.globalAlpha=.5);var o=4+r;t.arc(e,i,o,0,3*Math.PI/2,!1),t.moveTo(e+2+o,i+2),t.lineTo(e+o,i),t.lineTo(e-2+o,i+2),t.moveTo(e-2,i+2-o),t.lineTo(e,i-o),t.lineTo(e-2,i-2-o),t.strokeStyle=a,t.stroke(),t.closePath(),t.globalAlpha=1},e.Drawing.prototype.mover=function(t,e,i,n){var r=this.littleCircleRadius(),a=this.stx.defaultColor,o=r+1;t.save(),t.lineWidth=2,t.strokeStyle=a,t.translate(e,i),n||(t.globalAlpha=.5);for(var s=0;s<4;s++)t.rotate(Math.PI/2),t.beginPath(),t.moveTo(0,o),t.lineTo(0,o+5),t.moveTo(-2,o+5-2),t.lineTo(0,o+5),t.lineTo(2,o+5-2),t.closePath(),t.stroke();t.globalAlpha=1,t.restore()},e.Drawing.prototype.resizer=function(t,e,i,n){var r=this.littleCircleRadius(),a=this.stx.defaultColor,o=5*Math.sqrt(2),s=r+1;t.save(),t.lineWidth=2,t.strokeStyle=a,t.translate(e,i),t.rotate(-e*i/Math.abs(e*i)*Math.PI/4),n||(t.globalAlpha=.5);for(var l=0;l<2;l++)t.rotate(Math.PI),t.beginPath(),t.moveTo(0,s),t.lineTo(0,s+o),t.moveTo(-2,s+o-2),t.lineTo(0,s+o),t.lineTo(2,s+o-2),t.closePath(),t.stroke();t.globalAlpha=1,t.restore()},e.Drawing.prototype.pointIntersection=function(t,e,i){return!!this.stx.panels[this.panelName]&&t>=i.x0&&t<=i.x1&&e>=i.y1&&e<=i.y0},e.Drawing.prototype.setPoint=function(t,i,n,r){var a=null,o=null;"number"==typeof i?a=i:i.length>=8?o=i:a=Number(i),(n||0===n)&&(this["v"+t]=n);var s;if(null!==a)s=this.stx.dateFromTick(a,r,!0),this["tzo"+t]=s.getTimezoneOffset(),this["d"+t]=e.yyyymmddhhmmssmmm(s),this["p"+t]=[a,n];else if(null!==o){s=e.strToDateTime(o),this["tzo"+t]||0===this["tzo"+t]||(this["tzo"+t]=s.getTimezoneOffset()),this["d"+t]=o;var l=this["tzo"+t]-s.getTimezoneOffset();s.setMinutes(s.getMinutes()+l);var h=!1;"freeform"==this.name||e.ChartEngine.isDailyInterval(this.stx.layout.interval)||s.getHours()||s.getMinutes()||s.getSeconds()||s.getMilliseconds()||(h=!0),this["p"+t]=[this.stx.tickFromDate(e.yyyymmddhhmmssmmm(s),r,null,h),n]}},e.Drawing.prototype.setLineColor=function(t){t||(t=this.color);var i=t;return("auto"==i||e.isTransparent(i))&&(i=this.stx.defaultColor),this.highlighted&&(i=this.stx.getCanvasColor("stx_highlight_vector")),i},e.Drawing.BaseTwoPoint=function(){this.p0=null,this.p1=null,this.color=""},e.Drawing.BaseTwoPoint.ciqInheritsFrom(e.Drawing),e.Drawing.BaseTwoPoint.prototype.configs=[],e.Drawing.BaseTwoPoint.prototype.lineIntersection=function(t,i,n,r){var a=this.p0,o=this.p1,s=this.stx.layout;return a&&o&&e.boxIntersects(n.x0,n.y0,n.x1,n.y1,a[0],a[1],o[0],o[1],r,s.semiLog||"log"==s.chartScale)},e.Drawing.BaseTwoPoint.prototype.boxIntersection=function(t,e){return!(!this.p0||!this.p1)&&(!(t>Math.max(this.p0[0],this.p1[0])||t<Math.min(this.p0[0],this.p1[0]))&&!(e>Math.max(this.p0[1],this.p1[1])||e<Math.min(this.p0[1],this.p1[1])))},e.Drawing.BaseTwoPoint.prototype.accidentalClick=function(t,e){var i=this.stx.panels[this.panelName],n=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(t,i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),o=this.stx.pixelFromValueAdjusted(i,t,e),s=Math.abs(r-n),l=Math.abs(o-a);if(Math.sqrt(s*s+l*l)<10)return this.penDown=!1,this.dragToDraw&&this.stx.undo(),!0},e.Drawing.BaseTwoPoint.prototype.click=function(t,e,i){this.copyConfig();var n=this.stx.panels[this.panelName];return this.penDown?this.accidentalClick(e,i)?this.dragToDraw:(this.setPoint(1,e,i,n.chart),this.penDown=!1,!0):(this.setPoint(0,e,i,n.chart),this.penDown=!0,!1)},e.Drawing.BaseTwoPoint.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.setPoint(1,this.d1,this.v1,t.chart))},e.Drawing.BaseTwoPoint.prototype.move=function(t,e,i){this.penDown&&(this.copyConfig(),this.p1=[e,i],this.render(t))},e.Drawing.BaseTwoPoint.prototype.measure=function(){this.p0&&this.p1&&this.stx.setMeasure(this.p0[1],this.p1[1],this.p0[0],this.p1[0],!0,this.name)},e.Drawing.BaseTwoPoint.prototype.reposition=function(t,e,i,n){if(e){var r=this.stx.panels[this.panelName],a=e.tick-i,o=e.value-n;"move"==e.action?(this.setPoint(0,e.p0[0]-a,e.p0[1]-o,r.chart),this.setPoint(1,e.p1[0]-a,e.p1[1]-o,r.chart),this.render(t)):"drag"==e.action&&(this[e.point]=[i,n],this.setPoint(0,this.p0[0],this.p0[1],r.chart),this.setPoint(1,this.p1[0],this.p1[1],r.chart),this.render(t))}},e.Drawing.annotation=function(){this.name="annotation",this.arr=[],this.w=0,this.h=0,this.padding=4,this.text="",this.ta=null,this.fontSize=0,this.font={}},e.Drawing.annotation.ciqInheritsFrom(e.Drawing.BaseTwoPoint),e.Drawing.annotation.prototype.getFontString=function(){this.fontDef={style:null,weight:null,size:"12px",family:null};var t=this.stx.canvasStyle("stx_annotation");t&&(t.fontStyle&&(this.fontDef.style=t.fontStyle),t.fontWeight&&(this.fontDef.weight=t.fontWeight),t.fontSize&&(this.fontDef.size=t.fontSize),t.fontFamily&&(this.fontDef.family=t.fontFamily)),this.font.style&&(this.fontDef.style=this.font.style),this.font.weight&&(this.fontDef.weight=this.font.weight),this.font.size&&(this.fontDef.size=this.font.size),this.font.family&&(this.fontDef.family=this.font.family),this.fontString="";var e=!0;for(var i in this.fontDef)this.fontDef[i]&&(e?e=!1:this.fontString+=" ",this.fontString+=this.fontDef[i])},e.Drawing.annotation.prototype.configs=["color","font"],e.Drawing.annotation.prototype.measure=function(){},e.Drawing.annotation.prototype.render=function(t){var e=this.stx.panels[this.panelName];if(e){var i=this.stx.pixelFromTick(this.p0[0],e.chart),n=this.stx.pixelFromValueAdjusted(e,this.p0[0],this.p0[1]);t.font=this.fontString,t.textBaseline="top";var r=i,a=n,o=this.w,s=this.h,l=this.setLineColor();if(this.stem){var h,c,u,p;this.stem.d?(h=this.stx.pixelFromTick(this.stem.t),u=this.stx.pixelFromValueAdjusted(e,this.stem.t,this.stem.v),c=r+o/2,p=a+s/2):this.stem.x&&(h=r,u=a,r+=this.stem.x,a+=this.stem.y,c=r+o/2,p=a+s/2),t.beginPath(),this.borderColor?t.strokeStyle=this.borderColor:t.strokeStyle=l,t.moveTo(h,u),t.lineTo(c,p),t.stroke()}this.highlighted?(this.stx.canvasColor("stx_annotation_highlight_bg",t),t.fillRect(r,a,o,s)):this.fillColor?(t.fillStyle=this.fillColor,t.fillRect(r,a,o,s)):this.stem&&(t.fillStyle=this.stx.containerColor,t.fillRect(r,a,o,s)),this.borderColor&&(t.beginPath(),t.strokeStyle=this.borderColor,t.rect(r,a,o,s),t.stroke()),this.highlighted?this.stx.canvasColor("stx_annotation_highlight",t):t.fillStyle=l,a+=this.padding;for(var d=0;d<this.arr.length;d++)t.fillText(this.arr[d],r+this.padding,a),a+=this.fontSize;t.textBaseline="alphabetic"}},e.Drawing.annotation.prototype.onChange=function(t){},e.Drawing.annotation.prototype.edit=function(t){function i(t){return function(i){if(i){switch(window.event?event.keyCode:i.keyCode){case 27:return void t.stx.undo()}}var n=t.stx,r=t.ta,a=n.controls.annotationSave,o=n.controls.annotationCancel,s=r.value.split("\n"),l=0;n.chart.context.font=t.fontString;for(var h=0;h<s.length;h++){var c=n.chart.context.measureText(s[h]).width;c>l&&(l=c)}var u=(s.length+1)*(t.fontSize+3);l<50&&(l=50),r.style.width=l+30+"px",r.style.height=u+"px";var p=parseInt(e.stripPX(r.style.top),10),d=e.stripPX(r.style.left);l=r.clientWidth,u=r.clientHeight,d+l+100<t.stx.chart.canvasWidth?(a.style.top=p+"px",o.style.top=p+"px",a.style.left=d+l+10+"px",o.style.left=d+l+60+"px"):p+u+30<t.stx.chart.canvasHeight?(a.style.top=p+u+10+"px",o.style.top=p+u+10+"px",a.style.left=d+"px",o.style.left=d+50+"px"):(a.style.top=p-35+"px",o.style.top=p-35+"px",a.style.left=d+"px",o.style.left=d+50+"px")}}var n=this.stx.panels[this.panelName];if(n){this.stx.editingAnnotation=!0,this.stx.undisplayCrosshairs(),this.stx.openDialog="annotation",this.ta||(this.ta=document.createElement("TEXTAREA"),this.ta.className="stx_annotation",this.ta.onkeyup=i(this),this.ta.onmouseup=function(t){return function(i){t.manageTouchAndMouse&&e.ChartEngine.drawingLine&&t.mouseup(i)}}(this.stx),this.ta.setAttribute("wrap","hard"),e.isIOS7or8&&this.ta.setAttribute("placeholder","Enter Text"),this.stx.chart.container.appendChild(this.ta),this.ta.style.position="absolute",this.ta.style.width="100px",this.ta.style.height="20px",(e.ipad||e.iphone)&&(this.ta.ontouchstart=function(t){t.stopPropagation()}));var r=this;if(this.ta.oninput=function(t){r.onChange(t)},this.ta.style.font=this.fontString,this.color)if("transparent"==this.color||"auto"==this.color){var a=getComputedStyle(this.ta);a&&e.isTransparent(a.backgroundColor)?this.ta.style.color=this.stx.defaultColor:this.ta.style.color="#000"}else this.ta.style.color=this.color;var o=this.stx.pixelFromTick(this.p0[0],n.chart),s=this.stx.pixelFromValueAdjusted(n,this.p0[0],this.p0[1]);if(this.ta.style.left=o+140<this.stx.chart.canvasRight?o+"px":this.stx.chart.canvasRight-200+"px",this.ta.style.top=s+60<this.stx.chart.canvasHeight?s+"px":s-60+"px","callout"==this.name&&(this.ta.style.left=o-(isNaN(this.w)?this.defaultWidth:this.w/2)+"px",this.ta.style.top=s-(isNaN(this.h)?this.defaultHeight:this.h/2)+"px"),this.stx.controls.annotationSave.style.display="inline-block",this.stx.controls.annotationCancel.style.display="inline-block",e.safeClickTouch(this.stx.controls.annotationSave,function(t){return function(e){""!==t.ta.value&&(t.stx.editingAnnotation=!1,t.text=t.ta.value,t.adjust(),t.stx.addDrawing(t),t.stx.changeOccurred("vector"),t.stx.undo(),t.stx.cancelTouchSingleClick=!0)}}(this)),e.safeClickTouch(this.stx.controls.annotationCancel,function(t){return function(e){t.stx.editingAnnotation=!1,t.stx.undo(),t.stx.cancelTouchSingleClick=!0}}(this)),i(this)(),this.ta.focus(),e.isAndroid&&!e.is_chrome){this.priorBottom=this.stx.chart.container.style.bottom;var l=this.stx.resolveY(s)+100;if(l>e.pageHeight()-400){var h=e.pageHeight()-l,c=400-h;this.stx.chart.container.style.bottom=c+"px"}}}},e.Drawing.annotation.prototype.click=function(t,e,i){if(!this.stx.overXAxis&&!this.stx.overYAxis){var n=this.stx.panels[this.panelName];return this.copyConfig(),this.setPoint(0,e,i,n.chart),this.adjust(),this.edit(t),!1}},e.Drawing.annotation.prototype.reposition=function(t,e,i,n){if(e){var r=this.stx.panels[this.panelName],a=e.tick-i,o=e.value-n;this.setPoint(0,e.p0[0]-a,e.p0[1]-o,r.chart),this.render(t)}},e.Drawing.annotation.prototype.intersected=function(t,i,n){var r=this.stx.panels[this.panelName];if(!this.p0)return null;var a=this.stx.pixelFromTick(this.p0[0],r.chart),o=this.stx.pixelFromValueAdjusted(r,this.p0[0],this.p0[1]),s=a+this.w,l=o+this.h;this.stem&&this.stem.x&&(a+=this.stem.x,s+=this.stem.x,o+=this.stem.y,l+=this.stem.y);var h=this.stx.pixelFromTick(t,r.chart),c=this.stx.pixelFromValueAdjusted(r,t,i);return h>=a&&h<=s&&c>=o&&c<=l&&(this.highlighted=!0,{p0:e.clone(this.p0),tick:t,value:i})},e.Drawing.annotation.prototype.abort=function(){this.stx.controls.annotationSave.style.display="none",this.stx.controls.annotationCancel.style.display="none",this.ta&&this.stx.chart.container.removeChild(this.ta),this.ta=null,this.stx.openDialog="",this.stx.showCrosshairs(),this.stx.editingAnnotation=!1,e.clearCanvas(this.stx.chart.tempCanvas,this.stx),e.isAndroid&&!e.is_chrome&&(this.stx.chart.container.style.bottom=this.priorBottom),e.fixScreen()},e.Drawing.annotation.prototype.reconstruct=function(t,i){this.stx=t,this.color=i.col,this.panelName=i.pnl,this.d0=i.d0,this.tzo0=i.tzo0,this.v0=i.v0,this.text=t.escapeOnSerialize?decodeURIComponent(i.text):i.text,this.stem=i.stem,this.borderColor=i.bc,this.fillColor=i.bg,this.lineWidth=i.lw,this.pattern=i.ptrn,this.font=e.replaceFields(i.fnt,{st:"style",sz:"size",wt:"weight",fl:"family"}),this.font||(this.font={}),this.adjust()},e.Drawing.annotation.prototype.serialize=function(){var t={name:this.name,pnl:this.panelName,col:this.color,d0:this.d0,tzo0:this.tzo0,v0:this.v0,text:this.stx.escapeOnSerialize?encodeURIComponent(this.text):this.text};if(this.font){var i=e.removeNullValues(e.replaceFields(this.font,{style:"st",size:"sz",weight:"wt",family:"fl"}));e.isEmpty(i)||(t.fnt=i)}return this.stem&&(t.stem={d:this.stem.d,v:this.stem.v,x:this.stem.x,y:this.stem.y}),this.borderColor&&(t.bc=this.borderColor),this.fillColor&&(t.bg=this.fillColor),this.lineWidth&&(t.lw=this.lineWidth),this.pattern&&(t.ptrn=this.pattern),t},e.Drawing.annotation.prototype.adjust=function(){this.getFontString();var t=this.stx.panels[this.panelName];if(t){this.setPoint(0,this.d0,this.v0,t.chart),this.arr=this.text.split("\n");var i=0;this.stx.chart.context.font=this.fontString;for(var n=0;n<this.arr.length;n++){var r=this.stx.chart.context.measureText(this.arr[n]).width;r>i&&(i=r)}0===i&&(i=2*this.defaultWidth),this.fontSize=e.stripPX(this.fontDef.size);var a=this.arr.length*this.fontSize;e.touchDevice&&(a+=5),this.w=i+2*this.padding,this.h=a+2*this.padding;var o=this.stx.pixelFromTick(this.p0[0],t.chart)+i,s=this.stx.pixelFromValueAdjusted(t,this.p0[0],this.p0[1])+a;this.p1=[this.stx.tickFromPixel(o,t.chart),this.stx.valueFromPixel(s,t)],this.stem&&this.stem.d&&(this.stem.t=this.stx.tickFromDate(this.stem.d,t.chart))}},e.Drawing.segment=function(){this.name="segment"},e.Drawing.segment.ciqInheritsFrom(e.Drawing.BaseTwoPoint),e.Drawing.segment.prototype.render=function(t){var n=this.stx.panels[this.panelName];if(n){var r=this.stx.pixelFromTick(this.p0[0],n.chart),a=this.stx.pixelFromTick(this.p1[0],n.chart),o=this.stx.pixelFromValueAdjusted(n,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(n,this.p1[0],this.p1[1]),l=this.lineWidth,h=this.setLineColor(),c={pattern:this.pattern,lineWidth:l};if(this.stx.plotLine(r,a,o,s,h,this.name,t,n,c),this.axisLabel&&!this.highlighted)if("horizontal"==this.name){this.stx.endClip();var u=this.p0[1];n.chart.transformFunc&&(u=n.chart.transformFunc(this.stx,n.chart,u)),u=n.yAxis.priceFormatter?n.yAxis.priceFormatter(this.stx,n,u):this.stx.formatYAxisPrice(u,n),this.stx.createYAxisLabel(n,u,o,h),this.stx.startClip(n.name)}else if("vertical"==this.name&&this.p0[0]>=0&&!e.ChartEngine.hideDates()){var p,d;if(p=this.stx.dateFromTick(this.p0[0],n.chart,!0),e.ChartEngine.isDailyInterval(this.stx.layout.interval))p.setHours(0,0,0,0);else{var f=1e3*p.getSeconds()+p.getMilliseconds();this.stx.dataZone&&(d=new i.Date(p.getFullYear(),p.getMonth(),p.getDate(),p.getHours(),p.getMinutes(),this.stx.dataZone),p=new Date(d.getTime()+f)),this.stx.displayZone&&(d=new i.Date(p.getTime(),this.stx.displayZone),p=new Date(d.getFullYear(),d.getMonth(),d.getDate(),d.getHours(),d.getMinutes()),p=new Date(p.getTime()+f))}var m=e.mmddhhmm(e.yyyymmddhhmm(p));if(n.chart.xAxis.formatter)m=n.chart.xAxis.formatter(p);else if(this.stx.internationalizer){var g;0!==p.getHours()||0!==p.getMinutes()?(g=this.stx.internationalizer.monthDay.format(p),g+=" "+this.stx.internationalizer.hourMinute.format(p)):g=this.stx.internationalizer.yearMonthDay.format(p),m=g}this.stx.endClip(),this.stx.createXAxisLabel(n,m,r,h,null,!0),this.stx.startClip(n.name)}if(this.highlighted&&"horizontal"!=this.name&&"vertical"!=this.name){var v="p0"==this.highlighted,y="p1"==this.highlighted;this.littleCircle(t,r,o,v),this.littleCircle(t,a,s,y)}}},e.Drawing.segment.prototype.abort=function(){this.stx.setMeasure(null,null,null,null,!1)},e.Drawing.segment.prototype.intersected=function(t,i,n){if(!this.p0||!this.p1)return null;if("horizontal"!=this.name&&"vertical"!=this.name&&"gartley"!=this.name){if(this.pointIntersection(this.p0[0],this.p0[1],n))return this.highlighted="p0",{action:"drag",point:"p0"};if(this.pointIntersection(this.p1[0],this.p1[1],n))return this.highlighted="p1",{action:"drag",point:"p1"}}return this.lineIntersection(t,i,n,this.name)?(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i}):null},e.Drawing.segment.prototype.configs=["color","lineWidth","pattern"],e.Drawing.segment.prototype.copyConfig=function(){e.Drawing.copyConfig(this),"none"==this.pattern&&(this.pattern="solid")},e.Drawing.segment.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.adjust()},e.Drawing.segment.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1}},e.Drawing.continuous=function(){this.name="continuous",this.dragToDraw=!1,this.maxSegments=null},e.Drawing.continuous.ciqInheritsFrom(e.Drawing.segment),e.Drawing.continuous.prototype.click=function(t,i,n){var r=this.stx.panels[this.panelName];if(r){if(this.copyConfig(),!this.penDown)return this.setPoint(0,i,n,r.chart),this.penDown=!0,!1;if(this.accidentalClick(i,n))return this.stx.undo(),!0;this.setPoint(1,i,n,r.chart);var a=e.Drawing.segment,o=new a,s=this.serialize(this.stx);return o.reconstruct(this.stx,s),(this.stx.addDrawing(o),this.stx.changeOccurred("vector"),this.stx.draw(),this.segment++,this.maxSegments&&this.segment>this.maxSegments)?!0:(this.setPoint(0,i,n,r.chart),!1)}},e.Drawing.line=function(){this.name="line"},e.Drawing.line.prototype.dragToDraw=!1,e.Drawing.line.ciqInheritsFrom(e.Drawing.segment),e.Drawing.line.prototype.calculateOuterSet=function(t){if(this.p0[0]!=this.p1[0]&&this.p0[1]!=this.p1[1]&&!e.ChartEngine.isDailyInterval(this.stx.layout.interval)){var i={x0:this.p0[0],y0:this.p0[1],x1:this.p1[0],y1:this.p1[1]};i.x0>i.x1&&(i={x0:this.p1[0],y0:this.p1[1],x1:this.p0[0],y1:this.p0[1]});var n=i.x0-1e3,r=i.x1+1e3;this.v0B=e.yIntersection(i,n),this.v1B=e.yIntersection(i,r),this.d0B=this.stx.dateFromTick(n,t.chart),this.d1B=this.stx.dateFromTick(r,t.chart)}},e.Drawing.line.prototype.click=function(t,e,i){var n=this.stx.panels[this.panelName];if(n)return this.copyConfig(),this.penDown?this.accidentalClick(e,i)?this.dragToDraw:(this.setPoint(1,e,i,n.chart),this.calculateOuterSet(n),this.penDown=!1,!0):(this.setPoint(0,e,i,n.chart),this.penDown=!0,!1)},e.Drawing.line.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.v0=e.v0,this.v1=e.v1,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,e.d0B&&(this.d0B=e.d0B,this.d1B=e.d1B,this.v0B=e.v0B,this.v1B=e.v1B),this.adjust()},e.Drawing.line.prototype.serialize=function(){var t={name:this.name,pnl:this.panelName,col:this.color,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1};return this.d0B&&(t.d0B=this.d0B,t.d1B=this.d1B,t.v0B=this.v0B,t.v1B=this.v1B),t},e.Drawing.line.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.setPoint(1,this.d1,this.v1,t.chart),e.ChartEngine.isDailyInterval(this.stx.layout.interval)&&this.d0B&&(this.setPoint(0,this.d0B,this.v0B,t.chart),this.setPoint(1,this.d1B,this.v1B,t.chart)))},e.Drawing.ray=function(){this.name="ray"},e.Drawing.ray.ciqInheritsFrom(e.Drawing.line),e.Drawing.ray.prototype.calculateOuterSet=function(t){if(this.p0[0]!=this.p1[0]&&this.p0[1]!=this.p1[1]&&!e.ChartEngine.isDailyInterval(this.stx.layout.interval)){var i={x0:this.p0[0],y0:this.p0[1],x1:this.p1[0],y1:this.p1[1]},n=i.x1+1e3;i.x0>i.x1&&(n=i.x1-1e3),this.v0B=this.v0,this.v1B=e.yIntersection(i,n),this.d0B=this.d0,this.d1B=this.stx.dateFromTick(n,t.chart)}},e.Drawing.ray.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.setPoint(1,this.d1,this.v1,t.chart),e.ChartEngine.isDailyInterval(this.stx.layout.interval)&&this.d0B&&this.setPoint(1,this.d1B,this.v1B,t.chart))},e.Drawing.horizontal=function(){this.name="horizontal"},e.Drawing.horizontal.prototype.dragToDraw=!1,e.Drawing.horizontal.ciqInheritsFrom(e.Drawing.segment),e.Drawing.horizontal.prototype.measure=function(){},e.Drawing.horizontal.prototype.click=function(t,e,i){var n=this.stx.panels[this.panelName];if(n)return this.copyConfig(),this.setPoint(0,e,i,n.chart),!0},e.Drawing.horizontal.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.v0=e.v0,this.d0=e.d0,this.tzo0=e.tzo0,this.axisLabel=e.al,this.adjust()},e.Drawing.horizontal.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,ptrn:this.pattern,lw:this.lineWidth,v0:this.v0,d0:this.d0,tzo0:this.tzo0,al:this.axisLabel}},e.Drawing.horizontal.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.p1=[this.p0[0]+100,this.p0[1]])},e.Drawing.horizontal.prototype.configs=["color","lineWidth","pattern","axisLabel"],e.Drawing.horizontal.prototype.copyConfig=function(){e.Drawing.copyConfig(this),"none"==this.pattern&&(this.pattern="solid")},e.Drawing.vertical=function(){this.name="vertical"},e.Drawing.vertical.ciqInheritsFrom(e.Drawing.horizontal),e.Drawing.vertical.prototype.measure=function(){},e.Drawing.vertical.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.p1=[this.p0[0],this.p0[1]+1])},e.Drawing.measure=function(){this.name="measure"},e.Drawing.measure.ciqInheritsFrom(e.Drawing.segment),e.Drawing.measure.prototype.click=function(t,e,i){return this.copyConfig(),this.penDown?(this.stx.undo(),this.penDown=!1,!0):(this.p0=[e,i],this.penDown=!0,!1)},e.Drawing.rectangle=function(){this.name="rectangle"},e.Drawing.rectangle.ciqInheritsFrom(e.Drawing.BaseTwoPoint),e.Drawing.rectangle.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var n=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(this.p1[0],i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),o=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),s=Math.round(Math.min(n,r))+.5,l=Math.min(a,o),h=Math.max(n,r)-s,c=Math.max(a,o)-l,u=this.color;this.highlighted&&(u=this.stx.getCanvasColor("stx_highlight_vector"));var p=this.fillColor;p&&!e.isTransparent(p)&&"auto"!=p&&(t.beginPath(),t.rect(s,l,h,c),t.fillStyle=p,t.globalAlpha=.2,t.fill(),t.closePath(),t.globalAlpha=1);var d={pattern:this.pattern,lineWidth:this.lineWidth};if(this.highlighted&&"none"==d.pattern&&(d.pattern="solid",.1==d.lineWidth&&(d.lineWidth=1)),this.stx.plotLine(n,r,a,a,u,"segment",t,i,d),this.stx.plotLine(r,r,a-.5,o+.5,u,"segment",t,i,d),this.stx.plotLine(r,n,o,o,u,"segment",t,i,d),this.stx.plotLine(n,n,o+.5,a-.5,u,"segment",t,i,d),this.highlighted){var f="p0"==this.highlighted,m="p1"==this.highlighted;this.littleCircle(t,n,a,f),this.littleCircle(t,r,o,m)}}},e.Drawing.rectangle.prototype.intersected=function(t,i,n){return this.p0&&this.p1?this.pointIntersection(this.p0[0],this.p0[1],n)?(this.highlighted="p0",{action:"drag",point:"p0"}):this.pointIntersection(this.p1[0],this.p1[1],n)?(this.highlighted="p1",{action:"drag",point:"p1"}):this.boxIntersection(t,i)?(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i}):null:null},e.Drawing.rectangle.prototype.configs=["color","fillColor","lineWidth","pattern"],e.Drawing.rectangle.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.fillColor=e.fc,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.adjust()},e.Drawing.rectangle.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,fc:this.fillColor,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1}},e.Drawing.ellipse=function(){this.name="ellipse"},e.Drawing.ellipse.ciqInheritsFrom(e.Drawing.BaseTwoPoint),e.Drawing.ellipse.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var n=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(this.p1[0],i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),o=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),s=n-(r-n),l=r,h=a,c=o,u=a-(o-a),p=(c-u)/6,d=this.lineWidth;d||(d=1.1);var f=this.color;("auto"==f||e.isTransparent(f))&&(f=this.stx.defaultColor),this.highlighted&&(f=this.stx.getCanvasColor("stx_highlight_vector"),.1==d&&(d=1.1));var m=this.fillColor;if(t.beginPath(),t.moveTo(s,h),t.bezierCurveTo(s,c+p,l,c+p,l,h),t.bezierCurveTo(l,u-p,s,u-p,s,h),m&&!e.isTransparent(m)&&"auto"!=m&&(t.fillStyle=m,t.globalAlpha=.2,t.fill(),t.globalAlpha=1),f&&"none"!=this.pattern&&(t.strokeStyle=f,t.lineWidth=d,t.setLineDash&&(t.setLineDash(e.borderPatternToArray(d,this.pattern)),t.lineDashOffset=0),t.stroke()),t.closePath(),this.highlighted){var g="p1"==this.highlighted;this.littleCircle(t,r,o,g)}}},e.Drawing.ellipse.prototype.intersected=function(t,i,n){if(!this.p0||!this.p1)return null;if(this.pointIntersection(this.p1[0],this.p1[1],n))return this.highlighted="p1",{action:"drag",point:"p1"};var r=this.p0[0]-(this.p1[0]-this.p0[0]),a=this.p1[0],o=this.p1[1],s=this.p0[1]-(this.p1[1]-this.p0[1]);return!(t>Math.max(r,a)||t<Math.min(r,a))&&(!(i>Math.max(s,o)||i<Math.min(s,o))&&(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i}))},e.Drawing.ellipse.prototype.configs=["color","fillColor","lineWidth","pattern"],e.Drawing.ellipse.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.fillColor=e.fc,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.adjust()},e.Drawing.ellipse.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,fc:this.fillColor,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1}},e.Drawing.fibonacci=function(){this.name="fibonacci",this.configurator="fibonacci"},e.Drawing.fibonacci.ciqInheritsFrom(e.Drawing.BaseTwoPoint),e.Drawing.fibonacci.mapping={trend:"t",color:"c",parameters:"p",pattern:"pt",opacity:"o",lineWidth:"lw",level:"l",extendLeft:"e",printLevels:"pl",printValues:"pv",timezone:"tz"},e.Drawing.fibonacci.prototype.configs=["color","fillColor","lineWidth","pattern","parameters"],e.Drawing.fibonacci.prototype.setOuter=function(){this.outer={p0:e.clone(this.p0),p1:e.clone(this.p1)};for(var t=this.p0[1],i=this.p1[1],n=this.p0[0],r=this.p1[0],a=0,o=1,s=0;s<this.parameters.fibs.length;s++){var l=this.parameters.fibs[s];if(!(l.level>=a&&l.level<=o)&&l.display){var h=i-(i-t)*l.level,c=e.xIntersection({x0:n,x1:r,y0:t,y1:i},h);l.level<a?(a=l.level,this.outer.p1[1]=h,this.outer.p1[0]=c):l.level>o&&(o=l.level,this.outer.p0[1]=h,this.outer.p0[0]=c)}}},e.Drawing.fibonacci.prototype.click=function(t,i,n){var r=this.stx.panels[this.panelName];if(r)return this.copyConfig(),this.penDown?this.accidentalClick(i,n)?this.dragToDraw:(this.setPoint(1,i,n,r.chart),this.setOuter(),this.parameters=e.clone(this.parameters),this.penDown=!1,!0):(this.setPoint(0,i,n,r.chart),this.penDown=!0,!1)},e.Drawing.fibonacci.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var n=i.yAxis;if(this.p1){var r=Math.max(this.p0[1],this.p1[1]),a=Math.min(this.p0[1],this.p1[1]),o=r-a,s=this.stx.pixelFromTick(this.p0[0],i.chart),l=this.stx.pixelFromTick(this.p1[0],i.chart),h=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),c=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),u=Math.min(c,h),p=Math.max(c,h),d=p-u,f=(c-h)/(l-s)>0,m={color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}};this.parameters.trend||(this.parameters.trend=m);var g=this.setLineColor(this.parameters.trend.color);t.textBaseline="middle",this.stx.canvasFont("stx_yaxis",t);var v=t.measureText("161.8%").width+10,y=Number.MAX_VALUE,b=Number.MAX_VALUE,x=-1*Number.MAX_VALUE,w=-1*Number.MAX_VALUE,C=this.color;("auto"==C||e.isTransparent(C))&&(C=this.stx.defaultColor);for(var S=0;S<this.parameters.fibs.length;S++){t.textAlign="left",t.fillStyle=C;var T=this.parameters.fibs[S];if(T.display){var _=this.stx.pixelFromValueAdjusted(i,this.p0[0],c<h?r-o*T.level:a+o*T.level),k=e.xIntersection({x0:s,x1:l,y0:h,y1:c},_),D=this.parameters.extendLeft?0:k,M=this.stx.chart.left+this.stx.chart.width;if(this.parameters.printLevels){var E=Math.round(1e3*T.level)/10+"%";M-=v,this.parameters.printValues&&(t.fillStyle=C,this.stx.canvasFont("stx_yaxis",t)),M<D&&(t.textAlign="right"),t.fillText(E,M,_),M<D?M+=5:M-=5}if(this.parameters.printValues&&k<this.stx.chart.width){var A=this.stx.transformedPriceFromPixel(_,i);A=n.priceFormatter?n.priceFormatter(this.stx,i,A):this.stx.formatYAxisPrice(A,i),t==this.stx.chart.context&&this.stx.endClip(),this.stx.createYAxisLabel(i,A,_,C,null,t),t==this.stx.chart.context&&this.stx.startClip(i.name)}var P=T.color;("auto"==P||e.isTransparent(P))&&(P=this.color),("auto"==P||e.isTransparent(P))&&(P=this.stx.defaultColor);var L=T.color;("auto"==L||e.isTransparent(L))&&(L=this.fillColor),("auto"==L||e.isTransparent(L))&&(L=this.stx.defaultColor),t.fillStyle=L,this.stx.plotLine(D,M,_,_,P,"segment",t,i,T.parameters),t.globalAlpha=.05,t.beginPath(),t.moveTo(M,_),t.lineTo(D,_),D?t.lineTo(l,c):t.lineTo(D,c),t.lineTo(M,c),void 0!==L&&t.fill(),t.globalAlpha=1,_<b&&(y=k,b=_),_>w&&(x=k,w=_)}}for(var O in{0:0,1:1}){var F=f?p-d*O:u+d*O;F=Math.round(F),F<b&&(y=e.xIntersection({x0:s,x1:l,y0:h,y1:c},F),b=F),F>w&&(x=e.xIntersection({x0:s,x1:l,y0:h,y1:c},F),w=F)}if(this.stx.plotLine(y,x,b,w,g,"segment",t,i,this.parameters.trend.parameters),this.highlighted){var I="p0"==this.highlighted,j="p1"==this.highlighted;this.littleCircle(t,s,h,I),this.littleCircle(t,l,c,j)}}}},e.Drawing.fibonacci.prototype.reposition=function(t,i,n,r){i&&(e.Drawing.BaseTwoPoint.prototype.reposition.apply(this,arguments),this.adjust())},e.Drawing.fibonacci.prototype.intersected=function(t,i,n){var r=this.p0,a=this.p1,o=this.outer,s=this.stx.layout;return r&&a&&e.boxIntersects(n.x0,n.y0,n.x1,n.y1,o.p0[0],o.p0[1],o.p1[0],o.p1[1],"segment",s.semiLog||"log"==s.chartScale)?this.pointIntersection(r[0],r[1],n)?(this.highlighted="p0",{action:"drag",point:"p0"}):this.pointIntersection(a[0],a[1],n)?(this.highlighted="p1",{action:"drag",point:"p1"}):(this.highlighted=!0,{action:"move",p0:e.clone(r),p1:e.clone(a),tick:t,value:i}):null},e.Drawing.fibonacci.prototype.reconstruct=function(t,i){i=e.replaceFields(i,e.reverseObject(e.Drawing.fibonacci.mapping)),this.stx=t,this.parameters=i.parameters,this.parameters||(this.parameters=e.clone(this.stx.currentVectorParameters.fibonacci)),this.color=i.col,this.fillColor=i.fc,this.panelName=i.pnl,this.d0=i.d0,this.d1=i.d1,this.tzo0=i.tzo0,this.tzo1=i.tzo1,this.v0=i.v0,this.v1=i.v1,this.adjust()},e.Drawing.fibonacci.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.setPoint(1,this.d1,this.v1,t.chart),this.setOuter())},e.Drawing.fibonacci.prototype.serialize=function(){var t={name:this.name,parameters:this.parameters,pnl:this.panelName,col:this.color,fc:this.fillColor,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1};return e.replaceFields(t,e.Drawing.fibonacci.mapping)},e.Drawing.retracement=function(){this.name="retracement"},e.Drawing.retracement.ciqInheritsFrom(e.Drawing.fibonacci),e.Drawing.getDrawingToolList=function(t){var i={},n={ciqInheritsFrom:!0,stxInheritsFrom:!0,copyConfig:!0,getDrawingParameters:!0,getDrawingToolList:!0,BaseTwoPoint:!0,shape:!0};e.extend(n,t);for(var r in e.Drawing)n[r]||(i[(new e.Drawing[r]).name]=r);return i},t},__i18n_=function(t){var e=t.CIQ,i=t.$$;return e.I18N=function(){},e.I18N.hereDoc=function(t){return t.toString().replace(/^[^\/]+\/\*!?/,"").replace(/\*\/[^\/]+$/,"")},e.I18N.language="en",e.I18N.longMonths={zh:!0},e.I18N.reverseColorsByLocale={zh:!0,ja:!0},e.I18N.findAllTextNodes=function(t){if(t||(t=document.body),t==document.body&&!i("stashedTextNodes")){var n=document.createElement("div");n.id="stashedTextNodes",n.style.display="none",t.appendChild(n);for(var r=document.querySelectorAll("input,textarea,.editable_content"),a=0;a<r.length;a++){var o=r[a].getAttribute("placeholder");if(o){var s=n.appendChild(document.createElement("translate"));s.setAttribute("original",o),s.placeholderFor=r[a],s.appendChild(document.createTextNode(o))}}}for(var l=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null,!1),h=l.nextNode(),c=new RegExp("^\\s*$"),u=new RegExp("\n|\t|\f","g"),p={},d={SCRIPT:!0,STYLE:!0};h;){var f=h.nodeValue;if(!c.test(f)){var m=h.parentNode,g=m.tagName;if(!d[g]){if("TRANSLATE"!=g){var v=m.insertBefore(document.createElement("translate"),h);v.setAttribute("original",f),v.appendChild(h)}else f=m.getAttribute("original");u.test(f)&&(f=f.replace(u,"")),p[f]||(p[f]=[]),p[f].push(h)}}h=l.nextNode()}if(t==document.body){var y=e.Studies?e.Studies.studyLibrary:null;if(y)for(var b in y){null===p[b]&&(p[b]=[]);var x=y[b];if(x.inputs)for(var w in x.inputs)p[w]||(p[w]=[]);if(x.outputs)for(var C in x.outputs)p[C]||(p[C]=[])}}return p},e.I18N.missingWordList=function(t){t||(t=e.I18N.language);var i=e.I18N.findAllTextNodes(),n={},r=e.I18N.wordLists[t];r||(r={});var a=function(t){void 0===r[t]&&(n[t]="")};for(var o in i)a(o);if(!e.Studies||!e.Studies.studyLibrary)return n;var s,l;for(var h in e.Studies.studyLibrary){s=e.Studies.studyLibrary[h],a(s.name);for(var c in s.inputs)switch(a(c),l=s.inputs[c],Object.prototype.toString.call(l)){case"[object String]":a(l);break;case"[object Array]":for(var u=0;u<l.length;++u)a(l[u])}for(var p in s.outputs)a(p)}return a("Show Zones"),a("OverBought"),a("OverSold"),n},e.I18N.printableMissingWordList=function(t){var i=JSON.stringify(e.I18N.missingWordList(t));return i=i.replace(/","/g,'",\n"')},e.I18N.translateUI=function(t,i){if("pu"==t&&(t="pt"),e.I18N.wordLists){t||(t=e.I18N.language);var n=e.I18N.findAllTextNodes(i),r=e.I18N.wordLists[t];if(r)for(var a in n)for(var o=e.I18N.translateSections(a,r),s=n[a],l=0;l<s.length;l++){var h=s[l],c=h.parentNode,u=c.getAttribute("original");","!==o&&o||(o=u);var p=c.placeholderFor;p?p.placeholder=o:h.data=o}}},e.I18N.translate=function(t,i){if(i||(i=e.I18N.language),!e.I18N.wordLists)return console.log("Must include translations.js in order to use CIQ.I18N.translate()"),t;var n=e.I18N.wordLists[i],r=null;return n&&(r=e.I18N.translateSections(t,n)||t),","===r?t:r},e.I18N.translateSections=function(t,e){if("string"==typeof t&&-1!=t.indexOf("‌")){t=t.replace(/([(),])/g,"‌$1‌");var i=t.split("‌");return i.forEach(function(t,i,n){var r=t.match(/^(\s*).*\S(\s*)$/),a=e[t.trim()];a&&(r&&(a=r[1]+a+r[2]),n[i]=a)}),i.join("")}return e[t]},e.I18N.convertCSV=function(t){var i=new RegExp("[“”]|[‘’]","g"),n=new RegExp('^("+)|("(?="))',"g"),r=e.I18N.wordLists;t||(t=e.I18N.csv);for(var a=t.split("\n"),o=a[0],s=o.split(","),l=0;l<s.length;l++){var h=s[l];r[h]||(r[h]={})}for(var c=1;c<a.length;c++){var u=a[c].match(/(".*?"|[^",]+)(?=\s*,|\s*$)|(,(?=,))/g)||[],p=u[0];n.test(p)&&(p=p.replace(n,"")),i.test(p)&&(p=p.replace(i,'"'));for(var d=1;d<u.length;d++){var f=u[d];n.test(f)&&(f=f.replace(n,"")),r[s[d]][p]=f}}},e.I18N.setLanguage=function(t,i,n,r,a){"pu"==i&&(i="pt"),e.I18N.convertCSV(r),e.I18N.language=i,e.I18N.translateUI(i,a),n||(n=e.I18N.translate),t.translationCallback=n},e.I18N.setLocale=function(t,e,i,n,r){if(!Intl.__addLocaleData)return t.setLocale(e,r),void(i&&i(null));n=void 0===n?"locale-data/jsonp":n;var a=n+"/"+e+".js",o=document.createElement("SCRIPT");o.async=!0,o.src=a;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(o,s.nextSibling),o.onload=function(){t.setLocale(e,r),i&&i(null)},o.onerror=function(){i&&i("cannot load script")}},e.I18N.createMonthArrays=function(t,i,n){t.monthAbv=[],t.monthLetters=[];var r=new Date,a=!0;e.I18N.longMonths&&e.I18N.longMonths[n]&&(a=!1);for(var o=0;o<12;o++){r.setDate(1),r.setMonth(o);var s=i.format(r);if(a){for(var l="",h=0;h<s.length;h++){var c=s.charAt(h);c.charCodeAt(0)<65||(l+=c)}t.monthAbv[o]=l,t.monthLetters[o]=l[0]}else t.monthAbv[o]=s,t.monthLetters[o]=s}},e.I18N.localize=function(t,e){var i=t.locale,n=this.reverseColorsByLocale[e],r=this.reverseColorsByLocale[i];this.setLocale(t,e),this.setLanguage(t,e),n&&r||(n||r)&&this.reverseCandles(t)},e.I18N.reverseCandles=function(t){var e=t.styles,i=t.cloneStyle(e.stx_candle_down),n=t.cloneStyle(e.stx_candle_up);e.stx_candle_up=i,e.stx_candle_down=n},t},__markers_=function(t){var e=t.CIQ;return e.ChartEngine.prototype.makeMarkerHelper=function(){this.markerHelper={chartMap:{},classMap:{}}},e.ChartEngine.prototype.addToHolder=function(t){var i=this.panels[t.params.panelName];if(i){e.derivedFrom(t.params.node,e.Marker.NodeCreator)?(t.stxNodeCreator=t.params.node,t.node=t.stxNodeCreator.node):t.node=t.params.node,this.markerHelper||this.makeMarkerHelper(),t.params.chartContainer?this.container.appendChild(t.node):t.params.includeAxis?i.holder.appendChild(t.node):i.subholder.appendChild(t.node);var n=t.params.label;this.markers[n]||(this.markers[n]=[]),this.markers[n].push(t),t.chart=i.chart,this.markerHelper.chartMap[t.chart.name]||(this.markerHelper.chartMap[t.chart.name]={dataSetLength:0,markers:[]}),this.markerHelper.chartMap[t.chart.name].markers.push(t),t.className||console.log("Marker objects must have a member className");var r=this.markerHelper.classMap[t.className];r||(r=this.markerHelper.classMap[t.className]={}),r[t.params.panelName]||(r[t.params.panelName]=[]),r[t.params.panelName].push(t),this.setMarkerTick(t)}},e.ChartEngine.prototype.getMarkerArray=function(t,e){var i=[];for(var n in this.markers)for(var r=0;r<this.markers[n].length;r++){var a=this.markers[n][r];"panelName"==t?a.params.panelName==e&&i.push(a):"label"==t?n==e&&i.push(a):"all"==t&&i.push(a)}return i},e.ChartEngine.prototype.removeFromHolder=function(t){var e=this.panels[t.params.panelName];e&&(t.node.parentNode==e.holder?e.holder.removeChild(t.node):t.node.parentNode==e.subholder?e.subholder.removeChild(t.node):t.node.parentNode==this.container&&this.container.removeChild(t.node));var i=this.markers[t.params.label];if(i){var n;for(n=0;n<i.length;n++)if(i[n]===t){i.splice(n,1);break}var r=this.markerHelper.chartMap[t.chart.name];if(r)for(n=0;n<r.markers.length;n++)if(r.markers[n]===t){r.markers.splice(n,1);break}var a=this.markerHelper.classMap[t.className];if(a){var o=a[t.params.panelName];if(o)for(n=0;n<o.length;n++)if(o[n]===t){o.splice(n,1);break}}}},e.ChartEngine.prototype.moveMarkers=function(t,e){for(var i=this.getMarkerArray("panelName",t),n=0;n<i.length;n++)i[n].params.panelName=e;for(var r in this.markerHelper.classMap){var a=this.markerHelper.classMap[r][t];a&&(this.markerHelper.classMap[r][e]=a,delete this.markerHelper.classMap[r][t])}},e.ChartEngine.prototype.establishMarkerTicks=function(){this.markerHelper||this.makeMarkerHelper();var t=this.markerHelper.chartMap;for(var e in t){var i=t[e];if(i.dataSetLength!=this.charts[e].dataSet.length)for(var n=0;n<i.markers.length;n++)this.setMarkerTick(i.markers[n])}},e.ChartEngine.prototype.futureTickIfDisplayed=function(t){var e=t.chart;if(!(e.dataSet.length<1)){var i=e.xaxis[e.xaxis.length-1].DT;if(i=new Date(i.getTime()-6e4*this.timeZoneOffset),!(t.params.x>i))for(var n,r,a=e.maxTicks-e.dataSegment.length,o=e.dataSet.length+a,s=new Date(+e.dataSet[e.dataSet.length-1].DT),l=this.standardMarketIterator(s,null,e),h=t.params.x.getTime(),c=e.dataSet.length;c<o;c++){if(n=s.getTime(),s=l.next(),(r=s.getTime())==h)return void(t.tick=c);if(r>h&&n<h)return void(t.tick=Math.max(c-1,0))}}},e.ChartEngine.prototype.setMarkerTick=function(t){var e=t.chart;if("master"==t.params.xPositioner&&t.params.x)return void(t.tick=Math.floor(t.params.x/this.layout.periodicity));if("date"==t.params.xPositioner&&t.params.x){for(var i,n,r=t.params.x.getTime(),a=0;a<e.dataSet.length;a++){if(n=e.dataSet[a].DT.getTime(),i=n,a>0&&(i=e.dataSet[a-1].DT.getTime()),n==r)return void(t.tick=a);if(n>r&&i<r)return void(t.tick=Math.max(a-1,0));if(r<n)return void(t.tick=null)}if(e.dataSet.length<1)return;new Date(+e.dataSet[a-1].DT).getTime()<r&&(t.params.future=!0),t.tick=null}},e.ChartEngine.prototype.positionMarkers=function(){function t(){if(!e.runPrepend("positionMarkers",arguments)){e.markerTimeout=null;for(var t in e.markerHelper.classMap)for(var i in e.markerHelper.classMap[t]){var n=e.markerHelper.classMap[t][i],r=e.panels[i];if(n.length){var a={stx:e,arr:n,panel:r};a.firstTick=r.chart.dataSet.length-r.chart.scroll,a.lastTick=a.firstTick+r.chart.dataSegment.length;var o=n[0].constructor.placementFunction;o?o(a):e.defaultMarkerPlacement(a)}}e.runAppend("positionMarkers",arguments)}}var e=this;e.markerHelper&&(this.markerDelay||0===this.markerDelay?this.markerTimeout||(this.markerTimeout=setTimeout(t,this.markerDelay)):t())},e.Marker=function(t){if(this.params={xPositioner:"date",yPositioner:"value",panelName:"chart",permanent:!1,label:"generic",includeAxis:!1},e.extend(this.params,t),this.params.node||(this.params.node=document.createElement("DIV")),!this.params.stx)return void console.log("Marker created without specifying stx");this.className||(this.className="CIQ.Marker"),this.params.stx.addToHolder(this)},e.Marker.prototype.remove=function(){this.params.stx.removeFromHolder(this)},e.Marker.prototype.render=function(){var t=[this],e={stx:this.params.stx,arr:t,panel:this.params.stx.panels[this.params.panelName],showClass:this.showClass};this.constructor.placementFunction(e)},e.Marker.removeByLabel=function(t,e){for(var i=t.getMarkerArray("label",e),n=0;n<i.length;n++)t.removeFromHolder(i[n])},e.ChartEngine.prototype.getBarBounds=function(t){var e,i=(this.layout.chartType,this.layout.aggregationType);return e="pandf"==i?{high:Math.max(t.pfOpen,t.pfClose),low:Math.min(t.pfOpen,t.pfClose)}:{high:t.High,low:t.Low},t.markerHigh&&(e.high=markerHigh),t.markerLow&&(e.low=markerLow),e},e.ChartEngine.prototype.defaultMarkerPlacement=function(t){var e=t.panel,i=t.yAxis?t.yAxis:t.panel.yAxis,n=e.chart,r=t.stx,a=r.highLowBars[r.layout.chartType],o=n.defaultPlotField;o&&!a||(o="Close");for(var s={},l=0;l<t.arr.length;l++){var h=t.arr[l],c=h.params,u=h.node;h.clientWidth||(h.clientWidth=u.clientWidth),h.clientHeight||(h.clientHeight=u.clientHeight);var p=null,d=c.xPositioner,f=c.yPositioner,m=h.tick,g=n.dataSet,v=h.clientWidth;if("none"!=d){if("bar"==d&&c.x){if(c.x<n.xaxis.length){var y=n.xaxis[c.x];y&&(p=y.data)}u.style.left=Math.round(r.pixelFromBar(c.x,n)-v/2)+1+"px"}else{if(!m&&0!==m){if(!(c.future&&n.scroll<n.maxTicks)){u.style.left="-1000px";continue}if(r.futureTickIfDisplayed(h),!(m=h.tick)&&0!==m){u.style.left="-1000px";continue}}if(m<g.length&&(p=g[m]),m<t.firstTick&&h.rightEdge<0)continue;h.leftpx=Math.round(r.pixelFromTick(m,n)-n.left-v/2),h.rightEdge=h.leftpx+v,u.style.left=h.leftpx+"px"}p||(p=g[g.length-1])}else if(f.indexOf("candle")>-1&&(left=getComputedStyle(u).left,left)){var b=r.barFromPixel(parseInt(left,10),n);b>=0&&((p=n.xaxis[b].data)||(p=g[g.length-1]))}var x,w=c.y,C=u.clientHeight;if("none"!=f){var S=c.chartContainer?r.height:e.yAxis.bottom,T=0,_=0;void 0===s[u.style.left]&&(s[u.style.left]=0),_=s[u.style.left],s[u.style.left]+=C,"value"==f&&w?T=Math.round(S-r.pixelFromPrice(w,e,i)-C/2)+"px":"under_candle"==f&&p?(x=p[o],a&&(x=r.getBarBounds(p).low),T=Math.round(S-r.pixelFromPrice(x,e,i)-C-_)+"px"):"on_candle"==f&&p?(x=p[o],a&&(x=(p.Low+p.High)/2),T=Math.round(S-r.pixelFromPrice(x,e,i)-C/2-_)+"px"):"top"==f?T=Math.round(S-C-_)+"px":"bottom"==f?T=Math.round(_)+"px":p&&(x=p[o],a&&(x=r.getBarBounds(p).high),T=Math.round(S-r.pixelFromPrice(x,e,i)+_)+"px"),u.style.bottom!=T&&(u.style.bottom=T)}}},e.Marker.NodeCreator=function(){},e.Marker.NodeCreator.toNode=function(){return this.node},e.Marker.Simple=function(t){var i=this.node=document.createElement("div");i.className="stx-marker",e.appendClassName(i,t.type),t.category&&e.appendClassName(i,t.category);var n=e.newChild(i,"div","stx-visual");e.newChild(i,"div","stx-stem");var r;if("callout"==t.type){var a=e.newChild(n,"div","stx-marker-content");e.newChild(a,"h4",null,t.headline),r=e.newChild(a,"div","stx-marker-expand"),e.newChild(r,"p",null,t.story)}else r=e.newChild(i,"div","stx-marker-expand"),e.newChild(r,"h4",null,t.headline),e.newChild(r,"p",null,t.story),e.safeClickTouch(r,function(t){e.toggleClassName(i,"highlight")});e.safeClickTouch(n,function(t){e.toggleClassName(i,"highlight")})},e.Marker.Simple.ciqInheritsFrom(e.Marker.NodeCreator,!1),t},__quoteFeed_=function(t){function e(){}var i=t.CIQ;return e.fetchInitialData=function(t,e,i,n,r){},e.fetchUpdateData=function(t,e,i,n){},e.fetchPaginationData=function(t,e,i,n,r){},e.subscribe=function(t){},e.unsubscribe=function(t){},i.QuoteFeed=function(){},i.QuoteFeed.prototype.fetch=function(t,e){this.v2QuoteFeed||console.log("You must implement CIQ.QuoteFeed.[yourfeedname].prototype.fetch()")},i.QuoteFeed.prototype.announceError=function(t,e){t.suppressErrors||e.suppressAlert||t.startDate||t.endDate||e.error&&i.alert("Error fetching quote:"+e.error)},i.QuoteFeed.prototype.multiFetch=function(t,e){function n(t,e,i){return function(n){if(e.results.push({dataCallback:n,params:t}),++e.counter>=e.finished){var r=e.results;e.results=[],i(r)}}}0===t.length&&e([]);for(var r={counter:0,finished:t.length,results:[]},a=0;a<t.length;a++){var o=t[a];o.stx.isEquationChart(o.symbol)?i.fetchEquationChart(o,n(o,r,e)):i.ChartEngine.Driver.fetchData(i.QuoteFeed.SERIES,this,o,n(o,r,e))}},i.QuoteFeed.Subscriptions=function(){this.subscriptions=[]},i.QuoteFeed.Subscriptions.ciqInheritsFrom(i.QuoteFeed),i.QuoteFeed.Subscriptions.prototype.checkSubscriptions=function(t){for(var e,i,n=t.getSymbols(),r=0;r<this.subscriptions.length;r++)this.subscriptions[r].match=!1;for(var a=0;a<n.length;a++){i=n[a];var o=i.interval;for("month"!=o&&"week"!=o||t.dontRoll||(o="day"),i.interval=o,i.period=1,i.match=!1,isNaN(i.interval)||(i.period=i.interval,i.interval=i.timeUnit,i.interval||(i.interval="minute")),delete i.periodicity,delete i.timeUnit,delete i.setSpan,r=0;r<this.subscriptions.length;r++){if(e=this.subscriptions[r],e.symbol==i.symbol&&e.period==i.period&&e.interval==i.interval){i.match=!0,e.match=!0;break}e.symbol!=i.symbol?("period"!=i.reason&&(i.reason="symbol"),e.reason="symbol"):(i.reason="period",e.reason="period")}}var s=this;this.subscriptions=this.subscriptions.filter(function(e){return e.match||(e.stx||(e.stx=t),s.unsubscribe(e)),e.match}),n.forEach(function(e){e.match||(e.stx||(e.stx=t),e.reason||(e.reason="initialize"),s.subscribe(e),s.subscriptions.push(e))})},i.QuoteFeed.Subscriptions.prototype.fetch=function(t,e){var i=this;this.fetchFromSource(t,function(n){n.error||i.checkSubscriptions(t.stx),e(n)})},i.QuoteFeed.Subscriptions.prototype.subscribe=function(t){console.log("subscribe",t)},i.QuoteFeed.Subscriptions.prototype.unsubscribe=function(t){console.log("unsubscribe",t)},i.QuoteFeed.Subscriptions.prototype.fetchFromSource=function(t,e){console.log("Please provide implementation of fetchFromSource")},i.QuoteFeed.prototype.requiresImmediateRefresh=function(t){return!1},i.ChartEngine.prototype.attachQuoteFeed=function(t,e){if(e||(e={}),this.quoteDriver&&this.quoteDriver.die(),"function"!=typeof t.fetchInitialData&&"function"!=typeof t.fetchUpdateData&&"function"!=typeof t.fetchPaginationData)return void(this.quoteDriver=new i.ChartEngine.Driver(this,t,e));"function"!=typeof t.fetchPaginationData&&"function"!=typeof t.fetchUpdateData&&(e.noLoadMore=!0),t.v2QuoteFeed=!0,["multiFetch","announceError","requiresImmediateRefresh"].forEach(function(e){t[e]||(t[e]=i.QuoteFeed.prototype[e])}),"function"==typeof t.subscribe&&(t.checkSubscriptions=i.QuoteFeed.Subscriptions.prototype.checkSubscriptions,t.subscriptions=[]),this.quoteDriver=new i.ChartEngine.Driver(this,t,e)},i.ChartEngine.prototype.attachEngineQuoteFeed=function(t,e){this.attachQuoteFeed(t,e)},i.ChartEngine.prototype.attachTagAlongQuoteFeed=function(t){if(!t.label)return void console.log("Attempt to attachTagAlongQuoteFeed without assigning a label");this.quoteDriver.attachTagAlongQuoteFeed(t)},i.ChartEngine.prototype.detachTagAlongQuoteFeed=function(t){if(!t.label)return void console.log("Attempt to detachTagAlongQuoteFeed without assigning a label");this.quoteDriver.detachTagAlongQuoteFeed(t)},i.ChartEngine.Driver=function(t,e,i){this.tagalongs={},this.stx=t,this.quoteFeed=e,this.behavior=i,this.loadingNewChart=!1,this.intervalTimer=null,this.updatingChart=!1,this.updateChartLoop()},i.ChartEngine.Driver.prototype.die=function(){this.intervalTimer&&(window.clearInterval(this.intervalTimer),this.intervalTimer=-1)},i.ChartEngine.Driver.prototype.updateSubscriptions=function(){this.quoteFeed.checkSubscriptions&&this.quoteFeed.checkSubscriptions(this.stx)},i.ChartEngine.Driver.prototype.attachTagAlongQuoteFeed=function(t){t.label&&(this.tagalongs[t.label]||(this.tagalongs[t.label]={label:t.label,quoteFeed:t.quoteFeed,behavior:t.behavior?t.behavior:{},count:0}),this.tagalongs[t.label].count++)},i.ChartEngine.Driver.prototype.detachTagAlongQuoteFeed=function(t){if(t.label){var e=this.tagalongs[t.label];e.count--,e.count||(this.tagalongs[t.label]=null)}},i.ChartEngine.Driver.prototype.loadDependents=function(t,e){var n,r,a,o=t.stx,s=t.chart,l=s.series,h=o.masterData,c=[],u=t.originalState.update;for(n in l)if(r=l[n],(u||!1!==r.moreAvailable)&&(a=r.parameters.symbolObject,!r.parameters.data||r.parameters.data.useDefaultQuoteFeed)){for(var p=!0,d=0;d<c.length;d++)i.symbolEqual(c[d],a)&&(p=!1);p&&c.push(a)}for(var f=[],m=0;m<c.length;m++){a=c[m];var g=i.shallowClone(t.originalState);g.symbol=a.symbol,g.symbolObject=a,r=l[n],g.update?g.startDate=function(e){for(var n=h.length-1;n>=0;n--)if(h[n]&&void 0!==h[n][e])return i.strToDateTime(h[n].Date);return t.startDate}(n):(g.startDate||(g.startDate=t.startDate),g.endDate||(g.endDate=o.convertToDataZone(new Date)),g.ticks=t.ticks),f.push(g)}if(!f.length)return o.createDataSet(null,null,{appending:t.originalState.update}),t.nodraw||o.draw(),void(e&&e(null));this.quoteFeed.multiFetch(f,function(n){return function(a){for(var s=null,l=0;l<a.length;l++){var h=a[l],c=h.dataCallback.error;if(!c&&0!==c){for(var u=h.params.symbolObject,p=h.dataCallback,d=p.quotes,f=p.moreAvailable,m=o.getSeries({symbolObject:u}),g={},v=0;v<m.length;v++)r=m[v],n||(r.moreAvailable=!1!==f&&(f||d.length>(h.params.endDate?1:0))),g=r.parameters;i.addMemberToMasterdata({stx:o,label:u.symbol,data:d,fieldForLabel:g.field,fillGaps:g.fillGaps}),d&&d.length&&(!s||s>d[0].DT)&&(s=d[0].DT)}}o.createDataSet(null,null,{appending:t.originalState.update,appendToDate:s}),t.nodraw||o.draw(),e&&e(null)}}(u))},i.ChartEngine.Driver.prototype.executeTagAlongs=function(t){var e={count:i.objLength(this.taglongs)},n=this;for(var r in this.tagalongs){var a=this.tagalongs[r],o=i.shallowClone(a.behavior);i.extend(o,t,!0),i.ChartEngine.Driver.fetchData(null,a.quoteFeed,o,function(t,e,r){return function(a){if(r.count--,!a.error){var o=t.fields;o||(o=null),i.addMemberToMasterdata(n.stx,e.label,a.quotes,o)}-1==r.count&&(n.stx.createDataSet(null,null,{appending:t.originalState.update}),n.stx.draw())}}(o,a,e))}},i.ChartEngine.Driver.prototype.updateChart=function(){if(!this.updatingChart&&!this.loadingNewChart){var t=i.objLength(this.stx.charts),e=0,n=this.stx.layout.interval,r=this.stx.layout.timeUnit;for(var a in this.stx.charts){var o=this.stx.charts[a];if(o.symbol){var s=this.makeParams(o.symbol,o.symbolObject,o);o.masterData&&o.masterData.length&&(s.startDate=o.masterData[o.masterData.length-1].DT),s.update=!0,s.originalState=i.shallowClone(s),this.updatingChart=!0;var l=function(i,a,o){return i.behavior.prefetchAction&&i.behavior.prefetchAction("updateChart"),function(s){e++;var l=i.stx,h=a.chart,c=h.masterData;if(o==h.symbol&&n==l.layout.interval&&r==l.layout.timeUnit){if(s.error)i.quoteFeed.announceError(a.originalState,s);else{var u=s.quotes;l.doCleanupDates(s.quotes,n);var p=!1;if(!a.missingBarsCreated){if(c&&c.length&&u&&u.length>0){var d=c[c.length-1],f=u[0];(f.DT&&d.DT<f.DT||f.Date&&d.Date<f.Date)&&(u.unshift(d),p=!0)}s.quotes=u=l.doCleanupGaps(u,h),p&&u.shift()}l.appendMasterData(u,h,{noCreateDataSet:!0}),h.attribution=s.attribution}e==t&&(i.updatingChart=!1),i.executeTagAlongs(a),i.behavior.callback&&i.behavior.callback(a),i.loadDependents(a)}}}(this,s,o.symbol);this.stx.isEquationChart(s.symbol)?i.fetchEquationChart(s,l):i.ChartEngine.Driver.fetchData(i.QuoteFeed.UPDATE,this.quoteFeed,s,l)}}}},i.ChartEngine.Driver.prototype.updateChartLoop=function(t){-1!=this.intervalTimer&&(this.intervalTimer&&window.clearInterval(this.intervalTimer),this.behavior.noUpdate||(t||0===t||(t=this.behavior.refreshInterval),t&&(this.intervalTimer=window.setInterval(function(t){return function(){t.behavior.noUpdate||t.updateChart()}}(this),1e3*t))))},i.ChartEngine.Driver.prototype.resetRefreshInterval=function(t){this.behavior.refreshInterval=t,this.updateChartLoop()},i.ChartEngine.Driver.prototype.loadAll=function(t,e){function i(){return function(a){a?e(a):t.moreAvailable?t.loadingMore?e(null):++r>20?e("error, moreAvailable not implemented correctly in QuoteFeed"):n.checkLoadMore(t,!0,!0,i()):e(null)}}var n=this,r=0;i()()},i.ChartEngine.Driver.prototype.checkLoadMore=function(t,e,n,r,a){function o(e){t.loadingMore=!1,r&&r(e)}if(t.loadingMore)return t.initialScroll=t.scroll,void(r&&r(null));var s,l=this.stx;if(!t.moreAvailable){if(t.dataSet.length>0&&t.scroll>=t.dataSet.length||e)for(var h in t.series)if(!1!==t.series[h].moreAvailable)return s=this.makeParams(t.symbol,t.symbolObject,t),t.masterData&&t.masterData.length?s.endDate=t.masterData[0].DT:s.endDate=l.convertToDataZone(new Date),s.originalState=i.shallowClone(s),s.nodraw=a,t.loadingMore=!0,void this.loadDependents(s,o);return void(r&&r(null))}var c=l.layout.interval,u=l.layout.timeUnit,p=!1;if(!this.behavior.noLoadMore&&(!l.maxDataSetSize||t.dataSet.length<l.maxDataSetSize)){var d=t.dataSet.length-(this.behavior.bufferSize||0);if(d<0&&(d=0),t.scroll>=d||e){t.initialScroll=t.scroll,t.loadingMore=!0,s=this.makeParams(t.symbol,t.symbolObject,t),t.masterData&&t.masterData.length?s.endDate=function(){for(var e=0;e<t.masterData.length;e++)if(t.masterData[e]&&void 0!==t.masterData[e][t.defaultPlotField])return t.masterData[e].DT;return t.masterData[0].DT}():s.endDate=l.convertToDataZone(new Date),s.originalState=i.shallowClone(s),s.nodraw=a,l.fetchMaximumBars[l.layout.aggregationType]&&(n=!0),n&&(s.fetchMaximumBars=!0,s.ticks=Math.max(2e4,s.ticks));var f=function(t,e){return t.behavior.prefetchAction&&t.behavior.prefetchAction("checkLoadMore"),function(n){var o=t.stx,s=e.chart;if(e.symbol==s.symbol&&c==o.layout.interval&&u==o.layout.timeUnit)if(e.loadMore||(e.chart.loadingMore=!1),n.error)t.quoteFeed.announceError(e.originalState,n),e.chart.loadingMore=!1,r&&r(n.error);else{if(n.quotes||(n.quotes=[]),o.doCleanupDates(n.quotes,c),n.quotes.length){var l=n.quotes[n.quotes.length-1];!l.DT&&l.Date&&(l.DT=i.strToDateTime(l.Date)),l.DT&&+l.DT==+s.masterData[0].DT&&n.quotes.pop()}e.missingBarsCreated||(n.quotes.push(s.masterData[0]),n.quotes=o.doCleanupGaps(n.quotes,s),n.quotes.pop()),n.moreAvailable?s.moreAvailable=!0:!1!==n.moreAvailable&&n.quotes.length?s.moreAvailable=!0:s.moreAvailable=!1,t.tickMultiplier=n.quotes.length?2:2*t.tickMultiplier,s.loadingMore=!1,e.loadMoreReplace?o.setMasterData(n.quotes,s):i.addMemberToMasterdata({stx:o,chart:s,data:n.quotes,fields:["*"]}),o.createDataSet(),a||o.draw(),t.executeTagAlongs(e),t.behavior.callback&&t.behavior.callback(e),t.loadDependents(e,r)}}}(this,s);l.isEquationChart(s.symbol)?i.fetchEquationChart(s,f):i.ChartEngine.Driver.fetchData(i.QuoteFeed.PAGINATION,this.quoteFeed,s,f),p=!0}}!p&&r&&r(null)},i.ChartEngine.Driver.prototype.barsToFetch=function(t){if(t.isSeries)return t.stx.masterData.length;var e=this.stx.layout.interval,i=t.stx.layout.periodicity;return"month"!=e&&"week"!=e||this.stx.dontRoll||(i*="week"==e?7:30),t.stx.chart.maxTicks*i*this.tickMultiplier},i.ChartEngine.Driver.determineStartDate=function(t,e,n){var r=t.interval,a=t.stx.layout.periodicity,o=i.Market.Symbology.isForexSymbol?1.3:4;r="millisecond"===r||"second"===r?i.SECOND*a*o:"minute"===r?i.MINUTE*a*o:i.DAY*o;return t.fetchMaximumBars?new Date(Date.now()-n*r):t.startDate?t.startDate:e.previous(n)},i.ChartEngine.Driver.prototype.makeParams=function(t,e,n){var r=this.stx.layout.interval,a=this.barsToFetch({stx:this.stx});"month"!=r&&"week"!=r||this.stx.dontRoll||(r="day");var o=i.shallowClone(this.behavior);return i.extend(o,{stx:this.stx,symbol:t,symbolObject:e,chart:n,interval:r,extended:this.stx.layout.extended,period:1,feed:"delayed",ticks:a},!0),o.symbolObject||(o.symbolObject={symbol:t}),isNaN(o.interval)||(o.period=parseInt(o.interval,10),o.interval=this.stx.layout.timeUnit,o.interval||(o.interval="minute")),o},i.ChartEngine.Driver.prototype.newChart=function(t,e){var n=this.stx,r=t.symbol,a=n.layout.interval,o=n.layout.timeUnit,s=t.chart;s.moreAvailable=null,s.attribution=null,this.tickMultiplier=2;var l=this.makeParams(r,t.symbolObject,s);i.extend(l,t,!0),(n.fetchMaximumBars[n.layout.aggregationType]||t.fetchMaximumBars)&&(l.ticks=Math.max(2e4,l.ticks),l.fetchMaximumBars=!0),this.loadingNewChart=!0,this.updatingChart=!1,l.originalState=i.shallowClone(l);var h=function(i,s){return i.behavior.prefetchAction&&i.behavior.prefetchAction("newChart"),function(l){var h=s.chart,c=l.quotes;if(r!=h.symbol||a!=n.layout.interval||o!=n.layout.timeUnit)return void(e&&e("orphaned"));l.error?i.quoteFeed.announceError(s.originalState,l):(n.doCleanupDates(c,a),s.missingBarsCreated||(c=n.doCleanupGaps(c,h)),n.setMasterData(c,h),h.moreAvailable=!!c&&!1!==l.moreAvailable,h.attribution=l.attribution,t.initializeChart&&n.initializeChart(),n.createDataSet(),s.nodraw||n.home());for(var u in h.series)h.series[u].moreAvailable=null;i.loadingNewChart=!1;var p=h.masterData;p&&p.length&&(s.startDate=p[0].DT,s.endDate=p[p.length-1].DT),i.executeTagAlongs(s),i.behavior.callback&&i.behavior.callback(s),i.loadDependents(s,function(){e&&e(l.error),i.stx.dispatch("newChart",{stx:i.stx,symbol:i.stx.chart.symbol,symbolObject:i.stx.chart.symbolObject,moreAvailable:i.stx.chart.moreAvailable,quoteDriver:i}),i.resetRefreshInterval(i.behavior.refreshInterval)})}}(this,l);this.stx.isEquationChart(l.symbol)?i.fetchEquationChart(l,h):i.ChartEngine.Driver.fetchData(i.QuoteFeed.INITIAL,this.quoteFeed,l,h)},i.QuoteFeed.INITIAL=1,i.QuoteFeed.UPDATE=2,i.QuoteFeed.PAGINATION=3,i.QuoteFeed.SERIES=4,i.ChartEngine.Driver.fetchData=function(t,e,n,r){e.v2QuoteFeed?"function"!=typeof e.subscribe?i.ChartEngine.Driver.fetchDataInContext(t,e,n,r):i.ChartEngine.Driver.fetchDataInContext(t,e,n,function(t){t.error||e.checkSubscriptions(n.stx),r(t)}):e.fetch(n,r)},i.ChartEngine.Driver.fetchDataInContext=function(t,e,n,r){var a,o,s,l;switch(t===i.QuoteFeed.SERIES&&(n.series=!0,t=i.QuoteFeed.INITIAL,n.endDate&&!n.startDate?t=i.QuoteFeed.PAGINATION:n.startDate&&!n.endDate&&(t=i.QuoteFeed.UPDATE)),t){case i.QuoteFeed.UPDATE:var h;n.startDate?h=n.startDate:(h=new Date,h.setHours(0,0,0,0)),"function"==typeof e.fetchUpdateData&&e.fetchUpdateData(n.symbol,h,n,r);break;case i.QuoteFeed.INITIAL:l=new Date,l.setMilliseconds(0),a={begin:l,interval:"tick"==n.interval?1:n.interval,periodicity:"tick"==n.interval?n.stx.chart.xAxis.futureTicksInterval:n.period,inZone:n.stx.dataZone,outZone:n.stx.dataZone},o=n.stx.chart.market.newIterator(a),s=i.ChartEngine.Driver.determineStartDate(n,o,c),l=n.endDate?n.endDate:l,"function"==typeof e.fetchInitialData&&e.fetchInitialData(n.symbol,s,l,n,r);break;case i.QuoteFeed.PAGINATION:a={begin:n.endDate,interval:"tick"==n.interval?1:n.interval,periodicity:"tick"==n.interval?n.stx.chart.xAxis.futureTicksInterval:n.period,inZone:n.stx.dataZone,outZone:n.stx.dataZone},o=n.stx.chart.market.newIterator(a);var c=n.ticks;if(e.maxTicks&&(c=Math.min(c,e.maxTicks)),s=i.ChartEngine.Driver.determineStartDate(n,o,c),"function"==typeof e.fetchPaginationData){if(n.stx.maxMasterDataSize&&n.stx.maxMasterDataSize<=n.stx.masterData.length)return;e.fetchPaginationData(n.symbol,s,n.endDate,n,r)}break;default:console.error("Illegal fetchData constant")}},t},__span_=function(t){var e=t.CIQ;return e.ChartEngine.prototype.setRange=function(t,i){function n(e){void 0===e&&(e=null);var n=0,r=0,a=new Date,h=t.base,u=t.periodicity,p=o.dataSet,d=p.length,f=c.layout;if(!p||0===d)return void(i&&i(e));if("day"===h&&u&&"day"===u.interval){var m=t.multiplier;n=d<m?0:d-m,r=d-1}else if("today"===h&&p[d-1].DT.getDate()!=a.getDate()){for(var g=new Date(p[d-1].DT.getTime()),v=new Date(g.getTime()),y=d-1;y>=0;y--)if(p[y]&&p[y].DT.getDate()!=g.getDate()){g=new Date(+p[y+1].DT);break}v.getTime()==g.getTime()&&(g=new Date(+p[0].DT)),n=c.tickFromDate(g,o,null,!0),r=c.tickFromDate(v,o)}else n=s.getTime()>=p[0].DT.getTime()||t.goIntoPast?c.tickFromDate(s,o,null,!0):0,r=l.getTime()<=p[d-1].DT.getTime()||t.goIntoFuture?c.tickFromDate(l,o):d-1;var b=r-n+1;if(b<1)return void(i&&i(e));var x=c.getLabelOffsetInPixels(c,o,f.chartType),w=Math.max(x,t.padding);r<d-1&&(w=0);var C=(o.width-w)/b;c.setCandleWidth(C,o),o.scroll=b-(r-d)-1,c.micropixels=1;for(var S in c.panels)c.calculateYAxisMargins(c.panels[S].yAxis);c.draw(),c.changeOccurred("layout"),i&&i(e)}function r(t){return t&&0===u?(o.scroll=k,c.setCandleWidth(D),c.layout.interval=M,c.layout.periodicity=E,c.layout.timeUnit=A,void(i&&i(t))):++u>10?(console.log("CIQ.ChartEngine.setRange(): Too many loads (10) from server. Stopping. Check periodicity logic."),void n()):void(o.moreAvailable&&o.masterData[0]&&o.masterData[0].DT>s?c.quoteDriver.checkLoadMore(o,!0,!1,function(t){t?n(t):r()},!0):n())}e.isEmpty(t)&&(t={dtLeft:arguments[0],dtRight:arguments[1],padding:arguments[2],chart:arguments[3],goIntoFuture:!1},i=arguments[4]),t.chart||(t.chart=this.chart),void 0===t.padding&&(t.padding=0);var a=!1,o=t.chart,s=t.dtLeft,l=this.convertToDataZone(new Date);if(t.dtRight&&(l=t.dtRight),!s){var h=this.standardMarketIterator(l,null,o);s=h.previous(o.maxTicks),t.periodicity||(a=!0)}var c=this,u=0;if(this.quoteDriver){var p,d,f;if(a)p=this.layout.interval,f=this.layout.timeUnit,d=this.layout.periodicity;else if(t.periodicity)p=t.periodicity.interval,f=t.periodicity.timeUnit,d=t.periodicity.period;else{var m=l.getTime()-s.getTime();if(this.autoPickCandleWidth.turnOn){var g=0;g=this.autoPickCandleWidth.candleWidth?this.autoPickCandleWidth.candleWidth:this.barsHaveWidth[this.layout.chartType]?5:2;var v=o.width/g,y=this.dynamicRangePeriodicityMap;p=y[0].interval,d=1;for(var b,x=0;x<y.length;x++){var w=m/y[x].rangeInMS;if(w<v){y[x-1]?(p=y[x-1].interval,f=y[x-1].timeUnit,d=Math.ceil(b/v)):(p=y[x].interval,f=y[x].timeUnit,d=1);break}b=w}}else{for(var C=this.staticRangePeriodicityMap,S=null,T=0;T<C.length;T++){var _=C[T];if(m/_.rangeInMS<1.001){S=_;break}}p=S.interval,d=S.periodicity,f=S.timeUnit}}var k=this.chart.scroll,D=this.layout.candleWidth,M=this.layout.interval,E=this.layout.periodicity,A=this.layout.timeUnit;this.chart.scroll=this.chart.maxTicks=function(t,i,n,r,a,o){var s=0,l=t-i;return e.ChartEngine.isDailyInterval(n)?s="month"==n?l/e.MONTH/r:"week"==n?l/e.WEEK/r:l/e.DAY/r:isNaN(n)||(s="millisecond"==a?l/(r*n):"second"==a?l/e.SECOND/(r*n):l/e.MINUTE/(r*n)),Math.round(s)}(l.getTime(),s.getTime(),p,d,f,this.dontRoll),this.layout.candleWidth=this.chart.width/this.chart.maxTicks;var P=this.needDifferentData({periodicity:d,interval:p,timeUnit:f});if(this.chart.masterData&&this.chart.masterData.length&&!P)this.layout.interval==p&&this.layout.periodicity==d||(this.layout.interval=p,this.layout.periodicity=d,this.createDataSet()),r();else{this.layout.interval=p,this.layout.periodicity=d,this.layout.timeUnit=f,this.layout.timeUnit||(e.ChartEngine.isDailyInterval(this.layout.interval)?this.layout.timeUnit=null:"second"==this.layout.interval?this.layout.timeUnit="second":"tick"!=this.layout.interval&&(this.layout.timeUnit="minute"));var L={symbol:o.symbol,symbolObject:o.symbolObject,chart:o,nodraw:!0};"tick"==this.layout.interval&&(L.startDate=s,L.endDate=l),this.displayInitialized||(L.initializeChart=!0),L.startDate=new Date(2*s-l),L.startDate.setHours(0,0,0,0),this.quoteDriver.newChart(L,r)}}else n()},e.ChartEngine.prototype.setSpan=function(t,i){function n(t){return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}var r=arguments[0],a=arguments[1],o=arguments[2],s=arguments[3];if("object"==(void 0===t?"undefined":_typeof(t))?(r=t.period?t.period:t.multiplier?t.multiplier:1,a=t.interval?t.interval:t.base?t.base:t.span?t.span:t.period,o=t.padding,s=t.chart):(t={period:r,interval:a,padding:o,chart:s},i=arguments[5]),s||(s=this.chart),"all"==(a=a.toLowerCase()))return void this.displayAll(t,i);var l=a,h=1;"today"==a?l="day":"year"==a&&(l="month",h=12);var c=e.shallowClone(t);c.goIntoFuture=!1;var u,p={begin:new Date,interval:l,period:h,outZone:this.dataZone};"ytd"!==a&&(u=s.market.newIterator(p));var d=this.convertToDataZone(new Date);if("ytd"===a)d=n(d),d.setMonth(0),d.setDate(1);else if("today"===a)u.next(),(d=u.previous())>p.begin&&(d=u.previous());else if("month"===a)d=n(new Date),d.setMonth(d.getMonth()-r);else if("year"===a)d=n(new Date),d.setFullYear(d.getFullYear()-r);else if("week"===a)d=n(new Date),d.setDate(d.getDate()-7*r);else if("day"===a&&1==r&&this.chart.market.isMarketDay()){var f=d.getHours(),m=d.getMinutes(),g=d.getSeconds(),v=d.getMilliseconds();d=u.previous(),d.setHours(f),d.setMinutes(m),d.setSeconds(g),d.setMilliseconds(v)}else 1==r&&r++,d=u.previous(r-1);c.dtLeft=d,"today"===a&&(c.goIntoFuture=!0,c.dtRight=new Date(+d),c.dtRight.setDate(d.getDate()+1),c.dtRight=s.market._convertFromMarketTZ(c.dtRight,this.dataZone),c.dtLeft.setHours(u.market.zopen_hour),c.dtLeft.setMinutes(u.market.zopen_minute),c.dtLeft.setSeconds(0),c.dtLeft=s.market._convertFromMarketTZ(c.dtLeft,this.dataZone)),c.maintainPeriodicity&&(c.periodicity={},c.periodicity.interval=this.layout.interval,c.periodicity.period=this.layout.periodicity),s.spanLock=!1;var y=this;this.setRange(c,function(e){t.maintainPeriodicity||(y.layout.setSpan=t,y.changeOccurred("layout")),"today"==a&&(s.spanLock=!0),i&&i(e)})},e.ChartEngine.prototype.getSpanCandleWidth=function(t){if(t&&t.base&&t.multiplier){var e=parseFloat(t.multiplier),i=t.base,n=new Date,r=new Date;"year"==i?r.setFullYear(r.getFullYear()-e):"month"==i?r.setMonth(r.getMonth()-e):"day"==i?r.setDate(r.getDate()-e):"week"==i?r.setDate(r.getDate()-7*e):"YTD"==i&&(r.setMonth(0),r.setDate(1));var a=(n.getTime()-r.getTime())/1e3/60/60/24;a=5*a/7;return this.chart.width/a}},e.ChartEngine.prototype.displayAll=function(t,i){function n(){if(a.masterData&&a.masterData.length){var n=e.clone(t);n.dtLeft=a.masterData[0].DT,n.dtRight=a.masterData[a.masterData.length-1].DT,t.maintainPeriodicity?(n.periodicity={},n.periodicity.interval=o.layout.interval,n.periodicity.period=o.layout.periodicity):t.periodicity&&(n.periodicity=t.periodicity),o.setRange(n,function(e){t.maintainPeriodicity||(o.layout.setSpan={base:t.base,multiplier:t.multiplier},o.changeOccurred("layout"));for(var n in o.panels)o.calculateYAxisMargins(o.panels[n].yAxis);o.draw(),i&&i(e)})}}function r(){o.quoteDriver.loadAll(a,n)}var a=this.chart;t&&t.chart&&(a=t.chart);var o=this;if(!this.quoteDriver)return void n();var s=t.maintainPeriodicity?{periodicity:this.layout.periodicity,interval:this.layout.interval}:{periodicity:1,interval:"month"};s=t.periodicity?t.periodicity:s,s.period&&(s.periodicity=s.period);var l=this.needDifferentData(s);this.layout.periodicity=s.periodicity,this.layout.interval=s.interval,this.layout.timeUnit=s.timeUnit,t.forceLoad||l?this.quoteDriver.newChart({noDraw:!0,symbol:this.chart.symbol,symbolObject:this.chart.symbolObject,chart:this.chart,initializeChart:!0,fetchMaximumBars:!0},r):a.moreAvailable?r():(this.createDataSet(),n())},t},__studies_=function(t){var e=t.CIQ;return e.Studies=function(){},e.Studies.DEFAULT_INPUTS={Period:14},e.Studies.DEFAULT_OUTPUTS={Result:"auto"},e.Studies.actualOutputs=[],e.Studies.studyPanelMap={},e.Studies.colorPickerDiv=null,e.Studies.StudyDescriptor=function(t,i,n,r,a,o){this.name=t,this.type=i,this.panel=n,this.inputs=r,this.outputs=a,this.parameters=o,this.outputMap={},this.min=null,this.max=null,this.startFrom=0;var s=e.Studies.studyLibrary[i];s||(s={},("chart"==n||!n&&o&&"chart"==o.chartName)&&(this.overlay=!0)),void 0===s.inputs&&(s.inputs=e.clone(e.Studies.DEFAULT_INPUTS)),void 0===s.outputs&&(s.outputs=e.clone(e.Studies.DEFAULT_OUTPUTS)),this.study=s,this.libraryEntry=s},e.Studies.generateID=function(t,i,n,r){var a=e.Studies.studyLibrary[i];if(a&&(a.customRemoval||e.isEmpty(a.inputs)))return i;var o="‌"+i+"‌",s=o+" (",l=!1;for(var h in n)if("id"!=h&&"display"!=h&&"Shading"!=h){var c=n[h];"field"!=c&&(c=c.toString(),void 0!==e.Studies.prettify[c]&&(c=e.Studies.prettify[c]),l?c&&(s+=","):l=!0,s+=c)}if(s+=")",r&&0===r.indexOf(s))return r;if(t.layout.studies&&t.layout.studies[s])for(var u=2;u<50;u++){var p=s+"-"+u;if(!t.layout.studies[p]){s=p;break}}return s},e.Studies.DialogHelper=function(t){var i=this.stx=t.stx,n=this.sd=t.sd;this.name=n?n.type:t.name,this.inputs=[],this.outputs=[],this.parameters=[];var r=this.libraryEntry=n?n.study:e.Studies.studyLibrary[t.name];void 0===r.inputs&&(r.inputs=e.clone(e.Studies.DEFAULT_INPUTS)),void 0===r.outputs&&(r.outputs=e.clone(e.Studies.DEFAULT_OUTPUTS));var a=n&&i.panels[n.panel]?i.panels[n.panel]:{chart:i.chart},o=a.chart;this.title=i.translateIf(r.name),this.attributes=r.attributes,this.attributes||(this.attributes={});for(var s in r.inputs){var l={};this.inputs.push(l),l.name=s,l.heading=i.translateIf(s);var h=r.inputs[s];if(n&&n.inputs&&void 0!==n.inputs[s]&&null!==n.inputs[s]?l.value=n.inputs[s]:l.value=r.inputs[s],l.defaultInput=r.inputs[s],this.attributes[s]||(this.attributes[s]=e.Studies.inputAttributeDefaultGenerator(l.defaultInput)),h.constructor==Number)l.type="number";else if(h.constructor==String){var c=e.Studies.movingAverageHelper(i,l.defaultInput);if(c){l.type="select",l.defaultInput=c;var u=e.Studies.movingAverageHelper(i,l.value);u||(u=l.value),l.value=u,l.options=e.Studies.movingAverageHelper(i,"options")}else if("field"==h){l.type="select",l.options={};t:for(var p in o.dataSet[o.dataSet.length-1]){if(-1==["Open","High","Low","Close","Adj_Close","hl/2","hlc/3","hlcc/4","ohlc/4",o.defaultPlotField].indexOf(p)){if(-1==e.Studies.actualOutputs.indexOf(p))continue;if(t.sd)for(var d in t.sd.outputMap)if(-1!=p.indexOf(d)&&-1==p.indexOf(d+"-"))continue t}l.options[p]=i.translateIf(p)}"field"==l.value&&(l.value="Close"),"field"==l.defaultInput&&(l.defaultInput="Close")}else l.type="text"}else if(h.constructor==Boolean)l.type="checkbox",!0!==l.value&&"true"!=l.value&&"on"!=l.value||(l.value=!0);else if(h.constructor==Array){l.type="select",l.options={};for(var f=0;f<h.length;f++)l.options[h[f]]=i.translateIf(h[f]);l.value.constructor==Array&&(l.value=l.value[0]),l.defaultInput=h[0]}}for(s in r.outputs){var m={name:s,heading:i.translateIf(s)};this.outputs.push(m),m.color=m.defaultOutput=r.outputs[s],n&&n.outputs&&n.outputs[s]&&(m.color=n.outputs[s]),"auto"==m.color&&(m.color=i.defaultColor)}if(r.parameters&&"studyOverZones"==r.parameters.template){var g=r.parameters.init;if(g){var v;v={name:"studyOverZones",heading:i.translateIf("Show Zones"),defaultValue:g.studyOverZonesEnabled,value:g.studyOverZonesEnabled};var y=n?n.parameters:null;y&&(y.studyOverZonesEnabled||!1===y.studyOverZonesEnabled)&&(v.value=y.studyOverZonesEnabled),this.parameters.push(v),v={name:"studyOverBought",heading:i.translateIf("OverBought"),defaultValue:g.studyOverBoughtValue,value:g.studyOverBoughtValue,defaultColor:g.studyOverBoughtColor,color:g.studyOverBoughtColor},y&&y.studyOverBoughtValue&&(v.value=y.studyOverBoughtValue),y&&y.studyOverBoughtColor&&(v.color=y.studyOverBoughtColor),"auto"==v.color&&(v.color=i.defaultColor),this.parameters.push(v),v={name:"studyOverSold",heading:i.translateIf("OverSold"),defaultValue:g.studyOverSoldValue,value:g.studyOverSoldValue,defaultColor:g.studyOverSoldColor,color:g.studyOverSoldColor},y&&y.studyOverSoldValue&&(v.value=y.studyOverSoldValue),y&&y.studyOverSoldColor&&(v.color=y.studyOverSoldColor),"auto"==v.color&&(v.color=i.defaultColor),this.parameters.push(v),this.attributes.studyOverBoughtValue||(this.attributes.studyOverBoughtValue={}),this.attributes.studyOverSoldValue||(this.attributes.studyOverSoldValue={})}}},e.Studies.DialogHelper.prototype.updateStudy=function(t){var i={},n=this.sd,r=this.libraryEntry;r||(r={}),n||(n=r),i.inputs=e.shallowClone(n.inputs),i.outputs=e.clone(n.outputs),i.parameters=e.shallowClone(n.parameters),e.extend(i,t),i.parameters||(i.parameters={}),i.inputs&&i.inputs.id?this.sd=e.Studies.replaceStudy(this.stx,i.inputs.id,this.name,i.inputs,i.outputs,i.parameters,null,n.study):this.sd=e.Studies.addStudy(this.stx,this.name,i.inputs,i.outputs,i.parameters,null,n.study)},e.Studies.prepareStudy=function(t,i,n,r){if(void 0===i.calculateFN&&(i.useRawValues=!0),r&&r.replaceID&&(e.Studies.rejiggerDerivedStudies(t,r.replaceID,n.inputs.id,n.panel),delete r.replaceID),e.isEmpty(n.outputMap))for(var a in n.outputs)i.useRawValues?n.outputMap[a]=a:n.outputMap[a+" "+n.name]=a;(n.overlay||n.underlay)&&(t.overlays[n.name]=n),i.feed?t.attachTagAlongQuoteFeed(i.feed):(n.chart.dataSet&&t.createDataSet(),t.draw())},e.Studies.rejiggerDerivedStudies=function(t,i,n,r){var a=t.layout.studies;t.overlays;for(var o in a){var s=a[o],l=s.inputs,h=l.id;if(-1!=l.id.indexOf(i)&&-1==l.id.indexOf(i+"-")){for(var c=(l.id.replace(i,n),!1),u=e.Studies.getFieldInputs(s),p=0;p<u.length;p++)if(-1!=l[u[p]].indexOf(i)){s.name;l[u[p]]=l[u[p]].replace(i,n),l.id=l.id.replace(i,n),l.display=l.display.replace(i,n),s.name=s.name.replace(i,n),s.outputMap={};for(var d in s.outputs)s.study.useRawValues?s.outputMap[d]=d:s.outputMap[d+" "+s.name]=d;c=!0}c&&e.Studies.replaceStudy(t,h,s.type,s.inputs,s.outputs,s.parameters)}}},e.Studies.removeStudySymbols=function(t,e){t.series&&e.deleteSeries(t.series,null,{action:"remove-study"})},e.Studies.replaceStudy=function(t,i,n,r,a,o,s,l){o||(o={}),i&&(o.replaceID=i),r.id==r.display&&delete r.display,delete r.id;var h=t.layout.studies[o.replaceID];return e.Studies.removeStudySymbols(h,t),t.quoteDriver&&t.quoteDriver.updateSubscriptions(),e.Studies.addStudy(t,n,r,a,o,s,l)},e.Studies.addStudy=function(t,i,n,r,a,o,s){var l=s||e.Studies.studyLibrary[i];if(l){if(l.inputs){var h=e.shallowClone(l.inputs);for(var c in h)h[c]instanceof Array&&(h[c]=h[c][0]);n=e.extend(h,n)}l.outputs&&(r=e.extend(e.clone(l.outputs),r));var u=l.parameters;u&&u.init&&(a=e.extend(e.shallowClone(u.init),a))}n||(n=e.clone(e.Studies.DEFAULT_INPUTS)),r||(r=e.clone(e.Studies.DEFAULT_OUTPUTS)),a||(a={}),a.chartName||(a.chartName="chart"),n.Period<1&&(n.Period=1),n.id||(n.id=e.Studies.generateID(t,i,n,a.replaceID));var p=null;if(!(p=l&&l.initializeFN?l.initializeFN(t,i,n,r,a,o,s):e.Studies.initializeFN(t,i,n,r,a,o,s)))return void console.log("CIQ.Studies.addStudy: initializeFN() returned null for "+i);s=p.study,p.chart=t.charts[a.chartName],t.layout.studies||(t.layout.studies={}),t.layout.studies[p.inputs.id]=p,p.type=i,p.permanent=s.permanent,p.customLegend=s.customLegend;var d=t.panels[p.panel];e.Studies.prepareStudy(t,s,p,a),t.quoteDriver&&t.quoteDriver.updateSubscriptions(),t.changeOccurred("layout");var f=!1,m=!(p.overlay||p.underlay);if(m&&s.horizontalCrosshairFieldFN&&(d.horizontalCrosshairField=s.horizontalCrosshairFieldFN(t,p)),t.editCallback?f=!0:m?(t.callbacks.studyPanelEdit||t.callbackListeners.studyPanelEdit&&t.callbackListeners.studyPanelEdit.length)&&(f=!0):(t.callbacks.studyOverlayEdit||t.callbackListeners.studyOverlayEdit&&t.callbackListeners.studyOverlayEdit.length)&&(f=!0),f){a.editMode=!0;var g=!1;for(var v in p.inputs)if("id"!=v&&"display"!=v){g=!0;break}if(!g)for(var y in p.outputs){g=!0;break}if(g){var b;void 0!==p.study.edit?p.study.edit&&(b=function(t,e,i,n){return function(){e.study.edit(e,{stx:t,inputs:i,outputs:n,parameters:a})}}(t,p,n,r),t.setPanelEdit(d,b),p.editFunction=b):!m&&t.callbacks.studyOverlayEdit?(b=function(t,e,i,n,r){return function(a){t.dispatch("studyOverlayEdit",{stx:t,sd:e,inputs:i,outputs:n,parameters:r,forceEdit:a})}}(t,p,n,r,a),p.editFunction=b):t.editCallback?(b=function(t,n,r,o){return function(){var s=t.editCallback(t,n);e.Studies.studyDialog(t,i,s,{inputs:r,outputs:o,parameters:a})}}(t,p,n,r),"chart"!=d.name&&t.setPanelEdit(d,b)):(b=function(t,e,i,n,r){return function(){t.dispatch("studyPanelEdit",{stx:t,sd:e,inputs:i,outputs:n,parameters:r})}}(t,p,n,r,a),"chart"!=d.name&&(t.setPanelEdit(d,b),p.editFunction=b))}}return p},e.Studies.quickAddStudy=e.Studies.addStudy,e.Studies.removeStudy=function(t,e){if(e.overlay||e.underlay)t.removeOverlay(e.name),t.draw();else{var i=t.panels[e.panel];i&&t.panelClose(i)}},e.Studies.displayStudies=function(t,i,n){var r=t.layout.studies;if(r){n&&(e.Studies.actualOutputs=[]);var a={};a[i.name]=!0;for(var o in r){var s=r[o],l=s.study;if(l){if(n){if(!s.underlay&&!l.underlay)continue}else if(s.underlay||l.underlay)continue;var h=t.panels[s.panel];if(h){if(h.chart==i&&("bypass"!=s.study.range&&(h.min=null),!h.hidden)){if(!a[h.name]){var c=s.permanent;h.closeX?h.closeX.style.display=c?"none":"":h.close.style.display=c?"none":"",a[h.name]=c}var u=s.chart.dataSegment;for(var p in s.outputMap)e.Studies.actualOutputs.push(p);for(var d=e.Studies.getFieldInputs(s),f=0;f<d.length;f++)if(s.panel==s.parameters.chartName&&s.inputs[d[f]]){var m=e.Studies.studyPanelMap[s.inputs[d[f]]];if(m){s.panel=m.panel;break}}void 0===l.seriesFN?(e.Studies.displaySeriesAsLine(t,s,u),h&&e.Studies.displayError(t,s)):l.seriesFN&&h&&(l.seriesFN(t,s,u),e.Studies.displayError(t,s))}}else delete r[o]}}}},e.Studies.displayError=function(t,e,i){var n=i&&i.panel?i.panel:e.panel,r=t.panels[n].state;r.studyError||!e.error||"undefined"!=typeof practiceMode&&practiceMode||(i=i||{h:"center",v:"bottom"},i.text=r.studyError=!0===e.error?t.translateIf("Not enough data to compute ")+t.translateIf(e.study.name):t.translateIf(e.error),t.watermark(n,i))},e.Studies.calculateMinMaxForDataPoint=function(t,e,i){for(var n=Number.MAX_VALUE,r=-1*Number.MAX_VALUE,a=0;a<i.length;a++){var o=i[a][e];null!==o&&void 0!==o&&(isNaN(o)||(n=Math.min(o,n),r=Math.max(o,r)))}return{min:n,max:r}},e.Studies.determineMinMax=function(t,e,i){function n(t,e){if(t){var i=t[e];null===i||void 0===i||isNaN(i)||(r.min=Math.min(i,r.min),r.max=Math.max(i,r.max))}}var r=t.panels[e.panel];if(r){if(!r.min&&0!==r.min){var a=e.study;if(e.min||0===e.min)r.min=e.min,r.max=e.max;else{if("0 to 100"==a.range)r.min=0,r.max=100;else if("-1 to 1"==a.range)r.min=-1,r.max=1;else if("bypass"!=a.range){r.min=Number.MAX_VALUE,r.max=-1*Number.MAX_VALUE;for(var o,s,l,h=0;h<i.length;h++){var c=i[h];if(c){for(s in e.outputMap)n(c,s);for(o=0;o<=2;o++)l=e.name+"_hist"+(o||""),n(c,l)}}if(r.min==Number.MAX_VALUE||r.min==r.max){for(s in e.outputMap)n(t.getPreviousBar(r.chart,s,0),s),n(t.getNextBar(r.chart,s,i.length-1),s);for(o=0;o<=2;o++)l=e.name+"_hist"+(o||""),n(t.getPreviousBar(r.chart,l,0),l),n(t.getNextBar(r.chart,l,i.length-1),l)}}"0 to max"==a.range&&(r.min=Math.min(0,r.min))}}(r.highValue||0===r.highValue)&&r.highValue>r.max&&(r.max=r.highValue),(r.lowValue||0===r.lowValue)&&r.lowValue<r.min&&(r.min=r.lowValue);var u=r.yAxis;(u.max||0===u.max)&&(r.max=u.max),(u.min||0===u.min)&&(r.min=u.min),r.max==r.min&&(r.max=2*r.max,r.min=0),r.shadow=r.max-r.min,r.max>0&&r.min<0&&(r.shadow=r.max+-1*r.min),u.high=r.max,u.low=r.min,u.shadow=u.high-u.low}},e.Studies.createYAxis=function(t,i,n,r){if(!r.axisDrawn){r.height=r.bottom-r.top,e.Studies.determineMinMax(t,i,n);var a,o=i.study;o.yaxis||o.yAxisFN?(a={noDraw:!0},t.createYAxis(r,a),t.drawYAxis(r,a),o.yaxis&&o.yaxis(t,i),o.yAxisFN&&o.yAxisFN(t,i)):(a={noDraw:i.parameters&&i.parameters.studyOverZonesEnabled},"0 to 100"==o.range?a.range=[0,100]:"-1 to 1"==o.range&&(a.range=[-1,1]),o.yAxis&&o.yAxis.ground&&(a.ground=!0),t.createYAxis(r,a),t.drawYAxis(r,a)),i.error||(o.centerline?e.Studies.drawHorizontal(t,i,n,o.centerline):r.min<0&&r.max>0&&e.Studies.drawHorizontal(t,i,n,0)),r.axisDrawn=!0}},e.Studies.displaySeriesAsLine=function(t,i,n){if(n.length){var r=t.panels[i.panel];if(r&&!r.hidden){r.name==i.chart.name||i.underlay||e.Studies.createYAxis(t,i,n,r),e.Studies.drawZones(t,i,n);for(var a in i.outputMap)e.Studies.studyPanelMap[a]=i,e.Studies.displayIndividualSeriesAsLine(t,i,r,a,n)}}},e.Studies.displaySeriesAsHistogram=function(t,i,n){if(n.length){var r=t.panels[i.panel];if(r&&!r.hidden){var a=[];for(var o in i.outputMap){var s=i.outputs[i.outputMap[o]],l={field:o,fill_color_up:s,border_color_up:s,fill_color_down:s,border_color_down:s};a.push(l)}var h=i.inputs,c={name:i.name,type:h.HistogramType?h.HistogramType:"overlaid",panel:i.panel,heightPercentage:h.HeightPercentage?h.HeightPercentage:.25,widthFactor:h.WidthFactor?h.WidthFactor:.5};i.study&&i.study.parameters&&i.study.parameters.excludeYAxis||e.Studies.createYAxis(t,i,i.chart.dataSegment,t.panels[i.panel]),t.drawHistogram(c,a)}}},e.Studies.displayIndividualSeriesAsLine=function(t,i,n,r,a){n.height||(n.height=n.bottom-n.top);var o=t.chart.context,s=i.outputs[i.outputMap[r]];t.chart.context.save(),"string"==typeof s&&(s={color:s,width:1});var l=s.width||1;o.lineWidth=i.highlight?l+2:l;var h=s.color;"auto"==h&&(h=t.defaultColor),o.strokeStyle=h;var c=s.pattern;o.setLineDash(e.borderPatternToArray(o.lineWidth,c)),o.lineDashOffset=0;var u=0,p=i.study,d=n.yAxis;d.shadow<1e3&&(u=2),d.shadow<5&&(u=4),(i.overlay||i.underlay)&&(u=null),(d.decimalPlaces||0===d.decimalPlaces)&&(u=d.decimalPlaces);var f=null;i.parameters&&(f=i.parameters.label);var m=p.parameters;m||(m={});var g=!!i.series&&(i.series.parameters.type?"step"==i.series.parameters.type:"step"==m.plotType);m.noLabels&&(f=!1),i.noSlopes||!1===i.noSlopes||(i.noSlopes=m.noSlopes),i.extendToEnd||!1===i.extendToEnd||(i.extendToEnd=m.extendToEnd);var v=f||t.preferences.labels&&!1!==f,y=i.gaplines,b=y?t.getGapColorFunction(r,h,c,y):null;t.plotDataSegmentAsLine(r,n,{skipTransform:t.panels[i.panel].name!=i.chart.name,label:v,labelDecimalPlaces:u,noSlopes:i.noSlopes,step:g,extendToEndOfDataSet:i.extendToEnd,gaps:y},b),p.appendDisplaySeriesAsLine&&p.appendDisplaySeriesAsLine(t,i,a,r,n),t.chart.context.restore()},e.Studies.drawHorizontal=function(t,e,i,n){var r=t.panels[e.panel];if(r){var a=t.pixelFromPrice(n,r);a>r.top&&a<r.yAxis.bottom&&t.plotLine(r.left,r.right,a,a,"#DDDDDD","segment",t.chart.context,!1,{})}},e.Studies.displayHistogramWithSeries=function(t,i,n){var r=t.panels[i.panel];e.Studies.createYAxis(t,i,n,r),e.Studies.createHistogram(t,i,n,!1,.4),e.Studies.displaySeriesAsLine(t,i,n)},e.Studies.drawZones=function(t,i,n){if(i.parameters&&i.parameters.studyOverZonesEnabled){var r=parseFloat(i.parameters.studyOverSoldValue),a=parseFloat(i.parameters.studyOverBoughtValue),o=i.parameters.studyOverSoldColor,s=i.parameters.studyOverBoughtColor,l=i.zoneOutput;l||(l="Result");var h=e.Studies.determineColor(i.outputs[l]);h&&"auto"!=h&&!e.isTransparent(h)||(h=t.defaultColor),o||(o=h),o&&"auto"!=o&&!e.isTransparent(o)||(o=t.defaultColor),s||(s=h),s&&"auto"!=s&&!e.isTransparent(s)||(s=t.defaultColor);var c=t.panels[i.panel],u=c.yAxis.displayBorder;!1===t.axisBorders&&(u=!1),!0===t.axisBorders&&(u=!0);var p=Math.round(c.right)+.5,d=u?p-.5:c.right,f=u?3:0,m=t.chart.context,g=m.fillStyle;t.chart.context.globalAlpha=.2,t.startClip(c.name,!0);var v=c.yAxis,y=v.yAxisPlotter=new e.Plotter;y.newSeries("border","stroke",t.canvasStyle("stx_grid_border")),m.beginPath();var b=Math.round(t.pixelFromPrice(a,c))+.5;m.strokeStyle=s,m.moveTo(c.left,b),m.lineTo(d,b),m.stroke(),m.closePath(),t.chart.context.beginPath();var x=Math.round(t.pixelFromPrice(r,c))+.5;m.strokeStyle=o,m.moveTo(c.left,x),m.lineTo(d,x),m.stroke(),m.closePath(),u&&(y.moveTo("border",p-.5,b),y.lineTo("border",p+f,b),y.moveTo("border",p-.5,x),y.lineTo("border",p+f,x)),m.fillStyle=g;var w={skipTransform:t.panels[i.panel].name!=i.chart.name,panelName:i.panel,band:l+" "+i.name};if(e.preparePeakValleyFill(t,e.extend(w,{threshold:a,direction:1,color:s})),e.preparePeakValleyFill(t,e.extend(w,{threshold:r,direction:-1,color:o})),m.globalAlpha=1,!i.study||!i.study.yaxis){if(u){var C=Math.round(v.bottom)+.5;y.moveTo("border",p,v.top),y.lineTo("border",p,C),y.draw(t.chart.context,"border")}t.canvasFont("stx_yaxis"),t.canvasColor("stx_yaxis");var S=v.left+f+3;m.fillText(a,S,b),m.fillText(r,S,x),c.axisDrawn=!0}t.endClip(),m.globalAlpha=1}},e.Studies.createHistogram=function(t,i,n,r,a){var o=t.panels[i.panel];t.startClip(o.name);var s=t.layout.candleWidth-2;s<2&&(s=1);var l=t.pixelFromPrice(0,o);o.min>0&&(l=t.pixelFromPrice(o.min,o)),r&&(l=Math.floor(o.top+o.height/2));var h=t.chart.context,c=i.name+"_hist";i.outputs["Decreasing Bar"]||i.outputs["Negative Bar"]?h.globalAlpha=a||1:t.canvasColor("stx_histogram");for(var u=null,p=null,d=i.outputs,f=0;f<n.length;f++){var m=n[f];if(m){m.candleWidth&&(s=Math.floor(Math.max(1,m.candleWidth-2)));var g=Math.floor(t.pixelFromBar(f,o.chart)-s/2),v=Math.floor(s);if(null===u){var y=t.tickFromPixel(g,o.chart)-1;u=y<0?p:t.pixelFromPrice(t.chart.dataSet[y][c],o)-l}else u=p;p=t.pixelFromPrice(m[c],o)-l;var b=e.Studies.determineColor(d["Decreasing Bar"]),x=e.Studies.determineColor(d["Increasing Bar"]),w=e.Studies.determineColor(d["Positive Bar"]),C=e.Studies.determineColor(d["Negative Bar"]);b&&p>u?h.fillStyle=b:x&&p<u?h.fillStyle=x:w&&p<0?h.fillStyle=w:C&&p>0&&(h.fillStyle=C),h.fillRect(g,l,v,Math.floor(p))}}h.globalAlpha=1,t.endClip()},e.Studies.volumeChart=function(t,e,i,n){var r,a,o=-1*Number.MAX_VALUE;for(r in i)for(var s=0;s<i[r].length;s++)(a=i[r][s])&&a>o&&(o=a);var l=t.panels[e.panel],h=Math.floor(l.yAxis.bottom)+.5,c=Math.floor(l.yAxis.top)+.5,u=h-c,p=t.layout.candleWidth,d=null;e.parameters&&e.parameters.displayBorder||(n=null);var f=0;n||(f=(p-t.chart.tmpWidth)/2);var m=t.chart.context;m.lineWidth=1,t.startClip(e.panel);for(r in i){n&&(d=n[r]),m.fillStyle=r,d&&(m.strokeStyle=d),m.beginPath();for(var g,v=h+.5,y=Math.floor(t.pixelFromBar(0,l.chart)),b=0;b<i[r].length;b++)if(t.chart.dataSegment[b]&&t.chart.dataSegment[b].candleWidth?(p=t.chart.dataSegment[b].candleWidth,n||(f=p/4)):(p=t.layout.candleWidth,n||(f=(p-t.chart.tmpWidth)/2)),0===b&&(y-=p/2,g=y),a=i[r][b]){var x,w,C=a*(u/o),S=Math.min(Math.floor(h-u+(u-C))+.5,h);x=Math.floor(g+f),w=Math.floor(g+p-f),x=Math.max(x,y),m.moveTo(x,h),m.lineTo(w,h),m.lineTo(w,S),m.lineTo(x,S),n?(v>S||0===b)&&m.lineTo(x,v):m.lineTo(x,h),v=S,g+=p}else v=h,g+=p;m.fill(),m.strokeStyle=d,n&&t.layout.candleWidth>=2&&m.stroke(),m.closePath()}t.endClip()},e.Studies.prettify={Close:"C",Open:"O",High:"H",Low:"L",simple:"ma",exponential:"ema","time series":"tsma",triangular:"tma",variable:"vma",VIDYA:"vdma",weighted:"wma","welles wilder":"smma",true:"y",false:"n"},e.Studies.prettyRE=/^.*\((.*?)\).*$/,e.Studies.prettyDisplay=function(t){var i=e.Studies.prettyRE.exec(t);if(!i)return t;var n=i[1];if(n){for(var r in e.Studies.prettify)n=n.replace(r,e.Studies.prettify[r]);t=t.replace(i[1],n)}return t},e.Studies.getFieldInputs=function(t){var e=[],i=t.study.inputs;for(var n in i)"field"==i[n]&&e.push(n);return e},e.Studies.initializeFN=function(t,i,n,r,a,o,s){function l(i,n,r){for(var a=null,o=e.Studies.getFieldInputs(h),s=0;s<o.length;s++){var l=e.Studies.studyPanelMap[i[o[s]]];if(l){a=l.panel;break}"Volume"!=i[o[s]]||"Volume"==t.chart.defaultPlotField&&!t.highLowBars[t.layout.chartType]||(a=r.vchart?"vchart":"volume")}return a||(a=n.chartName),a}n||(n={id:i}),a||(a={}),n.display||(n.display=n.id);var h=new e.Studies.StudyDescriptor(n.id,i,n.id,n,r,a);n.Period&&(h.days=Math.max(1,parseInt(h.inputs.Period,10))),s?(s.inputs||(s.inputs=h.study.inputs),s.outputs||(s.outputs=h.study.outputs),h.study=s):s=h.study,s.display&&(n.display=s.display),o||(o=n.id);var c=h.overlay||s.overlay||n.Overlay,u=h.underlay||s.underlay||n.Underlay;u&&(h.underlay=!0),c&&(h.overlay=!0);var p=a.replaceID?t.layout.studies[a.replaceID]:null;if(p&&(t.panelExists(a.replaceID)||c||u))if(c||u)h.panel=l(n,a,t.panels),a.replaceID!=h.inputs.id&&(delete t.layout.studies[a.replaceID],delete t.overlays[a.replaceID],e.deleteRHS(e.Studies.studyPanelMap,p),t.panelExists(a.replaceID)&&t.panelClose(t.panels[a.replaceID]));else{h.panel=o;var d={};for(var f in t.panels)if(f==a.replaceID){var m=t.panels[f];m.name=o,m.display=n.display,d[o]=m,a.replaceID!=o&&e.deleteRHS(e.Studies.studyPanelMap,p),t.moveMarkers&&t.moveMarkers(a.replaceID,o)}else d[f]=t.panels[f];t.panels=d,a.replaceID!=h.inputs.id&&delete t.layout.studies[a.replaceID]}else if(t.panelExists(o))h.panel=o,h.underlay||h.panel!=t.chart.name||(h.overlay=!0);else if(c||u)h.panel=l(n,a,t.panels);else{var g=s.panelHeight?s.panelHeight:null;t.createPanel(n.display,n.id,g,a.chartName),s.yAxis||(t.panels[n.id].yAxis.displayGridLines=t.displayGridLinesInStudies),p&&a.replaceID!=h.inputs.id&&e.Studies.removeStudy(t,p)}var v=t.panels[h.panel];if(v&&v.chart.name!=v.name){var y=s?s.yAxis:null,b=s?s.parameters:null;y?(e.extend(v.yAxis,y),y.ground&&(v.yAxis.initialMarginBottom=0),(y.ground||y.initialMarginTop||0===y.initialMarginTop||y.initialMarginBottom||0===y.initialMarginBottom)&&t.calculateYAxisMargins(v.yAxis)):b&&(b.zoom||0===b.zoom)?v.yAxis.zoom=b.zoom:v.yAxis.zoom=10}return h},e.Studies.overZones=function(t,i,n){if(n.length){var r=t.panels[i.panel];if(r&&!r.hidden){e.Studies.displaySeriesAsLine(t,i,n);var a=i.parameters;if(a&&a.studyOverZonesEnabled){var o=t.chart.context,s=parseFloat(a.studyOverBoughtValue),l=parseFloat(a.studyOverSoldValue),h=r.height/r.shadow,c=r.bottom-h*s,u=r.bottom-h*l,p={lineWidth:1};if(o.globalAlpha=.2,t.plotLine(r.left,r.right-5,c,c,a.studyOverBoughtColor,"segment",o,!1,p),o.globalAlpha=.2,t.plotLine(r.left,r.right-5,u,u,a.studyOverSoldColor,"segment",o,!1,p),!i.study||!i.study.yaxis){var d=t.getCanvasFontSize("stx_yaxis");t.canvasFont("stx_yaxis"),t.canvasColor("stx_yaxis"),o.fillText(s,r.yAxis.left,c+d/2),o.fillText(l,r.yAxis.left,u+d/2),r.axisDrawn=!0}}}}},e.Studies.displayPSAR2=function(t,i,n){var r=t.panels[i.panel],a=r.name==r.chart.name;t.startClip(r.name);var o=t.chart.context,s="squarewave"==i.inputs["Plot Type"];for(var l in i.outputs){var h=l+" "+i.name;o.beginPath();for(var c=t.layout.candleWidth,u=Math.max(3,Math.floor(t.chart.tmpWidth/2)),p=0;p<n.length;p++){var d=n[p];if(d&&(d[h]||0===d[h])){d.candleWidth&&(c=d.candleWidth),a&&d.transform&&(d=d.transform);var f=t.pixelFromBar(p,r.chart);s&&(f-=c/2);var m=t.pixelFromTransformedValue(d[h],r);if(0!==p&&n[p-1]&&(n[p-1][h]||0===n[p-1][h])||o.moveTo(f,m),s){if(o.lineTo(f,m),o.lineTo(f+c,m),n[p+1]){var g=n[p+1];a&&g.transform&&(g=g.transform),g[h]||0===g[h]||o.lineTo(f+c,t.pixelFromTransformedValue(g[i.referenceOutput+" "+i.name],t.panels[i.panel]))}}else o.moveTo(f-u/2,m),o.lineTo(f+u/2,m)}}o.lineWidth=1,i.highlight&&(o.lineWidth=3);var v=e.Studies.determineColor(i.outputs[l]);"auto"==v&&(v=t.defaultColor),o.strokeStyle=v,o.stroke(),o.closePath(),o.lineWidth=1}t.endClip()},e.Studies.initializeStochastics=function(t,i,n,r){return n.display=t.translateIf("Stoch")+" ("+n.Period+")",e.Studies.initializeFN.apply(null,arguments)},e.Studies.calculateVolume=function(t,i){var n=i.outputs,r=e.Studies.determineColor(n["Up Volume"]),a=e.Studies.determineColor(n["Down Volume"]);if("vchart"==i.name||"volume"==i.name)t.setStyle("stx_volume_up","color",r),t.setStyle("stx_volume_down","color",a);else{if(!t||!t.chart.dataSet)return;var o=t.layout,s=i.parameters.removeStudy,l=o.volumeUnderlay;o.volumeUnderlay=!s,l!=o.volumeUnderlay&&t.changeOccurred("layout"),s?e.Studies.removeStudy(t,i):(t.setStyle("stx_volume_underlay_up","color",r),t.setStyle("stx_volume_underlay_down","color",a))}},e.Studies.MA=function(t,i,n,r,a,o,s){var l=new e.Studies.StudyDescriptor(a+" "+s.name,"ma",s.panel);l.chart=s.chart,l.days=parseInt(i,10),l.startFrom=s.startFrom,l.inputs={},t&&(l.inputs.Type=t),n&&(l.inputs.Field=n),r&&(l.inputs.Offset=parseInt(r,10)),e.Studies.calculateMovingAverage(o,l)},e.Studies.movingAverage={conversions:{ma:"simple",sma:"simple",ema:"exponential",tsma:"time series",tma:"triangular",vma:"variable",vdma:"vidya",wma:"weighted",smma:"welles wilder"},translations:{simple:"Simple",exponential:"Exponential","time series":"Time Series",triangular:"Triangular",variable:"Variable",vidya:"VIDYA",weighted:"Weighted","welles wilder":"Welles Wilder"},typeMap:{ema:"Exponential",exponential:"Exponential",tsma:"TimeSeries","time series":"TimeSeries",tma:"Triangular",triangular:"Triangular",vma:"Variable",variable:"Variable",vdma:"Variable",vidya:"Variable",wma:"Weighted",weighted:"Weighted",smma:"Exponential","welles wilder":"Exponential"}},e.Studies.movingAverageHelper=function(t,i){if("options"==i){var n={};for(var r in e.Studies.movingAverage.translations)n[r]=t.translateIf(e.Studies.movingAverage.translations[r]);return n}return e.Studies.movingAverage.conversions[i]},e.Studies.volUnderlay=function(t,i,n){e.Studies.createVolumeChart(t,i,n)},e.Studies.createVolumeChart=function(t,i,n){var r=i.panel,a=i.inputs,o=i.underlay,s=i.overlay,l=o||s,h=l?"stx_volume_underlay":"stx_volume",c=[{field:"Volume",fill_color_up:t.canvasStyle(h+"_up").color,border_color_up:t.canvasStyle(h+"_up").borderLeftColor,opacity_up:t.canvasStyle(h+"_up").opacity,fill_color_down:t.canvasStyle(h+"_down").color,border_color_down:t.canvasStyle(h+"_down").borderLeftColor,opacity_down:t.canvasStyle(h+"_down").opacity}],u=c[0];l||"rgb(184, 44, 12)"!==u.border_color_down||(u.border_color_down="#000000",u.border_color_up="#000000");var p={name:"Volume",panel:r,heightPercentage:l?.25:null,widthFactor:1,bindToYAxis:!l};e.extend(p,i.study.parameters),e.extend(p,i.parameters),t.colorByCandleDirection&&(u.color_function=function(t){var e=t.Open,i=t.Close;return{fill_color:e>i?u.fill_color_down:u.fill_color_up,border_color:e>i?u.border_color_down:u.border_color_up,opacity:e>i?u.opacity_down:u.opacity_up}}),l||(i.outputMap.Volume="transparent",e.Studies.createYAxis(t,i,i.chart.dataSegment,t.panels[r])),a.HeightPercentage&&(p.heightPercentage=a.HeightPercentage),t.drawHistogram(p,c)},e.Studies.calculateRSI=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)return void(e.error=!0);for(var n=e.startFrom;n<i.length;n++)if(n){var r=i[n],a=i[n-1],o=r.Close-a.Close,s=Math.min(n,e.days),l=a["_avgG "+e.name];l||(l=0),l-=l/s;var h=a["_avgL "+e.name];h||(h=0),h-=h/s,o>0?l+=o/s:h-=o/s,n>=e.days&&(r["RSI "+e.name]=function(t,e){return 0===e?100:100-100/(1+t/e)}(l,h)),r["_avgG "+e.name]=l,r["_avgL "+e.name]=h}e.zoneOutput="RSI"},e.Studies.calculateMACD=function(t,i){var n=i.chart.scrubbed,r=i.inputs,a=i.name;if(i.macd1Days||(i.macd1Days=parseFloat(r["Fast MA Period"])),i.macd2Days||(i.macd2Days=parseFloat(r["Slow MA Period"])),i.signalDays||(i.signalDays=parseFloat(r["Signal Period"])),i.days||(i.days=Math.max(i.macd1Days,i.macd2Days,i.signalDays)),n.length<i.days+1)return void(i.error=!0);var o=i.inputs.Field;o&&"field"!=o||(o="Close");var s=r["Moving Average Type"];s||(s="exponential"),e.Studies.MA(s,i.macd1Days,o,0,"_MACD1",t,i),e.Studies.MA(s,i.macd2Days,o,0,"_MACD2",t,i);var l,h,c=Math.max(i.startFrom,i.days-1);for(l=c;l<n.length;l++)h=n[l],h["MACD "+a]=h["_MACD1 "+a]-h["_MACD2 "+a];var u=r["Signal MA Type"];u||(u="exponential"),e.Studies.MA(u,i.signalDays,"MACD "+a,0,"Signal",t,i);var p=a+"_hist";for(l=c;l<n.length;l++){h=n[l];var d=h["Signal "+a];(d||0===d)&&(h[p]=h["MACD "+a]-h["Signal "+a])}},e.Studies.calculateStandardDeviation=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days+1)return void(i.error=!0);var r=i.inputs.Field;r&&"field"!=r||(r="Close");var a=i.inputs["Moving Average Type"];a||(a=i.inputs.Type),e.Studies.MA(a,i.days,r,i.inputs.Offset,"_MA",t,i);var o=0,s=0,l=0,h=Number(i.inputs["Standard Deviations"]);h<0&&(h=2);var c=i.name;for(var u in i.outputs)c=u+" "+c;var p,d,f;for(p=i.startFrom-1,f=0;p>=0&&f<i.days;p--,f++)d=n[p][r],isNaN(d)&&(d=0),o+=Math.pow(d,2),s+=d;for(p=i.startFrom;p<n.length;p++){var m=n[p];if(d=m[r],isNaN(d)&&(d=0),o+=Math.pow(d,2),s+=d,!(p<i.days-1)){if(p>=i.days){var g=n[p-i.days][r];isNaN(g)&&(g=0),o-=Math.pow(g,2),s-=g}l=m["_MA "+i.name],m[c]=Math.sqrt((o+i.days*Math.pow(l,2)-2*l*s)/i.days)*h}}},e.Studies.calculateMovingAverage=function(t,i){if(i.chart.scrubbed){var n=i.inputs.Type;"ma"!=n&&n||(n="simple");var r=e.Studies.movingAverage.typeMap;if(n in r)return e.Studies["calculateMovingAverage"+r[n]](t,i);if("simple"===n){var a=i.chart.scrubbed,o=0,s=[],l=i.name;for(var h in i.outputs)l=h+" "+l;var c=i.inputs.Field;c&&"field"!=c||(c="Close");var u=parseInt(i.inputs.Offset,10);isNaN(u)&&(u=0);var p,d,f=i.startFrom,m=u;for(p=i.startFrom-1;p>=0;p--)if((d=a[p][c])||0===d)if(m>0)m--,f=p;else{if(s.length==i.days-1)break;o+=d,s.unshift(d)}for(s.length<i.days-1&&(s=[],f=0),p=f;p<a.length;p++){d=a[p][c];var g=p+u>=0&&p+u<a.length,v=g?a[p+u]:null;d||0===d?(o+=d,s.push(d),s.length>i.days&&(o-=s.shift()),v&&(v[l]=s.length==i.days?o/i.days:null)):v&&(v[l]=null)}}}},e.Studies.calculateMovingAverageExponential=function(t,e){var i=e.inputs.Type,n=e.chart.scrubbed,r=0,a=0,o=0,s=2/(e.days+1);"welles wilder"==i&&(s=1/e.days);var l=null,h=e.name;for(var c in e.outputs)h=c+" "+h;var u=e.inputs.Field;u&&"field"!=u||(u="Close");var p=parseInt(e.inputs.Offset,10);isNaN(p)&&(p=0);var d,f,m=e.startFrom,g=p;for(d=e.startFrom-1;d>=0;d--)if((f=n[d][h])||0===f){if(null===l&&(l=f),o=e.days,g<=0)break;g--,m=d}for(null===l&&(l=m=0),d=m;d<n.length;d++){f=n[d][u];var v=d+p>=0&&d+p<n.length,y=v?n[d+p]:null;f||0===f?(o==e.days-1?(r+=f,a=r/e.days,y&&(y[h]=a)):o<e.days-1?(r+=f,a=r/(o+1),y&&(y[h]=null)):0===o?(r+=f,a=r,y&&(y[h]=null)):(l||0===l)&&(a=(f-l)*s+l,y&&(y[h]=a)),l=a,o++):y&&(y[h]=null)}},e.Studies.calculateMovingAverageVariable=function(t,i){var n=i.inputs.Type,r=i.chart.scrubbed,a=2/(i.days+1),o=null,s=i.name;for(var l in i.outputs)s=l+" "+s;var h=i.inputs.Field;h&&"field"!=h||(h="Close"),"vidya"==n?(i.std=new e.Studies.StudyDescriptor(i.name,"sdev",i.panel),i.std.chart=i.chart,i.std.days=5,i.std.startFrom=i.startFrom,i.std.inputs={Field:h,"Standard Deviations":1,Type:"ma"},i.std.outputs={_STD:null},e.Studies.calculateStandardDeviation(t,i.std),e.Studies.MA("ma",20,"_STD "+i.name,0,"_MASTD",t,i)):(i.cmo=new e.Studies.StudyDescriptor(i.name,"cmo",i.panel),i.cmo.chart=i.chart,i.cmo.days=9,i.cmo.startFrom=i.startFrom,i.cmo.outputs={_CMO:null},e.Studies.calculateChandeMomentum(t,i.cmo));var c=parseInt(i.inputs.Offset,10);isNaN(c)&&(c=0);var u,p,d=i.startFrom,f=c;for(u=i.startFrom-1;u>=0;u--)if((p=r[u][s])||0===p){if(null===o&&(o=p),f<=0)break;f--,d=u}for(null===o&&(o=d=0),u=d;u<r.length;u++){var m=r[u];p=m[h];var g=u+c>=0&&u+c<r.length,v=g?r[u+c]:null;if(p||0===p){var y;if("vidya"==n){if(!m["_MASTD "+i.name]&&0!==m["_MASTD "+i.name])continue;y=m["_STD "+i.name]/m["_MASTD "+i.name]}else{if(!m["_CMO "+i.name]&&0!==m["_CMO "+i.name])continue;y=Math.abs(m["_CMO "+i.name])/100}var b=a*y*p+(1-a*y)*o;o=b,u<i.days&&(b=null),v&&(v[s]=b)}else v&&(v[s]=null)}},e.Studies.calculateMovingAverageTimeSeries=function(t,i){i.ma=new e.Studies.StudyDescriptor(i.name,"ma",i.panel),i.ma.chart=i.chart,i.ma.days=i.days,i.ma.startFrom=i.startFrom,i.ma.inputs=i.inputs,e.Studies.calculateLinearRegressionIndicator(t,i.ma);var n=i.name;for(var r in i.outputs)n=r+" "+n;var a=parseInt(i.inputs.Offset,10);isNaN(a)&&(a=0);for(var o=i.chart.scrubbed,s=a,l=i.startFrom-1;l>=0;l--){var h=o[l][n];if(h||0===h){if(!(s>0))break;s--}}for(l++;l<o.length;l++){var c=o[l];l+a>=0&&l+a<o.length&&(o[l+a][n]=c["Forecast "+i.name])}},e.Studies.calculateMovingAverageTriangular=function(t,i){var n=i.chart.scrubbed,r=i.inputs.Field;r&&"field"!=r||(r="Close");var a=Math.ceil(i.days/2);e.Studies.MA("simple",a,i.inputs.Field,0,"TRI1",t,i),i.days%2==0&&a++,e.Studies.MA("simple",a,"TRI1 "+i.name,0,"TRI2",t,i);var o=i.name;for(var s in i.outputs)o=s+" "+o;var l=parseInt(i.inputs.Offset,10);isNaN(l)&&(l=0);for(var h=l,c=i.startFrom-1;c>=0;c--){var u=n[c][o];if(u||0===u){if(!(h>0))break;h--}}for(c++;c<n.length;c++)c+l>=0&&c+l<n.length&&(n[c+l][o]=n[c]["TRI2 "+i.name])},e.Studies.calculateMovingAverageWeighted=function(t,e){var i=e.chart.scrubbed,n=0,r=0,a=e.inputs.Field;a&&"field"!=a||(a="Close");var o=e.days*(e.days+1)/2,s=e.name;for(var l in e.outputs)s=l+" "+s;var h=parseInt(e.inputs.Offset,10);isNaN(h)&&(h=0);var c,u,p=[],d=e.startFrom,f=h;for(c=e.startFrom-1;c>=0;c--)if((u=i[c][a])||0===u)if(f>0)f--,d=c;else{if(p.length==e.days-1)break;p.unshift(u)}for(p.length<e.days-1&&(p=[],d=0),c=0;c<p.length;c++)n+=(c+1)*p[c],r+=p[c];for(c=d;c<i.length;c++){u=i[c][a];var m=c+h>=0&&c+h<i.length,g=m?i[c+h]:null;u||0===u?(p.push(u),p.length>e.days&&(n-=r,r-=p.shift()),n+=p.length*u,r+=u,c<e.days-1?g&&(g[s]=null):g&&(g[s]=n/o)):g&&(g[s]=null)}},e.Studies.calculateKlinger=function(t,i){var n=i.chart.scrubbed,r=Number(i.inputs["Short Cycle"]),a=Number(i.inputs["Long Cycle"]);if(n.length<Math.max(r,a)+1)return void(i.error=!0);var o,s=i.name+"_hist",l="Klinger "+i.name,h="KlingerSignal "+i.name,c="_SV "+i.name,u="_EMA-S "+i.name,p="_EMA-L "+i.name;for(o=Math.max(1,i.startFrom);o<n.length;o++){var d=n[o].Volume;n[o]["hlc/3"]<n[o-1]["hlc/3"]&&(d*=-1),n[o][c]=d}for(e.Studies.MA("exponential",r,c,0,"_EMA-S",t,i),e.Studies.MA("exponential",a,c,0,"_EMA-L",t,i),o=Math.max(a,i.startFrom);o<n.length;o++)n[o][l]=n[o][u]-n[o][p];for(e.Studies.MA("exponential",Number(i.inputs["Signal Periods"]),l,0,"KlingerSignal",t,i),o=i.startFrom;o<n.length;o++)n[o][s]=n[o][l]-n[o][h]},e.Studies.calculateStochastics=function(t,i){i.smooth||(i.smooth=i.inputs.Smooth);var n=i.inputs.Field;n&&"field"!=n||(n="Close");var r=i.inputs["%K Periods"];r||(r=i.days);var a=i.chart.scrubbed;if(a.length<Math.max(r,i.days)+1)return void(i.error=!0);var o=i.inputs["%K Smoothing Periods"];o?i.smooth=!0:i.smooth&&(o=3);var s=i.inputs["%D Periods"];s||(s=3),i.outputMap={},i.outputMap["%K "+i.name]="Fast",i.outputMap["%D "+i.name]="Slow";for(var l=Math.max(r,i.startFrom);l<a.length;l++)a[l][i.name]=function(t,e,i){for(var n=t-i+1,r=-1*Number.MAX_VALUE,o=Number.MAX_VALUE,s=n;s<=t;s++)o=Math.min(o,a[s].Low),r=Math.max(r,a[s].High);return r==o?0:(a[t][e]-o)/(r-o)*100}(l,n,r);e.Studies.MA("simple",i.smooth?o:1,i.name,0,"%K",t,i),e.Studies.MA("simple",s,"%K "+i.name,0,"%D",t,i)},e.Studies.calculateStudyATR=function(t,e){var i=e.chart.scrubbed,n=e.days;if(i.length<n+1)return void(e.error=!0);for(var r=0,a=e.name,o=Math.max(e.startFrom,1);o<i.length;o++){var s=i[o],l=i[o-1],h=s.trueRange;l["Sum True Range "+a]&&(r=l["Sum True Range "+a]),r+=h,o>n&&(r-=i[o-n]["True Range "+a]),s["True Range "+a]=h,s["Sum True Range "+a]=r,o==n?s["ATR "+a]=r/n:o>n&&(s["ATR "+a]=(l["ATR "+a]*(n-1)+h)/n)}},e.Studies.calculatePSAR=function(t,e){function i(){r=0,a=null,o=!o}var n=e.chart.scrubbed,r=0,a=null,o=!1,s=0,l=parseFloat(e.inputs["Minimum AF"]),h=parseFloat(e.inputs["Maximum AF"]);if(e.startFrom>0){s=n[e.startFrom-1]["Result "+e.name];var c=n[e.startFrom-1]["_state "+e.name];c&&3==c.length&&(r=c[0],a=c[1],o=c[2])}for(var u=e.startFrom-1;u<n.length-1;u++)if(!(u<0)){var p=s;if(o){(!a||a<n[u].High)&&(a=n[u].High,r=Math.min(r+l,h)),s=p+r*(a-p);var d=Math.min(n[Math.max(1,u)-1].Low,n[u].Low);s>n[u+1].Low?(s=a,i()):s>d&&(s=d)}else{(!a||a>n[u].Low)&&(a=n[u].Low,r=Math.min(r+l,h)),s=p+r*(a-p);var f=Math.max(n[Math.max(1,u)-1].High,n[u].High);s<n[u+1].High?(s=a,i()):s<f&&(s=f)}n[u+1]["Result "+e.name]=s,n[u+1]["_state "+e.name]=[r,a,o]}},e.Studies.calculateTRIX=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days+1)return void(i.error=!0);for(var r=i.name,a=["Close","_MA1 "+r,"_MA2 "+r,"_MA3 "+r],o=0;o<a.length-1;o++)e.Studies.MA("exponential",i.days,a[o],0,"_MA"+(o+1).toString(),t,i);for(var s=a[3],l=Math.max(1,i.startFrom);l<n.length;l++){var h=n[l-1][s];h&&(n[l]["Result "+r]=100*(n[l][s]/h-1))}},e.Studies.calculateIntradayMomentum=function(t,e){var i=e.chart.scrubbed,n=e.days;if(i.length<n+1)return void(e.error=!0);var r=0,a=0;e.startFrom>1&&(r=i[e.startFrom-1]["_totUp "+e.name],a=i[e.startFrom-1]["_totDn "+e.name]);for(var o=e.startFrom;o<i.length;o++){var s=i[o].Close-i[o].Open;if(s>0?r+=s:a-=s,o>=n){var l=i[o-n].Close-i[o-n].Open;l>0?r-=l:a+=l}i[o]["Result "+e.name]=100*r/(r+a),i[o]["_totUp "+e.name]=r,i[o]["_totDn "+e.name]=a}},e.Studies.calculateQStick=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days+1)return void(i.error=!0);for(var r=i.startFrom;r<n.length;r++)n[r]["_Close-Open "+i.name]=n[r].Close-n[r].Open;e.Studies.MA(i.inputs["Moving Average Type"],i.days,"_Close-Open "+i.name,0,"Result",t,i)},e.Studies.calculateSchaff=function(t,i){function n(t,e,n){for(var a=null,o=null,s=e-t+1;s<=e;s++){var l=r[s][n+" "+i.name];l&&(a=null===a?l:Math.min(a,l),o=null===o?l:Math.max(o,l))}return[a,o]}var r=i.chart.scrubbed,a=i.days,o=Number(i.inputs["Short Cycle"]),s=Number(i.inputs["Long Cycle"]);if(r.length<Math.max(a,o,s)+1)return void(i.error=!0);var l=i.inputs.Field;l&&"field"!=l||(l="Close");e.Studies.MA(i.inputs["Moving Average Type"],o,l,0,"_MACD1",t,i),e.Studies.MA(i.inputs["Moving Average Type"],s,l,0,"_MACD2",t,i);for(var h=0,c=0,u=i.startFrom;u<r.length;u++){var p=r[u];if(p["Result "+i.name]=c,!(u<s-1||(p["_MACD "+i.name]=p["_MACD1 "+i.name]-p["_MACD2 "+i.name],u<s+(a-1)))){var d=n(a,u,"_MACD");h=d[1]>d[0]?100*(p["_MACD "+i.name]-d[0])/(d[1]-d[0]):h,p["_PF "+i.name]=r[u-1]["_PF "+i.name]?r[u-1]["_PF "+i.name]+.5*(h-r[u-1]["_PF "+i.name]):h,u<s+2*(a-1)||(d=n(a,u,"_PF"),c=d[1]>d[0]?100*(p["_PF "+i.name]-d[0])/(d[1]-d[0]):c,p["Result "+i.name]=r[u-1]["Result "+i.name]?r[u-1]["Result "+i.name]+.5*(c-r[u-1]["Result "+i.name]):c)}}},e.Studies.calculateStochMomentum=function(t,i){var n=Number(i.inputs["%K Periods"]),r=Number(i.inputs["%K Smoothing Periods"]),a=Number(i.inputs["%K Double Smoothing Periods"]),o=Number(i.inputs["%D Periods"]),s=i.chart.scrubbed;if(s.length<n+r+a-1||s.length<o)return void(i.error=!0);var l;for(l=Math.max(n,i.startFrom)-1;l<s.length;l++){var h=s[l],c=function(t,e){for(var i=null,n=null,r=e-t+1;r<=e;r++)i=null===i?s[r].Low:Math.min(i,s[r].Low),n=null===n?s[r].High:Math.max(n,s[r].High);return[i,n]}(n,l);h["_H "+i.name]=h.Close-(c[0]+c[1])/2,h["_DHL "+i.name]=c[1]-c[0]}for(e.Studies.MA("exponential",r,"_H "+i.name,0,"_HS1",t,i),e.Studies.MA("exponential",a,"_HS1 "+i.name,0,"_HS2",t,i),e.Studies.MA("exponential",r,"_DHL "+i.name,0,"_DHL1",t,i),e.Studies.MA("exponential",a,"_DHL1 "+i.name,0,"_DHL2",t,i),l=n-1;l<s.length;l++)s[l]["%K "+i.name]=s[l]["_HS2 "+i.name]/(.5*s[l]["_DHL2 "+i.name])*100;e.Studies.MA(i.inputs["%D Moving Average Type"],o,"%K "+i.name,0,"%D",t,i),i.zoneOutput="%K"},e.Studies.calculateEhlerFisher=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)return void(e.error=!0);var n=0;e.startFrom>1&&(n=i[e.startFrom-1]["_n "+e.name]);for(var r=e.startFrom;r<i.length;r++){var a=i[r];if(r<e.days-1)a["EF "+e.name]=a["EF Trigger "+e.name]=n;else{var o=function(t,e){for(var n=Number.MAX_VALUE,r=-1*Number.MAX_VALUE,a=e-t+1;a<=e;a++){var o=(i[a].High+i[a].Low)/2;n=Math.min(n,o),r=Math.max(r,o)}return[n,r]}(e.days,r);n=.66*(((i[r].High+i[r].Low)/2-o[0])/Math.max(1e-6,o[1]-o[0])-.5)+.67*n,n>0?n=Math.min(n,.9999):n<0&&(n=Math.max(n,-.9999));var s=r?i[r-1]["EF "+e.name]:0;a["EF "+e.name]=.5*Math.log((1+n)/(1-n))+.5*s,a["EF Trigger "+e.name]=s,a["_n "+e.name]=n}}},e.Studies.calculatePrettyGoodOscillator=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days+1)return void(i.error=!0);e.Studies.MA("exponential",i.days,"trueRange",0,"_EMA",t,i),e.Studies.MA("simple",i.days,"Close",0,"_SMA",t,i);for(var r=Math.max(1,i.startFrom);r<n.length;r++)n[r]["_SMA "+i.name]&&n[r]["_EMA "+i.name]&&(n[r]["Result "+i.name]=(n[r].Close-n[r]["_SMA "+i.name])/n[r]["_EMA "+i.name])},e.Studies.calculateUltimateOscillator=function(t,e){var i=e.chart.scrubbed,n=[e.inputs["Cycle 1"],e.inputs["Cycle 2"],e.inputs["Cycle 3"]],r=Math.max(n[0],n[1],n[2]);if(i.length<r+1)return void(e.error=!0);var a=n[0]*n[1],o=n[0]*n[2],s=n[1]*n[2],l=[0,0,0],h=[0,0,0];e.startFrom&&(i[e.startFrom-1]["_accbp "+e.name]&&(l=i[e.startFrom-1]["_accbp "+e.name].slice()),i[e.startFrom-1]["_acctr "+e.name]&&(h=i[e.startFrom-1]["_acctr "+e.name].slice()));for(var c=Math.max(1,e.startFrom);c<i.length;c++){for(var u=Math.min(i[c].Low,i[c-1].Close),p=i[c].Close-u,d=Math.max(i[c].High,i[c-1].Close)-u,f=0;f<n.length;f++)if(l[f]+=p,h[f]+=d,c>n[f]){var m=Math.min(i[c-n[f]].Low,i[c-n[f]-1].Close),g=i[c-n[f]].Close-m,v=Math.max(i[c-n[f]].High,i[c-n[f]-1].Close)-m;l[f]-=g,h[f]-=v}if(i[c]["_accbp "+e.name]=l.slice(),i[c]["_acctr "+e.name]=h.slice(),!(c<r)){var y=s*l[0]/h[0]+o*l[1]/h[1]+a*l[2]/h[2],b=s+o+a;i[c]["Result "+e.name]=100*y/b}}},e.Studies.calculatePriceVolumeTrend=function(t,e){var i=e.inputs.Field;i&&"field"!=i||(i="Close");var n=e.chart.scrubbed,r=0;e.startFrom>1&&(r=n[e.startFrom-1]["Result "+e.name]);for(var a=Math.max(1,e.startFrom);a<n.length;a++)n[a][i]&&n[a-1][i]&&(r+=n[a].Volume*(n[a][i]-n[a-1][i])/n[a-1][i],n[a]["Result "+e.name]=r)},e.Studies.calculateOnBalanceVolume=function(t,e){var i=e.inputs.Field;i&&"field"!=i||(i="Close");var n=e.inputs["Min Tick Value"],r=!1;n||0===n||(r=!0,n=0);for(var a,o,s=e.chart.scrubbed,l=0,h=e.startFrom;h<s.length;h++)if(a=s[h],h&&a[i]&&(s[h-1][i]&&(o=s[h-1]),o)){a[i]-o[i]>n?l=1:o[i]-a[i]>n?l=-1:r&&(l=0);var c=o["Result "+e.name];c||(c=0),c+=a.Volume*l,a["Result "+e.name]=c}},e.Studies.calculateVolumeIndex=function(t,i){var n=i.inputs.Field;n&&"field"!=n||(n="Close");var r=i.chart.scrubbed;if(r.length<i.days+1)return void(i.error=!0);var a=100;i.startFrom>1&&(a=r[i.startFrom-1]["Index "+i.name]);for(var o=Math.max(1,i.startFrom);o<r.length;o++)r[o][n]&&r[o-1][n]&&(("Pos Vol"==i.type&&r[o].Volume>r[o-1].Volume||"Neg Vol"==i.type&&r[o].Volume<r[o-1].Volume)&&(a*=r[o][n]/r[o-1][n]),r[o]["Index "+i.name]=a);e.Studies.MA(i.inputs["Moving Average Type"],i.days,"Index "+i.name,0,"MA",t,i)},e.Studies.calculateHistoricalVolatility=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)return void(e.error=!0);var n=e.inputs.Field;n&&"field"!=n||(n="Close");var r=e.inputs["Standard Deviations"];r<0&&(r=1);var a=100*Math.sqrt(function(e){return isNaN(e)&&(e=365),"day"==t.layout.interval?e:"week"==t.layout.interval?52:"month"==t.layout.interval?12:e}(e.inputs["Days Per Year"]))*r,o=[],s=0;e.startFrom>1&&(s=i[e.startFrom-1]["_state "+e.name][0],o=i[e.startFrom-1]["_state "+e.name][1].slice());for(var l=Math.max(1,e.startFrom);l<i.length;l++){var h=i[l-1][n];if(h){var c=Math.log(i[l][n]/h);if(o.push(c),s+=c,l>=e.days){var u=0;s/=e.days;for(var p=0;p<o.length;p++)u+=Math.pow(o[p]-s,2);s*=e.days,s-=o.shift(),i[l]["Result "+e.name]=Math.sqrt(u/e.days)*a}}i[l]["_state "+e.name]=[s,o.slice()]}},e.Studies.calculateSwingIndex=function(t,e){var i=e.inputs["Limit Move Value"];(null===i||isNaN(i))&&(i=99999);var n=e.chart.scrubbed,r=0;e.startFrom>1&&(r=n[e.startFrom-1]["Result "+e.name]);for(var a=Math.max(1,e.startFrom);a<n.length;a++){var o=Math.abs(n[a].High-n[a-1].Close),s=Math.abs(n[a].Low-n[a-1].Close),l=Math.abs(n[a].High-n[a].Low),h=Math.abs(n[a-1].Close-n[a-1].Open),c=Math.max(o,s),u=Math.max(l,c),p=u+.25*h;u==o?p-=.5*s:u==s&&(p-=.5*o);var d=50*(n[a].Close-n[a-1].Close+.5*(n[a].Close-n[a].Open)+.25*(n[a-1].Close-n[a-1].Open))/p*(c/i);0!==p&&0!==i||(d=0),"Swing"==e.type&&(r=0),r+=d,n[a]["Result "+e.name]=r}},e.Studies.calculateADX=function(t,i){e.Studies.calculateStudyATR(t,i);var n=i.chart.scrubbed,r=i.days,a=parseInt(i.inputs["Smoothing Period"],10);if(a||0===a||(a=r),n.length<i.days+1)return void(i.error=!0);for(var o,s=0,l=0,h=0,c=0,u=Math.max(1,i.startFrom);u<n.length;u++){o=n[u];var p=Math.max(0,o.High-n[u-1].High),d=Math.max(0,n[u-1].Low-o.Low);if(p>d?d=0:p=d>p?0:d=0,u<=r?(l+=p,h+=d,s+=o["True Range "+i.name]):(l=n[u-1]["_sm+DM "+i.name]*(r-1)/r+p,h=n[u-1]["_sm-DM "+i.name]*(r-1)/r+d,s=n[u-1]["_smTR "+i.name]*(r-1)/r+o["True Range "+i.name]),o["_sm+DM "+i.name]=l,o["_sm-DM "+i.name]=h,o["_smTR "+i.name]=s,!(u<r)){var f=100*l/s,m=100*h/s,g=100*Math.abs(f-m)/(f+m);if(o["+DI "+i.name]=f,o["-DI "+i.name]=m,!1!==i.inputs.Series&&a)if(u<r+a-1){if(u==i.startFrom)for(var v=r;v<i.startFrom;v++)c+=100*Math.abs(n[v]["+DI "+i.name]-n[v]["-DI "+i.name])/(n[v]["+DI "+i.name]+n[v]["-DI "+i.name]);c+=g}else o["ADX "+i.name]=u==r+a-1?c/a:(n[u-1]["ADX "+i.name]*(a-1)+g)/a;if(i.inputs.Histogram){var y=i.name+"_hist";if(!o["+DI "+i.name]&&0!==o["+DI "+i.name])continue;if(!o["-DI "+i.name]&&0!==o["-DI "+i.name])continue;o[y]=o["+DI "+i.name]-o["-DI "+i.name],!1===i.inputs.Series&&(o["+DI "+i.name]=null,o["-DI "+i.name]=null)}}}},e.Studies.calculateRandomWalk=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)return void(e.error=!0);for(var n=Math.max(2,e.startFrom);n<i.length;n++){for(var r=0,a=i[n].High,o=i[n].Low,s=0,l=0,h=1;h<=e.days;h++){if(n<=h){s=l=0;break}r+=i[n-h].trueRange;var c=r/h*Math.sqrt(h);if(c){var u=(a-i[n-h].Low)/c,p=(i[n-h].High-o)/c;s=Math.max(s,u),l=Math.max(l,p)}}i[n]["Random Walk High "+e.name]=s,i[n]["Random Walk Low "+e.name]=l}},e.Studies.calculateRateOfChange=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)return void(e.error=!0);var n=e.inputs.Field;"Vol ROC"==e.type?n="Volume":n&&"field"!=n||(n="Close");var r=e.name;for(var a in e.outputs)r=a+" "+r;var o=e.inputs["Center Line"];o=o?parseInt(o,10):0;for(var s=Math.max(e.startFrom,e.days);s<i.length;s++)if("Momentum"==e.type)i[s][r]=i[s][n]-i[s-e.days][n]+o;else{var l=i[s-e.days][n];l&&(i[s][r]=100*(i[s][n]/l-1)+o)}},e.Studies.calculateTypicalPrice=function(t,e){var i=e.chart.scrubbed,n=e.days;if(i.length<n+1)return void(e.overlay||(e.error=!0));var r=e.name;for(var a in e.outputs)r=a+" "+r;var o="hlc/3";"Med Price"==e.type?o="hl/2":"Weighted Close"==e.type&&(o="hlcc/4");var s=0;e.startFrom<=n&&(e.startFrom=0);for(var l=e.startFrom;l<i.length;l++)l&&i[l-1][r]&&(s=i[l-1][r]*n),s+=i[l][o],l>=n&&(s-=i[l-n][o],i[l][r]=s/n)},e.Studies.calculateElderRay=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days)return void(i.error=!0);e.Studies.MA("exponential",i.days,"Close",0,"_EMA",t,i);for(var r=Math.max(i.startFrom,i.days-1);r<n.length;r++)n[r][i.name+"_hist1"]=n[r].High-n[r]["_EMA "+i.name],n[r][i.name+"_hist2"]=n[r].Low-n[r]["_EMA "+i.name]},e.Studies.calculateElderForce=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days)return void(i.error=!0);for(var r=Math.max(1,i.startFrom);r<n.length;r++)n[r]["_EF1 "+i.name]=n[r].Volume*(n[r].Close-n[r-1].Close);e.Studies.MA("exponential",i.days,"_EF1 "+i.name,0,"Result",t,i)},e.Studies.calculateCenterOfGravity=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days)return void(e.error=!0);var n=e.inputs.Field;n&&"field"!=n||(n="Close");for(var r=Math.max(e.startFrom,e.days-1);r<i.length;r++){for(var a=0,o=0,s=0;s<e.days;s++)a-=(s+1)*i[r-s][n],o+=i[r-s][n];o&&(i[r]["Result "+e.name]=a/o)}},e.Studies.calculateEaseOfMovement=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days)return void(i.error=!0);for(var r=Math.max(1,i.startFrom);r<n.length;r++){var a=(n[r].High+n[r].Low)/2,o=(n[r-1].High+n[r-1].Low)/2,s=a-o,l=n[r].Volume/1e8/(n[r].High-n[r].Low),h=s/l;isFinite(h)?n[r]["_EOM1 "+i.name]=h:n[r]["_EOM1 "+i.name]=NaN}e.Studies.MA(i.inputs["Moving Average Type"],i.days,"_EOM1 "+i.name,0,"Result",t,i)},e.Studies.calculateChaikinVolatility=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days)return void(i.error=!0);var r;for(r=i.startFrom;r<n.length;r++)n[r]["_High-Low "+i.name]=n[r].High-n[r].Low;e.Studies.MA(i.inputs["Moving Average Type"],i.days,"_High-Low "+i.name,0,"_MA",t,i);var a=i.inputs["Rate Of Change"];for(a||(a=i.days),r=Math.max(i.startFrom,a);r<n.length;r++)n[r-a]["_MA "+i.name]&&(n[r]["Result "+i.name]=100*(n[r]["_MA "+i.name]/n[r-a]["_MA "+i.name]-1))},e.Studies.calculateChaikinMoneyFlow=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days)return void(e.error=!0);var n=0,r=0,a=i[e.startFrom-1];a&&(a["_sumMF "+e.name]&&(n=a["_sumMF "+e.name]),a["_sumV "+e.name]&&(r=a["_sumV "+e.name]));for(var o=e.startFrom;o<i.length;o++)i[o].High==i[o].Low?i[o]["_MFV "+e.name]=0:i[o]["_MFV "+e.name]=i[o].Volume*(2*i[o].Close-i[o].High-i[o].Low)/(i[o].High-i[o].Low),n+=i[o]["_MFV "+e.name],r+=i[o].Volume,o>e.days-1&&(n-=i[o-e.days]["_MFV "+e.name],(r-=i[o-e.days].Volume)&&(i[o]["Result "+e.name]=n/r)),i[o]["_sumMF "+e.name]=n,i[o]["_sumV "+e.name]=r},e.Studies.calculateTwiggsMoneyFlow=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days)return void(e.error=!0);var n=0,r=0,a=i[e.startFrom-1];a&&(a["_sumMF "+e.name]&&(n=a["_sumMF "+e.name]),a["_sumV "+e.name]&&(r=a["_sumV "+e.name]));for(var o=Math.max(1,e.startFrom);o<i.length;o++){var s=Math.max(i[o-1].Close,i[o].High),l=Math.min(i[o-1].Close,i[o].Low);i[o]["_MFV "+e.name]=i[o].Volume*(2*i[o].Close-s-l)/(s-l==0?999999:s-l),o>e.days-1&&(n*=(e.days-1)/e.days,r*=(e.days-1)/e.days),n+=i[o]["_MFV "+e.name],r+=i[o].Volume,o>e.days-1&&r&&(i[o]["Result "+e.name]=n/(r>0?r:999999)),i[o]["_sumMF "+e.name]=n,i[o]["_sumV "+e.name]=r}},e.Studies.calculateMassIndex=function(t,i){var n=i.chart.scrubbed;if(n.length<Math.max(9,i.days+1))return void(i.error=!0);for(var r=i.startFrom;r<n.length;r++)n[r]["_High-Low "+i.name]=n[r].High-n[r].Low;e.Studies.MA("exponential",9,"_High-Low "+i.name,0,"_EMA",t,i),e.Studies.MA("exponential",9,"_EMA "+i.name,0,"_EMA2",t,i);var a=0;n[i.startFrom-1]&&n[i.startFrom-1]["_total "+i.name]&&(a=n[i.startFrom-1]["_total "+i.name]);for(var o=Math.max(17,i.startFrom);o<n.length;o++)a+=n[o]["_EMA "+i.name]/n[o]["_EMA2 "+i.name],o>=17+i.days-1&&(n[o]["Result "+i.name]=a,a-=n[o-i.days+1]["_EMA "+i.name]/n[o-i.days+1]["_EMA2 "+i.name]),n[o]["_total "+i.name]=a},e.Studies.calculateMoneyFlowIndex=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)return void(e.error=!0);var n=0,r=0,a=i[e.startFrom-1],o="_rawMF "+e.name,s="_cumMF "+e.name,l="Result "+e.name;a&&a[s]&&(n=a[s][0],r=a[s][1]);for(var h=e.startFrom;h<i.length;h++){var c=i[h]["hlc/3"];if(h>0){var u=i[h-1]["hlc/3"],p=c*i[h].Volume;if(c>u?n+=p:c<u?(p*=-1,r-=p):p=0,h>e.days){var d=i[h-e.days][o];d>0?n-=d:r+=d,i[h][l]=0===r?100:100-100/(1+n/r)}i[h][o]=p,i[h][s]=[n,r]}}},e.Studies.calculateChandeMomentum=function(t,e){var i=e.name;for(var n in e.outputs)i=n+" "+i;var r=e.chart.scrubbed;if(r.length<e.days+1)return void(e.error=!0);for(var a=0,o=0,s=[],l=e.startFrom-e.days+1;l<r.length;l++)if(!(l<1)){var h=r[l].Close-r[l-1].Close;if(s.push(h),a+=h,o+=Math.abs(h),s.length==e.days){r[l][i]=100*a/o;var c=s.shift();a-=c,o-=Math.abs(c)}}},e.Studies.calculateChandeForecast=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days+1)return void(i.error=!0);var r=i.inputs.Field;r&&"field"!=r||(r="Close"),e.Studies.MA("time series",i.days,r,0,"MA",t,i);for(var a=Math.max(1,i.startFrom);a<n.length;a++)n[a]["Result "+i.name]=100*(1-n[a]["MA "+i.name]/n[a][r])},e.Studies.calculateDetrendedPrice=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days+1)return void(i.error=!0);var r=i.inputs.Field;r&&"field"!=r||(r="Close"),e.Studies.MA(i.inputs["Moving Average Type"],i.days,r,0,"MA",t,i);for(var a=Math.max(i.startFrom,Math.floor(i.days/2+1));a<n.length;a++)n[a]["Result "+i.name]=n[a-Math.floor(i.days/2+1)][r]-n[a]["MA "+i.name]},e.Studies.calculateAroon=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)return void(e.error=!0);var n=0,r=0,a=null,o=null;if(e.startFrom>0){var s=i[e.startFrom-1]["_state "+e.name];s&&(n=s[0],r=s[1],a=s[2],o=s[3])}for(var l,h=e.startFrom;h<i.length;h++){if(null===a&&(a=i[h].High),null===o&&(o=i[h].Low),(a=Math.max(a,i[h].High))==i[h].High)n=0;else if(++n>e.days)for(a=i[h].High,n=0,l=1;l<=e.days;l++)(a=Math.max(a,i[h-l].High))==i[h-l].High&&(n=l);if((o=Math.min(o,i[h].Low))==i[h].Low)r=0;else if(++r>e.days)for(o=i[h].Low,r=0,l=1;l<=e.days;l++)(o=Math.min(o,i[h-l].Low))==i[h-l].Low&&(r=l);i[h]["Aroon Up "+e.name]=100*(1-n/e.days),i[h]["Aroon Down "+e.name]=100*(1-r/e.days),i[h]["Aroon Oscillator "+e.name]=i[h]["Aroon Up "+e.name]-i[h]["Aroon Down "+e.name],i[h]["_state "+e.name]=[n,r,a,o]}},e.Studies.calculatePrimeNumber=function(t,e){function i(t){if(t<=0)return!1;if(t!=Math.floor(t))return!1;if(!0===n[t]||!1===n[t])return n[t];for(var e=parseInt(Math.sqrt(t),10),i=2;i<=e;i++)if(t%i==0)return n[t]=!1,!1;return n[t]=!0,!0}for(var n=[],r=e.chart.scrubbed,a=e.startFrom;a<r.length;a++){var o=r[a];if(o){for(var s=o.High,l=0;s>0&&s<=10;l++)s*=10;for(i(s)&&(s+=2),s=Math.ceil(s),s%2==0&&s++;!i(s);)s+=2;s/=Math.pow(10,l);for(var h=o.Low,c=0;h>0&&h<=10;c++)h*=10;if(i(h)&&(h-=2),h=Math.floor(h),h%2==0&&h--,h>0){for(;!i(h);)h-=2;h/=Math.pow(10,c)}if("Prime Number Bands"==e.type)o["Prime Bands Top "+e.name]=s,o["Prime Bands Bottom "+e.name]=Math.max(0,h);else{var u=0,p=e.inputs["Tolerance Percentage"]*(s-h)/100,d=s+h-2*o.Close;d<p?u=1:d>p&&(u=-1),u&&(o["Result "+e.name]=u)}}}},e.Studies.calculateVerticalHorizontalFilter=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days+1)return void(i.error=!0);i.mhml=new e.Studies.StudyDescriptor(i.name,i.type,i.panel),i.mhml.chart=i.chart,i.mhml.days=i.days,i.mhml.startFrom=i.startFrom,i.mhml.inputs={},i.mhml.outputs={_MHML:null},e.Studies.calculateMaxHighMinLow(t,i.mhml);for(var r=0,a=[],o=Math.max(1,i.startFrom-i.days);o<n.length;o++){var s=Math.abs(n[o].Close-n[o-1].Close);a.push(s),r+=s,a.length==i.days&&(n[o]["Result "+i.name]=n[o]["_MHML "+i.name]/r,r-=a.shift())}},e.Studies.calculatePriceOscillator=function(t,i){var n=i.chart.scrubbed,r=Number(i.inputs["Short Cycle"]),a=Number(i.inputs["Long Cycle"]);if(n.length<Math.max(r,a)+1)return void(i.error=!0);var o=i.inputs.Field,s=i.inputs["Moving Average Type"];s||(s="simple"),o&&"field"!=o||(i.parameters.isVolume?(o="Volume",s="exponential"):o="Close");var l=i.inputs["Points Or Percent"];l||(l="Percent"),e.Studies.MA(s,r,o,0,"_Short MA",t,i),e.Studies.MA(s,a,o,0,"_Long MA",t,i);for(var h=Math.max(a,i.startFrom);h<n.length;h++){var c=n[h];c&&(c["Result "+i.name]="Points"==l?c["_Short MA "+i.name]-c["_Long MA "+i.name]:100*(c["_Short MA "+i.name]/c["_Long MA "+i.name]-1),i.outputs["Increasing Bar"]&&(c[i.name+"_hist"]=c["Result "+i.name]))}},e.Studies.calculateKeltner=function(t,i){e.Studies.MA(i.inputs["Moving Average Type"],i.days,"Close",0,"MA",t,i),e.Studies.calculateStudyATR(t,i),e.Studies.calculateGenericEnvelope(t,i,i.inputs.Shift,"MA "+i.name,"ATR "+i.name)},e.Studies.calculateCoppock=function(t,i){var n=i.chart.scrubbed,r=i.inputs.Field;r&&"field"!=r||(r="Close");var a=parseInt(i.inputs["Long RoC"],10);a||(a=14);var o=parseInt(i.inputs["Short RoC"],10);o||(o=11);var s=i.days;if(s||(s=10),!(a<o)){if(n.length<Math.max(o,a,s)+1)return void(i.error=!0);for(var l=Math.max(i.startFrom,a);l<n.length;l++){var h=n[l-o][r],c=n[l-a][r];h&&c&&(n[l]["_Sum "+i.name]=100*(n[l][r]/h+n[l][r]/c-2))}e.Studies.MA("weighted",s,"_Sum "+i.name,0,"Result",t,i)}},e.Studies.calculateLinearRegressionIndicator=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)return void(e.error=!0);var n=e.inputs.Field;n&&"field"!=n||(n="Close");var r=e.days*(e.days+1)/2,a=Math.pow(r,2),o=r*(2*e.days+1)/3,s=0,l=0,h=0;if(e.startFrom){var c=i[e.startFrom-1]["_sums "+e.name];c&&(l=c[0],s=c[1],h=c[2])}for(var u=e.startFrom;u<i.length;u++)if((i[u][n]||0===i[u][n])&&(l+=e.days*i[u][n]-s,s+=i[u][n],h+=Math.pow(i[u][n],2),!(u<e.days-1))){if(u>e.days-1){if(!i[u-e.days][n]&&0!==i[u-e.days][n])continue;s-=i[u-e.days][n],h-=Math.pow(i[u-e.days][n],2)}var p=(e.days*l-r*s)/(e.days*o-a);i[u]["Slope "+e.name]=p;var d=(s-p*r)/e.days;i[u]["Intercept "+e.name]=d,i[u]["Forecast "+e.name]=d+p*e.days;var f=(e.days*o-a)/(e.days*h-Math.pow(s,2));i[u]["RSquared "+e.name]=p*p*f,i[u]["_sums "+e.name]=[l,s,h]}},e.Studies.calculateBollinger=function(t,i){var n=i.inputs.Field;n&&"field"!=n||(n="Close"),e.Studies.MA(i.inputs["Moving Average Type"],i.days,n,0,"_MA",t,i),i.std=new e.Studies.StudyDescriptor(i.name,"STD Dev",i.panel),i.std.chart=i.chart,i.std.startFrom=i.startFrom,i.std.days=i.days,i.std.inputs={Field:n,"Standard Deviations":1,Type:i.inputs["Moving Average Type"]},i.std.outputs={"_STD Dev":null},e.Studies.calculateStandardDeviation(t,i.std),e.Studies.calculateGenericEnvelope(t,i,i.inputs["Standard Deviations"],"_MA "+i.name,"_STD Dev "+i.name),"Boll %b"==i.type&&(i.zoneOutput="%b")},e.Studies.calculateMAEnvelope=function(t,i){var n=i.inputs.Field;n&&"field"!=n||(n="Close"),e.Studies.MA(i.inputs["Moving Average Type"],i.days,n,0,"MA",t,i);var r=i.inputs["Shift Type"],a=i.inputs.Shift;r||(r="percent",a=i.inputs["Shift Percentage"]),"percent"==r?e.Studies.calculateGenericEnvelope(t,i,a/100,"MA "+i.name):"points"==r&&e.Studies.calculateGenericEnvelope(t,i,null,"MA "+i.name,null,Number(a))},e.Studies.calculateGenericEnvelope=function(t,e,i,n,r,a){i||(i=0),a||(a=0),n||(n="Close"),r||(r=n);for(var o=e.chart.scrubbed,s=e.startFrom;o&&s<o.length;s++){var l=o[s];if(l&&l[n]){var h=i*l[r]+a;l[e.type+" Top "+e.name]=l[n]+h,l[e.type+" Bottom "+e.name]=l[n]-h,l[e.type+" Median "+e.name]=l[n],l["Bandwidth "+e.name]=200*h/l[n],l["%b "+e.name]=50*((l.Close-l[n])/h+1)}}},e.Studies.calculateMaxHighMinLow=function(t,e){var i=e.chart.scrubbed,n=e.days,r=e.days;if(e.inputs["High Period"]&&(n=e.inputs["High Period"]),e.inputs["Low Period"]&&(r=e.inputs["Low Period"]),i.length<Math.max(n,r)+1)return void(e.error=!0);var a,o=Number.MAX_VALUE,s=-1*Number.MAX_VALUE;if(e.startFrom>1){for(a=1;a<n;a++)s=Math.max(s,i[e.startFrom-a].High);for(a=1;a<r;a++)o=Math.min(o,i[e.startFrom-a].Low)}for(var l=Math.max(0,e.startFrom-1);l<i.length;l++){if(s=Math.max(s,i[l].High),o=Math.min(o,i[l].Low),l>=n&&i[l-n].High==s)for(s=i[l].High,a=1;a<n;a++)s=Math.max(s,i[l-a].High);if(l>=r&&i[l-r].Low==o)for(o=i[l].Low,a=1;a<r;a++)o=Math.min(o,i[l-a].Low);var h=0;if("HHV"==e.type)h=s;else if("LLV"==e.type)h=o;else if("Donchian Width"==e.type)h=s-o;else if("GAPO"==e.type||"Gopala"==e.type)h=Math.log(s-o)/Math.log(r);else{if("VT HZ Filter"==e.type){h=s-o,i[l]["_MHML "+e.name]=h;continue}if("Williams %R"==e.type){h=-100*(s-i[l].Close)/(s-o),i[l]["Result "+e.name]=h;continue}}if(l==i.length-1)break;"Donchian Channel"==e.type?(i[l+1]["Donchian High "+e.name]=s,i[l+1]["Donchian Low "+e.name]=o,i[l+1]["Donchian Median "+e.name]=(s+o)/2):i[l+1]["Result "+e.name]=h}},e.Studies.calculateAccumulationDistribution=function(t,e){for(var i=e.chart.scrubbed,n=e.startFrom;n<i.length;n++)if(n){var r=i[n],a=i[n-1],o=0;r.Close>a.Close?o=r.Close-Math.min(r.Low,a.Close):r.Close<a.Close&&(o=r.Close-Math.max(r.High,a.Close)),e.inputs["Use Volume"]&&(o*=r.Volume);var s=a["Result "+e.name];s||(s=0),s+=o,r["Result "+e.name]=s}},e.Studies.calculateCCI=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days+1)return void(i.error=!0);e.Studies.MA("simple",i.days,"hlc/3",0,"MA",t,i);for(var r=Math.max(i.startFrom,i.days-1);r<n.length;r++){var a=n[r];if(a){for(var o=0,s=0;s<i.days;s++)o+=Math.abs(n[r-s]["hlc/3"]-a["MA "+i.name]);o/=i.days,Math.abs(o)<1e-8?a["Result "+i.name]=0:a["Result "+i.name]=(a["hlc/3"]-a["MA "+i.name])/(.015*o)}}},e.Studies.calculateFractalChaos=function(t,e){var i=e.chart.scrubbed,n=0,r=0,a=0;e.startFrom&&"Fractal Chaos Bands"==e.type&&(n=i[e.startFrom-1]["Fractal High "+e.name],r=i[e.startFrom-1]["Fractal Low "+e.name]);for(var o=Math.max(4,e.startFrom);o<i.length;o++){i[o]["Result "+e.name]=0;var s;for(a=0,s=0;s<=o&&i[o-s]&&!(i[o-s].High>i[o-2].High)&&!(s<2&&i[o-s].High==i[o-2].High);s++)if(i[o-s].High<i[o-2].High&&a++,4==a){n=i[o-2].High;break}for("Fractal Chaos Bands"==e.type?i[o]["Fractal High "+e.name]=n>0?n:null:4==a&&(i[o]["Result "+e.name]=1),a=0,s=0;s<=o&&i[o-s]&&!(i[o-s].Low<i[o-2].Low)&&!(s<2&&i[o-s].Low==i[o-2].Low);s++)if(i[o-s].Low>i[o-2].Low&&a++,4==a){r=i[o-2].Low;break}"Fractal Chaos Bands"==e.type?i[o]["Fractal Low "+e.name]=r>0?r:null:4==a&&(i[o]["Result "+e.name]=-1)}},e.Studies.displayPrettyGoodOscillator=function(t,i,n){e.Studies.displaySeriesAsLine(t,i,n);var r=t.panels[i.panel],a=t.chart.context.strokeStyle;t.chart.context.globalAlpha=.2,t.chart.context.strokeStyle=i.outputs.Result,t.chart.context.beginPath();var o=t.pixelFromPrice(3,r);t.chart.context.moveTo(0,o),t.chart.context.lineTo(t.chart.width,o);var s=t.pixelFromPrice(-3,r);t.chart.context.moveTo(0,s),t.chart.context.lineTo(t.chart.width,s),t.chart.context.stroke(),t.chart.context.closePath();var l={skipTransform:t.panels[i.panel].name!=i.chart.name,panelName:i.panel,band:"Result "+i.name,threshold:3,direction:1,color:i.outputs.Result};e.preparePeakValleyFill(t,l),e.preparePeakValleyFill(t,e.extend(l,{threshold:-3,direction:-1})),t.chart.context.strokeStyle=a,t.chart.context.globalAlpha=1},e.Studies.displayRAVI=function(t,i,n){var r;e.Studies.determineMinMax(t,i,n);var a=t.panels[i.panel];a.yAxis.low=a.min=Math.min(0,a.min),a.yAxis.high=a.max=Math.max(0,a.max),e.Studies.displaySeriesAsLine(t,i,n);var o=t.pixelFromPrice(0,a),s=t.layout.candleWidth-2;s<2&&(s=1);var l=e.Studies.determineColor(i.outputs["Increasing Bar"]),h=e.Studies.determineColor(i.outputs["Decreasing Bar"]);for(t.canvasColor("stx_histogram"),t.chart.context.globalAlpha=1,t.startClip(i.panel),r=0;r<n.length;r++){var c=n[r];if(c&&n[r-1]){var u=0,p=0;i.parameters&&i.parameters.studyOverZonesEnabled&&(u=parseFloat(i.parameters.studyOverBoughtValue),p=parseFloat(i.parameters.studyOverSoldValue)),0===r?t.chart.context.fillStyle="#CCCCCC":c[i.name+"_hist"]>u&&n[r-1][i.name+"_hist"]<c[i.name+"_hist"]?t.chart.context.fillStyle=l:c[i.name+"_hist"]<p&&n[r-1][i.name+"_hist"]>c[i.name+"_hist"]?t.chart.context.fillStyle=h:t.chart.context.fillStyle="#CCCCCC",c.candleWidth&&(s=Math.floor(Math.max(1,c.candleWidth-2))),t.chart.context.fillRect(Math.floor(t.pixelFromBar(r,a.chart)-s/2),Math.floor(o),Math.floor(s),Math.floor(t.pixelFromPrice(c[i.name+"_hist"],a)-o))}}t.endClip()},e.Studies.displayElderForce=function(t,i,n){e.Studies.displaySeriesAsLine(t,i,n);var r={skipTransform:t.panels[i.panel].name!=i.chart.name,panelName:i.panel,band:"Result "+i.name,threshold:0,color:i.outputs.Result};r.direction=1,e.preparePeakValleyFill(t,r),r.direction=-1,e.preparePeakValleyFill(t,r)},e.Studies.displayElderRay=function(t,i,n){function r(n,r,l,h){t.chart.context.fillStyle=e.Studies.determineColor(i.outputs[l]),t.chart.context.fillRect(Math.floor(t.pixelFromBar(n,a.chart)-s/2+s*r),Math.floor(o),Math.floor(s*(1-2*r)),Math.floor(t.pixelFromPrice(c[i.name+h],a)-o))}e.Studies.determineMinMax(t,i,n);var a=t.panels[i.panel];a.yAxis.low=a.min=Math.min(0,a.min),a.yAxis.high=a.max=Math.max(0,a.max),e.Studies.displaySeriesAsLine(t,i,n);var o=t.pixelFromPrice(0,a),s=t.layout.candleWidth-2;s<2&&(s=1),t.canvasColor("stx_histogram");var l=t.chart.context.fillStyle;t.chart.context.globalAlpha=1,t.startClip(i.panel);for(var h=0;h<n.length;h++){var c=n[h];c&&(c.candleWidth&&(s=Math.floor(Math.max(1,c.candleWidth-2))),c[i.name+"_hist1"]>0&&r(h,0,"Elder Bull Power","_hist1"),c[i.name+"_hist2"]<0&&r(h,0,"Elder Bear Power","_hist2"),c[i.name+"_hist1"]<0&&r(h,.1,"Elder Bull Power","_hist1"),c[i.name+"_hist2"]>0&&r(h,.1,"Elder Bear Power","_hist2"))}t.endClip(),t.chart.context.fillStyle=l},e.Studies.displayADX=function(t,i,n){if(e.Studies.createYAxis(t,i,n,t.panels[i.panel]),i.inputs.Series&&i.inputs.Shading){var r="+DI "+i.name,a="-DI "+i.name,o=e.Studies.determineColor(i.outputs[i.outputMap[r]]),s=e.Studies.determineColor(i.outputs[i.outputMap[a]]),l={topBand:r,bottomBand:a,topColor:o,bottomColor:s,skipTransform:t.panels[i.panel].name!=i.chart.name};e.fillIntersecting(t,i.panel,l)}var h=i.inputs.Series?.4:1;i.inputs.Histogram&&e.Studies.createHistogram(t,i,n,!1,h),!1!==i.inputs.Series?e.Studies.displaySeriesAsLine(t,i,n):i.inputs.Series||i.inputs.Histogram||t.watermark(i.panel,"center","bottom",t.translateIf("Nothing to display"))},e.Studies.displayMassIndex=function(t,i,n){e.Studies.displaySeriesAsLine(t,i,n);var r=i.inputs["Bulge Threshold"],a=t.panels[i.panel],o=t.chart.context.strokeStyle;t.chart.context.globalAlpha=.2,t.chart.context.strokeStyle=i.outputs.Result,t.chart.context.beginPath();var s=t.pixelFromPrice(r,a);t.chart.context.moveTo(0,s),t.chart.context.lineTo(t.chart.width,s),t.chart.context.stroke(),t.chart.context.closePath(),e.preparePeakValleyFill(t,{skipTransform:t.panels[i.panel].name!=i.chart.name,panelName:i.panel,band:"Result "+i.name,threshold:r,direction:1,color:i.outputs.Result}),t.chart.context.strokeStyle=o,t.chart.context.globalAlpha=1},e.Studies.displayChannel=function(t,i,n){if(i.inputs["Channel Fill"]){var r={panelName:i.panel};for(var a in i.outputs){var o=a.split(" ").pop();"Top"==o||"High"==o?r.topBand=a+" "+i.name:"Bottom"==o||"Low"==o?r.bottomBand=a+" "+i.name:"Median"!=o&&"Channel"!=o||(r.color=e.Studies.determineColor(i.outputs[a]))}i.parameters&&i.parameters.opacity&&(r.opacity=i.parameters.opacity),r.skipTransform=t.panels[i.panel].name!=i.chart.name,e.prepareChannelFill(t,r)}e.Studies.displaySeriesAsLine(t,i,n)},e.Studies.inputAttributeDefaultGenerator=function(t){return(t||0===t)&&t.constructor==Number?Math.floor(t)==t?t>0?{min:1,step:1}:{step:1}:t>0?{min:0,step:.01}:{step:.01}:{}},e.Studies.getStudyList=function(t){var i={},n={Directional:!0,Gopala:!0,vchart:!0};e.extend(n,t);for(var r in e.Studies.studyLibrary)n[r]||(i[e.Studies.studyLibrary[r].name]=r);return i},e.Studies.determineColor=function(t){return t?"object"===(void 0===t?"undefined":_typeof(t))?t.color:t:null},e.Studies.studyLibrary={rsi:{name:"RSI",inputs:{Period:14},calculateFN:e.Studies.calculateRSI,range:"0 to 100",outputs:{RSI:"auto"},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:80,studyOverBoughtColor:"auto",studyOverSoldValue:20,studyOverSoldColor:"auto"}}},ma:{name:"Moving Average",overlay:!0,range:"bypass",calculateFN:e.Studies.calculateMovingAverage,inputs:{Period:50,Field:"field",Type:"ma",Offset:0,Underlay:!1},outputs:{MA:"#FF0000"}},macd:{name:"MACD",calculateFN:e.Studies.calculateMACD,seriesFN:e.Studies.displayHistogramWithSeries,inputs:{"Fast MA Period":12,"Slow MA Period":26,"Signal Period":9},outputs:{MACD:"auto",Signal:"#FF0000","Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"}},stochastics:{name:"Stochastics",range:"0 to 100",initializeFN:e.Studies.initializeStochastics,calculateFN:e.Studies.calculateStochastics,inputs:{Period:14,Smooth:!0},outputs:{Fast:"auto",Slow:"#FF0000"},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:80,studyOverBoughtColor:"auto",studyOverSoldValue:20,studyOverSoldColor:"auto"}}},Aroon:{name:"Aroon",range:"0 to 100",calculateFN:e.Studies.calculateAroon,outputs:{"Aroon Up":"#00DD00","Aroon Down":"#FF0000"}},"Aroon Osc":{name:"Aroon Oscillator",calculateFN:e.Studies.calculateAroon,outputs:{"Aroon Oscillator":"auto"}},"Lin R2":{name:"Linear Reg R2",calculateFN:e.Studies.calculateLinearRegressionIndicator,inputs:{Period:14,Field:"field"},outputs:{RSquared:"auto"}},"Lin Fcst":{name:"Linear Reg Forecast",overlay:!0,calculateFN:e.Studies.calculateLinearRegressionIndicator,inputs:{Period:14,Field:"field"},outputs:{Forecast:"auto"}},"Lin Incpt":{name:"Linear Reg Intercept",overlay:!0,calculateFN:e.Studies.calculateLinearRegressionIndicator,inputs:{Period:14,Field:"field"},outputs:{Intercept:"auto"}},"Time Fcst":{name:"Time Series Forecast",overlay:!0,calculateFN:e.Studies.calculateLinearRegressionIndicator,inputs:{Period:14,Field:"field"},outputs:{Forecast:"auto"}},"VT HZ Filter":{name:"Vertical Horizontal Filter",calculateFN:e.Studies.calculateVerticalHorizontalFilter,inputs:{Period:28}},TRIX:{name:"TRIX",calculateFN:e.Studies.calculateTRIX},"STD Dev":{name:"Standard Deviation",calculateFN:e.Studies.calculateStandardDeviation,inputs:{Period:14,Field:"field","Standard Deviations":2,"Moving Average Type":"ma"},attributes:{"Standard Deviations":{min:.1,step:.1}}},"Trade Vol":{name:"Trade Volume Index",calculateFN:e.Studies.calculateOnBalanceVolume,inputs:{"Min Tick Value":.5}},Swing:{name:"Swing Index",calculateFN:e.Studies.calculateSwingIndex,inputs:{"Limit Move Value":.5}},"Acc Swing":{name:"Accumulative Swing Index",calculateFN:e.Studies.calculateSwingIndex,inputs:{"Limit Move Value":.5}},"Price ROC":{name:"Price Rate of Change",calculateFN:e.Studies.calculateRateOfChange,inputs:{Field:"field",Period:14}},"Vol ROC":{name:"Volume Rate of Change",calculateFN:e.Studies.calculateRateOfChange},Momentum:{name:"Momentum Indicator",calculateFN:e.Studies.calculateRateOfChange,inputs:{Period:14},centerline:0},"Price Vol":{name:"Price Volume Trend",calculateFN:e.Studies.calculatePriceVolumeTrend,inputs:{Field:"field"}},"Pos Vol":{name:"Positive Volume Index",calculateFN:e.Studies.calculateVolumeIndex,inputs:{Field:"field","Moving Average Type":"ma",Period:255},outputs:{Index:"auto",MA:"#FF0000"}},"Neg Vol":{name:"Negative Volume Index",calculateFN:e.Studies.calculateVolumeIndex,inputs:{Field:"field","Moving Average Type":"ma",Period:255},outputs:{Index:"auto",MA:"#FF0000"}},"On Bal Vol":{name:"On Balance Volume",calculateFN:e.Studies.calculateOnBalanceVolume,inputs:{}},"Stch Mtm":{name:"Stochastic Momentum Index",calculateFN:e.Studies.calculateStochMomentum,inputs:{"%K Periods":10,"%K Smoothing Periods":3,"%K Double Smoothing Periods":3,"%D Periods":10,"%D Moving Average Type":"ema"},outputs:{"%K":"auto","%D":"#FF0000"},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:40,studyOverBoughtColor:"auto",studyOverSoldValue:-40,studyOverSoldColor:"auto"}}},"Hist Vol":{name:"Historical Volatility",calculateFN:e.Studies.calculateHistoricalVolatility,inputs:{Field:"field",Period:10,"Days Per Year":[252,365],"Standard Deviations":1},attributes:{"Standard Deviations":{min:.1,step:.1}}},"Pretty Good":{name:"Pretty Good Oscillator",seriesFN:e.Studies.displayPrettyGoodOscillator,calculateFN:e.Studies.calculatePrettyGoodOscillator},Ultimate:{name:"Ultimate Oscillator",calculateFN:e.Studies.calculateUltimateOscillator,inputs:{"Cycle 1":7,"Cycle 2":14,"Cycle 3":28},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:70,studyOverBoughtColor:"auto",studyOverSoldValue:30,studyOverSoldColor:"auto"}}},"Vol Osc":{name:"Volume Oscillator",calculateFN:e.Studies.calculatePriceOscillator,inputs:{"Short Cycle":12,"Long Cycle":26,"Points Or Percent":["Points","Percent"]},parameters:{init:{isVolume:!0}}},Twiggs:{name:"Twiggs Money Flow",calculateFN:e.Studies.calculateTwiggsMoneyFlow,inputs:{Period:21}},"Chaikin MF":{name:"Chaikin Money Flow",calculateFN:e.Studies.calculateChaikinMoneyFlow,inputs:{Period:20}},"Chaikin Vol":{name:"Chaikin Volatility",calculateFN:e.Studies.calculateChaikinVolatility,inputs:{Period:14,"Rate Of Change":2,"Moving Average Type":"ma"}},"Price Osc":{name:"Price Oscillator",calculateFN:e.Studies.calculatePriceOscillator,inputs:{Field:"field","Long Cycle":26,"Short Cycle":12,"Moving Average Type":"ema","Points Or Percent":["Points","Percent"]}},EOM:{name:"Ease of Movement",calculateFN:e.Studies.calculateEaseOfMovement,inputs:{Period:14,"Moving Average Type":"ma"}},CCI:{name:"Commodity Channel Index",calculateFN:e.Studies.calculateCCI,inputs:{Period:20},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:100,studyOverBoughtColor:"auto",studyOverSoldValue:-100,studyOverSoldColor:"auto"}},attributes:{Period:{min:2}}},Detrended:{name:"Detrended Price Oscillator",calculateFN:e.Studies.calculateDetrendedPrice,inputs:{Field:"field",Period:14,"Moving Average Type":"ma"}},"True Range":{name:"True Range",calculateFN:e.Studies.calculateStudyATR,inputs:{},outputs:{"True Range":"auto"}},ATR:{name:"Average True Range",calculateFN:e.Studies.calculateStudyATR,outputs:{ATR:"auto"}},"Ehler Fisher":{name:"Ehler Fisher Transform",calculateFN:e.Studies.calculateEhlerFisher,inputs:{Period:10},outputs:{EF:"auto","EF Trigger":"#FF0000"}},Schaff:{name:"Schaff Trend Cycle",range:"0 to 100",calculateFN:e.Studies.calculateSchaff,inputs:{Field:"field",Period:10,"Short Cycle":23,"Long Cycle":50,"Moving Average Type":"ema"},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:75,studyOverBoughtColor:"auto",studyOverSoldValue:25,studyOverSoldColor:"auto"}}},QStick:{name:"QStick",calculateFN:e.Studies.calculateQStick,inputs:{Period:8,"Moving Average Type":"ma"}},Coppock:{name:"Coppock Curve",calculateFN:e.Studies.calculateCoppock,inputs:{Field:"field","Short RoC":11,"Long RoC":14,Period:10}},"Chande Mtm":{name:"Chande Momentum Oscillator",calculateFN:e.Studies.calculateChandeMomentum,inputs:{Period:9},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:50,studyOverBoughtColor:"auto",studyOverSoldValue:-50,studyOverSoldColor:"auto"}}},"Chande Fcst":{name:"Chande Forecast Oscillator",calculateFN:e.Studies.calculateChandeForecast,inputs:{Field:"field",Period:14}},"Intraday Mtm":{name:"Intraday Momentum Index",calculateFN:e.Studies.calculateIntradayMomentum,inputs:{Period:20},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:70,studyOverBoughtColor:"auto",studyOverSoldValue:30,studyOverSoldColor:"auto"}}},RAVI:{name:"RAVI",seriesFN:e.Studies.displayRAVI,calculateFN:e.Studies.calculatePriceOscillator,inputs:{Field:"field","Moving Average Type":"vdma","Short Cycle":7,"Long Cycle":65},outputs:{"Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:3,studyOverBoughtColor:"auto",studyOverSoldValue:-3,studyOverSoldColor:"auto"}},attributes:{studyOverBoughtValue:{min:0,step:"0.1"},studyOverSoldValue:{max:0,step:"0.1"}}},"Random Walk":{name:"Random Walk Index",calculateFN:e.Studies.calculateRandomWalk,outputs:{"Random Walk High":"#FF0000","Random Walk Low":"#0000FF"}},ADX:{name:"ADX/DMS",calculateFN:e.Studies.calculateADX,seriesFN:e.Studies.displayADX,inputs:{Period:14,"Smoothing Period":14,Series:!0,Shading:!1,Histogram:!1},outputs:{"+DI":"#00FF00","-DI":"#FF0000",ADX:"auto","Positive Bar":"#00DD00","Negative Bar":"#FF0000"}},"High Low":{name:"High Low Bands",overlay:!0,seriesFN:e.Studies.displayChannel,calculateFN:function(t,i){i.inputs["Moving Average Type"]="triangular",e.Studies.calculateMAEnvelope(t,i)},inputs:{Field:"field",Period:10,"Shift Percentage":5,"Channel Fill":!0},outputs:{"High Low Top":"auto","High Low Median":"auto","High Low Bottom":"auto"},attributes:{"Shift Percentage":{min:.1,step:.1}}},"High-Low":{name:"High Minus Low",calculateFN:function(t,e){for(var i=e.chart.scrubbed,n=e.startFrom;n<i.length;n++)i[n]["Result "+e.name]=i[n].High-i[n].Low},inputs:{}},"Med Price":{name:"Median Price",calculateFN:e.Studies.calculateTypicalPrice,inputs:{Period:14,Overlay:!1}},"MA Env":{name:"Moving Average Envelope",overlay:!0,seriesFN:e.Studies.displayChannel,calculateFN:e.Studies.calculateMAEnvelope,inputs:{Field:"field",Period:50,"Shift Type":["percent","points"],Shift:5,"Moving Average Type":"ma","Channel Fill":!0},outputs:{"MA Env Top":"auto","MA Env Median":"auto","MA Env Bottom":"auto"},attributes:{Shift:{min:.1,step:.1}}},"Fractal Chaos Bands":{name:"Fractal Chaos Bands",overlay:!0,calculateFN:e.Studies.calculateFractalChaos,seriesFN:e.Studies.displayChannel,inputs:{"Channel Fill":!0},outputs:{"Fractal High":"auto","Fractal Low":"auto","Fractal Channel":"auto"}},"Fractal Chaos":{name:"Fractal Chaos Oscillator",range:"-1 to 1",calculateFN:e.Studies.calculateFractalChaos,inputs:{},centerline:20},GAPO:{name:"Gopalakrishnan Range Index",calculateFN:e.Studies.calculateMaxHighMinLow},"Prime Number Bands":{name:"Prime Number Bands",overlay:!0,calculateFN:e.Studies.calculatePrimeNumber,seriesFN:e.Studies.displayChannel,inputs:{"Channel Fill":!0},outputs:{"Prime Bands Top":"auto","Prime Bands Bottom":"auto","Prime Bands Channel":"auto"}},"Prime Number":{name:"Prime Number Oscillator",range:"-1 to 1",calculateFN:e.Studies.calculatePrimeNumber,inputs:{"Tolerance Percentage":5},attributes:{"Tolerance Percentage":{min:.1,step:.1}}},"Bollinger Bands":{name:"Bollinger Bands",overlay:!0,calculateFN:e.Studies.calculateBollinger,seriesFN:e.Studies.displayChannel,inputs:{Field:"field",Period:20,"Standard Deviations":2,"Moving Average Type":"ma","Channel Fill":!0},outputs:{"Bollinger Bands Top":"auto","Bollinger Bands Median":"auto","Bollinger Bands Bottom":"auto"},attributes:{"Standard Deviations":{min:.1,step:.1}}},"Donchian Channel":{name:"Donchian Channel",overlay:!0,calculateFN:e.Studies.calculateMaxHighMinLow,seriesFN:e.Studies.displayChannel,inputs:{"High Period":20,"Low Period":20,"Channel Fill":!0},outputs:{"Donchian High":"auto","Donchian Median":"auto","Donchian Low":"auto"}},HHV:{name:"Highest High Value",calculateFN:e.Studies.calculateMaxHighMinLow,inputs:{Period:14}},LLV:{name:"Lowest Low Value",calculateFN:e.Studies.calculateMaxHighMinLow,inputs:{Period:14}},"Mass Idx":{name:"Mass Index",seriesFN:e.Studies.displayMassIndex,calculateFN:e.Studies.calculateMassIndex,inputs:{Period:25,"Bulge Threshold":27},attributes:{"Bulge Threshold":{min:20,max:35,step:.1}}},Keltner:{name:"Keltner Channel",overlay:!0,seriesFN:e.Studies.displayChannel,calculateFN:e.Studies.calculateKeltner,inputs:{Period:50,Shift:5,"Moving Average Type":"ema","Channel Fill":!0},outputs:{"Keltner Top":"auto","Keltner Median":"auto","Keltner Bottom":"auto"},attributes:{Shift:{min:.1,step:.1}}},PSAR:{name:"Parabolic SAR",overlay:!0,calculateFN:e.Studies.calculatePSAR,seriesFN:e.Studies.displayPSAR2,inputs:{"Minimum AF":.02,"Maximum AF":.2}},Klinger:{name:"Klinger Volume Oscillator",seriesFN:e.Studies.displayHistogramWithSeries,calculateFN:e.Studies.calculateKlinger,inputs:{"Signal Periods":13,"Short Cycle":34,"Long Cycle":55},outputs:{Klinger:"auto",KlingerSignal:"#FF0000","Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"}},"Elder Ray":{name:"Elder Ray Index",seriesFN:e.Studies.displayElderRay,calculateFN:e.Studies.calculateElderRay,inputs:{Period:13},outputs:{"Elder Bull Power":"#00DD00","Elder Bear Power":"#FF0000"}},"Elder Force":{name:"Elder Force Index",calculateFN:e.Studies.calculateElderForce,seriesFN:e.Studies.displayElderForce,inputs:{Period:13}},"LR Slope":{name:"Linear Reg Slope",calculateFN:e.Studies.calculateLinearRegressionIndicator,inputs:{Period:14,Field:"field"},outputs:{Slope:"auto"}},COG:{name:"Center Of Gravity",calculateFN:e.Studies.calculateCenterOfGravity,inputs:{Period:10,Field:"field"}},"Typical Price":{name:"Typical Price",calculateFN:e.Studies.calculateTypicalPrice,inputs:{Period:14,Overlay:!1}},"Weighted Close":{name:"Weighted Close",calculateFN:e.Studies.calculateTypicalPrice,inputs:{Period:14,Overlay:!1}},"M Flow":{name:"Money Flow Index",range:"0 to 100",calculateFN:e.Studies.calculateMoneyFlowIndex,inputs:{Period:14},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:80,studyOverBoughtColor:"auto",studyOverSoldValue:20,studyOverSoldColor:"auto"}}},"Williams %R":{name:"Williams %R",calculateFN:e.Studies.calculateMaxHighMinLow,inputs:{Period:14},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:-20,studyOverBoughtColor:"auto",studyOverSoldValue:-80,studyOverSoldColor:"auto"}}},"W Acc Dist":{name:"Accumulation/Distribution",calculateFN:e.Studies.calculateAccumulationDistribution,inputs:{"Use Volume":!1}},volume:{name:"Volume Chart",range:"0 to max",yAxis:{ground:!0,initialMarginTop:0},seriesFN:e.Studies.createVolumeChart,calculateFN:e.Studies.calculateVolume,inputs:{},outputs:{"Up Volume":"#8cc176","Down Volume":"#b82c0c"},parameters:{zoom:0,widthFactor:1}},"vol undr":{name:"Volume Underlay",underlay:!0,seriesFN:e.Studies.createVolumeChart,calculateFN:e.Studies.calculateVolume,inputs:{},outputs:{"Up Volume":"#8cc176","Down Volume":"#b82c0c"},customRemoval:!0,removeFN:function(t,e){t.layout.volumeUnderlay=!1,t.changeOccurred("layout")},parameters:{init:{heightPercentage:.25},widthFactor:1}}},t},__drawingAdvanced_=function(t){var e=t.CIQ,i=t.timezoneJS;return e.Drawing.channel=function(){this.name="channel",this.dragToDraw=!1,this.p2=null},e.Drawing.channel.ciqInheritsFrom(e.Drawing.segment),e.Drawing.channel.prototype.configs=["color","fillColor","lineWidth","pattern"],e.Drawing.channel.prototype.move=function(t,e,i){if(this.penDown){if(this.copyConfig(),null===this.p2)this.p1=[e,i];else{var n=i-(this.p1[1]-this.p0[1])/(this.p1[0]-this.p0[0])*(e-this.p1[0]);this.p2=[this.p1[0],n]}this.render(t)}},e.Drawing.channel.prototype.click=function(t,e,i){var n=this.stx.panels[this.panelName];if(n)return this.copyConfig(),this.penDown?this.accidentalClick(e,i)?(this.stx.undo(),!0):null!==this.p2?(this.setPoint(2,this.p2[0],this.p2[1],n.chart),!0):(this.setPoint(1,e,i,n.chart),this.p0[0]==this.p1[0]?(this.p1=null,!1):(this.p2=[this.p1[0],this.p1[1]],!1)):(this.setPoint(0,e,i,n.chart),this.penDown=!0,!1)},e.Drawing.channel.prototype.boxIntersection=function(t,e){return!!(this.p0&&this.p1&&this.p2)&&(!(t>Math.max(this.p0[0],this.p1[0])||t<Math.min(this.p0[0],this.p1[0]))&&((this.p1[0]-this.p0[0])*(e-this.p0[1])-(this.p1[1]-this.p0[1])*(t-this.p0[0]))*((this.p2[0]-this.p0[0])*(e-(this.p0[1]+this.p2[1]-this.p1[1]))-(this.p1[1]-this.p0[1])*(t-this.p0[0]))<0)},e.Drawing.channel.prototype.intersected=function(t,i,n){return this.p0&&this.p1&&this.p2?this.pointIntersection(this.p0[0],this.p0[1],n)?(this.highlighted="p0",{action:"drag",point:"p0"}):this.pointIntersection(this.p1[0],this.p1[1],n)?(this.highlighted="p1",{action:"drag",point:"p1"}):this.pointIntersection(this.p2[0],this.p2[1],n)?(this.highlighted="p2",{action:"drag",point:"p2"}):this.boxIntersection(t,i)?(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),p2:e.clone(this.p2),tick:t,value:i}):null:null},e.Drawing.channel.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var n=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(this.p1[0],i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),o=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),s=null;this.p2&&(s=this.stx.pixelFromValueAdjusted(i,this.p2[0],this.p2[1]));var l=this.lineWidth,h=this.setLineColor(),c=this.fillColor;this.p2&&c&&!e.isTransparent(c)&&"auto"!=c&&(t.beginPath(),t.moveTo(n,a),t.lineTo(r,o),t.lineTo(r,s),t.lineTo(n,a+(s-o)),t.closePath(),t.globalAlpha=.2,t.fillStyle=c,t.fill(),t.globalAlpha=1);var u={pattern:this.pattern,lineWidth:l};if(this.stx.plotLine(n,r,a,o,h,"segment",t,i,u),this.p2&&this.stx.plotLine(n,r,a+(s-o),s,h,"segment",t,i,u),this.highlighted){var p="p0"==this.highlighted,d="p1"==this.highlighted,f="p2"==this.highlighted;this.littleCircle(t,n,a,p),this.littleCircle(t,r,o,d),this.littleCircle(t,r,s,f)}}},e.Drawing.channel.prototype.reposition=function(t,e,i,n){if(e){var r=this.stx.panels[this.panelName],a=e.tick-i,o=e.value-n;"move"==e.action?(this.setPoint(0,e.p0[0]-a,e.p0[1]-o,r.chart),this.setPoint(1,e.p1[0]-a,e.p1[1]-o,r.chart),this.setPoint(2,e.p2[0]-a,e.p2[1]-o,r.chart),this.render(t)):"drag"==e.action&&(this[e.point]=[i,n],this.setPoint(0,this.p0[0],this.p0[1],r.chart),this.setPoint(1,this.p1[0],this.p1[1],r.chart),this.setPoint(2,this.p2[0],this.p2[1],r.chart),this.render(t))}},e.Drawing.channel.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.setPoint(1,this.d1,this.v1,t.chart),this.setPoint(2,this.d1,this.v2,t.chart))},e.Drawing.channel.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.fillColor=e.fc,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.v2=e.v2,this.adjust()},e.Drawing.channel.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,fc:this.fillColor,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1,v2:this.v2}},e.Drawing.pitchfork=function(){this.name="pitchfork",this.dragToDraw=!1,this.p2=null},e.Drawing.pitchfork.ciqInheritsFrom(e.Drawing.channel),e.Drawing.pitchfork.prototype.configs=["color","lineWidth","pattern"],e.Drawing.pitchfork.prototype.move=function(t,e,i){this.penDown&&(this.copyConfig(),null===this.p2?this.p1=[e,i]:this.p2=[e,i],this.render(t))},e.Drawing.pitchfork.prototype.lineIntersection=function(t,i,n,r){var a=this.p0,o=this.p1,s=this.p2,l=this.stx.layout;return a&&o&&s&&e.boxIntersects(n.x0,n.y0,n.x1,n.y1,a[0],a[1],(o[0]+s[0])/2,(o[1]+s[1])/2,r,l.semiLog||"log"==l.chartScale)},e.Drawing.pitchfork.prototype.intersected=function(t,i,n){return this.p0&&this.p1&&this.p2?this.pointIntersection(this.p0[0],this.p0[1],n)?(this.highlighted="p0",{action:"drag",point:"p0"}):this.pointIntersection(this.p1[0],this.p1[1],n)?(this.highlighted="p1",{action:"drag",point:"p1"}):this.pointIntersection(this.p2[0],this.p2[1],n)?(this.highlighted="p2",{action:"drag",point:"p2"}):this.lineIntersection(t,i,n,"ray")?(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),p2:e.clone(this.p2),tick:t,value:i}):null:null},e.Drawing.pitchfork.prototype.render=function(t){var e=this.stx.panels[this.panelName];if(e){var i=this.p2;i||(i=this.p1);var n=this.stx.pixelFromTick(this.p0[0],e.chart),r=this.stx.pixelFromTick(this.p1[0],e.chart),a=this.stx.pixelFromTick(i[0],e.chart),o=this.stx.pixelFromValueAdjusted(e,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(e,this.p1[0],this.p1[1]),l=this.stx.pixelFromValueAdjusted(e,i[0],i[1]),h=this.lineWidth,c=this.setLineColor(),u={pattern:this.pattern,lineWidth:h},p=50,d=2*o-s-l,f=2*n-r-a;if(f<0&&(p*=-1),d=p*d/f,this.stx.plotLine(n,(r+a)/2,o,(s+l)/2,c,"ray",t,e,u),this.stx.plotLine(r,a,s,l,c,"segment",t,e,u),r==a&&s==l||(this.stx.plotLine(r,r-p,s,s-d,c,"ray",t,e,u),this.stx.plotLine(a,a-p,l,l-d,c,"ray",t,e,u)),this.highlighted){var m="p0"==this.highlighted,g="p1"==this.highlighted,v="p2"==this.highlighted;this.littleCircle(t,n,o,m),this.littleCircle(t,r,s,g),this.littleCircle(t,a,l,v)}}},e.Drawing.pitchfork.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.setPoint(1,this.d1,this.v1,t.chart),this.setPoint(2,this.d2,this.v2,t.chart))},e.Drawing.pitchfork.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.d2=e.d2,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.tzo2=e.tzo2,this.v0=e.v0,this.v1=e.v1,this.v2=e.v2,this.adjust()},e.Drawing.pitchfork.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,d2:this.d2,tzo0:this.tzo0,tzo1:this.tzo1,tzo2:this.tzo2,v0:this.v0,v1:this.v1,v2:this.v2}},e.Drawing.gartley=function(){this.name="gartley",this.dragToDraw=!1,this.maxSegments=4,this.shape=null,this.points=[]},e.Drawing.gartley.ciqInheritsFrom(e.Drawing.continuous),e.Drawing.gartley.prototype.check=function(t,e){if(!e)return!0;if(t[0]>=e[0]||t[1]==e[1])return!1;if(1==this.segment)t[1]<e[1]?this.shape="M":this.shape="W";else if(2==this.segment){if("M"==this.shape&&t[1]<e[1])return!1;if("W"==this.shape&&t[1]>e[1])return!1;if((e[1]-t[1])/(this.points[0][1]-t[1])<.618)return!1;if((e[1]-t[1])/(this.points[0][1]-t[1])>=.786)return!1}else if(3==this.segment){if("M"==this.shape&&t[1]>e[1])return!1;if("W"==this.shape&&t[1]<e[1])return!1;if((e[1]-t[1])/(this.points[1][1]-t[1])<.618)return!1;if((e[1]-t[1])/(this.points[1][1]-t[1])>=.786)return!1}else if(4==this.segment){if("M"==this.shape&&(t[1]<e[1]||e[1]<this.points[0][1]))return!1;if("W"==this.shape&&(t[1]>e[1]||e[1]>this.points[0][1]))return!1;if((this.points[1][1]-e[1])/(this.points[1][1]-this.points[2][1])<1.27)return!1;if((this.points[1][1]-e[1])/(this.points[1][1]-this.points[2][1])>=1.618)return!1}return!0},e.Drawing.gartley.prototype.click=function(t,e,i){var n=this.stx.panels[this.panelName];if(n){if(this.copyConfig(),!this.penDown)return this.setPoint(0,e,i,n.chart),this.pts=[],this.penDown=!0,this.segment=1,!1;if(this.accidentalClick(e,i))return this.penDown=!0,!1;if(this.check(this.p0,this.p1)){if(1==this.segment&&this.points.push(this.p0),this.points.push(this.p1),this.drawDropZones=!0,this.setPoint(1,e,i,n.chart),++this.segment>this.maxSegments)return this.setPoint(0,this.points[0][0],this.points[0][1],n.chart),!0;this.pts.push(this.d1,this.tzo1,this.v1),this.setPoint(0,e,i,n.chart)}return!1}},e.Drawing.gartley.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var n=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(this.p1[0],i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),o=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]);if(2==this.segment)this.drawDropZone(t,.618*this.points[0][1]+.382*this.p0[1],.786*this.points[0][1]+.214*this.p0[1],this.p0[0]);else if(3==this.segment)this.drawDropZone(t,.618*this.points[1][1]+.382*this.p0[1],.786*this.points[1][1]+.214*this.p0[1],this.p0[0]);else if(4==this.segment){var s=1.618*this.points[2][1]-.618*this.points[1][1];s="M"==this.shape?Math.max(s,this.points[0][1]):Math.min(s,this.points[0][1]),this.drawDropZone(t,s,1.27*this.points[2][1]-.27*this.points[1][1],this.p0[0])}var l=this.lineWidth,h=this.setLineColor(),c={pattern:this.pattern,lineWidth:l};this.segment<=this.maxSegments&&this.stx.plotLine(n,r,a,o,h,this.name,t,i,c);var u=this.fillColor,p=[];if(this.points.length){t.beginPath();for(var d=1;d<this.points.length&&d<=4;d++){var f=this.stx.pixelFromTick(this.points[d-1][0],i.chart),m=this.stx.pixelFromTick(this.points[d][0],i.chart),g=this.stx.pixelFromValueAdjusted(i,this.points[d-1][0],this.points[d-1][1]),v=this.stx.pixelFromValueAdjusted(i,this.points[d][0],this.points[d][1]);1==d&&p.push(f,g),p.push(m,v),this.stx.plotLine(f,m,g,v,h,this.name,t,i,c)}if(2!=this.points.length&&4!=this.points.length||p.push(r,o),this.points[2]&&p.push(this.stx.pixelFromTick(this.points[2][0],i.chart),this.stx.pixelFromValueAdjusted(i,this.points[2][0],this.points[2][1])),u&&"auto"!=u&&!e.isTransparent(u)){for(var y=0;y<p.length;y+=2)0===y&&t.moveTo(p[0],p[1]),t.lineTo(p[y],p[y+1]);t.fillStyle=u,t.globalAlpha=.2,t.closePath(),t.fill(),t.globalAlpha=1}}}},e.Drawing.gartley.prototype.lineIntersection=function(t,i,n,r){var a=this.points,o=this.stx.layout;if(a.length!=this.maxSegments+1)return!1;for(var s=0;s<a.length-1;s++)if(e.boxIntersects(n.x0,n.y0,n.x1,n.y1,a[s][0],a[s][1],a[s+1][0],a[s+1][1],"segment",o.semiLog||"log"==o.chartScale))return!0;return!1},e.Drawing.gartley.prototype.boxIntersection=function(t,e){if(!this.p0||!this.p1)return!1;if(t>Math.max(this.p0[0],this.p1[0])||t<Math.min(this.p0[0],this.p1[0]))return!1;for(var i=Math.min(this.p0[1],this.p1[1]),n=Math.max(this.p0[1],this.p1[1]),r=0;r<this.points.length;r++)i=Math.min(i,this.points[r][1]),n=Math.max(n,this.points[r][1]);return!(e>n||e<i)},e.Drawing.gartley.prototype.reposition=function(t,e,i,n){if(e){var r=this.stx.panels[this.panelName],a=e.tick-i;e.tick=i;var o=e.value-n;if(e.value=n,"move"==e.action){this.pts=[];for(var s=0;s<this.points.length;s++)this.points[s][0]-=a,this.points[s][1]-=o,this.setPoint(1,this.points[s][0],this.points[s][1],r.chart),s&&s<this.points.length-1&&this.pts.push(this.d1,this.tzo1,this.v1),this.points[s]=this.p1;this.setPoint(0,this.points[0][0],this.points[0][1],r.chart),this.render(t)}}},e.Drawing.gartley.prototype.configs=["color","fillColor","lineWidth","pattern"],e.Drawing.gartley.prototype.drawDropZone=function(t,e,i,n){var r=this.stx.panels[this.panelName];if(r){var a=this.stx.pixelFromPrice(e,r),o=this.stx.pixelFromPrice(i,r)-a,s=this.stx.pixelFromTick(n,r.chart),l=this.stx.chart.width-s;t.fillStyle="#008000",t.globalAlpha=.2,t.fillRect(s,a,l,o),t.globalAlpha=1}},e.Drawing.gartley.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.reconstructPoints(),this.setPoint(0,this.d0,this.v0,t.chart),this.points.unshift(this.p0),this.setPoint(1,this.d1,this.v1,t.chart),this.points.push(this.p1))},e.Drawing.gartley.prototype.reconstructPoints=function(){var t=this.stx.panels[this.panelName];if(t){this.points=[];for(var i=0;i<this.pts.length;i+=3){var n=e.strToDateTime(this.pts[i]);n.setMinutes(n.getMinutes()+Number(this.pts[i+1])-n.getTimezoneOffset()),this.points.push([this.stx.tickFromDate(e.yyyymmddhhmmssmmm(n),t.chart),this.pts[i+2]])}}},e.Drawing.gartley.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.fillColor=e.fc,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.pts=e.pts.split(","),this.adjust()},e.Drawing.gartley.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,fc:this.fillColor,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1,pts:this.pts.join(",")}},e.Drawing.freeform=function(){this.name="freeform",this.splineTension=.3,this.dragToDraw=!0},e.Drawing.freeform.ciqInheritsFrom(e.Drawing.segment),e.Drawing.freeform.prototype.measure=function(){},e.Drawing.freeform.prototype.intersected=function(t,i,n){return t>this.hiX||t<this.lowX?null:i>this.hiY||i<this.lowY?null:(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),tick:t,value:i})},e.Drawing.freeform.prototype.reposition=function(t,e,i,n){if(e){var r=this.stx.panels[this.panelName],a=e.tick-i,o=e.value-n;"move"==e.action&&(this.setPoint(0,e.p0[0]-a,e.p0[1]-o,r.chart),this.adjust(),this.render(t))}},e.Drawing.freeform.prototype.click=function(t,i,n){var r=this.stx.panels[this.panelName];if(r){if(!1===this.penDown){this.copyConfig(),this.startX=Math.round(this.stx.resolveX(this.stx.pixelFromTick(i,r.chart))),this.startY=Math.round(this.stx.resolveY(this.stx.pixelFromValueAdjusted(r,i,n)));var a=this.stx.dateFromTick(i,r.chart,!0);return this.d0=e.yyyymmddhhmmssmmm(a),this.tzo0=a.getTimezoneOffset(),this.v0=n,this.p0=[e.ChartEngine.crosshairX-this.startX,e.ChartEngine.crosshairY-this.startY],this.nodes=[this.p0[0],this.p0[1]],this.pNodes=[this.p0],this.candleWidth=this.stx.layout.candleWidth,this.multiplier=r.yAxis.multiplier,this.interval=this.stx.layout.interval,this.periodicity=this.stx.layout.periodicity,this.tempSplineTension=this.splineTension,this.splineTension=-1,document.body.style.cursor="pointer",this.penDown=!0,!1}return this.penDown=!1,this.splineTension=this.tempSplineTension,document.body.style.cursor="auto",!0}},e.Drawing.freeform.prototype.move=function(t,i,n){if(this.penDown){var r=this.stx.panels[this.panelName],a=this.stx.dateFromTick(i,r.chart,!0);return this.d1=e.yyyymmddhhmmssmmm(a),this.tzo1=a.getTimezoneOffset(),this.v1=n,this.p1=[e.ChartEngine.crosshairX-this.startX,e.ChartEngine.crosshairY-this.startY],this.pNodes.length>2&&(this.p1[0]==this.pNodes[this.pNodes.length-2][0]&&this.p1[0]==this.pNodes[this.pNodes.length-1][0]?(this.pNodes.length--,this.nodes.length-=2):this.p1[1]==this.pNodes[this.pNodes.length-2][1]&&this.p1[1]==this.pNodes[this.pNodes.length-1][1]&&(this.pNodes.length--,this.nodes.length-=2)),this.nodes.push(this.p1[0],this.p1[1]),this.pNodes.push(this.p1),this.render(t),!1}},e.Drawing.freeform.prototype.intervalRatio=function(t,i,n,r,a,o){function s(t,i){return e.Market.Symbology.isForexSymbol(i)?1440:390}var l=0;return t==i?l=1:isNaN(t)||isNaN(i)?isNaN(t)?"month"==t?"week"==i?l=5:"day"==i?l=30:isNaN(i)||(l=30*s(a,o)/i):"week"==t?("month"==i&&(l=.2),"day"==i?l=5:isNaN(i)||(l=5*s(a,o)/i)):"day"==t&&("week"==i?l=.2:"month"==i?l=1/30:isNaN(i)||(l=s(a,o)/i)):isNaN(t)||("month"==i?l=t/(30*s(a,o)):"week"==i?l=t/(5*s(a,o)):"day"==i&&(l=t/s(a,o))):l=t/i,l*=n/r},e.Drawing.freeform.prototype.render=function(t){var e=this.stx.panels[this.panelName];if(e){var i=this.intervalRatio(this.interval,this.stx.layout.interval,this.periodicity,this.stx.layout.periodicity,this.d0,e.chart.symbol);if(0!==i){var n=this.stx.layout.candleWidth/this.candleWidth,r=e.yAxis.multiplier/this.multiplier;this.setPoint(0,this.d0,this.v0,e.chart);for(var a=this.stx.pixelFromTick(this.p0[0],e.chart),o=this.stx.pixelFromValueAdjusted(e,this.p0[0],this.p0[1]),s=[],l=this.lineWidth,h=this.setLineColor(),c={pattern:this.pattern,lineWidth:l},u=0;u<this.pNodes.length;u++){var p=i*n*this.pNodes[u][0]+a,d=r*this.pNodes[u][1]+o;s.push(p,d)}s.length&&(this.splineTension<0?this.stx.connectTheDots(s,h,this.name,t,e,c):this.stx.plotSpline(s,this.splineTension,h,this.name,t,!0,c))}}},e.Drawing.freeform.prototype.adjust=function(){var t=this.stx.panels[this.panelName];if(t){var e=[this.nodes[0],this.nodes[1]];this.pNodes=[e],this.lowX=this.nodes[0],this.hiX=this.nodes[0],this.lowY=this.nodes[1],this.hiY=this.nodes[1];for(var i=2;i<this.nodes.length;i+=2){var n=[this.nodes[i],this.nodes[i+1]];this.pNodes.push(n),this.lowX=Math.min(this.lowX,n[0]),this.hiX=Math.max(this.hiX,n[0]),this.lowY=Math.max(this.lowY,n[1]),this.hiY=Math.min(this.hiY,n[1])}var r=this.intervalRatio(this.interval,this.stx.layout.interval,this.periodicity,this.stx.layout.periodicity,this.d0,t.chart.symbol);if(0!==r){var a=this.stx.layout.candleWidth/this.candleWidth,o=t.yAxis.multiplier/this.multiplier;this.setPoint(0,this.d0,this.v0,t.chart);var s=this.stx.pixelFromTick(this.p0[0],t.chart),l=this.stx.pixelFromValueAdjusted(t,this.p0[0],this.p0[1]);this.lowX=this.stx.tickFromPixel(Math.floor(r*a*this.lowX)+s,t.chart),this.hiX=this.stx.tickFromPixel(Math.ceil(r*a*this.hiX)+s,t.chart),this.lowY=this.stx.valueFromPixel(Math.floor(o*this.lowY)+l,t),this.hiY=this.stx.valueFromPixel(Math.ceil(o*this.hiY)+l,t)}}},e.Drawing.freeform.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,ptrn:this.pattern,lw:this.lineWidth,cw:Number(this.candleWidth.toFixed(4)),mlt:Number(this.multiplier.toFixed(4)),d0:this.d0,tzo0:this.tzo0,v0:this.v0,inter:this.interval,pd:this.periodicity,nodes:this.nodes}},e.Drawing.freeform.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.candleWidth=e.cw,this.multiplier=e.mlt,this.d0=e.d0,this.tzo0=e.tzo0,this.v0=e.v0,this.interval=e.inter,this.periodicity=e.pd,this.nodes=e.nodes,this.adjust()},e.Drawing.callout=function(){this.name="callout",this.arr=[],this.w=0,this.h=0,this.padding=4,this.text="",this.ta=null,this.fontSize=0,this.font={},this.stemEntry="",this.defaultWidth=50,this.defaultHeight=10},e.Drawing.callout.ciqInheritsFrom(e.Drawing.annotation),e.Drawing.callout.prototype.configs=["color","fillColor","lineWidth","pattern","font"],e.Drawing.callout.prototype.copyConfig=function(){e.Drawing.copyConfig(this),this.borderColor=this.color},e.Drawing.callout.prototype.move=function(t,e,i){this.penDown&&(this.copyConfig(),this.p0=[e,i],this.render(t))},e.Drawing.callout.prototype.onChange=function(t){if(this.stx.panels[this.panelName]){var i=t.target;this.w=i.clientWidth,this.h=i.clientHeight;var n=this.context||this.stx.chart.tempCanvas.context;e.clearCanvas(n.canvas,this.stx),this.render(n),this.edit(n)}},e.Drawing.callout.prototype.render=function(t){this.context=t;var i=this.stx.panels[this.panelName];if(i){var n=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]);if(!isNaN(r)){t.font=this.fontString,t.textBaseline="top";var a=n,o=r,s=this.w/2,l=this.h/2;this.penDown&&(s=this.defaultWidth,(l=this.defaultHeight)||(l=this.fontSize));var h=this.lineWidth;h||(h=1.1);var c=this.color;("auto"==c||e.isTransparent(c))&&(c=this.stx.defaultColor);var u=this.borderColor;("auto"==u||e.isTransparent(u))&&(u=this.stx.defaultColor),this.highlighted&&(u=this.stx.getCanvasColor("stx_highlight_vector"));var p,d,f,m,g=Math.min(Math.min(s,l)/2,8);if(this.stem){this.stem.d?(p=this.stx.pixelFromTick(this.stem.t),f=this.stx.pixelFromValueAdjusted(i,this.stem.t,this.stem.v)):this.stem.x&&(p=a,f=o,a+=this.stem.x,o+=this.stem.y);var v="";p>=a+s?(d=a+s,v="r"):p>a-s&&p<a+s?(d=a,v="c"):p<=a-s&&(d=a-s,v="l"),f>=o+l?(m=o+l,v+="b"):f>o-l&&f<o+l?(m=o,v+="m"):f<=o-l&&(m=o-l,v+="t"),this.stemEntry=v,"cm"!=v&&(p=Math.round(p),d=Math.round(d),f=Math.round(f),m=Math.round(m))}this.highlighted?this.stx.canvasColor("stx_annotation_highlight_bg",t):this.fillColor?(t.fillStyle=this.fillColor,t.globalAlpha=.4):this.stem&&(t.fillStyle=this.stx.containerColor),t.strokeStyle=u,t.setLineDash&&(t.setLineDash(e.borderPatternToArray(h,this.pattern)),t.lineDashOffset=0),u&&(t.beginPath(),t.lineWidth=h,t.moveTo(a+s-g,o-l),"rt"!=this.stemEntry?t.quadraticCurveTo(a+s,o-l,a+s,o-l+g):(t.lineTo(p,f),t.lineTo(a+s,o-l+g)),t.lineTo(a+s,o-g/2),"rm"==this.stemEntry&&t.lineTo(p,f),t.lineTo(a+s,o+g/2),t.lineTo(a+s,o+l-g),"rb"!=this.stemEntry?t.quadraticCurveTo(a+s,o+l,a+s-g,o+l):(t.lineTo(p,f),t.lineTo(a+s-g,o+l)),t.lineTo(a+g/2,o+l),"cb"==this.stemEntry&&t.lineTo(p,f),t.lineTo(a-g/2,o+l),t.lineTo(a-s+g,o+l),"lb"!=this.stemEntry?t.quadraticCurveTo(a-s,o+l,a-s,o+l-g):(t.lineTo(p,f),t.lineTo(a-s,o+l-g)),t.lineTo(a-s,o+g/2),"lm"==this.stemEntry&&t.lineTo(p,f),t.lineTo(a-s,o-g/2),t.lineTo(a-s,o-l+g),"lt"!=this.stemEntry?t.quadraticCurveTo(a-s,o-l,a-s+g,o-l):(t.lineTo(p,f),t.lineTo(a-s+g,o-l)),t.lineTo(a-g/2,o-l),"ct"==this.stemEntry&&t.lineTo(p,f),t.lineTo(a+g/2,o-l),t.lineTo(a+s-g,o-l),t.fill(),t.globalAlpha=1,t.stroke()),this.highlighted?this.stx.canvasColor("stx_annotation_highlight",t):t.fillStyle=c,o+=this.padding;for(var y=0;y<this.arr.length;y++)t.fillText(this.arr[y],a-s+this.padding,o-l),o+=this.fontSize;if(t.textBaseline="alphabetic",this.highlighted){var b="p0"==this.highlighted;this.littleCircle(t,p,f,b)}}}},e.Drawing.callout.prototype.click=function(t,e,i){if(!this.stx.overXAxis&&!this.stx.overYAxis){var n=this.stx.panels[this.panelName];return this.copyConfig(),(this.setPoint(0,e,i,n.chart),this.penDown)?(this.adjust(),this.edit(t),this.penDown=!1,!1):(this.stem={d:this.d0,v:this.v0},this.penDown=!0,this.adjust(),!1)}},e.Drawing.callout.prototype.reposition=function(t,e,i,n){if(e){var r=this.stx.panels[this.panelName],a=e.tick-i,o=e.value-n;e.stem?("drag"==e.action?this.stem={d:this.stx.dateFromTick(i,r.chart,!0),v:n}:"move"==e.action&&(this.setPoint(0,e.p0[0]-a,e.p0[1]-o,r.chart),this.stem={d:this.stx.dateFromTick(this.stx.tickFromDate(e.stem.d,r.chart)-a),v:e.stem.v-o}),this.adjust()):this.setPoint(0,e.p0[0]-a,e.p0[1]-o,r.chart),this.render(t)}},e.Drawing.callout.prototype.lineIntersection=function(t,i,n,r){var a=this.stx.panels[this.panelName],o=this.stem,s=this.p0,l=this.stx.layout;if(!s||!o)return!1;var h=this.stx.tickFromDate(o.d,a.chart);return e.boxIntersects(n.x0,n.y0,n.x1,n.y1,s[0],s[1],h,o.v,r,l.semiLog||"log"==l.chartScale)},e.Drawing.callout.prototype.intersected=function(t,i,n){var r=this.stx.panels[this.panelName];if(!this.p0)return null;if(this.pointIntersection(this.stem.t,this.stem.v,n))return this.highlighted="p0",{action:"drag",stem:!0};var a=this.stx.pixelFromTick(this.p0[0],r.chart)-this.w/2,o=this.stx.pixelFromValueAdjusted(r,this.p0[0],this.p0[1])-this.h/2,s=a+this.w,l=o+this.h;this.stem&&this.stem.x&&(a+=this.stem.x,s+=this.stem.x,o+=this.stem.y,l+=this.stem.y);var h=this.stx.pixelFromTick(t,r.chart),c=this.stx.pixelFromValueAdjusted(r,t,i);return h>=a&&h<=s&&c>=o&&c<=l?(this.highlighted=!0,{p0:e.clone(this.p0),tick:t,value:i}):this.lineIntersection(t,i,n,"segment")?(this.highlighted=!0,{action:"move",stem:e.clone(this.stem),p0:e.clone(this.p0),tick:t,value:i}):null},e.Drawing.fibarc=function(){this.name="fibarc"},e.Drawing.fibarc.ciqInheritsFrom(e.Drawing.fibonacci),e.Drawing.fibarc.prototype.setOuter=function(){this.outer={p0:e.clone(this.p0),p1:e.clone(this.p1)};var t=this.p0[1],i=this.p1[1],n=this.p0[0],r=this.p1[0],a=2*(t-i)+i,o=e.xIntersection({x0:n,x1:r,y0:t,y1:i},a);this.outer.p0[1]=a,this.outer.p0[0]=o},e.Drawing.fibarc.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var n=i.yAxis;if(this.p1){var r=this.stx.pixelFromTick(this.p0[0],i.chart),a=this.stx.pixelFromTick(this.p1[0],i.chart),o=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),l=s<o,h=Math.abs((s-o)/(a-r)),c=this.setLineColor(this.parameters.trend.color);t.textBaseline="middle",this.stx.canvasFont("stx_yaxis",t);var u=this.color;("auto"==u||e.isTransparent(u))&&(u=this.stx.defaultColor);for(var p=0;p<this.parameters.fibs.length;p++){t.fillStyle=u;var d=this.parameters.fibs[p];if(!(d.level<0)&&d.display){var f=Math.abs(this.p1[1]-this.p0[1])*Math.sqrt(2)*d.level,m=this.p1[1]+f*(l?-1:1),g=this.stx.pixelFromValueAdjusted(i,this.p0[0],m),v=e.xIntersection({x0:r,x1:a,y0:o,y1:s},g);if(this.parameters.printLevels){t.textAlign="center";var y=Math.round(1e3*d.level)/10+"%";this.parameters.printValues&&(t.fillStyle=u,this.stx.canvasFont("stx_yaxis",t)),t.fillText(y,a,Math.round(g-5))}if(t.textAlign="left",this.parameters.printValues&&v<this.stx.chart.width){var b=m;b=n.priceFormatter?n.priceFormatter(this.stx,i,b):this.stx.formatYAxisPrice(b,i),t==this.stx.chart.context&&this.stx.endClip(),this.stx.createYAxisLabel(i,b,g,u,null,t),t==this.stx.chart.context&&this.stx.startClip(i.name)}var x=d.color;("auto"==x||e.isTransparent(x))&&(x=this.color),("auto"==x||e.isTransparent(x))&&(x=this.stx.defaultColor),t.strokeStyle=x;var w=d.color;("auto"==w||e.isTransparent(w))&&(w=this.fillColor),("auto"==w||e.isTransparent(w))&&(w=this.stx.defaultColor),t.fillStyle=w,t.globalAlpha=d.parameters.opacity,t.lineWidth=d.parameters.lineWidth,t.setLineDash&&(t.setLineDash(e.borderPatternToArray(t.lineWidth,d.parameters.pattern)),t.lineDashOffset=0),t.save(),t.beginPath(),t.scale(1/h,1),t.arc(a*h,s,Math.abs(g-s),0,Math.PI,!l),t.stroke(),t.globalAlpha=.05,t.fill(),t.restore(),t.setLineDash&&t.setLineDash([]),t.globalAlpha=1}}if(t.textAlign="left",this.stx.plotLine(a,2*r-a,s,2*o-s,c,"segment",t,i,this.parameters.trend.parameters),this.highlighted){var C="p0"==this.highlighted,S="p1"==this.highlighted;this.littleCircle(t,r,o,C),this.littleCircle(t,a,s,S)}}}},e.Drawing.fibfan=function(){this.name="fibfan"},e.Drawing.fibfan.ciqInheritsFrom(e.Drawing.fibonacci),e.Drawing.fibfan.prototype.setOuter=function(){this.outer={p0:e.clone(this.p0),p1:e.clone(this.p1)};for(var t=this.p0[1],i=this.p1[1],n=this.p0[0],r=this.p1[0],a=0,o=0;o<this.parameters.fibs.length;o++){var s=this.parameters.fibs[o];if(!(s.level>=a)&&s.display){var l=(t-i)*s.level+i,h=e.xIntersection({x0:n,x1:r,y0:t,y1:i},l);a=s.level,this.outer.p1[1]=l,this.outer.p1[0]=h}}},e.Drawing.fibfan.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var n=i.yAxis;if(this.p1){var r=this.stx.pixelFromTick(this.p0[0],i.chart),a=this.stx.pixelFromTick(this.p1[0],i.chart),o=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),l=Math.min(s,o),h=Math.max(s,o),c=h-l,u=(s-o)/(a-r)>0,p=this.setLineColor(this.parameters.trend.color);t.textBaseline="middle",this.stx.canvasFont("stx_yaxis",t);var d=t.measureText("161.8%").width+10,f=Number.MAX_VALUE,m=-1*Number.MAX_VALUE,g=this.color;("auto"==g||e.isTransparent(g))&&(g=this.stx.defaultColor);for(var v=0;v<this.parameters.fibs.length;v++){t.fillStyle=g;var y=this.parameters.fibs[v];if(y.display){var b=this.stx.pixelFromValueAdjusted(i,this.p0[0],(this.p0[1]-this.p1[1])*y.level+this.p1[1]),x=e.xIntersection({x0:a,x1:a,y0:o,y1:s},b),w=this.stx.chart.left;a>r&&(w+=this.stx.chart.width);var C=(w-r)*(b-o)/(x-r)+o;if(!(r>w-(this.parameters.printLevels?d+5:0)&&a>r||r<w+(this.parameters.printLevels?d+5:0)&&a<r)){if(this.parameters.printLevels){var S=Math.round(1e3*y.level)/10+"%";a>r?(w-=d,t.textAlign="left"):(w+=d,t.textAlign="right"),this.parameters.printValues&&(t.fillStyle=g,this.stx.canvasFont("stx_yaxis",t)),C=(w-r)*(b-o)/(x-r)+o,t.fillText(S,w,C),a>r?w-=5:w+=5}if(t.textAlign="left",this.parameters.printValues&&x<this.stx.chart.width){var T=this.stx.transformedPriceFromPixel(b,i);T=n.priceFormatter?n.priceFormatter(this.stx,i,T):this.stx.formatYAxisPrice(T,i),t==this.stx.chart.context&&this.stx.endClip(),this.stx.createYAxisLabel(i,T,b,g,null,t),t==this.stx.chart.context&&this.stx.startClip(i.name)}var _=y.color;("auto"==_||e.isTransparent(_))&&(_=this.color),("auto"==_||e.isTransparent(_))&&(_=this.stx.defaultColor);var k=y.color;("auto"==k||e.isTransparent(k))&&(k=this.fillColor),("auto"==k||e.isTransparent(k))&&(k=this.stx.defaultColor),t.fillStyle=k,this.parameters.printLevels&&(C=(w-r)*(b-o)/(x-r)+o),this.stx.plotLine(r,w,o,C,y.level||!this.highlighted?_:p,"segment",t,i,y.parameters),t.globalAlpha=.05,t.beginPath(),t.moveTo(w,C),t.lineTo(r,o),t.lineTo(w,o),t.fill(),t.globalAlpha=1,b<f&&(f=b),b>m&&(m=b)}}}for(var D in{0:0,1:1}){var M=u?h-c*D:l+c*D;M=Math.round(M),M<f&&(f=M),M>m&&(m=M)}if(this.highlighted){var E="p0"==this.highlighted,A="p1"==this.highlighted;this.littleCircle(t,r,o,E),this.littleCircle(t,a,s,A)}}}},e.Drawing.fibtimezone=function(){this.name="fibtimezone"},e.Drawing.fibtimezone.ciqInheritsFrom(e.Drawing.fibonacci),e.Drawing.fibtimezone.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i&&this.p1){var n=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(this.p1[0],i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),o=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),s=[1,0],l=this.setLineColor(this.parameters.trend.color);t.textBaseline="middle",this.stx.canvasFont("stx_yaxis",t);var h=this.p1[0]-this.p0[0],c=this.color;("auto"==c||e.isTransparent(c))&&(c=this.stx.defaultColor),t.textAlign="center";var u=n,p=this.stx.chart.panel.yAxis.height,d=0,f=this.parameters.timezone.color;("auto"==f||e.isTransparent(f))&&(f=this.color),("auto"==f||e.isTransparent(f))&&(f=this.stx.defaultColor);var m=this.parameters.timezone.color;("auto"==m||e.isTransparent(m))&&(m=this.fillColor),("auto"==m||e.isTransparent(m))&&(m=this.stx.defaultColor),this.parameters.printLevels&&(p-=13);do{if(u=this.stx.pixelFromTick(this.p0[0]+d*h,i.chart),n<r&&u>this.stx.chart.left+this.stx.chart.width)break;if(n>r&&u<this.stx.chart.left)break;this.parameters.printLevels&&(t.fillStyle=c,t.fillText(r>n?d:-1*d,u,p+7)),t.fillStyle=m,this.stx.plotLine(u,u,0,p,this.highlighted?l:f,"segment",t,i,this.parameters.timezone.parameters),t.globalAlpha=.05,t.beginPath(),t.moveTo(n,0),t.lineTo(u,0),t.lineTo(u,p),t.lineTo(n,p),t.fill(),t.globalAlpha=1,d=s[0]+s[1],s.unshift(d)}while(h);if(t.textAlign="left",this.stx.plotLine(n,r,a,o,l,"segment",t,i,this.parameters.trend.parameters),this.highlighted){var g="p0"==this.highlighted,v="p1"==this.highlighted;this.littleCircle(t,n,a,g),this.littleCircle(t,r,o,v)}}},e.Drawing.fibtimezone.prototype.intersected=function(t,i,n){var r=this.p0,a=this.p1,o=this.stx.layout;return r&&a?this.pointIntersection(r[0],r[1],n)?(this.highlighted="p0",{action:"drag",point:"p0"}):this.pointIntersection(a[0],a[1],n)?(this.highlighted="p1",{action:"drag",point:"p1"}):e.boxIntersects(n.x0,n.y0,n.x1,n.y1,r[0],r[1],a[0],a[1],"segment",o.semiLog||"log"==o.chartScale)||n.x0<=r[0]&&n.x1>=r[0]?(this.highlighted=!0,{action:"move",p0:e.clone(r),p1:e.clone(a),tick:t,value:i}):null:null},e.Drawing.shape=function(){this.name="shape",this.radians=0,this.a=0,this.rotating=!1,this.textMeasure=!1,this.configurator="shape",this.dimension=[0,0],this.points=[]},e.Drawing.shape.ciqInheritsFrom(e.Drawing.BaseTwoPoint),e.Drawing.shape.prototype.measure=function(){},e.Drawing.shape.prototype.render=function(t){if(this.points.length){var i=this.stx.panels[this.panelName];if(i){var n=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]);if(this.p1){var a=this.stx.pixelFromTick(this.p1[0],i.chart),o=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]);t.globalAlpha=.5,t.fillStyle="#000000",this.rotating?(this.radians=Math.atan((o-r)/(a-n)),a<n?this.radians+=Math.PI:o<r&&(this.radians+=2*Math.PI),this.a=5*parseInt((36*this.radians/Math.PI).toFixed(0),10),this.a%=360,this.radians=this.a*Math.PI/180,this.textMeasure&&t.fillText(this.a+"°",a+10,o+10)):this.penDown&&(this.sx=Math.max(1,parseFloat(Math.abs(2*(a-n)/this.dimension[0]).toFixed(1))),a<n&&(this.sx*=-1),this.sy=Math.max(1,parseFloat(Math.abs(2*(o-r)/this.dimension[1]).toFixed(1))),o<r&&(this.sy*=-1),this.textMeasure&&t.fillText(this.sx+"x,"+this.sy+"x",a+this.sx+5,o+this.sy+5)),t.globalAlpha=1}var s=this.lineWidth;s||(s=1.1);var l={pattern:this.pattern,lineWidth:s};this.highlighted&&"none"==l.pattern&&(l.pattern="solid",.1==l.lineWidth&&(l.lineWidth=1));var h=this.color;("auto"==h||e.isTransparent(h))&&(h=this.stx.defaultColor),this.highlighted&&(h=this.stx.getCanvasColor("stx_highlight_vector"),.1==s&&(s=1.1));var c=this.fillColor;s/=2*Math.abs(this.sx*this.sy)/(Math.abs(this.sx)+Math.abs(this.sy)),t.save(),t.translate(n,r),t.rotate(this.radians),t.scale(this.sx,this.sy);var u,p;for(u=0;u<this.points.length;u++){for(t.beginPath(),p=0;p<this.points[u].length;p++){var d,f,m,g,v,y;"M"==this.points[u][p]?(d=this.points[u][++p]-(this.dimension[0]-1)/2,f=this.points[u][++p]-(this.dimension[1]-1)/2,t.moveTo(d,f)):"L"==this.points[u][p]?(d=this.points[u][++p]-(this.dimension[0]-1)/2,f=this.points[u][++p]-(this.dimension[1]-1)/2,t.lineTo(d,f)):"Q"==this.points[u][p]?(m=this.points[u][++p]-(this.dimension[0]-1)/2,v=this.points[u][++p]-(this.dimension[1]-1)/2,d=this.points[u][++p]-(this.dimension[0]-1)/2,f=this.points[u][++p]-(this.dimension[1]-1)/2,t.quadraticCurveTo(m,v,d,f)):"B"==this.points[u][p]&&(m=this.points[u][++p]-(this.dimension[0]-1)/2,v=this.points[u][++p]-(this.dimension[1]-1)/2,g=this.points[u][++p]-(this.dimension[0]-1)/2,y=this.points[u][++p]-(this.dimension[1]-1)/2,d=this.points[u][++p]-(this.dimension[0]-1)/2,f=this.points[u][++p]-(this.dimension[1]-1)/2,t.bezierCurveTo(m,v,g,y,d,f))}t.closePath(),c&&!e.isTransparent(c)&&"auto"!=c&&(t.fillStyle=c,t.fill()),h&&"none"!=this.pattern&&(t.strokeStyle=h,t.lineWidth=s,t.setLineDash&&(t.setLineDash(e.borderPatternToArray(s,this.pattern)),t.lineDashOffset=0),t.stroke())}if(t.restore(),t.save(),t.translate(n,r),t.rotate(this.radians),this.highlighted){var b="p0"==this.highlighted,x="p1"==this.highlighted,w="p2"==this.highlighted;this.littleCircle(t,0,0,b),this.mover(t,0,0,b),this.littleCircle(t,this.sx*this.dimension[0]/2,this.sy*this.dimension[1]/2,x),this.resizer(t,this.sx*this.dimension[0]/2,this.sy*this.dimension[1]/2,x),this.littleCircle(t,this.sx*this.dimension[0]/2,0,w),this.rotator(t,this.sx*this.dimension[0]/2,0,w),t.globalAlpha=.5,t.fillStyle="#000000",this.textMeasure&&(t.fillText(this.sx+"x,"+this.sy+"x",this.sx*this.dimension[0]/2+12,this.sy*this.dimension[1]/2+5),t.fillText(this.a+"°",this.sx*this.dimension[0]/2+12,5)),t.globalAlpha=1}else this.penDown&&(this.rotating?this.rotator(t,this.sx*this.dimension[0]/2,0,!0):this.resizer(t,this.sx*this.dimension[0]/2,this.sy*this.dimension[1]/2,!0));t.restore()}}},e.Drawing.shape.prototype.reposition=function(t,e,i,n){if(e){var r=this.stx.panels[this.panelName];if("move"==e.action){var a=e.tick-i,o=e.value-n;this.setPoint(0,e.p0[0]-a,e.p0[1]-o,r.chart),this.render(t)}else{var s=this.stx.pixelFromTick(this.p0[0],r.chart),l=this.stx.pixelFromValueAdjusted(r,this.p0[0],this.p0[1]),h=this.stx.pixelFromTick(i,r.chart),c=this.stx.pixelFromValueAdjusted(r,i,n);"scale"==e.action?(this[e.point]=[i,n],this.sx=parseFloat((((h-s)*Math.cos(this.radians)+(c-l)*Math.sin(this.radians))/(this.dimension[0]/2)).toFixed(1)),Math.abs(this.sx)<1&&(this.sx/=Math.abs(this.sy)),this.sy=parseFloat((((c-l)*Math.cos(this.radians)-(h-s)*Math.sin(this.radians))/(this.dimension[1]/2)).toFixed(1)),Math.abs(this.sy)<1&&(this.sy/=Math.abs(this.sy)),this.render(t)):"rotate"==e.action&&(this[e.point]=[i,n],this.radians=Math.atan((c-l)/(h-s)),h<s?this.radians+=Math.PI:c<l&&(this.radians+=2*Math.PI),this.a=5*parseInt((36*this.radians/Math.PI).toFixed(0),10),this.sx<0&&(this.a=this.a+180),this.a%=360,this.radians=this.a*Math.PI/180,this.render(t))}}},e.Drawing.shape.prototype.intersected=function(t,i,n){if(!this.p0)return null;if(this.stx.repositioningDrawing==this&&this.stx.repositioningDrawing.repositioner)return this.stx.repositioningDrawing.repositioner;var r=this.stx.panels[this.panelName],a=this.stx.pixelFromTick(this.p0[0],r.chart),o=this.stx.pixelFromValueAdjusted(r,this.p0[0],this.p0[1]),s=this.stx.pixelFromTick(t,r.chart),l=this.stx.pixelFromValueAdjusted(r,t,i);s-=a,l-=o;var h=l,c=s;s=Math.cos(this.radians)*c+Math.sin(this.radians)*h,l=Math.cos(this.radians)*h-Math.sin(this.radians)*c,s/=this.sx,l/=this.sy;var u=Math.pow(e.touchDevice?25:5+this.littleCircleRadius(),2),p=Math.abs(u/(this.sx*this.sy)),d=Math.pow(this.dimension[0]/2,2)+Math.pow(this.dimension[1]/2,2)>Math.pow(s,2)+Math.pow(l,2),f=(u-(Math.pow(s*this.sx,2)+Math.pow(l*this.sy,2)))/Math.abs(this.sx*this.sy),m=p-(Math.pow(s-this.dimension[0]/2,2)+Math.pow(l-this.dimension[1]/2,2)),g=p-(Math.pow(s-this.dimension[0]/2,2)+Math.pow(l,2));return m>0&&m>=g&&m>=f?(this.highlighted="p1",{action:"scale"}):g>0&&g>=m&&g>=f?(this.highlighted="p2",{action:"rotate"}):f>0&&f>=m&&f>=g?(this.highlighted="p0",{action:"move",p0:e.clone(this.p0),tick:t,value:i}):d?(this.highlighted=!0,{}):null},e.Drawing.shape.prototype.configs=["color","fillColor","lineWidth","pattern"],e.Drawing.shape.prototype.littleCircleRadius=function(){return 3},e.Drawing.shape.prototype.click=function(t,e,i){if(!this.points.length)return!1;this.copyConfig();var n=this.stx.panels[this.panelName];return this.penDown?(this.setPoint(1,e,i,n.chart),this.rotating?(this.penDown=!1,this.rotating=!1,!0):(this.rotating=!0,!1)):(this.setPoint(0,e,i,n.chart),this.penDown=!0,!1)},e.Drawing.shape.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.radians=Math.round(this.a/5)*Math.PI/36)},e.Drawing.shape.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.fillColor=e.fc,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.v0=e.v0,this.tzo0=e.tzo0,this.a=e.a,this.sx=e.sx,this.sy=e.sy,this.adjust()},e.Drawing.shape.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,fc:this.fillColor,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,v0:this.v0,tzo0:this.tzo0,a:this.a,sx:this.sx,sy:this.sy}},e.Drawing.xcross=function(){this.name="xcross",this.dimension=[7,7],this.points=[["M",1,0,"L",3,2,"L",5,0,"L",6,1,"L",4,3,"L",6,5,"L",5,6,"L",3,4,"L",1,6,"L",0,5,"L",2,3,"L",0,1,"L",1,0]]},e.Drawing.xcross.ciqInheritsFrom(e.Drawing.shape),e.Drawing.arrow=function(){this.name="arrow",this.dimension=[11,11],this.points=[["M",3,0,"L",7,0,"L",7,5,"L",10,5,"L",5,10,"L",0,5,"L",3,5,"L",3,0]]},e.Drawing.arrow.ciqInheritsFrom(e.Drawing.shape),e.Drawing.check=function(){this.name="check",this.dimension=[8,9],this.points=[["M",1,5,"L",0,6,"L",2,8,"L",7,1,"L",6,0,"L",2,6,"L",1,5]]},e.Drawing.check.ciqInheritsFrom(e.Drawing.shape),e.Drawing.star=function(){this.name="star",this.dimension=[12,12],this.points=[["M",0,4,"L",4,4,"L",5.5,0,"L",7,4,"L",11,4,"L",8,7,"L",9,11,"L",5.5,9,"L",2,11,"L",3,7,"L",0,4]]},e.Drawing.star.ciqInheritsFrom(e.Drawing.shape),e.Drawing.heart=function(){this.name="heart",this.dimension=[23,20],this.points=[["M",11,3,"B",11,2.4,10,0,6,0,"B",0,0,0,7.5,0,7.5,"B",0,11,4,15.4,11,19,"B",18,15.4,22,11,22,7.5,"B",22,7.5,22,0,16,0,"B",13,0,11,2.4,11,3]]},e.Drawing.heart.ciqInheritsFrom(e.Drawing.shape),e.Drawing.focusarrow=function(){this.name="focusarrow",this.dimension=[7,5],this.points=[["M",0,0,"L",2,2,"L",0,4,"L",0,0],["M",6,0,"L",4,2,"L",6,4,"L",6,0]]},e.Drawing.focusarrow.ciqInheritsFrom(e.Drawing.shape),e.Drawing.crossline=function(){this.name="crossline"},e.Drawing.crossline.ciqInheritsFrom(e.Drawing.horizontal),e.extend(e.Drawing.crossline.prototype,{measure:function(){},accidentalClick:function(t,e){return!1},adjust:function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.p1=e.clone(this.p0))},intersected:function(t,i,n){if(!this.p0||!this.p1)return null;this.p1[0]+=1;var r=this.lineIntersection(t,i,n,"horizontal");return this.p1=e.clone(this.p0),r||(this.p1[1]+=1,r=this.lineIntersection(t,i,n,"vertical"),this.p1=e.clone(this.p0),r)?(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i}):null},render:function(t){var n=this.stx.panels[this.panelName];if(n){var r=this.stx.pixelFromTick(this.p0[0],n.chart),a=this.stx.pixelFromValueAdjusted(n,this.p0[0],this.p0[1]),o=this.setLineColor(),s={pattern:this.pattern,lineWidth:this.lineWidth};if(this.stx.plotLine(r,r+100,a,a,o,"horizontal",t,n,s),this.stx.plotLine(r,r,a,a+100,o,"vertical",t,n,s),this.axisLabel&&!this.highlighted){this.stx.endClip();var l=this.p0[1];if(n.chart.transformFunc&&(l=n.chart.transformFunc(this.stx,n.chart,l)),l=n.yAxis.priceFormatter?n.yAxis.priceFormatter(this.stx,n,l):this.stx.formatYAxisPrice(l,n),this.stx.createYAxisLabel(n,l,a,o),this.stx.startClip(n.name),this.p0[0]>=0&&!e.ChartEngine.hideDates()){var h,c;if(h=this.stx.dateFromTick(this.p0[0],n.chart,!0),e.ChartEngine.isDailyInterval(this.stx.layout.interval))h.setHours(0,0,0,0);else{var u=1e3*h.getSeconds()+h.getMilliseconds();this.stx.dataZone&&(c=new i.Date(h.getFullYear(),h.getMonth(),h.getDate(),h.getHours(),h.getMinutes(),this.stx.dataZone),h=new Date(c.getTime()+u)),this.stx.displayZone&&(c=new i.Date(h.getTime(),this.stx.displayZone),h=new Date(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes()),h=new Date(h.getTime()+u))}var p=e.mmddhhmm(e.yyyymmddhhmm(h));if(n.chart.xAxis.formatter)p=n.chart.xAxis.formatter(h);else if(this.stx.internationalizer){var d;0!==h.getHours()||0!==h.getMinutes()?(d=this.stx.internationalizer.monthDay.format(h),d+=" "+this.stx.internationalizer.hourMinute.format(h)):d=this.stx.internationalizer.yearMonthDay.format(h),p=d}this.stx.endClip(),this.stx.createXAxisLabel(n,p,r,o,null,!0),this.stx.startClip(n.name)}}}}}),e.Drawing.speedarc=function(){this.name="speedarc",this.printLevels=!0},e.Drawing.speedarc.ciqInheritsFrom(e.Drawing.segment),e.extend(e.Drawing.speedarc.prototype,{defaultOpacity:.25,configs:["color","fillColor","lineWidth","pattern"],lineIntersection:function(t,i,n,r){var a=this.p0,o=this.p1,s=this.stx.layout;return a&&o&&e.boxIntersects(n.x0,n.y0,n.x1,n.y1,a[0],a[1],o[0],o[1],"segment",s.semiLog||"log"==s.chartScale)},copyConfig:function(){this.color=this.stx.currentVectorParameters.currentColor,this.fillColor=this.stx.currentVectorParameters.fillColor,this.lineWidth=this.stx.currentVectorParameters.lineWidth,this.pattern=this.stx.currentVectorParameters.pattern},render:function(t){var i=this.stx.panels[this.panelName];if(i&&this.p1){var n=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(this.p1[0],i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),o=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),s=o<a,l=Math.abs((o-a)/(r-n)),h=this.color;("auto"==h||e.isTransparent(h))&&(h=this.stx.defaultColor),t.strokeStyle=h;var c=this.fillColor;("auto"==c||e.isTransparent(c))&&(c=this.stx.defaultColor),t.fillStyle=c,t.setLineDash&&(t.setLineDash(e.borderPatternToArray(this.lineWidth,this.pattern)),t.lineDashOffset=0),this.stx.canvasFont("stx_yaxis",t);for(var u=1;u<3;u++){var p=Math.abs(this.p1[1]-this.p0[1])*Math.sqrt(2)*u/3,d=this.p1[1]+p*(s?-1:1),f=this.stx.pixelFromValueAdjusted(i,this.p0[0],d);if(t.save(),t.beginPath(),t.scale(1/l,1),t.arc(r*l,o,Math.abs(f-o),0,Math.PI,!s),t.globalAlpha=this.defaultOpacity,t.stroke(),t.globalAlpha=.1,t.fill(),t.restore(),t.globalAlpha=1,this.printLevels){t.fillStyle=h,t.textAlign="center";var m=u+"/3";t.fillText(m,r,Math.round(f-5)),t.fillStyle=c}}t.textAlign="left";var g=this.setLineColor(),v={pattern:this.pattern,lineWidth:this.lineWidth,opacity:this.defaultOpacity};if(this.stx.plotLine(n,r,a,o,g,"segment",t,i,v),t.setLineDash&&t.setLineDash([]),this.highlighted){var y="p0"==this.highlighted,b="p1"==this.highlighted;this.littleCircle(t,n,a,y),this.littleCircle(t,r,o,b)}}},reconstruct:function(t,e){this.stx=t,this.color=e.col,this.fillColor=e.fc,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.adjust()},serialize:function(){return{name:this.name,pnl:this.panelName,col:this.color,fc:this.fillColor,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1}}}),e.Drawing.speedline=function(){this.name="speedline",this.printLevels=!0},e.Drawing.speedline.ciqInheritsFrom(e.Drawing.speedarc),e.extend(e.Drawing.speedline.prototype,{render:function(t){var i=this.stx.panels[this.panelName];if(i&&this.p1){var n=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(this.p1[0],i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),o=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]);this.stx.canvasFont("stx_yaxis",t);var s=this.setLineColor(),l=this.color;("auto"==l||e.isTransparent(l))&&(l=this.stx.defaultColor),t.strokeStyle=l;var h=this.fillColor;("auto"==h||e.isTransparent(h))&&(h=this.stx.defaultColor),t.fillStyle=h;for(var c,u,p={pattern:this.pattern,lineWidth:this.lineWidth,opacity:this.defaultOpacity},d=["1","2/3","1/3","3/2","3"],f=[1,2/3,1/3,1.5,3],m=[],g=0;g<f.length;g++){var v=f[g];if(!(v>1)||this.extension){var y,b=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]-(this.p0[1]-this.p1[1])*v);v>1?(y=e.xIntersection({x0:n,x1:r,y0:a,y1:b},o),m.push(y)):(y=e.xIntersection({x0:r,x1:r,y0:a,y1:o},b),m.push(b));var x=v>1?y:r,w=v>1?o:b;if(this.confineToGrid||(x=this.stx.chart.left,r>n&&(x+=this.stx.chart.width),w=(x-n)*(b-a)/(r-n)+a),this.printLevels&&(1!=v||this.extension)){t.fillStyle=l;var C=0,S=0;a>o?(S=-5,t.textBaseline="bottom"):(S=5,t.textBaseline="top"),n>r?(C=5,t.textAlign="right"):(C=-5,t.textAlign="left"),v>1?t.fillText(d[g],y+(this.confineToGrid?0:C),o):t.fillText(d[g],r,b+(this.confineToGrid?0:S)),t.fillStyle=h}this.stx.plotLine(n,x,a,w,g||!this.highlighted?l:s,"segment",t,i,p),1==v&&(c=x,u=w),t.globalAlpha=.1,t.beginPath(),t.moveTo(x,w),t.lineTo(n,a),t.lineTo(c,u),t.fill(),t.globalAlpha=1}}if(t.textAlign="left",t.textBaseline="middle",this.confineToGrid&&(t.globalAlpha=.3,t.beginPath(),t.moveTo(n,a),t.lineTo(n,o),t.lineTo(r,o),t.lineTo(r,a),t.lineTo(n,a),t.moveTo(n,m[1]),t.lineTo(r,m[1]),t.moveTo(n,m[2]),t.lineTo(r,m[2]),this.extension&&(t.moveTo(m[3],a),t.lineTo(m[3],o),t.moveTo(m[4],a),t.lineTo(m[4],o)),t.stroke(),t.globalAlpha=1),this.highlighted){var T="p0"==this.highlighted,_="p1"==this.highlighted;this.littleCircle(t,n,a,T),this.littleCircle(t,r,o,_)}}}}),e.Drawing.gannfan=function(){this.name="gannfan",this.printLevels=!0},e.Drawing.gannfan.ciqInheritsFrom(e.Drawing.speedarc),e.extend(e.Drawing.gannfan.prototype,{render:function(t){var i=this.stx.panels[this.panelName];if(i&&this.p1){var n=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(this.p1[0],i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),o=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]);this.stx.canvasFont("stx_yaxis",t);var s=this.setLineColor(),l=this.color;("auto"==l||e.isTransparent(l))&&(l=this.stx.defaultColor),t.strokeStyle=l;var h=this.fillColor;("auto"==h||e.isTransparent(h))&&(h=this.stx.defaultColor),t.fillStyle=h;for(var c,u,p={pattern:this.pattern,lineWidth:this.lineWidth,opacity:this.defaultOpacity},d=[1,2,3,4,8,.5,1/3,.25,1/8],f=0;f<d.length;f++){var m=d[f],g=n+(r-n)/m,v=a-m*(a-o),y=this.stx.chart.left;r>n&&(y+=this.stx.chart.width);var b=(y-n)*(v-a)/(r-n)+a;if(this.printLevels){t.fillStyle=l;var x=0,w=0;a>o?(w=5,t.textBaseline="top"):(w=-5,t.textBaseline="botttom"),n>r?(x=5,t.textAlign="left"):(x=-5,t.textAlign="right"),m>1?t.fillText(m+"x1",g+x,o):t.fillText("1x"+1/m,r,v+w),t.fillStyle=h}this.stx.plotLine(n,y,a,b,f||!this.highlighted?l:s,"segment",t,i,p),1==m&&(c=y,u=b),t.globalAlpha=.1,t.beginPath(),t.moveTo(y,b),t.lineTo(n,a),t.lineTo(c,u),t.fill(),t.globalAlpha=1}if(t.textAlign="left",t.textBaseline="middle",this.highlighted){var C="p0"==this.highlighted,S="p1"==this.highlighted;this.littleCircle(t,n,a,C),this.littleCircle(t,r,o,S)}}}}),e.Drawing.timecycle=function(){this.name="timecycle",this.printLevels=!0},e.Drawing.timecycle.ciqInheritsFrom(e.Drawing.speedarc),e.extend(e.Drawing.timecycle.prototype,{intersected:function(t,i,n){var r=this.p0,a=this.p1,o=this.stx.layout;return r&&a?this.pointIntersection(r[0],r[1],n)?(this.highlighted="p0",{action:"drag",point:"p0"}):this.pointIntersection(a[0],a[1],n)?(this.highlighted="p1",{action:"drag",point:"p1"}):e.boxIntersects(n.x0,n.y0,n.x1,n.y1,r[0],r[1],a[0],a[1],"segment",o.semiLog||"log"==o.chartScale)||n.x0<=this.p0[0]&&n.x1>=r[0]?(this.highlighted=!0,{action:"move",p0:e.clone(r),p1:e.clone(a),tick:t,value:i}):null:null},render:function(t){var i=this.stx.panels[this.panelName];if(i&&this.p1){var n=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(this.p1[0],i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),o=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),s=0,l=this.setLineColor();t.textBaseline="middle",this.stx.canvasFont("stx_yaxis",t);var h=this.p1[0]-this.p0[0];t.textAlign="center";var c=n,u=this.stx.chart.panel.yAxis.height,p=this.color;("auto"==p||e.isTransparent(p))&&(p=this.stx.defaultColor);var d=this.fillColor;("auto"==d||e.isTransparent(d))&&(d=this.stx.defaultColor),this.printLevels&&(u-=13);var f={pattern:this.pattern,lineWidth:this.lineWidth,opacity:this.defaultOpacity},m=[];t.save(),t.fillStyle=d,t.globalAlpha=.05;do{if(c=this.stx.pixelFromTick(this.p0[0]+s*h,i.chart),s++,n<r&&c>this.stx.chart.left+this.stx.chart.width)break;if(n>r&&c<this.stx.chart.left)break;c<this.stx.chart.left||c>this.stx.chart.left+this.stx.chart.width||(t.beginPath(),t.moveTo(n,0),t.lineTo(c,0),t.lineTo(c,u),t.lineTo(n,u),t.fill(),m.push({c:s,x:c}))}while(h);t.globalAlpha=1;for(var g=0,v=0;v<m.length;v++)if(this.stx.plotLine(m[v].x,m[v].x,0,u,this.highlighted?l:p,"segment",t,i,f),this.printLevels){t.fillStyle=p;var y=this.stx.chart.context.measureText(m[v].c).width+3;y<this.stx.layout.candleWidth+g?(t.fillText(m[v].c,m[v].x,u+7),g=0):g+=this.stx.layout.candleWidth}if(t.restore(),t.textAlign="left",this.stx.plotLine(n,r,a,o,l,"segment",t,i,f),this.highlighted){var b="p0"==this.highlighted,x="p1"==this.highlighted;this.littleCircle(t,n,a,b),this.littleCircle(t,r,o,x)}}}}),e.Drawing.regression=function(){this.name="regression"},e.Drawing.regression.ciqInheritsFrom(e.Drawing.segment),e.extend(e.Drawing.regression.prototype,{click:function(t,e,i){if(!(e<0)){this.copyConfig();var n=this.stx.panels[this.panelName];return this.penDown?this.accidentalClick(e,i)?this.dragToDraw:(this.setPoint(1,e,i,n.chart),this.penDown=!1,!0):(this.setPoint(0,e,i,n.chart),this.penDown=!0,!1)}},lineIntersection:function(t,i,n,r){var a=this.p0,o=this.p1,s=this.stx.layout;return a&&o&&e.boxIntersects(n.x0,n.y0,n.x1,n.y1,a[0],a[1],o[0],o[1],"segment",s.semiLog||"log"==s.chartScale)},render:function(t){var e=this.stx.panels[this.panelName];if(e&&this.p1&&!(this.p0[0]<0||this.p1[0]<0)){var i=this.stx.pixelFromTick(this.p0[0],e.chart),n=this.stx.pixelFromTick(this.p1[0],e.chart);if(!(i<this.stx.chart.left&&n<this.stx.chart.left||i>this.stx.chart.right&&n>this.stx.chart.right)){for(var r=[],a=0,o=0,s=0,l=Math.min(this.p1[0],this.p0[0]);l<=Math.max(this.p1[0],this.p0[0]);l++){if(this.stx.chart.dataSet[l]){var h=this.stx.chart.dataSet[l].Close;(h||0===h)&&r.push(h)}s++}for(l=0;l<r.length;l++)o+=r.length*r[l]-a,a+=r[l];var c,u,p=r.length,d=p*(p+1)/2,f=Math.pow(d,2),m=d*(2*p+1)/3,g=(p*o-d*a)/(p*m-f),v=(a-g*d)/p;this.p0[0]<this.p1[0]?(c=this.stx.pixelFromValueAdjusted(e,this.p0[0],v),u=this.stx.pixelFromValueAdjusted(e,this.p1[0],g*s+v)):(c=this.stx.pixelFromValueAdjusted(e,this.p0[0],g*s+v),u=this.stx.pixelFromValueAdjusted(e,this.p1[0],v));var y=this.setLineColor(),b={pattern:this.pattern,lineWidth:this.lineWidth};if(this.stx.plotLine(i,n,c,u,y,"segment",t,e,b),this.stx.plotLine(i,i,c-20,c+20,y,"segment",t,e,b),this.stx.plotLine(n,n,u-20,u+20,y,"segment",t,e,b),this.highlighted){var x="p0"==this.highlighted,w="p1"==this.highlighted;this.littleCircle(t,i,c,x),this.littleCircle(t,n,u,w)}else this.p0[0]<this.p1[0]?(this.setPoint(0,this.p0[0],v,e.chart),this.setPoint(1,this.p1[0],g*s+v,e.chart)):(this.setPoint(0,this.p0[0],g*s+v,e.chart),this.setPoint(1,this.p1[0],v,e.chart))}}}}),e.Drawing.average=function(){this.name="average"},e.Drawing.average.ciqInheritsFrom(e.Drawing.regression),e.extend(e.Drawing.average.prototype,{configs:["color","lineWidth","pattern","axisLabel"],measure:function(){},render:function(t){var e=this.stx.panels[this.panelName];if(e&&this.p1&&!(this.p0[0]<0||this.p1[0]<0)){var i=this.stx.pixelFromTick(this.p0[0],e.chart),n=this.stx.pixelFromTick(this.p1[0],e.chart);if(!(i<this.stx.chart.left&&n<this.stx.chart.left||i>this.stx.chart.right&&n>this.stx.chart.right)){for(var r=0,a=0,o=0,s=Math.min(this.p1[0],this.p0[0]);s<=Math.max(this.p1[0],this.p0[0]);s++){if(this.stx.chart.dataSet[s]){var l=this.stx.chart.dataSet[s].Close;(l||0===l)&&(o++,r+=l)}a++}if(o){var h=r/o;y=this.stx.pixelFromValueAdjusted(e,this.p0[0],h);var c=this.setLineColor(),u={pattern:this.pattern,lineWidth:this.lineWidth};if(this.stx.plotLine(i,n,y,y,c,"segment",t,e,u),this.stx.plotLine(i,i,y-20,y+20,c,"segment",t,e,u),this.stx.plotLine(n,n,y-20,y+20,c,"segment",t,e,u),this.axisLabel&&!this.highlighted&&!this.penDown&&(i>=e.chart.left&&i<=e.chart.right||n>=e.chart.left&&n<=e.chart.right)){this.stx.endClip();var p=h;e.chart.transformFunc&&(p=e.chart.transformFunc(this.stx,e.chart,p)),p=e.yAxis.priceFormatter?e.yAxis.priceFormatter(this.stx,e,p):this.stx.formatYAxisPrice(p,e),this.stx.createYAxisLabel(e,p,y,c),this.stx.startClip(e.name)}if(this.highlighted){var d="p0"==this.highlighted,f="p1"==this.highlighted;this.littleCircle(t,i,y,d),this.littleCircle(t,n,y,f)}else this.setPoint(0,this.p0[0],h),this.setPoint(1,this.p1[0],h)}}}},reconstruct:function(t,e){this.stx=t,this.color=e.col,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.axisLabel=e.al,this.adjust()},serialize:function(){return{name:this.name,pnl:this.panelName,col:this.color,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1,al:this.axisLabel}}}),e.Drawing.quadrant=function(){this.name="quadrant"},e.Drawing.quadrant.ciqInheritsFrom(e.Drawing.speedarc),e.extend(e.Drawing.quadrant.prototype,{render:function(t){var i=this.stx.panels[this.panelName];if(i&&this.p1){for(var n=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(this.p1[0],i.chart),a=null,o=null,s=Math.min(this.p1[0],this.p0[0]);s<=Math.max(this.p1[0],this.p0[0]);s++)if(this.stx.chart.dataSet[s]){var l=this.stx.chart.dataSet[s].Close;(l||0===l)&&((null===a||l>a)&&(a=l),(null===o||l<o)&&(o=l))}var h=(a+o)/2,c=this.stx.pixelFromValueAdjusted(i,this.p0[0],a),u=this.stx.pixelFromValueAdjusted(i,this.p0[0],(a+h)/2),p=this.stx.pixelFromValueAdjusted(i,this.p0[0],(2*a+o)/3),d=this.stx.pixelFromValueAdjusted(i,this.p0[0],h),f=this.stx.pixelFromValueAdjusted(i,this.p0[0],(a+2*o)/3),m=this.stx.pixelFromValueAdjusted(i,this.p0[0],(o+h)/2),g=this.stx.pixelFromValueAdjusted(i,this.p0[0],o),v=this.setLineColor(),y=this.fillColor;("auto"==y||e.isTransparent(y))&&(y=this.stx.defaultColor),t.fillStyle=y;var b={pattern:this.pattern,lineWidth:this.lineWidth};if(this.stx.plotLine(n,r,c,c,v,"segment",t,i,b),this.stx.plotLine(n,r,g,g,v,"segment",t,i,b),"quadrant"==this.name?(this.stx.plotLine(n,r,u,u,v,"segment",t,i,b),this.stx.plotLine(n,r,m,m,v,"segment",t,i,b)):"tirone"==this.name&&(this.stx.plotLine(n,r,p,p,v,"segment",t,i,b),this.stx.plotLine(n,r,f,f,v,"segment",t,i,b)),this.stx.plotLine(n,n,c,g,v,"segment",t,i,b),this.stx.plotLine(r,r,c,g,v,"segment",t,i,b),this.stx.plotLine(n,r,d,d,v,"segment",t,i,e.extend(b,{opacity:"tirone"==this.name?.2:1})),t.globalAlpha=.1,t.beginPath(),t.fillRect(n,c,r-n,g-c),"quadrant"==this.name?t.fillRect(n,u,r-n,m-u):"tirone"==this.name&&t.fillRect(n,p,r-n,f-p),t.globalAlpha=1,this.highlighted){var x="p0"==this.highlighted,w="p1"==this.highlighted;this.littleCircle(t,n,d,x),this.littleCircle(t,r,d,w)}else this.setPoint(0,this.p0[0],h,i.chart),this.setPoint(1,this.p1[0],h,i.chart)}}}),e.Drawing.tirone=function(){this.name="tirone"},e.Drawing.tirone.ciqInheritsFrom(e.Drawing.quadrant),t},__equations_=function(t){var e=t.CIQ,i=function(){function t(t){function e(){}return e.prototype=t,new e}function e(t,e,i,n){this.type_=t,this.index_=e||0,this.prio_=i||0,this.number_=void 0!==n&&null!==n?n:0,this.toString=function(){switch(this.type_){case O:return this.number_;case F:case I:case j:return this.index_;case N:return"CALL";default:return"Invalid Token"}}}function i(t,e,i,n){this.tokens=t,this.ops1=e,this.ops2=i,this.functions=n}function n(t){return"string"==typeof t?(R.lastIndex=0,R.test(t)?"'"+t.replace(R,function(t){var e=V[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+"'":"'"+t+"'"):t}function r(t,e){return Number(t)+Number(e)}function a(t,e){return t-e}function o(t,e){return t*e}function s(t,e){return t/e}function l(t,e){return t%e}function h(t,e){return""+t+e}function c(t,e){return t==e}function u(t,e){return t!=e}function p(t,e){return t>e}function d(t,e){return t<e}function f(t,e){return t>=e}function m(t,e){return t<=e}function g(t,e){return Boolean(t&&e)}function v(t,e){return Boolean(t||e)}function y(t){return Math.sinh?Math.sinh(t):(Math.exp(t)-Math.exp(-t))/2}function b(t){return Math.cosh?Math.cosh(t):(Math.exp(t)+Math.exp(-t))/2}function x(t){return Math.tanh?Math.tanh(t):t===1/0?1:t===-1/0?-1:(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))}function w(t){return Math.asinh?Math.asinh(t):t===-1/0?t:Math.log(t+Math.sqrt(t*t+1))}function C(t){return Math.acosh?Math.acosh(t):Math.log(t+Math.sqrt(t*t-1))}function S(t){return Math.atanh?Math.atanh(t):Math.log((1+t)/(1-t))/2}function T(t){return Math.log(t)*Math.LOG10E}function _(t){return-t}function k(t){return Math.trunc?Math.trunc(t):t<0?Math.ceil(t):Math.floor(t)}function D(t){return Math.random()*(t||1)}function M(t){t=Math.floor(t);for(var e=t;t>1;)e*=--t;return e}function E(){if(Math.hypot)return Math.hypot.apply(this,arguments);for(var t=0,e=arguments.length,i=0;i<e;i++){if(arguments[i]===1/0||arguments[i]===-1/0)return 1/0;t+=arguments[i]*arguments[i]}return Math.sqrt(t)}function A(t,e,i){return t?e:i}function P(t,e){return"[object Array]"!=Object.prototype.toString.call(t)?[t,e]:(t=t.slice(),t.push(e),t)}function L(){this.success=!1,this.errormsg="",this.expression="",this.pos=0,this.tokennumber=0,this.tokenprio=0,this.tokenindex=0,this.tmpprio=0,this.ops1={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:y,cosh:b,tanh:x,asinh:w,acosh:C,atanh:S,sqrt:Math.sqrt,log:Math.log,lg:T,log10:T,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:k,"-":_,exp:Math.exp},this.ops2={"+":r,"-":a,"*":o,"/":s,"%":l,"^":Math.pow,",":P,"||":h,"==":c,"!=":u,">":p,"<":d,">=":f,"<=":m,and:g,or:v},this.functions={random:D,fac:M,min:Math.min,max:Math.max,hypot:E,pyt:E,pow:Math.pow,atan2:Math.atan2,if:A},this.consts={E:Math.E,PI:Math.PI}}var O=0,F=1,I=2,j=3,N=4,R=/[\\\'\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,V={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","'":"\\'","\\":"\\\\"};i.prototype={simplify:function(n){n=n||{};var r,a,o,s,l=[],h=[],c=this.tokens.length,u=0;for(u=0;u<c;u++){s=this.tokens[u];var p=s.type_;if(p===O)l.push(s);else if(p===j&&s.index_ in n)s=new e(O,0,0,n[s.index_]),l.push(s);else if(p===I&&l.length>1)a=l.pop(),r=l.pop(),o=this.ops2[s.index_],s=new e(O,0,0,o(r.number_,a.number_)),l.push(s);else if(p===F&&l.length>0)r=l.pop(),o=this.ops1[s.index_],s=new e(O,0,0,o(r.number_)),l.push(s);else{for(;l.length>0;)h.push(l.shift());h.push(s)}}for(;l.length>0;)h.push(l.shift());return new i(h,t(this.ops1),t(this.ops2),t(this.functions))},substitute:function(n,r){r instanceof i||(r=(new L).parse(String(r)));var a,o=[],s=this.tokens.length,l=0;for(l=0;l<s;l++){a=this.tokens[l];if(a.type_===j&&a.index_===n)for(var h=0;h<r.tokens.length;h++){var c=r.tokens[h],u=new e(c.type_,c.index_,c.prio_,c.number_);o.push(u)}else o.push(a)}return new i(o,t(this.ops1),t(this.ops2),t(this.functions))},evaluate:function(t){t=t||{};var e,i,n,r,a=[],o=this.tokens.length,s=0;for(s=0;s<o;s++){r=this.tokens[s];var l=r.type_;if(l===O)a.push(r.number_);else if(l===I)i=a.pop(),e=a.pop(),n=this.ops2[r.index_],a.push(n(e,i));else if(l===j)if(r.index_ in t)a.push(t[r.index_]);else{if(!(r.index_ in this.functions))throw new Error("undefined variable: "+r.index_);a.push(this.functions[r.index_])}else if(l===F)e=a.pop(),n=this.ops1[r.index_],a.push(n(e));else{if(l!==N)throw new Error("invalid Expression");if(e=a.pop(),n=a.pop(),!n.apply||!n.call)throw new Error(n+" is not a function");"[object Array]"==Object.prototype.toString.call(e)?a.push(n.apply(void 0,e)):a.push(n.call(void 0,e))}}if(a.length>1)throw new Error("invalid Expression (parity)");return a[0]},toString:function(t){var e,i,r,a,o=[],s=this.tokens.length,l=0;for(l=0;l<s;l++){a=this.tokens[l];var h=a.type_;if(h===O)o.push(n(a.number_));else if(h===I)i=o.pop(),e=o.pop(),r=a.index_,t&&"^"==r?o.push("Math.pow("+e+","+i+")"):o.push("("+e+r+i+")");else if(h===j)o.push(a.index_);else if(h===F)e=o.pop(),r=a.index_,"-"===r?o.push("("+r+e+")"):o.push(r+"("+e+")");else{if(h!==N)throw new Error("invalid Expression");e=o.pop(),r=o.pop(),o.push(r+"("+e+")")}}if(o.length>1)throw new Error("invalid Expression (parity)");return o[0]},variables:function(){for(var t=this.tokens.length,e=[],i=0;i<t;i++){var n=this.tokens[i];n.type_===j&&-1==e.indexOf(n.index_)&&e.push(n.index_)}return e}},L.parse=function(t){return(new L).parse(t)},L.evaluate=function(t,e){return L.parse(t).evaluate(e)},L.Expression=i,L.values={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:y,cosh:b,tanh:x,asinh:w,acosh:C,atanh:S,sqrt:Math.sqrt,log:Math.log,lg:T,log10:T,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:k,random:D,fac:M,exp:Math.exp,min:Math.min,max:Math.max,hypot:E,pyt:E,pow:Math.pow,atan2:Math.atan2,if:A,E:Math.E,PI:Math.PI};return L.prototype={parse:function(n){this.errormsg="",this.success=!0;var r=[],a=[];this.tmpprio=0;var o=77,s=0;for(this.expression=n,this.pos=0;this.pos<this.expression.length;){var l;if(this.isOperator())this.isSign()&&64&o?(this.isNegativeSign()&&(this.tokenprio=2,this.tokenindex="-",s++,this.addfunc(a,r,F)),o=77):this.isComment()||(0==(2&o)&&this.error_parsing(this.pos,"unexpected operator"),s+=2,this.addfunc(a,r,I),o=77);else if(this.isNumber())0==(1&o)&&this.error_parsing(this.pos,"unexpected number"),l=new e(O,0,0,this.tokennumber),a.push(l),o=50;else if(this.isString())0==(1&o)&&this.error_parsing(this.pos,"unexpected string"),l=new e(O,0,0,this.tokennumber),a.push(l),o=50;else if(this.isLeftParenth())0==(8&o)&&this.error_parsing(this.pos,'unexpected "("'),128&o&&(s+=2,this.tokenprio=-2,this.tokenindex=-1,this.addfunc(a,r,N)),o=333;else if(this.isRightParenth())256&o?(l=new e(O,0,0,[]),a.push(l)):0==(16&o)&&this.error_parsing(this.pos,'unexpected ")"'),o=186;else if(this.isComma())0==(32&o)&&this.error_parsing(this.pos,'unexpected ","'),this.addfunc(a,r,I),s+=2,o=77;else if(this.isConst()){0==(1&o)&&this.error_parsing(this.pos,"unexpected constant");var h=new e(O,0,0,this.tokennumber);a.push(h),o=50}else if(this.isOp2())0==(4&o)&&this.error_parsing(this.pos,"unexpected function"),this.addfunc(a,r,I),s+=2,o=8;else if(this.isOp1())0==(4&o)&&this.error_parsing(this.pos,"unexpected function"),this.addfunc(a,r,F),s++,o=8;else if(this.isVar()){0==(1&o)&&this.error_parsing(this.pos,"unexpected variable");var c=new e(j,this.tokenindex,0,0);a.push(c),o=186}else this.isWhite()||(""===this.errormsg?this.error_parsing(this.pos,"unknown character"):this.error_parsing(this.pos,this.errormsg))}for((this.tmpprio<0||this.tmpprio>=10)&&this.error_parsing(this.pos,'unmatched "()"');r.length>0;){var u=r.pop();a.push(u)}return s+1!==a.length&&this.error_parsing(this.pos,"parity"),new i(a,t(this.ops1),t(this.ops2),t(this.functions))},evaluate:function(t,e){return this.parse(t).evaluate(e)},error_parsing:function(t,e){throw this.success=!1,this.errormsg="parse error [column "+t+"]: "+e,this.column=t,new Error(this.errormsg)},addfunc:function(t,i,n){for(var r=new e(n,this.tokenindex,this.tokenprio+this.tmpprio,0);i.length>0&&r.prio_<=i[i.length-1].prio_;)t.push(i.pop());i.push(r)},isNumber:function(){for(var t=!1,e="";this.pos<this.expression.length;){var i=this.expression.charCodeAt(this.pos);if(!(i>=48&&i<=57||46===i))break;e+=this.expression.charAt(this.pos),this.pos++,this.tokennumber=parseFloat(e),t=!0}return t},unescape:function(t,e){for(var i=[],n=!1,r=0;r<t.length;r++){var a=t.charAt(r);if(n){switch(a){case"'":i.push("'");break;case"\\":i.push("\\");break;case"/":i.push("/");break;case"b":i.push("\b");break;case"f":i.push("\f");break;case"n":i.push("\n");break;case"r":i.push("\r");break;case"t":i.push("\t");break;case"u":var o=parseInt(t.substring(r+1,r+5),16);i.push(String.fromCharCode(o)),r+=4;break;default:throw this.error_parsing(e+r,"Illegal escape sequence: '\\"+a+"'")}n=!1}else"\\"==a?n=!0:i.push(a)}return i.join("")},isString:function(){var t=!1,e="",i=this.pos;if(this.pos<this.expression.length&&"'"==this.expression.charAt(this.pos))for(this.pos++;this.pos<this.expression.length;){var n=this.expression.charAt(this.pos);if("'"==n&&"\\"!=e.slice(-1)){this.pos++,this.tokennumber=this.unescape(e,i),t=!0;break}e+=this.expression.charAt(this.pos),this.pos++}return t},isConst:function(){var t;for(var e in this.consts){var i=e.length;if(t=this.expression.substr(this.pos,i),e===t)return this.tokennumber=this.consts[e],this.pos+=i,!0}return!1},isOperator:function(){var t=this.expression.charCodeAt(this.pos);if(43===t)this.tokenprio=2,this.tokenindex="+";else if(45===t)this.tokenprio=2,this.tokenindex="-";else if(62===t)61===this.expression.charCodeAt(this.pos+1)?(this.pos++,this.tokenprio=1,this.tokenindex=">="):(this.tokenprio=1,this.tokenindex=">");else if(60===t)61===this.expression.charCodeAt(this.pos+1)?(this.pos++,this.tokenprio=1,this.tokenindex="<="):(this.tokenprio=1,this.tokenindex="<");else if(124===t){if(124!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=1,this.tokenindex="||"}else if(61===t){if(61!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=1,this.tokenindex="=="}else if(33===t){if(61!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=1,this.tokenindex="!="}else if(97===t){if(110!==this.expression.charCodeAt(this.pos+1)||100!==this.expression.charCodeAt(this.pos+2))return!1;this.pos++,this.pos++,this.tokenprio=0,this.tokenindex="and"}else if(111===t){if(114!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=0,this.tokenindex="or"}else if(42===t||8729===t||8226===t)this.tokenprio=3,this.tokenindex="*";else if(47===t)this.tokenprio=4,this.tokenindex="/";else if(37===t)this.tokenprio=4,this.tokenindex="%";else{if(94!==t)return!1;this.tokenprio=5,this.tokenindex="^"}return this.pos++,!0},isSign:function(){var t=this.expression.charCodeAt(this.pos-1);return 45===t||43===t},isPositiveSign:function(){return 43===this.expression.charCodeAt(this.pos-1)},isNegativeSign:function(){return 45===this.expression.charCodeAt(this.pos-1)},isLeftParenth:function(){return 40===this.expression.charCodeAt(this.pos)&&(this.pos++,this.tmpprio+=10,!0)},isRightParenth:function(){return 41===this.expression.charCodeAt(this.pos)&&(this.pos++,this.tmpprio-=10,!0)},isComma:function(){return 44===this.expression.charCodeAt(this.pos)&&(this.pos++,this.tokenprio=-1,this.tokenindex=",",!0)},isWhite:function(){var t=this.expression.charCodeAt(this.pos);return(32===t||9===t||10===t||13===t)&&(this.pos++,!0)},isOp1:function(){for(var t="",e=this.pos;e<this.expression.length;e++){var i=this.expression.charAt(e);if(i.toUpperCase()===i.toLowerCase()&&(e===this.pos||"_"!=i&&(i<"0"||i>"9")))break;t+=i}return t.length>0&&t in this.ops1&&(this.tokenindex=t,this.tokenprio=5,this.pos+=t.length,!0)},isOp2:function(){for(var t="",e=this.pos;e<this.expression.length;e++){var i=this.expression.charAt(e);if(i.toUpperCase()===i.toLowerCase()&&(e===this.pos||"_"!=i&&(i<"0"||i>"9")))break;t+=i}return t.length>0&&t in this.ops2&&(this.tokenindex=t,this.tokenprio=5,this.pos+=t.length,!0)},isVar:function(){for(var t="",e=this.pos;e<this.expression.length;e++){var i=this.expression.charAt(e);if(i.toUpperCase()===i.toLowerCase()&&(e===this.pos||"_"!=i&&(i<"0"||i>"9")))break;t+=i}return t.length>0&&(this.tokenindex=t,this.tokenprio=4,this.pos+=t.length,!0)},isComment:function(){return 47===this.expression.charCodeAt(this.pos-1)&&42===this.expression.charCodeAt(this.pos)&&(this.pos=this.expression.indexOf("*/",this.pos)+2,1===this.pos&&(this.pos=this.expression.length),!0)}},L};return e.formatEquation=function(t){for(var e="",i=[],n="",r=!1,a=1;a<t.length;a++){var o=t[a].toUpperCase();"["!=o||r?"]"==o&&r?(r=!1,""!==n&&(i.push(n),e+="["+n+"]"),n=""):r?n+=o:"+"==o||"-"==o||"*"==o||"/"==o||":"==o||"%"==o||"("==o||")"==o?(""!==n&&isNaN(n)?(i.push(n),e+="["+n+"]"):e+=n,":"==o&&(o="/"),e+=o,n=""):" "!=o&&(n+=o):r=!0}return""!==n&&isNaN(n)?(i.push(n),e+="["+n+"]"):e+=n,{equation:e,symbols:i}},e.fetchEquationChart=function(t,i){var n=e.formatEquation(t.symbol),r=n.symbols,a=[],o=t.stx;t.stx=null;for(var s=0;s<r.length;s++){var l=e.shallowClone(t);l.stx=o,l.symbol=r[s],a.push(l)}t.stx=o,o.quoteDriver.quoteFeed.multiFetch(a,function(r){var o={};t.loadMoreReplace=!0;for(var s={charge:0},l=0;l<r.length;l++){var h=r[l];if(h.dataCallback.error)return void i({error:h.dataCallback.error});o[h.params.symbol]=h.dataCallback.quotes,t.loadMoreReplace=t.loadMoreReplace&&h.params.loadMoreReplace,t.moreToLoad=t.moreToLoad||h.dataCallback.moreAvailable,h.dataCallback.attribution.charge&&(s.charge+=h.dataCallback.attribution.charge)}if(a.length||!t.loadMore&&!t.update)try{var c=e.computeEquationChart(n.equation,o);i({quotes:c,moreAvailable:t.moreToLoad,attribution:s})}catch(t){var u={error:"Invalid equation: "+n.equation};t.name&&"NoException"==t.name&&(u.suppressAlert=!0),i(u)}})},e.computeEquationChart=function(t,n){function r(t){if(t.i++,n[t.s]){if(t.i>=n[t.s].length)return 0;l=n[t.s][t.i]}return l.DT||(l.DT=e.strToDateTime(l.Date)),t.d=l.DT,1}t=t.replace(/[:]/,"/").toUpperCase();var a=0;for(var o in n){var s=new RegExp("\\["+o.replace("$","\\$").replace("^","\\^").replace(/[+\-*\/%()]/g,"\\$&")+"\\]","g");t=t.replace(s,"symbol"+a),a++}var l,h=i().parse(t),c=[],u={},p=0,d=null,f=!1,m=[];for(o in n){var g={sym:o,map:n[o]};n[o]?m.unshift(g):m.push(g)}for(var v=0;v<m.length;v++){var y=m[v];u[y.sym]={i:0,s:y.sym},y.map?(p++,l=y.map[0]):1==p&&(f=y.sym),l.DT||(l.DT=e.strToDateTime(l.Date)),u[y.sym].d=l.DT,d||(d=u[y.sym])}var b=0===p,x=1==p&&-1==t.indexOf("%");t:for(;;){var w=function(){var t=null,e=null;for(var i in u)e?u[i].d.getTime()<e.d.getTime()?t=e=u[i]:u[i].d.getTime()>e.d.getTime()&&(t=e):e=u[i];return t?r(t)?-1:0:1}();if(!w)break;if(1==w){var C;if(f){var S=h.evaluate({symbol0:n[d.s][d.i].Close,symbol1:n[d.s][d.i][f]});S=Number(S.toFixed(8)),C={DT:d.d,Close:S,Adj_Close:S},C[d.s]=n[d.s][d.i].Close,isNaN(S)||S==1/0||c.push(C)}else{if(b){var T=h.evaluate({});throw e.alert(t+"="+T),{name:"NoException",message:""}}a=0;var _={Adj_Close:{},Close:{},Open:{},High:{},Low:{},Volume:{}};for(o in n){for(var k in _)_[k]["symbol"+a]=n[o][u[o].i][k];a++}C={DT:d.d},C.Adj_Close=h.evaluate(_.Adj_Close),C.Close=h.evaluate(_.Close),C.Open=h.evaluate(_.Open),C.Volume=h.evaluate(_.Volume),isNaN(C.Volume)&&(C.Volume=0),x?(C.High=h.evaluate(_.High),C.Low=h.evaluate(_.Low)):(C.High=Math.max(C.Open,C.Close),C.Low=Math.min(C.Open,C.Close)),isNaN(C.Close)||C.Close==1/0||c.push(C),isNaN(C.High)||(C.High=Number(C.High.toFixed(8))),isNaN(C.Low)||(C.Low=Number(C.Low.toFixed(8))),isNaN(C.Open)||(C.Open=Number(C.Open.toFixed(8))),isNaN(C.Close)||(C.Close=Number(C.Close.toFixed(8))),isNaN(C.Adj_Close)?C.Adj_Close=C.Close:C.Adj_Close=Number(C.Adj_Close.toFixed(8))}for(o in n)if(!r(u[o]))break t}}return c},t},__renderersAdvanced_=function(t){var e=t.CIQ;return e.Renderer.Shading=function(t){this.construct(t),this.shading=null,this.errTimeout=null},e.Renderer.Shading.ciqInheritsFrom(e.Renderer.Lines,!1),e.Renderer.Shading.prototype.setShading=function(t){t.constructor!=Array&&(t=[t]),this.shading=t},e.Renderer.Shading.prototype.draw=function(){if(!this.shading&&!this.errTimeout){console.log("Warning: no shading scheme set.  Use myRenderer.setShading(scheme) to set.");var t=this;this.errTimeout=setTimeout(function(){t.errTimeout=null},1e4)}var i,n=this.stx.panels[this.params.panel].chart,r={};for(i=0;i<this.seriesParams.length;i++)if(n.series[this.seriesParams[i].field]){var a=e.clone(n.series[this.seriesParams[i].field].parameters);r[this.seriesParams[i].field]={parameters:e.extend(e.extend(a,this.params),this.seriesParams[i]),yValueCache:this.caches[this.seriesParams[i].field],useChartLegend:!1}}this.stx.drawSeries(n,r,this.params.yAxis);for(i in r)this.caches[i]=r[i].yValueCache;for(i=0;i<this.shading.length;i++){var o=this.shading[i];if(o.greater||(o.greater=o.color),o.lesser||(o.lesser=o.color),o.primary||(o.primary="Close"),o.secondary||(o.secondary=this.seriesParams[0].field),o.secondary&&o.greater&&o.lesser&&(r[o.primary]||"Close"==o.primary)&&r[o.secondary]&&("Close"!=o.primary||this.params.yAxis==n.yAxis)){var s={topBand:o.primary,topColor:o.greater,topAxis:this.params.yAxis,bottomBand:o.secondary,bottomColor:o.lesser,bottomAxis:"Close"==o.primary?null:this.params.yAxis};e.fillIntersecting(this.stx,this.params.panel,s)}}},e.Renderer.Histogram=function(t){this.construct(t),this.params.type="histogram",this.params.highlightable=!1},e.Renderer.Histogram.ciqInheritsFrom(e.Renderer,!1),e.Renderer.Histogram.prototype.performCalculations=function(t){if(this.params.yAxis){for(var e=this.stx.panels[this.params.panel],i=[],n=0;n<this.seriesParams.length;n++)i.push(this.seriesParams[n].field);var r=this.stx.determineMinMax(this.stx.chart.dataSegment,i,"stacked"==this.params.subtype,!0);t&&t.length&&(r[0]=Math.min(t[0],r[0]),r[1]=Math.max(t[1],r[1])),this.stx.calculateYAxisRange(e,this.params.yAxis,0,r[1]);var a=this.params.heightPercentage?this.params.heightPercentage:1;this.params.yAxis.high=r[1]/a,this.params.yAxis.min=0,this.params.bindToYAxis=!0}},e.Renderer.Histogram.prototype.draw=function(){this.stx.drawHistogram(e.clone(this.params),this.seriesParams)},e.Renderer.Heatmap=function(t){this.construct(t),this.params.type="heatmap",this.params.highlightable=!1},e.Renderer.Heatmap.ciqInheritsFrom(e.Renderer,!1),e.Renderer.Heatmap.prototype.performCalculations=function(t){for(var e=this.stx.panels[this.params.panel],i=this.params.yAxis?this.params.yAxis:e.yAxis,n=[],r=0;r<this.seriesParams.length;r++)n.push(this.seriesParams[r].field);var a=this.stx.determineMinMax(this.stx.chart.dataSegment,n,!1,!0);t&&t.length&&(a[0]=Math.min(t[0],a[0]),a[1]=Math.max(t[1],a[1])),this.params.yAxis?this.stx.calculateYAxisRange(e,i,a[0],a[1]):this.params.panel==this.stx.chart.panel.name?(this.stx.chart.lowValue=Math.min(this.stx.chart.lowValue,a[0]),this.stx.chart.highValue=Math.max(this.stx.chart.highValue,a[1])):(this.stx.calculateYAxisRange(e,i,a[0],a[1]),e.lowValue=e.yAxis.low,e.highValue=e.yAxis.high)},e.Renderer.Heatmap.prototype.draw=function(){this.stx.drawHeatmap(e.clone(this.params),this.seriesParams)},t},__share_=function(t){function e(t,e,i){e||(e={});var n=document.querySelector("body");if(e.hide&&e.hide instanceof Array)for(var o=e.hide.join(", "),s=document.querySelectorAll(o),l=0;l<s.length;l++)a.appendClassName(s[l],"ciq-no-share");a.appendClassName(n,"sharing"),r(t.chart.container,{allowTaint:!1,logging:!1,width:e.width?e.width:null,height:e.height?e.height:null,background:e.background?e.background:null,useCORS:!0}).then(function(t){if(i)return a.unappendClassName(n,"sharing"),e.data?i(null,t.toDataURL("image/png")):i(null,t)})}function i(t){if("undefined"!=typeof html2canvas)return r=html2canvas,t();if("undefined"!=typeof requirejs)try{return requirejs(["html2canvas"],function(e){return r=e,t()})}catch(t){console.warn("Require loading has failed, attempting to load html2canvas manually.")}a.loadScript(n()+"/html2canvas.js",function(){return r=html2canvas,t()})}function n(){if(a.Share.html2canvasLocation)return a.Share.html2canvasLocation;for(var t=document.getElementsByTagName("script"),e=0;e<t.length;e++){var i=t[e];if(i.src&&i.src.indexOf("share.js")>-1)return i.src.replace(/advanced\/share\.js/,"")+"thirdparty/"}return"js/thirdparty/"}var r,a=t.CIQ;return a.Share=function(){},t.STXSocial=a.Share,a.Share.FullChart2PNG=function(t,n,a){if(t&&t.chart){if("undefined"==typeof html2canvas)return i(function(){return e(t,n,a)});r=html2canvas,e(t,n,a)}},a.Share.createImage=function(t,e,i){var n=[].slice.call(arguments);i=n.pop(),null!==e&&"object"==(void 0===e?"undefined":_typeof(e))||(e={widthPX:n[1],heightPX:n[2],imageType:n[3]});var r=e.widthPX,o=e.heightPX,s=e.imageType,l=t.chart.canvas.height,h=t.chart.canvas.width;t.chart.canvas.style.height&&(l=a.stripPX(t.chart.canvas.style.height),h=a.stripPX(t.chart.canvas.style.width)),r&&o?(l=o,h=r):o?h=t.chart.canvas.width*(l/t.chart.canvas.height):r&&(h=r,l=t.chart.canvas.height*(r/t.chart.canvas.width));var c=s?"image/"+s:"image/png",u=document.createElement("img");u.onload=function(){a.Share.FullChart2PNG(t,{image:this,width:h,height:l,hide:e.hide},function(t,e){try{i(e.toDataURL(c))}catch(t){console.warn("Safari devices do not handle CORS enabled images. Using the charts' canvas as a fallback."),i(u.src)}})},u.src=t.chart.canvas.toDataURL(c)},a.Share.uploadImage=function(t,e,i,n){i||(i={}),i.image=t,a.postAjax(e,JSON.stringify(i),function(t,e){if(200!=t)return void n(t,null);n(null,e)})||n(0,null)},a.Share.shareChart=function(t,e,i){a.Share.createImage(t,{},function(n){var r=a.uniqueID(),o="https://share.chartiq.com",s=o+"/upload/"+r;e&&(e.host&&(o=e.host),e.path&&(s=o+e.path+"/"+r));var l=t.getStartDateOffset(),h={layout:t.exportLayout(),drawings:t.exportDrawings(),xOffset:l,startDate:t.chart.dataSegment[l].Date,endDate:t.chart.dataSegment[t.chart.dataSegment.length-1].Date,id:r,symbol:t.chart.symbol},c={id:r,image:n,config:h};a.Share.uploadImage(n,s,c,function(t,e){null!==t?a.alert("error sharing chart: ",t):i(o+e)})})},t},__studiesAdvanced_=function(t){var e=t.CIQ;return e.Studies.calculateValuationLines=function(t,e,i){for(var n="field"==e.inputs.Field?"Close":e.inputs.Field,r=e.inputs["Average Type"],a=e.inputs["Display Average"],o=e.inputs["Display 1 Standard Deviation (1σ)"],s=e.inputs["Display 2 Standard Deviation (2σ)"],l=e.inputs["Display 3 Standard Deviation (3σ)"],h=[],c=0;c<i.length;++c)i[c]&&h.push(i[c][n]);var u=function(t,e){var i=t.length,n=0,r=0,a=0;switch(e){case"mean":for(r=i;a<i;++a)n+=t[a];break;case"harmonic":for(n=i;a<i;++a)r+=1/t[a];break;case"median":var o=Math.floor(i/2),s=t.slice().sort(function(t,e){return t>e?1:t<e?-1:0});i%1==0?(n=s[o]+s[o-1],r=2):(n=s[o],r=1)}return n/r}(h,r),p=!(o||s||l)||function(t,e){for(var i=t.length,n=0,r=0;r<i;++r)n+=Math.pow(t[r]-e,2);return Math.sqrt(n/i)}(h,u);e.data={Average:a?[u]:null,"1 Standard Deviation (1σ)":o?[u+p,u-p]:null,"2 Standard Deviation (2σ)":s?[u+2*p,u-2*p]:null,"3 Standard Deviation (3σ)":l?[u+3*p,u-3*p]:null}},e.Studies.displayValuationLines=function(t,i){var n,r,a,o,s,l,h,c,u,p=t.panels[i.panel],d=i.chart.context,f=i.data,m=i.parameters.labels,g=i.inputs["Average Type"],v={mean:"AVG",median:"MED",harmonic:"HAVG"},y=t.canvasStyle("ciq-valuation-average-line"),b=t.canvasStyle("ciq-valuation-deviation-line"),x=t.getCanvasFontSize("stx_yaxis")+6;for(var w in f)if(f[w])for(n="Average"==w,r=e.Studies.determineColor(i.outputs[w]),a=f[w],o=0;o<a.length;++o)s=a[o],(l=t.pixelFromTransformedValue(s,p))<=p.top||l>=p.yAxis.bottom||(u=n?{pattern:"none"!=y.borderStyle?y.borderStyle||"solid":"solid",lineWidth:parseFloat(y.borderWidth)||1,opacity:parseFloat(y.opacity)||1}:{pattern:"none"!=b.borderStyle?b.borderStyle||"dashed":"dashed",lineWidth:parseFloat(b.borderWidth)||1,opacity:parseFloat(b.opacity)||1},t.plotLine(p.left,p.right,l,l,r,"line",d,p,u),"yaxis"!==m?(l+=Math.floor(u.lineWidth/2))+x>=p.yAxis.bottom||(h=(n?v[g]+": ":w[0]+"σ: ")+t.formatYAxisPrice(s,p),c=d.measureText(h).width,d.strokeText(h,p.right-c-3,l+x/2+.5)):t.createYAxisLabel(p,t.formatYAxisPrice(s,p),l,r,null,d))},e.Studies.calculateCorrelationCoefficient=function(t,e){var i=e.chart.scrubbed,n=e.days;if(i.length<n+1)return void(e.error=!0);if(e.compare=e.inputs["Compare To"],!e.compare){e.compare=[],e.outputs={},e.outputMap={};for(var r in t.chart.series){var a=t.chart.series[r];a.parameters.color&&(e.compare.push(a.display),e.outputs["Result "+a.display]=a.parameters.color,e.outputMap["Result "+a.display+" "+e.name]="Result "+a.display)}}if(!e.compare.length)return void(e.error="Correlation Coefficient requires at least one comparison symbol");for(var o=0;o<e.compare.length;o++)for(var s=0,l=0,h=0,c=0,u=0,p=e.compare[o],d=0,f=e.startFrom-n;f<i.length;f++)if(i[f]){var m=i[f][p];if(m||(m=f>0&&i[f-1]&&i[f-1]["_temps "+e.name].c?i[f-1]["_temps "+e.name].c:0),i[f]["_temps "+e.name]={},s+=i[f]["_temps "+e.name].b=i[f].Close,l+=i[f]["_temps "+e.name].c=m,h+=i[f]["_temps "+e.name].b2=Math.pow(i[f].Close,2),c+=i[f]["_temps "+e.name].c2=Math.pow(m,2),u+=i[f]["_temps "+e.name].bc=i[f].Close*m,d>=n){s-=i[f-n]["_temps "+e.name].b,l-=i[f-n]["_temps "+e.name].c,h-=i[f-n]["_temps "+e.name].b2,c-=i[f-n]["_temps "+e.name].c2,u-=i[f-n]["_temps "+e.name].bc;var g=h/n-Math.pow(s/n,2),v=c/n-Math.pow(l/n,2),y=u/n-s*l/Math.pow(n,2),b=y/Math.sqrt(g*v);i[f]["Result "+p+" "+e.name]=b}d++}},e.Studies.prettify=e.extend({"2-exponential":"dema","3-exponential":"tema",hull:"hma"},e.Studies.prettify),e.extend(e.Studies.movingAverage,{conversions:{hma:"hull",dema:"2-exponential",tema:"3-exponential"},translations:{hull:"Hull","2-exponential":"Double Exponential","3-exponential":"Triple Exponential"},typeMap:{hma:"Hull",hull:"Hull",dema:"DoubleExponential","2-exponential":"DoubleExponential",tema:"TripleExponential","3-exponential":"TripleExponential"}}),e.Studies.calculateMovingAverageHull=function(t,i){var n=i.chart.scrubbed,r=i.inputs.Field;r&&"field"!=r||(r="Close"),e.Studies.MA("wma",i.days,r,0,"_WMA1",t,i),e.Studies.MA("wma",Math.ceil(i.days/2),r,0,"_WMA2",t,i);var a,o;for(a=i.startFrom-1;a>=0&&(!(o=n[a][r])&&0!==o);a--);for(a++;a<n.length;a++){var s=n[a];s["_MMA "+i.name]=2*s["_WMA2 "+i.name]-s["_WMA1 "+i.name]}var l=parseInt(i.inputs.Offset,10);isNaN(l)&&(l=0);var h=Math.floor(Math.sqrt(i.days));e.Studies.MA("wma",h,"_MMA "+i.name,l,"_HMA",t,i);var c=i.name;for(var u in i.outputs)c=u+" "+c;for(a=Math.max(i.days+h-1,i.startFrom);a<n.length;a++)n[a][c]=n[a]["_HMA "+i.name]},e.Studies.calculateMovingAverageDoubleExponential=function(t,i){var n=i.chart.scrubbed,r=i.inputs.Field;r&&"field"!=r||(r="Close"),e.Studies.MA("ema",i.days,r,0,"_EMA1",t,i),e.Studies.MA("ema",i.days,"_EMA1 "+i.name,0,"_EMA2",t,i);var a=parseInt(i.inputs.Offset,10);isNaN(a)&&(a=0);var o,s,l=a;for(o=i.startFrom-1;o>=0;o--)if((s=n[o][r])||0===s){if(!(l>0))break;l--}var h=i.name;for(var c in i.outputs)h=c+" "+h;for(o++;o<n.length;o++)if(!(o<2*(i.days-1))){var u=n[o];n[o+a]&&(n[o+a][h]=2*u["_EMA1 "+i.name]-u["_EMA2 "+i.name])}},e.Studies.calculateMovingAverageTripleExponential=function(t,i){var n=i.chart.scrubbed,r=i.inputs.Field;r&&"field"!=r||(r="Close"),e.Studies.MA("ema",i.days,r,0,"_EMA1",t,i),e.Studies.MA("ema",i.days,"_EMA1 "+i.name,0,"_EMA2",t,i),e.Studies.MA("ema",i.days,"_EMA2 "+i.name,0,"_EMA3",t,i);var a=parseInt(i.inputs.Offset,10);isNaN(a)&&(a=0);var o,s,l=a;for(o=i.startFrom-1;o>=0;o--)if((s=n[o][r])||0===s){if(!(l>0))break;l--}var h=i.name;for(var c in i.outputs)h=c+" "+h;for(o++;o<n.length;o++)if(!(o<3*(i.days-1))){var u=n[o];n[o+a]&&(n[o+a][h]=3*u["_EMA1 "+i.name]-3*u["_EMA2 "+i.name]+u["_EMA3 "+i.name])}},e.Studies.calculateATRBands=function(t,i){e.Studies.calculateStudyATR(t,i);var n=i.inputs.Field;n&&"field"!=n||(n="Close"),e.Studies.calculateGenericEnvelope(t,i,i.inputs.Shift,n,"ATR "+i.name)},e.Studies.calculateSTARCBands=function(t,i){e.Studies.calculateStudyATR(t,i),e.Studies.MA("simple",i.inputs["MA Period"],"Close",0,"_MA",t,i),e.Studies.calculateGenericEnvelope(t,i,i.inputs.Multiplier,"_MA "+i.name,"ATR "+i.name)},e.Studies.calculateATRStops=function(t,i){var n=i.chart.scrubbed;if(n){e.Studies.calculateStudyATR(t,i);for(var r=i.inputs.HighLow,a=Math.max(i.startFrom-1,1);a<n.length-1;a++){var o=n[a],s=n[a-1],l=o["Buy Stops "+i.name];if(l||(l=o["Sell Stops "+i.name]),l||(l=0),o&&s){var h=o.Close,c=h,u=o["ATR "+i.name]*i.inputs.Multiplier;o.Close>l&&s.Close>l?(r&&(h=o.High),c=Math.max(l,h-u)):o.Close<=l&&s.Close<=l?(r&&(h=o.Low),c=Math.min(l,h+u)):o.Close>l?(r&&(h=o.High),c=h-u):o.Close<=l&&(r&&(h=o.Low),c=h+u),h<=c?(n[a+1]["Buy Stops "+i.name]=c,delete n[a+1]["Sell Stops "+i.name]):h>c&&(n[a+1]["Sell Stops "+i.name]=c,delete n[a+1]["Buy Stops "+i.name]),n[a+1]["All Stops "+i.name]=c,i.referenceOutput="All Stops"}}}},e.Studies.calculateAwesomeOscillator=function(t,i){var n=i.chart.scrubbed;if(n.length<33)return void(i.error=!0);e.Studies.MA("simple",5,"hl/2",0,"_MA5",t,i),e.Studies.MA("simple",34,"hl/2",0,"_MA34",t,i);for(var r=Math.max(i.startFrom,33);r<n.length;r++)n[r]&&(n[r][i.name+"_hist"]=n[r]["_MA5 "+i.name]-n[r]["_MA34 "+i.name])},e.Studies.calculateRelativeVolatility=function(t,i){i.days=Number(i.inputs["Smoothing Period"]);var n=Number(i.inputs["STD Period"]),r=i.chart.scrubbed;if(r.length<i.days+n)return void(i.error=!0);var a=i.inputs.Field;a&&"field"!=a||(a="Close"),i.std=new e.Studies.StudyDescriptor(i.name,"sdev",i.panel),i.std.chart=i.chart,i.std.days=n,i.std.startFrom=i.startFrom,i.std.inputs={Field:a,"Standard Deviations":1,Type:"ma"},i.std.outputs={STD:null},e.Studies.calculateStandardDeviation(t,i.std);var o=0,s=0;i.startFrom>1&&(o=r[i.startFrom-1]["_avgG "+i.name],s=r[i.startFrom-1]["_avgL "+i.name]);for(var l=Math.max(i.startFrom,i.days);l<r.length;l++){var h=r[l];h[a]>r[l-1][a]?(o=(o*(i.days-1)+h["STD "+i.name])/i.days,s=s*(i.days-1)/i.days):(s=(s*(i.days-1)+h["STD "+i.name])/i.days,o=o*(i.days-1)/i.days),h["Rel Vol "+i.name]=function(t,e){return t+e===0?100:100*t/(t+e)}(o,s),h["_avgG "+i.name]=o,h["_avgL "+i.name]=s}i.zoneOutput="Rel Vol"},e.Studies.calculatePMO=function(t,i){var n={Smooth:Number(i.inputs["Smoothing Period"])-1,Double:Number(i.inputs["Double Smoothing Period"])-1,Signal:Number(i.inputs["Signal Period"])},r=i.chart.scrubbed;if(r.length<n.Smooth+n.Double)return void(i.error=!0);var a=i.inputs.Field;a&&"field"!=a||(a="Close");var o;for(o=i.startFrom;o<r.length;o++)if(r[o]&&r[o-1]){var s=r[o-1][a];s&&(r[o]["_ROCx10 "+i.name]=1e3*(r[o][a]/s-1))}e.Studies.MA("exponential",n.Smooth,"_ROCx10 "+i.name,0,"_EMAx10",t,i),e.Studies.MA("exponential",n.Double,"_EMAx10 "+i.name,0,"PMO",t,i),e.Studies.MA("exponential",n.Signal,"PMO "+i.name,0,"PMOSignal",t,i),i.zoneOutput="PMO"},e.Studies.calculateElderImpulse=function(t,i){var n=i.chart.scrubbed,r=i.outputs.Bullish,a=i.outputs.Bearish,o=i.outputs.Neutral;e.Studies.MA("exponential",13,"Close",0,"_MA",t,i),i.macd=new e.Studies.StudyDescriptor("_"+i.name,"macd",i.panel),i.macd.chart=i.chart,i.macd.days=i.days,i.macd.startFrom=i.startFrom,i.macd.inputs={"Fast MA Period":12,"Slow MA Period":26,"Signal Period":9},i.macd.outputs={_MACD:null,_Signal:null},e.Studies.calculateMACD(t,i.macd);for(var s,l=i.startFrom;l<n.length;l++)s=0===l?o:n[l]["_MA "+i.name]>n[l-1]["_MA "+i.name]&&n[l]["_"+i.name+"_hist"]>n[l-1]["_"+i.name+"_hist"]?r:n[l]["_MA "+i.name]<n[l-1]["_MA "+i.name]&&n[l]["_"+i.name+"_hist"]<n[l-1]["_"+i.name+"_hist"]?a:o,n[l]["Result "+i.name]=s},e.Studies.calculatePivotPoints=function(t,i){function n(){c.pivotPoint=(c.high+c.low+r[u-1].Close)/3,c.prevHigh=c.high,c.prevLow=c.low,c.hlSpread=c.high-c.low,c.high=c.low=0}var r=i.chart.scrubbed,a="day";if("day"==t.layout.interval)a="month";else if(e.ChartEngine.isDailyInterval(t.layout.interval))a="year";else if("second"==t.layout.interval||"millisecond"==t.layout.interval||"second"==t.layout.timeUnit||"millisecond"==t.layout.timeUnit)a="15min";else{var o=t.layout.periodicity;"minute"!=t.layout.interval&&(o*=t.layout.interval),o>=30&&(a="week")}var s=e.Market.Symbology.isForexSymbol(t.chart.symbol),l=e.Market.Symbology.isForexMetal(t.chart.symbol),h=null,c={pivotPoint:NaN,high:0,low:0,prevHigh:0,prevLow:0,hlSpread:0};i.startFrom>1&&(c=e.clone(r[i.startFrom-1]["_pointers "+i.name]));for(var u=Math.max(1,i.startFrom);u<r.length;u++)if(r[u-1]){if(c.high=Math.max(c.high,r[u-1].High),c.low=Math.min(c.low>0?c.low:r[u-1].Low,r[u-1].Low),i.inputs.Continuous)n();else if("year"==a&&r[u].DT.getYear()!=r[u-1].DT.getYear())n();else if("month"==a&&r[u].DT.getMonth()!=r[u-1].DT.getMonth())n();else if("week"==a&&r[u].DT.getDay()<r[u-1].DT.getDay())n();else if("day"==a){null===h&&(h=function(i){var n="America/New_York";if(!s)if(t.chart.market)n=t.chart.market.market_tz;else{var r=e.Market.Symbology.isForeignSymbol(t.chart.symbol)&&t.chart.symbol.split(".").pop();n=e&&e.realTimeDataSource?(new e.QuoteFeed[e.realTimeDataSource]).exchangeZones[r]:e.QuoteFeed.Xignite.Utility.timeZone[r]}var a=new Date(i.getTime()+6e4*i.getTimezoneOffset());return n&&-1!=n.indexOf("UTC")||(a=e.convertTimeZone(a,"UTC",n)),new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()).getTime()-i.getTime()}(r[u].DT),s&&(h+=l?216e5:252e5));var p=new Date(new Date(+r[u].DT).setMilliseconds(r[u].DT.getMilliseconds()+h)),d=new Date(new Date(+r[u-1].DT).setMilliseconds(r[u-1].DT.getMilliseconds()+h));d.getDate()!=p.getDate()&&0!==p.getDay()&&6!=p.getDay()&&(h=null,n())}else"15min"!=a||r[u].DT.getHours()==r[u-1].DT.getHours()&&Math.floor(r[u].DT.getMinutes()/15)==Math.floor(r[u-1].DT.getMinutes()/15)||n();r[u]["Pivot "+i.name]=c.pivotPoint,"fibonacci"==i.inputs.Type.toLowerCase()?(r[u]["Resistance 1 "+i.name]=c.pivotPoint+.382*c.hlSpread,r[u]["Resistance 2 "+i.name]=c.pivotPoint+.618*c.hlSpread,r[u]["Resistance 3 "+i.name]=c.pivotPoint+c.hlSpread,r[u]["Support 1 "+i.name]=c.pivotPoint-.382*c.hlSpread,r[u]["Support 2 "+i.name]=c.pivotPoint-.618*c.hlSpread,r[u]["Support 3 "+i.name]=c.pivotPoint-c.hlSpread):(r[u]["Resistance 1 "+i.name]=2*c.pivotPoint-c.prevLow,r[u]["Resistance 2 "+i.name]=c.pivotPoint+c.hlSpread,r[u]["Resistance 3 "+i.name]=c.pivotPoint+2*c.hlSpread,r[u]["Support 1 "+i.name]=2*c.pivotPoint-c.prevHigh,r[u]["Support 2 "+i.name]=c.pivotPoint-c.hlSpread,r[u]["Support 3 "+i.name]=c.pivotPoint-2*c.hlSpread),r[u]["_pointers "+i.name]=e.clone(c)}},e.Studies.calculateVWAP=function(t,i){var n=i.chart.scrubbed;if(e.ChartEngine.isDailyInterval(t.layout.interval))return void(i.error="VWAP is Intraday Only");var r=e.Market.Symbology.isForexSymbol(t.chart.symbol),a=e.Market.Symbology.isForexMetal(t.chart.symbol),o=null,s=0,l=0,h=!1;i.startFrom>1&&(s=n[i.startFrom-1]["_V "+i.name],l=n[i.startFrom-1]["_VxP "+i.name]);for(var c=i.startFrom;c<n.length;c++){if(null===o&&(o=function(i){var n="America/New_York";if(!r)if(t.chart.market)n=t.chart.market.market_tz;else{var a=e.Market.Symbology.isForeignSymbol(t.chart.symbol)&&t.chart.symbol.split(".").pop();n=e&&e.realTimeDataSource?(new e.QuoteFeed[e.realTimeDataSource]).exchangeZones[a]:e.QuoteFeed.Xignite.Utility.timeZone[a]}var o=new Date(i.getTime()+6e4*i.getTimezoneOffset());return n&&-1!=n.indexOf("UTC")||(o=e.convertTimeZone(o,"UTC",n)),new Date(o.getFullYear(),o.getMonth(),o.getDate(),o.getHours(),o.getMinutes(),o.getSeconds(),o.getMilliseconds()).getTime()-i.getTime()}(n[c].DT),r&&(o+=a?216e5:252e5)),n[c-1]&&n[c-1].DT){var u=new Date(new Date(+n[c].DT).setMilliseconds(n[c].DT.getMilliseconds()+o));new Date(new Date(+n[c-1].DT).setMilliseconds(n[c-1].DT.getMilliseconds()+o)).getDate()!=u.getDate()&&0!==u.getDay()&&6!=u.getDay()&&(o=null,s=l=0)}var p=n[c]["hlc/3"];s+=n[c].Volume,l+=n[c].Volume*p,s&&(n[c]["VWAP "+i.name]=l/s,n[c]["_V "+i.name]=s,n[c]["_VxP "+i.name]=l,h=!0)}h||(i.error="VWAP Requires Volume")},e.Studies.calculateMFI=function(t,e){var i,n=e.chart.scrubbed,r=0,a=e.inputs["Scale Factor"];a||(a=e.study.inputs["Scale Factor"]);var o=Math.pow(10,Number(a));e.startFrom>1&&(r=n[e.startFrom-1]["_high "+e.name]);var s;for(s=e.startFrom;s<n.length;s++)n[s]&&n[s].Volume&&(n[s][e.name+"_hist"]=i=o*(n[s].High-n[s].Low)/n[s].Volume,n[s]["_high "+e.name]=r=Math.max(r,i))},e.Studies.calculateAlligator=function(t,i){var n={J:Number(i.inputs["Jaw Period"]),T:Number(i.inputs["Teeth Period"]),L:Number(i.inputs["Lips Period"])},r=i.chart.scrubbed;if(r.length<Math.max(n.J,n.T,n.L)+1)return void(i.error=!0);e.Studies.MA("welles wilder",n.J,"hl/2",i.inputs["Jaw Offset"],"Jaw",t,i),e.Studies.MA("welles wilder",n.T,"hl/2",i.inputs["Teeth Offset"],"Teeth",t,i),e.Studies.MA("welles wilder",n.L,"hl/2",i.inputs["Lips Offset"],"Lips",t,i);for(var a=i.startFrom;a<r.length;a++)if(r[a]&&("Gator"==i.type&&(r[a][i.name+"_hist1"]=Math.abs(r[a]["Jaw "+i.name]-r[a]["Teeth "+i.name]),r[a][i.name+"_hist2"]=-Math.abs(r[a]["Teeth "+i.name]-r[a]["Lips "+i.name])),i.inputs["Show Fractals"])){if(!(r[a-2]&&r[a-1]&&r[a]&&r[a+1]&&r[a+2]))continue;r[a-2].High&&r[a-1].High&&r[a].High&&r[a+1].High&&r[a+2].High&&r[a].High>r[a-1].High&&r[a].High>r[a-2].High&&r[a].High>r[a+1].High&&r[a].High>r[a+2].High&&(r[a]["Fractal High "+i.name]=1),r[a-2].Low&&r[a-1].Low&&r[a].Low&&r[a+1].Low&&r[a+2].Low&&r[a].Low<r[a-1].Low&&r[a].Low<r[a-2].Low&&r[a].Low<r[a+1].Low&&r[a].Low<r[a+2].Low&&(r[a]["Fractal Low "+i.name]=1)}},e.Studies.calculateRelativeVigor=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days+1)return void(i.error=!0);var r;for(r=i.startFrom;r<n.length;r++)n[r]["_Change "+i.name]=n[r].Close-n[r].Open,n[r]["_Range "+i.name]=n[r].High-n[r].Low;e.Studies.MA("triangular",4,"_Change "+i.name,0,"_Numer",t,i),e.Studies.MA("triangular",4,"_Range "+i.name,0,"_Denom",t,i);var a=[],o=[];for(r=Math.max(i.startFrom-i.days,0);r<n.length;r++){a.push(n[r]["_Numer "+i.name]),o.push(n[r]["_Denom "+i.name]),a.length>i.days&&(a.shift(),o.shift());var s,l=0,h=0;for(s=0;s<a.length;s++)l+=a[s];for(s=0;s<o.length;s++)h+=o[s];0===h&&(h=1e-8),r<i.startFrom||(n[r]["Rel Vig "+i.name]=l/h)}for(e.Studies.MA("triangular",4,"Rel Vig "+i.name,0,"RelVigSignal",t,i),r=i.startFrom;r<n.length;r++)n[r][i.name+"_hist"]=n[r]["Rel Vig "+i.name]-n[r]["RelVigSignal "+i.name]},e.Studies.calculateUlcerIndex=function(t,i){var n=i.chart.scrubbed;if(n.length<2*i.days-1)return void(i.error=!0);var r=i.inputs.Field;r&&"field"!=r||(r="Close");var a;for(a=Math.max(i.startFrom,i.days-1);a<n.length;a++)n[a]["_PD2 "+i.name]=Math.pow(100*(n[a][r]/function(t,e,i){for(var r=null,a=e-t+1;a<=e;a++)a<0||(r=null===r?n[a][i]:Math.max(r,n[a][i]));return r}(i.days,a,r)-1),2);for(e.Studies.MA("simple",i.days,"_PD2 "+i.name,0,"_MA",t,i),a=Math.max(i.startFrom,2*(i.days-1));a<n.length;a++)n[a]["Result "+i.name]=Math.sqrt(n[a]["_MA "+i.name])},e.Studies.calculateChoppiness=function(t,i){e.Studies.calculateStudyATR(t,i);var n=i.chart.scrubbed;if(n.length<i.days+1)return void(i.error=!0);for(var r=Math.max(i.startFrom,i.days);r<n.length;r++)if(n[r]){var a=function(t,e){for(var i=-1*Number.MAX_VALUE,r=Number.MAX_VALUE,a=e-t+1;a<=e;a++)a<0||(i=Math.max(i,n[a].High),r=Math.min(r,n[a].Low));return[r,i]}(i.days,r);n[r]["Sum True Range "+i.name]?n[r]["Result "+i.name]=100*Math.log(n[r]["Sum True Range "+i.name]/Math.max(1e-6,a[1]-a[0]))/Math.log(i.days):n[r]["Result "+i.name]=0}},e.Studies.calculateDisparity=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days+1)return void(i.error=!0);var r=i.inputs.Field;r&&"field"!=r||(r="Close"),e.Studies.MA(i.inputs["Moving Average Type"],i.days,r,0,"_MA",t,i);for(var a=Math.max(i.startFrom,i.days-1);a<n.length;a++)n[a]&&(n[a]["Result "+i.name]=100*(n[a][r]/n[a]["_MA "+i.name]-1))},e.Studies.calculateRainbow=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days+1)return void(i.error=!0);var r=i.inputs.Field;r&&"field"!=r||(r="Close");for(var a=r,o=1;o<=10;o++)e.Studies.MA("simple",i.days,a,0,"SMA"+o,t,i),a="SMA"+o+" "+i.name;for(var s=Math.max(i.startFrom,10);s<n.length;s++)if(n[s]){var l=0,h=-1*Number.MAX_VALUE,c=Number.MAX_VALUE;for(o=1;o<=10;o++){var u=n[s]["SMA"+o+" "+i.name];l+=u,h=Math.max(h,u),c=Math.min(c,u)}if(i.name.indexOf("Osc")>-1){var p=function(t,e){for(var i=-1*Number.MAX_VALUE,r=Number.MAX_VALUE,a=e-t+1;a<=e;a++)a<0||(i=Math.max(i,n[a].Close),r=Math.min(r,n[a].Close));return[r,i]}(i.inputs["HHV/LLV Lookback"],s);n[s][i.name+"_hist"]=100*(n[s][r]-l/10)/Math.max(1e-6,p[1]-p[0]),n[s]["Over "+i.name]=100*(h-c)/Math.max(1e-6,p[1]-p[0]),n[s]["Under "+i.name]=-n[s]["Over "+i.name],n[s]["Zero "+i.name]=0}}},e.Studies.calculateKST=function(t,i){var n=i.chart.scrubbed,r=i.inputs.Field;r&&"field"!=r||(r="Close");var a={},o={};a[1]=Number(i.inputs["Lightest Rate of Change Period"]),a[2]=Number(i.inputs["Light Rate of Change Period"]),a[3]=Number(i.inputs["Heavy Rate of Change Period"]),a[4]=Number(i.inputs["Heaviest Rate of Change Period"]),o[1]=Number(i.inputs["Lightest SMA Period"]),o[2]=Number(i.inputs["Light SMA Period"]),o[3]=Number(i.inputs["Heavy SMA Period"]),o[4]=Number(i.inputs["Heaviest SMA Period"]);var s,l,h=Number(i.inputs["Signal Period"]);for(s=i.startFrom;s<n.length;s++)if(n[s])for(l=1;l<=4;l++)s>=a[l]&&n[s-a[l]]&&n[s-a[l]][r]&&(n[s]["_ROC"+l+" "+i.name]=100*(n[s][r]/n[s-a[l]][r]-1));for(l=1;l<=4;l++)e.Studies.MA("simple",o[l],"_ROC"+l+" "+i.name,0,"_SMA"+l,t,i);for(s=i.startFrom;s<n.length;s++)for(n[s]["KST "+i.name]=0,l=1;l<=4;l++)n[s]["KST "+i.name]+=l*n[s]["_SMA"+l+" "+i.name];e.Studies.MA("simple",h,"KST "+i.name,0,"KSTSignal",t,i)},e.Studies.calculateSpecialK=function(t,i){var n=i.chart.scrubbed,r=i.inputs.Field;r&&"field"!=r||(r="Close");var a=i.inputs.Interval;a||(a="daily");var o,s,l={daily:[10,15,20,30,50,65,75,100,195,265,390,530],weekly:[4,5,6,8,10,13,15,20,39,52,78,104]},h={daily:[10,10,10,15,50,65,75,100,130,130,130,195],weekly:[4,5,6,8,10,13,15,20,26,26,26,39]};for(o=i.startFrom;o<n.length;o++)if(n[o])for(s=0;s<l[a].length;s++)o>=l[a][s]&&n[o-l[a][s]]&&n[o-l[a][s]][r]&&(n[o]["_ROC"+s+" "+i.name]=100*(n[o][r]/n[o-l[a][s]][r]-1));for(s=0;s<h[a].length;s++)e.Studies.MA("daily"==a?"simple":"exponential",h[a][s],"_ROC"+s+" "+i.name,0,"_MA"+s,t,i);for(o=i.startFrom;o<n.length;o++)for(n[o]["Result "+i.name]=0,s=0;s<h[a].length;s++)n[o]["Result "+i.name]+=(s%4+1)*n[o]["_MA"+s+" "+i.name]},e.Studies.calculateDarvas=function(t,i){var n=i.chart.scrubbed,r=0,a=parseInt(i.inputs["ATH Lookback Period"],10);i.inputs["Volume Spike"]&&e.Studies.MA("simple",a,"Volume",0,"ADV",t,i);var o,s=parseFloat(i.inputs["Volume % of Avg"])/100,l="none",h={},c=null,u=null,p=null,d=parseFloat(i.inputs["Level Offset"]),f={};for(["Darvas","Ghost","Profit","Loss","ATH","ADV","Spike"].forEach(function(t){f[t]=t+" "+i.name}),o=i.startFrom-1;o>0;o--){var m=n[o];if(!m[f.Darvas]&&!m[f.Ghost]){r=m[f.ATH]||0,u=m[f.Profit],p=m[f.Loss];break}for(var g in f)m[g]=null}for(o;o<n.length;o++){var v=n[o];if(v){if(parseFloat(i.inputs["Price Minimum"])<=n[r].Close){if(!c||c.End&&o!=c.End+1||(n[o-1].Close>h.High?h={State:1,High:2*h.High-h.Low,Low:h.High,Start:o,End:2*h.End-h.Start+1}:c=null,c&&(v[f.Ghost]=e.clone(h),h.State=0,n[h.End]&&(n[h.End][f.Ghost]=e.clone(h)),c={Start:h.Start,End:h.End},u=h.High+d,(!p||p<h.Low-d)&&(p=h.Low-d))),v[f.Profit]=u,v[f.Loss]=p,v.Close>=u?u=null:"high/low"==i.inputs["Exit Field"]&&v.High>=u&&(u=null),"none"==l&&o==r+3&&!n[r+2][f.Darvas]&&!n[r+1][f.Darvas]&&!n[r][f.Darvas]&&n[r].High>v.High&&(l="high"),"high"==l&&(v.High>n[r].High?l="none":n[o-3].Low<n[o-2].Low&&n[o-3].Low<n[o-1].Low&&n[o-3].Low<v.Low&&(h={State:1,High:n[r].High,Low:n[o-3].Low,Start:r},n[r][f.Darvas]=e.clone(h),l="darvas",c&&(c.End>o&&n[c.Start]&&(v[f.Ghost]=e.clone(n[c.Start][f.Ghost]),v[f.Ghost].End=o,n[c.End]&&delete n[c.End][f.Ghost]),v[f.Ghost].State=0,n[c.Start][f.Ghost].End=o,c=null),u=h.High+d,(!p||p<h.Low-d)&&(p=h.Low-d))),"darvas"==l&&(v.Close>h.High?c={}:"high/low"==i.inputs["Exit Field"]&&v.High>h.High?c={}:v.Close<h.Low?l="none":"high/low"==i.inputs["Exit Field"]&&v.Low<h.Low&&(l="none"),c?l="none":"none"==l&&(u=null,p=null),i.inputs["Ghost Boxes"]||(c=null),"none"==l)){for(var y=h.Start+1;y<o;y++)n[y][f.Darvas]=e.clone(h);h.State=0,h.End=o,v[f.Darvas]=e.clone(h),v[f.ATH]=r;continue}p&&(v.Close<h.Low||"high/low"==i.inputs["Exit Field"]&&v.Low<h.Low)&&("darvas"==l&&(l="none"),(v.Close<p||"high/low"==i.inputs["Exit Field"]&&v.Low<p)&&(u=null,p=null),c&&(c.End>o&&n[c.Start]&&(v[f.Ghost]=e.clone(n[c.Start][f.Ghost]),v[f.Ghost].End=o,n[c.End]&&delete n[c.End][f.Ghost]),v[f.Ghost].State=0,n[c.Start][f.Ghost].End=o,c=null))}if(v.High>=n[r].High&&(r=o),(o<3||v.High>=n[o-1].High&&v.High>=n[o-2].High&&v.High>=n[o-3].High)&&o-r>=a){r=o;for(var b=0;b<a&&!(o-b<0);b++)n[o-b].High>n[r].High&&(r=o-b)}i.inputs["Volume Spike"]&&o>a&&o==r&&v[f.ADV]*s<v.Volume&&(v[f.Spike]=1),v[f.ATH]=r}}},e.Studies.calculateSupertrend=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days+1)return void(i.error=!0);e.Studies.calculateStudyATR(t,i);for(var r=i.startFrom;r<n.length;r++){var a=n[r];if(a){var o=(a.High+a.Low)/2,s=i.inputs.Multiplier*a["ATR "+i.name],l=o-s,h=o+s;r&&(n[r-1]&&n[r-1].Close&&n[r-1].Close>n[r-1]["_Uptrend "+i.name]&&n[r-1]["_Uptrend "+i.name]>l&&(l=n[r-1]["_Uptrend "+i.name]),n[r-1]&&n[r-1].Close&&n[r-1].Close<n[r-1]["_Downtrend "+i.name]&&n[r-1]["_Downtrend "+i.name]<h&&(h=n[r-1]["_Downtrend "+i.name])),a["_Direction "+i.name]=1,r&&(a["_Direction "+i.name]=n[r-1]["_Direction "+i.name],a.Close>n[r-1]["_Downtrend "+i.name]?a["_Direction "+i.name]=1:a.Close<n[r-1]["_Uptrend "+i.name]&&(a["_Direction "+i.name]=-1)),a["_Uptrend "+i.name]=l,a["_Downtrend "+i.name]=h,a["Trend "+i.name]=a["_Direction "+i.name]>0?l:h}}i.outputMap={},i.outputMap["Trend "+i.name]="Trend"},e.Studies.fetchAdditionalInstruments=function(t,i,n,r){function a(){t.createDataSet(),t.draw()}if(!t.quoteDriver)return void console.log("CIQ.Studies.fetchAdditionalInstruments: No quotefeed to fetch symbol");var o=t.panels[i.panel].chart;i.symbols=n;var s,l,h;for(s=0;s<n.length;s++){l=h=n[s],"object"==(void 0===h?"undefined":_typeof(h))?l=h.symbol:h={symbol:l};var c={symbol:l,symbolObject:h,bucket:"study",studyName:i.name,chartName:o.name,action:"add-study"};t.currentlyImporting&&(c.loadData=!1),e.extend(c,r),i.series=t.addSeries(null,c,a)}},e.Studies.initPriceRelative=function(t,i,n,r,a,o){var s=e.Studies.initializeFN(t,i,n,r,a,o),l=[s.inputs["Comparison Symbol"].toUpperCase()];return e.Studies.fetchAdditionalInstruments(t,s,l),s},e.Studies.calculatePriceRelative=function(t,i){var n=i.chart.scrubbed,r=i.inputs["Comparison Symbol"].toUpperCase();r||(r=i.study.inputs["Comparison Symbol"]);var a={},o=t.chart.symbol.replace(/=/,"");if(o=o.replace(/[+\-*\\%]/g,""),a[o]=n.slice(i.startFrom),a[o].length){o!=r&&(a[r]=null);for(var s=e.computeEquationChart("["+o+"]/["+r+"]",a),l=0,h=i.startFrom;h<n.length&&l<s.length;h++){for(;l<s.length&&n[h].DT.getTime()>s[l].DT.getTime();)l++;n[h].DT.getTime()<s[l].DT.getTime()||(n[h]["Result "+i.name]=s[l].Close,l++)}}},e.Studies.calculatePerformance=function(t,i){var n=i.chart.scrubbed,r=i.inputs["Comparison Symbol"].toUpperCase();if(r||(r=i.study.inputs["Comparison Symbol"]),i.days||(i.days=i.study.inputs.Period),n.length<i.days+1)return void(i.error=!0);e.Studies.MA("ma",i.days,"Close",0,"_MA Base",t,i),e.Studies.MA("ma",i.days,r,0,"_MA Comp",t,i);for(var a=i.startFrom;a<n.length;a++)n[a]["Result "+i.name]=n[a].Close/n[a][r]*(n[a]["_MA Comp "+i.name]/n[a]["_MA Base "+i.name])},e.Studies.calculateBeta=function(t,i){var n=i.chart.scrubbed,r=i.inputs["Comparison Symbol"].toUpperCase();if(r||(r=i.study.inputs["Comparison Symbol"]),i.days||(i.days=i.study.inputs.Period),n.length<i.days+1)return void(i.error=!0);for(var a=Math.max(i.startFrom,1);a<n.length;a++)n[a]["_BaseChange "+i.name]=n[a].Close/n[a-1].Close-1,n[a]["_CompChange "+i.name]=n[a][r]/n[a-1][r]-1;for(e.Studies.MA("ma",i.days,"_BaseChange "+i.name,0,"_MA Base",t,i),e.Studies.MA("ma",i.days,"_CompChange "+i.name,0,"_MA Comp",t,i),a=Math.max(i.startFrom,i.days);a<n.length;a++)n[a]["_COVARn "+i.name]=(n[a]["_BaseChange "+i.name]-n[a]["_MA Base "+i.name])*(n[a]["_CompChange "+i.name]-n[a]["_MA Comp "+i.name]),n[a]["_VARn "+i.name]=Math.pow(n[a]["_CompChange "+i.name]-n[a]["_MA Comp "+i.name],2);for(e.Studies.MA("ma",i.days,"_COVARn "+i.name,0,"_COVAR",t,i),e.Studies.MA("ma",i.days,"_VARn "+i.name,0,"_VAR",t,i),a=Math.max(i.startFrom,2*i.days-1);a<n.length;a++)n[a]["Result "+i.name]=n[a]["_COVAR "+i.name]/n[a]["_VAR "+i.name]},e.Studies.calculateVortex=function(t,i){var n=i.chart.scrubbed,r=i.days;if(n.length<r+1)return void(i.error=!0);var a={tr:0,vmPlus:0,vmMinus:0};i.startFrom>1&&(a=e.clone(n[i.startFrom-1]["_totals "+i.name]));for(var o=Math.max(i.startFrom,1);o<n.length;o++){var s=n[o],l=n[o-1],h=Math.abs(s.High-l.Low),c=Math.abs(s.Low-l.High),u=Math.max(s.High,l.Close)-Math.min(s.Low,l.Close);a.tr+=u,a.vmPlus+=h,a.vmMinus+=c,o>r&&(a.tr-=n[o-r]["_True Range "+i.name],a.vmPlus-=n[o-r]["_VMPlus "+i.name],a.vmMinus-=n[o-r]["_VMMinus "+i.name]),s["_True Range "+i.name]=u,s["_VMPlus "+i.name]=h,s["_VMMinus "+i.name]=c,o>=r&&(s["+VI "+i.name]=a.vmPlus/a.tr,s["-VI "+i.name]=a.vmMinus/a.tr),s["_totals "+i.name]=e.clone(a)}},e.Studies.calculateBalanceOfPower=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days+1)return void(i.error=!0);for(var r=i.startFrom;r<n.length;r++){var a=n[r];a["_Ratio "+i.name]=a.Close-a.Open,0!==a["_Ratio "+i.name]&&(a["_Ratio "+i.name]/=a.High-a.Low)}e.Studies.MA(i.inputs["Moving Average Type"],i.days,"_Ratio "+i.name,0,"Result",t,i)},e.Studies.calculateTrendIntensity=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days+1)return void(i.error=!0);var r=i.inputs.Field;r&&"field"!=r||(r="Close"),e.Studies.MA("ma",i.days,r,0,"_SMA",t,i);var a,o,s=0,l=0,h=[],c=Math.ceil(i.days/2);for(a=Math.max(0,i.startFrom-c);a<n.length;a++)(n[a]["_SMA "+i.name]||0===n[a]["_SMA "+i.name])&&(o=n[a][r]-n[a]["_SMA "+i.name],o<0?l+=-1*o:s+=o,h.push(o),h.length>c&&(o=h.shift(),o<0?l-=-1*o:s-=o),a<i.startFrom||(n[a]["TII "+i.name]=function(t,e){return Math.abs(e)<1e-8?100:100-100/(1+t/e)}(s,l)));e.Studies.MA("ema",i.inputs["Signal Period"],"TII "+i.name,0,"Signal",t,i),i.zoneOutput="TII"},e.Studies.calculateZigZag=function(t,e){function i(t,i){for(var r=t+1;r<i;r++)n[r]["ShadowResult "+e.name]=(n[i]["Result "+e.name]-n[t]["Result "+e.name])*(r-t)/(i-t)+n[t]["Result "+e.name],delete n[r]["Result "+e.name]}var n=e.chart.scrubbed;if(n&&n.length){for(var r=e.highLowChart,a=null,o=null,s=e.inputs["Distance(%)"],l=0,h=0,c=0,u=null,p=null,d=0,f=Math.min(n.length-1,e.startFrom);f>=0;f--)if(d=f,n[f]["_state "+e.name]){var m=n[f]["_state "+e.name];a=m[0],o=m[1],l=m[2],h=m[3],c=m[4],u=m[5],p=m[6];break}for(var g=d;g<n.length;g++){var v=n[g][r?"High":"Close"],y=n[g][r?"Low":"Close"];if(null===o||o<v)if(o=v,l<0&&(a=y),u=(1-s/100)*o,l>-1){if(null!==p&&o>p){n[h]["Result "+e.name]=n[h][r?"Low":"Close"],i(c,h),l=-1,a=y,c=h,h=g;continue}}else h=g;if(null===a||a>y)if(a=y,l>0&&(o=v),p=(1+s/100)*a,l<1){if(null!==u&&a<u){n[h]["Result "+e.name]=n[h][r?"High":"Close"],i(c,h),l=1,o=v,c=h,h=g;continue}}else h=g}n[h]["Result "+e.name]=n[h][r?1==l?"Low":"High":"Close"],n[h]["_state "+e.name]=[a,o,l,h,c,u,p],i(c,h),n[n.length-1]["Result "+e.name]=n[n.length-1][r?1==l?"High":"Low":"Close"],i(h,n.length-1)}},e.Studies.calculatePsychologicalLine=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)return void(e.error=!0);for(var n=[],r=100/e.days,a=0,o=Math.max(e.startFrom-e.days,1);o<i.length;o++){var s=Number(i[o].Close>i[o-1].Close);s&&(a+=r),n.push(s),n.length>e.days&&(a-=n.shift()*r),o<e.startFrom||(i[o]["Result "+e.name]=a)}},e.Studies.calculateMADev=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days+1)return void(i.error=!0);var r=i.inputs.Field;r&&"field"!=r||(r="Close");var a=i.inputs["Points Or Percent"];a||(a="Points");var o=i.inputs["Moving Average Type"];o||(o="exponential"),e.Studies.MA(o,i.days,r,0,"_MA",t,i);for(var s=i.name+"_hist",l=Math.max(i.startFrom,i.days-1);l<n.length;l++){var h=n[l];h[s]="Points"==a?h[r]-h["_MA "+i.name]:100*(h[r]/h["_MA "+i.name]-1)}},e.Studies.calculateShinohara=function(t,i){var n=i.chart.scrubbed;if(n.length<i.days+1)return void(i.error=!0);var r={weakNum:0,weakDen:0,strongNum:0,strongDen:0};i.startFrom>1&&(r=e.clone(n[i.startFrom-1]["_accums "+i.name]));for(var a=i.startFrom;a<n.length;a++)r.weakNum+=n[a].High-n[a].Close,r.weakDen+=n[a].Close-n[a].Low,a>0&&(r.strongNum+=n[a].High-n[a-1].Close,r.strongDen+=n[a-1].Close-n[a].Low),a>=i.days&&(r.weakNum-=n[a-i.days].High-n[a-i.days].Close,r.weakDen-=n[a-i.days].Close-n[a-i.days].Low,n[a]["Weak Ratio "+i.name]=100*r.weakNum/r.weakDen,a>i.days&&(r.strongNum-=n[a-i.days].High-n[a-i.days-1].Close,r.strongDen-=n[a-i.days-1].Close-n[a-i.days].Low,n[a]["Strong Ratio "+i.name]=100*r.strongNum/r.strongDen)),n[a]["_accums "+i.name]=e.clone(r)},e.Studies.calculateIchimoku=function(t,e){function i(t,e){for(var i=Number.MAX_VALUE,n=-1*Number.MAX_VALUE,r=e-t+1;r<=e;r++)r<0||(i=Math.min(i,a[r].Low),n=Math.max(n,a[r].High));return[i,n]}var n,r,a=e.chart.scrubbed,o={Base:Number(e.inputs["Base Line Period"]),Conv:Number(e.inputs["Conversion Line Period"]),LeadB:Number(e.inputs["Leading Span B Period"]),Lag:Number(e.inputs["Lagging Span Period"])};for(n=e.startFrom;n<a.length;n++)a[n]&&(r=i(o.Conv,n),a[n]["Conversion Line "+e.name]=(r[1]+r[0])/2,r=i(o.Base,n),a[n]["Base Line "+e.name]=(r[1]+r[0])/2,n<o.Lag||(a[n-o.Lag]["Lagging Span "+e.name]=a[n].Close));for(e.futureA=[],e.futureB=[],n=Math.max(0,e.startFrom-o.Base);n<a.length;n++){r=i(o.LeadB,n);var s=(a[n]["Conversion Line "+e.name]+a[n]["Base Line "+e.name])/2,l=(r[1]+r[0])/2;a[n+o.Base]?(a[n+o.Base]["Leading Span A "+e.name]=s,a[n+o.Base]["Leading Span B "+e.name]=l):(e.futureA.push(s),e.futureB.push(l))}},e.Studies.displayIchimoku=function(t,i,n){function r(n,r){var a={color:!1===r?l:r?s:"transparent",opacity:.3,panelName:i.panel};e.fillArea(t,n,a),t.endClip()}var a="Leading Span A "+i.name,o="Leading Span B "+i.name,s=e.Studies.determineColor(i.outputs[i.outputMap[a]]),l=e.Studies.determineColor(i.outputs[i.outputMap[o]]),h={topBand:a,bottomBand:o,topColor:s,bottomColor:l,skipTransform:t.panels[i.panel].name!=i.chart.name};e.fillIntersecting(t,i.panel,h);var c=t.panels[i.panel],u=t.pixelFromBar(n.length-1,c.chart),p=t.pixelFromPrice(n[n.length-1][a],c),d=t.pixelFromPrice(n[n.length-1][o],c),f=[[u,d],[u,p]],m=null,g=i.futureA,v=i.futureB;if(i.chart.dataSegment.length>=i.chart.scroll){for(var y=0;g&&y<g.length-1;y++)if(null!==g[y]&&!isNaN(g[y])&&null!==v[y]&&!isNaN(v[y])){var b=t.pixelFromBar(n.length+y,c.chart),x=t.pixelFromBar(n.length+y+1,c.chart),w=t.pixelFromPrice(g[y],c),C=t.pixelFromPrice(g[y+1],c),S=t.pixelFromPrice(v[y],c),T=t.pixelFromPrice(v[y+1],c);if(f.push([b,w]),f.unshift([b,S]),(m=w<S)&&C>T||!m&&C<T){var _=e.intersectLineLineX(b,x,w,C,b,x,S,T),k=e.intersectLineLineY(b,x,w,C,b,x,S,T);f.push([_,k]),r(f,m),f=[[_,k]],m=null}}f.length>2&&r(f,m)}e.Studies.displaySeriesAsLine(t,i,n)},e.Studies.displayDarvas=function(t,i,n){var r=i.outputs.Levels;r&&"auto"!=r&&!e.isTransparent(r)||(r=t.defaultColor);var a=i.outputs.Darvas;a&&"auto"!=a&&!e.isTransparent(a)||(a=t.defaultColor);var o=i.outputs.Ghost;o&&"auto"!=o&&!e.isTransparent(o)||(o=t.defaultColor);var s,l,h,c=t.panels[i.panel],u=t.layout.candleWidth-2;if(u<2&&(u=1),t.startClip(i.panel),i.inputs["Stop Levels"]){for(t.chart.context.setLineDash&&t.chart.context.setLineDash([2,2]),t.chart.context.lineWidth=2,t.chart.context.strokeStyle=r,t.chart.context.beginPath(),s=0;s<n.length;s++){l=n[s];var p=n[s-1];if(l){h=l["Loss "+i.name]?Math.floor(t.pixelFromPrice(l["Loss "+i.name],c)):null;var d=p&&p["Loss "+i.name]?Math.floor(t.pixelFromPrice(p["Loss "+i.name],c)):null;if(h){l.candleWidth&&(u=Math.floor(Math.max(1,l.candleWidth)));var f=Math.floor(t.pixelFromBar(s,c.chart)+u/2),m=Math.floor(t.pixelFromBar(s,c.chart)-u/2);d&&d>=h?t.chart.context.lineTo(m,h):0===s?t.chart.context.moveTo(t.chart.left,h):t.chart.context.moveTo(m,h),t.chart.context.lineTo(f,h)}}}t.chart.context.stroke(),t.chart.context.setLineDash&&t.chart.context.setLineDash([]),t.chart.context.lineWidth=1}var g,v,y,b,x=-10,w=0,C=-10,S=0,T=!1,_=!1,k=t.chart.context.measureText("▲").width/2;for(s=0;s<n.length;s++)if(n[s]){if(n[s]["Spike "+i.name]){t.chart.context.fillStyle=a,t.chart.context.textBaseline="bottom";var D=t.pixelFromPrice(n[s].High,t.chart.panel);t.chart.context.fillText("▼",t.pixelFromBar(s)-k,D-5)}n[s].candleWidth&&(u=Math.floor(Math.max(1,n[s].candleWidth))),n[s]["Darvas "+i.name]&&(l=n[s]["Darvas "+i.name],1!=l.State||T?0===l.State&&(w=Math.floor(t.pixelFromBar(s,c.chart)+u/2)-x,g=Math.floor(t.pixelFromPrice(l.High,c)),v=Math.floor(t.pixelFromPrice(l.Low,c))-g,t.chart.context.strokeStyle=a,t.chart.context.fillStyle=a,i.inputs["Stop Levels"]?t.chart.context.globalAlpha=.3:(t.chart.context.strokeRect(x,g,w,v),t.chart.context.globalAlpha=.2),t.chart.context.fillRect(x,g,w,v),t.chart.context.globalAlpha=1,T=!1):(x=Math.floor(t.pixelFromBar(s,c.chart)-u/2),g=Math.floor(t.pixelFromPrice(l.High,c)),v=Math.floor(t.pixelFromPrice(l.Low,c))-g,T=!0)),n[s]["Ghost "+i.name]&&i.inputs["Ghost Boxes"]&&(l=n[s]["Ghost "+i.name],1!=l.State||_?0===l.State&&(l.Start==l.End&&(C=Math.floor(t.pixelFromBar(s,c.chart)-u/2)),S=Math.floor(t.pixelFromBar(s,c.chart)+u/2)-C,y=Math.floor(t.pixelFromPrice(l.High,c)),b=Math.floor(t.pixelFromPrice(l.Low,c))-y,t.chart.context.strokeStyle=o,t.chart.context.fillStyle=o,i.inputs["Stop Levels"]?t.chart.context.globalAlpha=.3:(t.chart.context.strokeRect(C,y,S,b),t.chart.context.globalAlpha=.2),t.chart.context.fillRect(C,y,S,b),t.chart.context.globalAlpha=1,_=!1):(C=Math.floor(t.pixelFromBar(s,c.chart)-u/2),y=Math.floor(t.pixelFromPrice(l.High,c)),S=Math.floor((l.End-l.Start+1)*t.layout.candleWidth+u/2),b=Math.floor(t.pixelFromPrice(l.Low,c))-y,_=!0))}if(T&&(w=Math.floor(t.pixelFromBar(s,c.chart)+u/2)-x,t.chart.context.strokeStyle=a,t.chart.context.fillStyle=a,i.inputs["Stop Levels"]?t.chart.context.globalAlpha=.3:(t.chart.context.beginPath(),t.chart.context.moveTo(x+2*w,g),t.chart.context.lineTo(x,g),t.chart.context.lineTo(x,g+v),t.chart.context.lineTo(x+2*w,g+v),t.chart.context.stroke(),t.chart.context.globalAlpha=.2),t.chart.context.fillRect(x,g,2*w,v),t.chart.context.globalAlpha=1),_&&(t.chart.context.strokeStyle=o,t.chart.context.fillStyle=o,i.inputs["Stop Levels"]?t.chart.context.globalAlpha=.3:(t.chart.context.strokeRect(C,y,S,b),t.chart.context.globalAlpha=.2),t.chart.context.fillRect(C,y,S,b),t.chart.context.globalAlpha=1),T||_){if(i.inputs["Stop Levels"]){t.chart.context.setLineDash&&t.chart.context.setLineDash([2,2]),t.chart.context.lineWidth=2,t.chart.context.strokeStyle=r;var M=Math.floor(t.pixelFromBar(s-1,c.chart)+u/2);h&&(t.chart.context.beginPath(),t.chart.context.moveTo(M,h),t.chart.context.lineTo(T?x+2*w:C+S,h),t.chart.context.stroke()),t.chart.context.setLineDash&&t.chart.context.setLineDash([]),t.chart.context.lineWidth=1}T=!1,_=!1}t.endClip()},e.Studies.displaySupertrend=function(t,e,i){function n(t,i,n){return i&&i["_Direction "+e.name]<0?e.outputs.Downtrend:e.outputs.Uptrend}var r=t.panels[e.panel],a={skipProjections:!0,label:t.preferences.labels},o=t.chart.context;o.strokeStyle=n(t,i[i.length-1]),o.lineWidth=2,e.highlight&&(o.lineWidth=3);for(var s="Trend "+e.name,l=0;r.chart.transformFunc&&l<i.length;l++){var h=i[l];h&&h.transform&&(h.transform[s]=r.chart.transformFunc(t,r.chart,h[s]))}t.plotDataSegmentAsLine(s,r,a,n),o.lineWidth=1,t.startClip(e.panel);var c,u=t.chart.context.measureText("▲").width/2;for(c=0;c<i.length;c++)if(i[c]&&i[c-1])if(i[c-1]["_Direction "+e.name]>i[c]["_Direction "+e.name]){t.chart.context.fillStyle=e.outputs.Downtrend,t.chart.context.textBaseline="bottom";for(var p=t.pixelFromPrice(i[c].High,t.chart.panel),d=5;d<=45;d+=10)t.chart.context.fillText("▼",t.pixelFromBar(c)-u,p-d)}else if(i[c-1]["_Direction "+e.name]<i[c]["_Direction "+e.name]){t.chart.context.fillStyle=e.outputs.Uptrend,t.chart.context.textBaseline="top";for(var f=t.pixelFromPrice(i[c].Low,t.chart.panel),m=5;m<=45;m+=10)t.chart.context.fillText("▲",t.pixelFromBar(c)-u,f+m)}t.endClip()},e.Studies.displayVsComparisonSymbol=function(t,i,n){var r=i.inputs["Comparison Symbol"].toUpperCase();if(!t.getSeries({symbol:r,chart:i.chart}).length)return void t.watermark(i.panel,"center","bottom",t.translateIf(i.study.name+" Not Available"));for(var a={skipTransform:t.panels[i.panel].name!=i.chart.name,panelName:i.panel,band:"Result "+i.name,threshold:i.study.centerline},o=n.length-1;o>=0;o--)if(n[o]&&n[o][r])return e.Studies.displaySeriesAsLine(t,i,n),void((i.study.centerline||0===i.study.centerline)&&(i.outputs.Gain&&e.preparePeakValleyFill(t,e.extend(a,{direction:1,color:i.outputs.Gain})),i.outputs.Loss&&e.preparePeakValleyFill(t,e.extend(a,{direction:-1,color:i.outputs.Loss}))))},e.Studies.displayMFI=function(t,i,n){var r=t.panels[i.panel];r.yAxis.min=0,e.Studies.displaySeriesAsLine(t,i,n);var a=r.yAxis.bottom,o=t.layout.candleWidth-2;o<2&&(o=1);var s=i.outputs.Green,l=i.outputs.Fade,h=i.outputs.Fake,c=i.outputs.Squat;t.canvasColor("stx_histogram"),t.chart.context.globalAlpha=1,t.chart.context.fillStyle="#CCCCCC",t.startClip(i.panel);for(var u=0;u<n.length;u++){var p=n[u];p&&n[u-1]&&(0===u||(n[u-1][i.name+"_hist"]<p[i.name+"_hist"]?n[u-1].Volume<p.Volume?t.chart.context.fillStyle=s:n[u-1].Volume>p.Volume&&(t.chart.context.fillStyle=h):n[u-1][i.name+"_hist"]>p[i.name+"_hist"]&&(n[u-1].Volume<p.Volume?t.chart.context.fillStyle=c:n[u-1].Volume>p.Volume&&(t.chart.context.fillStyle=l))),p.candleWidth&&(o=Math.floor(Math.max(1,p.candleWidth-2))),t.chart.context.fillRect(Math.floor(t.pixelFromBar(u,r.chart)-o/2),Math.floor(a),Math.floor(o),Math.floor(t.pixelFromPrice(p[i.name+"_hist"],r)-a)))}t.endClip()},e.Studies.displayAwesomeOscillator=function(t,i,n){e.Studies.determineMinMax(t,i,n);var r=t.panels[i.panel];r.yAxis.low=r.min=Math.min(0,r.min),r.yAxis.high=r.max=Math.max(0,r.max),e.Studies.displaySeriesAsLine(t,i,n);var a=t.pixelFromPrice(0,r),o=t.layout.candleWidth-2;o<2&&(o=1);var s=e.Studies.determineColor(i.outputs["Increasing Bar"]),l=e.Studies.determineColor(i.outputs["Decreasing Bar"]);t.canvasColor("stx_histogram"),t.chart.context.globalAlpha=1,t.chart.context.fillStyle="#CCCCCC",t.startClip(i.panel);for(var h=0;h<n.length;h++){var c=n[h];c&&n[h-1]&&(0===h||(n[h-1][i.name+"_hist"]<c[i.name+"_hist"]?t.chart.context.fillStyle=s:n[h-1][i.name+"_hist"]>c[i.name+"_hist"]&&(t.chart.context.fillStyle=l)),c.candleWidth&&(o=Math.floor(Math.max(1,c.candleWidth-2))),t.chart.context.fillRect(Math.floor(t.pixelFromBar(h,r.chart)-o/2),Math.floor(a),Math.floor(o),Math.floor(t.pixelFromPrice(c[i.name+"_hist"],r)-a)))}t.endClip()},e.Studies.displayGator=function(t,i,n){e.Studies.determineMinMax(t,i,n);var r=t.panels[i.panel];r.yAxis.low=r.min=Math.min(0,r.min),r.yAxis.high=r.max=Math.max(0,r.max),e.Studies.displaySeriesAsLine(t,i,n);var a=t.pixelFromPrice(0,r),o=t.layout.candleWidth-2;o<2&&(o=1);var s=e.Studies.determineColor(i.outputs["Increasing Bar"]),l=e.Studies.determineColor(i.outputs["Decreasing Bar"]);t.canvasColor("stx_histogram"),t.chart.context.globalAlpha=1,t.chart.context.fillStyle="#CCCCCC",t.startClip(i.panel);for(var h=1;h<n.length;h++){var c=n[h];if(c&&n[h-1])for(var u=1;u<=2;u++)Math.abs(n[h-1][i.name+"_hist"+u])<Math.abs(c[i.name+"_hist"+u])?t.chart.context.fillStyle=s:Math.abs(n[h-1][i.name+"_hist"+u])>Math.abs(c[i.name+"_hist"+u])&&(t.chart.context.fillStyle=l),c.candleWidth&&(o=Math.floor(Math.max(1,c.candleWidth-2))),t.chart.context.fillRect(Math.floor(t.pixelFromBar(h,r.chart)-o/2),Math.floor(a),Math.floor(o),Math.floor(t.pixelFromPrice(c[i.name+"_hist"+u],r)-a))}t.endClip()},e.Studies.displayElderImpulse=function(t,e,i){t.chart.customChart={chartType:"colored_bar",colorFunction:function(t,i,n){return i["Result "+e.name]}}},e.Studies.displayPivotPoints=function(t,i,n){if(i.noSlopes=!i.inputs.Continuous,e.Studies.displaySeriesAsLine(t,i,n),i.inputs.Shading){var r={noSlopes:i.noSlopes,opacity:i.parameters.opacity?i.parameters.opacity:.2,skipTransform:t.panels[i.panel].name!=i.chart.name};e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"Resistance 3 "+i.name,bottomBand:"Resistance 2 "+i.name,color:e.Studies.determineColor(i.outputs["Resistance 3"])},r)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"Resistance 2 "+i.name,bottomBand:"Resistance 1 "+i.name,color:e.Studies.determineColor(i.outputs["Resistance 2"])},r)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"Resistance 1 "+i.name,bottomBand:"Pivot "+i.name,color:e.Studies.determineColor(i.outputs["Resistance 1"])},r)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"Support 1 "+i.name,bottomBand:"Pivot "+i.name,color:e.Studies.determineColor(i.outputs["Support 1"])},r)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"Support 2 "+i.name,bottomBand:"Support 1 "+i.name,color:e.Studies.determineColor(i.outputs["Support 2"])},r)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"Support 3 "+i.name,bottomBand:"Support 2 "+i.name,color:e.Studies.determineColor(i.outputs["Support 3"])},r))}},e.Studies.displayAlligator=function(t,i,n){function r(e,i){var r;"high"==e?(t.chart.context.fillStyle=t.defaultColor,t.chart.context.textBaseline="bottom",r=t.pixelFromPrice(n[i].High,t.chart.panel),t.chart.context.fillText("▲",t.pixelFromBar(o,t.chart)-t.chart.context.measureText("▲").width/2+1,r-5)):"low"==e&&(t.chart.context.fillStyle=t.defaultColor,t.chart.context.textBaseline="top",r=t.pixelFromPrice(n[i].Low,t.chart.panel),t.chart.context.fillText("▼",t.pixelFromBar(o,t.chart)-t.chart.context.measureText("▼").width/2+1,r+5))}var a=t.panels[i.panel];if(e.Studies.displayIndividualSeriesAsLine(t,i,a,"Jaw "+i.name,n),e.Studies.displayIndividualSeriesAsLine(t,i,a,"Lips "+i.name,n),e.Studies.displayIndividualSeriesAsLine(t,i,a,"Teeth "+i.name,n),i.inputs["Show Fractals"]){t.startClip(i.panel);for(var o=2;o<n.length-2;o++)n[o]&&(n[o]["Fractal High "+i.name]&&r("high",o),n[o]["Fractal Low "+i.name]&&r("low",o));t.endClip()}},e.Studies.displayRainbowMA=function(t,i,n){for(var r=t.panels[i.panel],a=10;a>0;a--)e.Studies.displayIndividualSeriesAsLine(t,i,r,"SMA"+a+" "+i.name,n)},e.Studies.displayRainbowOsc=function(t,i,n){var r=t.panels[i.panel];r.min=-100,r.max=100,r.yAxis.low=r.min=Math.min(0,r.min),r.yAxis.high=r.max=Math.max(0,r.max),e.Studies.displaySeriesAsLine(t,i,n),t.startClip(i.panel);var a=t.pixelFromPrice(0,r);t.plotDataSegmentAsLine("Zero "+i.name,r,{noDraw:!0,skipTransform:!0,label:!1});var o=e.Studies.determineColor(i.outputs["Positive Bar"]);t.chart.context.strokeStyle=o,t.plotDataSegmentAsLine("Over "+i.name,r,{skipTransform:!0,label:!1});var s=t.panels[i.panel].name!=i.chart.name,l=t.chart.context.createLinearGradient(0,a,0,r.yAxis.top);l.addColorStop(0,t.containerColor),l.addColorStop(1,o),e.prepareChannelFill(t,{skipTransform:s,color:l,opacity:1,panelName:i.name,topBand:"Over "+i.name,bottomBand:"Zero "+i.name});var h=e.Studies.determineColor(i.outputs["Negative Bar"]);t.chart.context.strokeStyle=h,t.plotDataSegmentAsLine("Under "+i.name,r,{skipTransform:!0,label:!1});var c=t.chart.context.createLinearGradient(0,a,0,r.yAxis.bottom);c.addColorStop(0,t.containerColor),c.addColorStop(1,h),e.prepareChannelFill(t,{skipTransform:s,color:c,opacity:1,panelName:i.name,topBand:"Zero "+i.name,bottomBand:"Under "+i.name});var u=t.layout.candleWidth-2;u<2&&(u=1),t.canvasColor("stx_histogram"),t.chart.context.globalAlpha=1,t.chart.context.fillStyle="#CCCCCC";for(var p=0;p<n.length;p++){var d=n[p];d&&(d[i.name+"_hist"]>0?t.chart.context.fillStyle=o:d[i.name+"_hist"]<0&&(t.chart.context.fillStyle=h),d.candleWidth&&(u=Math.floor(Math.max(1,d.candleWidth-2))),t.chart.context.fillRect(Math.floor(t.pixelFromBar(p,r.chart)-u/2),Math.floor(a),Math.floor(u),Math.floor(t.pixelFromPrice(d[i.name+"_hist"],r)-a)))}t.endClip()},e.Studies.displayZigZag=function(t,i,n){var r=t.highLowBars[t.layout.chartType];i.highLowChart!=r&&(i.highLowChart=r,i.startFrom=0,i.study.calculateFN(t,i));for(var a=t.chart,o=0;o<n.length;o++)n[o]&&n[o]["_shadowCopy "+i.name]&&(delete n[o]["Result "+i.name],n[o].transform&&delete n[o].transform["Result "+i.name],delete n[o]["_shadowCopy "+i.name]);var s=n[0],l=n[n.length-1];s&&!s["Result "+i.name]&&s["ShadowResult "+i.name]&&(s["Result "+i.name]=s["ShadowResult "+i.name],s.transform&&(s.transform["Result "+i.name]=a.transformFunc(t,a,s["ShadowResult "+i.name])),s["_shadowCopy "+i.name]=1),l&&!l["Result "+i.name]&&l["ShadowResult "+i.name]&&(l["Result "+i.name]=l["ShadowResult "+i.name],l.transform&&(l.transform["Result "+i.name]=a.transformFunc(t,a,l["ShadowResult "+i.name])),l["_shadowCopy "+i.name]=1),e.Studies.displaySeriesAsLine(t,i,n)},e.Studies.displayVolumeProfile=function(t,i,n){function r(t,i){i||(T-=2),M.canvasColor(t),e.isIE8&&(x.globalAlpha=.5),x.beginPath();for(var n=u[0][0],r=T,a=1;a<u.length;a++){if(u[a][1]){var o=Math.round(T-u[a][1]*_/d)-.5,s=Math.round(M.pixelFromTransformedValue(n,C))+.5,l=Math.round(M.pixelFromTransformedValue(u[a][0],C))+.5;if(i||(s-=.5,l+=.5,o+=.5),s>S&&(s=S),l<S)if(x.moveTo(T,s),x.lineTo(T,l),x.lineTo(o,l),x.lineTo(o,s),i)(r>o||1==a)&&x.lineTo(r,s);else if(x.lineTo(T,s),h){var c=e.condenseInt(u[a][1]),p=s-l;if(w<=p-2){var f;try{f=x.measureText(c).width}catch(t){f=0}x.textBaseline="top";var m=x.fillStyle;x.fillStyle=k,x.fillText(c,o-f-3,l+(p/2-w/2)),x.fillStyle=m}}r=o}else r=T;n=u[a][0]}i||x.fill(),x.strokeStyle=k,i&&x.stroke(),x.closePath()}if(t&&t.chart.dataSet){var a=t.chart,o=i.parameters.numberOfBars,s=i.parameters.widthPercentage,l=i.parameters.displayBorder,h=i.parameters.displayVolume;(!o||o<0)&&(o=30),o=Math.ceil(o),(!s||s<0)&&(s=.25),!1!==l&&(l=!0),!0!==h&&(h=!1);var c=(a.highValue-a.lowValue)/o;if(0!==c){for(var u=[],p=a.lowValue;p<a.highValue+.1;p+=c)u.push([p,0]);if(u.length<2)return void t.watermark("chart","center","top",t.translateIf("Not enough data to render the Volume Profile"));for(var d=0,f=0;f<n.length;f++){var m=n[f];if(m){var g=m.Volume;i.panel==a.name&&m.transform&&(m=m.transform);for(var v=u[0][0],y=0,b=1;b<u.length;b++)y=u[b][0],(m.Low>=v&&m.Low<=y||m.Low<v&&m.High>y||m.High>=v&&m.High<=y)&&(u[b][1]+=g,u[b][1]>d&&(d=u[b][1])),v=y}}if(0===d)return void t.watermark("chart","center","top",t.translateIf("Not enough data to render the Volume Profile"));t.setStyle("stx_volume_profile","color",e.Studies.determineColor(i.outputs["Bars Color"]));var x=a.context;t.canvasFont("stx-float-date",x);var w=t.getCanvasFontSize("stx-float-date"),C=a.panel,S=C.yAxis.bottom,T=Math.round(a.width)-.5,_=a.width*s,k=t.canvasStyle("stx_volume_profile").borderColor,D=!e.isTransparent(t.canvasStyle("stx_volume_profile").borderColor)&&l,M=t;r("stx_volume_profile",!1),D&&r("stx_volume_profile",!0),x.globalAlpha=1}}},e.Studies.studyLibrary=e.extend(e.Studies.studyLibrary,{"val lines":{name:"Valuation Lines",calculateFN:function(){},seriesFN:function(t,i,n){e.Studies.calculateValuationLines(t,i,n),e.Studies.displayValuationLines(t,i)},overlay:!0,inputs:{Field:"field","Average Type":["mean","median","harmonic"],"Display Average":!0,"Display 1 Standard Deviation (1σ)":!1,"Display 2 Standard Deviation (2σ)":!1,"Display 3 Standard Deviation (3σ)":!1},outputs:{Average:"#00afed","1 Standard Deviation (1σ)":"#e1e1e1","2 Standard Deviation (2σ)":"#85c99e","3 Standard Deviation (3σ)":"#fff69e"}},correl:{name:"Correlation Coefficient",range:"-1 to 1",calculateFN:e.Studies.calculateCorrelationCoefficient,outputs:{}},PMO:{name:"Price Momentum Oscillator",calculateFN:e.Studies.calculatePMO,inputs:{Field:"field","Smoothing Period":35,"Double Smoothing Period":20,"Signal Period":10},outputs:{PMO:"auto",PMOSignal:"#FF0000"},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:2.5,studyOverBoughtColor:"auto",studyOverSoldValue:-2.5,studyOverSoldColor:"auto"}},attributes:{studyOverBoughtValue:{min:0,step:"0.05"},studyOverSoldValue:{max:0,step:"0.05"}}},"Rel Vol":{name:"Relative Volatility",range:"0 to 100",calculateFN:e.Studies.calculateRelativeVolatility,inputs:{Field:"field","STD Period":10,"Smoothing Period":14},outputs:{"Rel Vol":"auto"},centerline:50,parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:70,studyOverBoughtColor:"auto",studyOverSoldValue:30,studyOverSoldColor:"auto"}}},Awesome:{name:"Awesome Oscillator",seriesFN:e.Studies.displayAwesomeOscillator,calculateFN:e.Studies.calculateAwesomeOscillator,inputs:{},outputs:{"Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"}},"W MFI":{name:"Market Facilitation Index",seriesFN:e.Studies.displayMFI,calculateFN:e.Studies.calculateMFI,yAxis:{ground:!0},range:"0 to max",inputs:{"Scale Factor":6},outputs:{Green:"#8bc176",Fade:"#ab611f",Fake:"#5f7cb8",Squat:"#ffd0cf"}},"ATR Bands":{name:"ATR Bands",overlay:!0,seriesFN:e.Studies.displayChannel,calculateFN:e.Studies.calculateATRBands,inputs:{Period:5,Shift:3,Field:"field","Channel Fill":!0},outputs:{"ATR Bands Top":"auto","ATR Bands Bottom":"auto","ATR Bands Channel":"auto"},attributes:{Shift:{min:.1,step:.1}}},"STARC Bands":{name:"STARC Bands",overlay:!0,seriesFN:e.Studies.displayChannel,calculateFN:e.Studies.calculateSTARCBands,inputs:{Period:15,"MA Period":5,Multiplier:1.3,"Channel Fill":!0},outputs:{"STARC Bands Top":"auto","STARC Bands Median":"auto","STARC Bands Bottom":"auto"},attributes:{Multiplier:{min:.1,step:.1}}},"ATR Trailing Stop":{name:"ATR Trailing Stops",overlay:!0,seriesFN:e.Studies.displayPSAR2,calculateFN:e.Studies.calculateATRStops,inputs:{Multiplier:3,Period:21,"Plot Type":["points","squarewave"],HighLow:!1},outputs:{"Buy Stops":"#FF0000","Sell Stops":"#00FF00"},attributes:{Multiplier:{min:.1,step:.1}}},"Boll %b":{name:"Bollinger %b",calculateFN:e.Studies.calculateBollinger,inputs:{Field:"field",Period:20,"Standard Deviations":2,"Moving Average Type":"ma"},outputs:{"%b":"auto"},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:100,studyOverBoughtColor:"auto",studyOverSoldValue:0,studyOverSoldColor:"auto"}},attributes:{"Standard Deviations":{min:.1,step:.1}}},"Boll BW":{name:"Bollinger Bandwidth",calculateFN:e.Studies.calculateBollinger,inputs:{Field:"field",Period:20,"Standard Deviations":2,"Moving Average Type":"ma"},outputs:{Bandwidth:"auto"},attributes:{"Standard Deviations":{min:.1,step:.1}}},"Donchian Width":{name:"Donchian Width",calculateFN:e.Studies.calculateMaxHighMinLow,inputs:{"High Period":20,"Low Period":20}},"Rel Vig":{name:"Relative Vigor Index",seriesFN:e.Studies.displayHistogramWithSeries,calculateFN:e.Studies.calculateRelativeVigor,inputs:{Period:10},outputs:{"Rel Vig":"auto",RelVigSignal:"#FF0000","Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"}},"Elder Impulse":{name:"Elder Impulse System",calculateFN:e.Studies.calculateElderImpulse,seriesFN:e.Studies.displayElderImpulse,customRemoval:!0,underlay:!0,inputs:{},outputs:{Bullish:"#8BC176",Bearish:"#DD3E39",Neutral:"#5F7CB8"},removeFN:function(t,e){t.chart.customChart=null}},"Pivot Points":{name:"Pivot Points",overlay:!0,seriesFN:e.Studies.displayPivotPoints,calculateFN:e.Studies.calculatePivotPoints,inputs:{Type:["standard","fibonacci"],Continuous:!1,Shading:!1},outputs:{Pivot:"auto","Resistance 1":"rgb(184,44,11)","Support 1":"rgb(105,145,88)","Resistance 2":"rgb(227,100,96)","Support 2":"rgb(179,217,135)","Resistance 3":"rgb(255,208,207)","Support 3":"rgb(211,232,174)"},parameters:{init:{opacity:.2}}},VWAP:{name:"VWAP",overlay:!0,calculateFN:e.Studies.calculateVWAP,inputs:{},outputs:{VWAP:"#FF0000"}},Alligator:{name:"Alligator",overlay:!0,seriesFN:e.Studies.displayAlligator,calculateFN:e.Studies.calculateAlligator,inputs:{"Jaw Period":13,"Jaw Offset":8,"Teeth Period":8,"Teeth Offset":5,"Lips Period":5,"Lips Offset":3,"Show Fractals":!1},outputs:{Jaw:"#0000FF",Teeth:"#FF0000",Lips:"#00DD00"}},Gator:{name:"Gator Oscillator",seriesFN:e.Studies.displayGator,calculateFN:e.Studies.calculateAlligator,inputs:{"Jaw Period":13,"Jaw Offset":8,"Teeth Period":8,"Teeth Offset":5,"Lips Period":5,"Lips Offset":3},outputs:{"Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"},centerline:0},"Ichimoku Clouds":{name:"Ichimoku Clouds",overlay:!0,range:"bypass",calculateFN:e.Studies.calculateIchimoku,seriesFN:e.Studies.displayIchimoku,inputs:{"Conversion Line Period":9,"Base Line Period":26,"Leading Span B Period":52,"Lagging Span Period":26},outputs:{"Conversion Line":"#0000FF","Base Line":"#FF0000","Leading Span A":"#00FF00","Leading Span B":"#FF0000","Lagging Span":"#808000"}},"P Rel":{name:"Price Relative",initializeFN:e.Studies.initPriceRelative,seriesFN:e.Studies.displayVsComparisonSymbol,calculateFN:e.Studies.calculatePriceRelative,inputs:{"Comparison Symbol":"SPY"},deferUpdate:!0},"Perf Idx":{name:"Performance Index",centerline:1,initializeFN:e.Studies.initPriceRelative,seriesFN:e.Studies.displayVsComparisonSymbol,calculateFN:e.Studies.calculatePerformance,inputs:{Period:120,"Comparison Symbol":"SPY"},outputs:{Result:"auto",Gain:"#00DD00",Loss:"#FF0000"},deferUpdate:!0},Beta:{name:"Beta",centerline:1,initializeFN:e.Studies.initPriceRelative,seriesFN:e.Studies.displayVsComparisonSymbol,calculateFN:e.Studies.calculateBeta,inputs:{Period:20,"Comparison Symbol":"SPY"},deferUpdate:!0},Ulcer:{name:"Ulcer Index",calculateFN:e.Studies.calculateUlcerIndex,inputs:{Field:"field",Period:14}},"Bal Pwr":{name:"Balance of Power",range:"-1 to 1",calculateFN:e.Studies.calculateBalanceOfPower,inputs:{Period:14,"Moving Average Type":"ma"}},"Trend Int":{name:"Trend Intensity Index",calculateFN:e.Studies.calculateTrendIntensity,range:"0 to 100",inputs:{Field:"field",Period:14,"Signal Period":9},outputs:{TII:"auto",Signal:"#FF0000"},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:80,studyOverBoughtColor:"auto",studyOverSoldValue:20,studyOverSoldColor:"auto"}}},Choppiness:{name:"Choppiness Index",calculateFN:e.Studies.calculateChoppiness,centerline:50,parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:61.8,studyOverBoughtColor:"auto",studyOverSoldValue:38.2,studyOverSoldColor:"auto"}},attributes:{studyOverBoughtValue:{min:50,step:"0.1"},studyOverSoldValue:{max:50,step:"0.1"}}},Disparity:{name:"Disparity Index",calculateFN:e.Studies.calculateDisparity,inputs:{Field:"field",Period:14,"Moving Average Type":"ma"}},"Rainbow MA":{name:"Rainbow Moving Average",overlay:!0,calculateFN:e.Studies.calculateRainbow,seriesFN:e.Studies.displayRainbowMA,inputs:{Field:"field",Period:2,Underlay:!1},outputs:{SMA1:"#FF0000",SMA2:"#FF7F00",SMA3:"#FFFF00",SMA4:"#7FFF00",SMA5:"#00FF7F",SMA6:"#00FFFF",SMA7:"#007FFF",SMA8:"#0000FF",SMA9:"#7F00FF",SMA10:"#FF00FF"}},"Rainbow Osc":{name:"Rainbow Oscillator",calculateFN:e.Studies.calculateRainbow,seriesFN:e.Studies.displayRainbowOsc,inputs:{Field:"field",Period:2,"HHV/LLV Lookback":10},outputs:{"Positive Bar":"#00DD00","Negative Bar":"#FF0000"}},"Pring KST":{name:"Pring's Know Sure Thing",calculateFN:e.Studies.calculateKST,inputs:{Field:"field","Lightest Rate of Change Period":10,"Lightest SMA Period":10,"Light Rate of Change Period":15,"Light SMA Period":10,"Heavy Rate of Change Period":20,"Heavy SMA Period":10,"Heaviest Rate of Change Period":30,"Heaviest SMA Period":15,"Signal Period":9},outputs:{KST:"#00DD00",KSTSignal:"#FF0000"}},"Pring Sp-K":{name:"Pring's Special K",calculateFN:e.Studies.calculateSpecialK,inputs:{Field:"field",Interval:["daily","weekly"]}},Darvas:{name:"Darvas Box",underlay:!0,calculateFN:e.Studies.calculateDarvas,seriesFN:e.Studies.displayDarvas,inputs:{"ATH Lookback Period":100,"Exit Field":["close","high/low"],"Ghost Boxes":!0,"Stop Levels":!1,"Level Offset":.01,"Price Minimum":5,"Volume Spike":!1,"Volume % of Avg":400},outputs:{Darvas:"#5F7CB8",Ghost:"#699158",Levels:"auto"},customRemoval:!0,attributes:{"Price Minimum":{min:.01,step:.01}}},Supertrend:{name:"Supertrend",overlay:!0,seriesFN:e.Studies.displaySupertrend,calculateFN:e.Studies.calculateSupertrend,inputs:{Period:7,Multiplier:3},outputs:{Uptrend:"#8cc176",Downtrend:"#b82c0c"},attributes:{Multiplier:{min:.1,step:.1}}},"vol profile":{name:"Volume Profile",overlay:!0,seriesFN:e.Studies.displayVolumeProfile,calculateFN:null,inputs:{},outputs:{"Bars Color":"#b64a96"},customRemoval:!0,parameters:{init:{displayBorder:!0,displayVolume:!1,numberOfBars:30,widthPercentage:.25}}},Vortex:{name:"Vortex Indicator",calculateFN:e.Studies.calculateVortex,centerline:1,outputs:{"+VI":"#00FF00","-VI":"#FF0000"},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:1.1,studyOverBoughtColor:"auto",studyOverSoldValue:.9,studyOverSoldColor:"auto"}},attributes:{studyOverBoughtValue:{min:1,step:"0.01"},studyOverSoldValue:{max:1,step:"0.01"}}},ZigZag:{name:"ZigZag",overlay:!0,seriesFN:e.Studies.displayZigZag,calculateFN:e.Studies.calculateZigZag,inputs:{"Distance(%)":10},parameters:{init:{label:!1}},customRemoval:!0,attributes:{"Distance(%)":{min:.1,step:.1}}},PSY:{name:"Psychological Line",range:"0 to 100",calculateFN:e.Studies.calculatePsychologicalLine,inputs:{Period:20}},"MA Dev":{name:"Moving Average Deviation",calculateFN:e.Studies.calculateMADev,seriesFN:e.Studies.displayHistogramWithSeries,inputs:{Field:"field",Period:12,"Moving Average Type":"ma","Points Or Percent":["Points","Percent"]},outputs:{"Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"}},Shinohara:{name:"Shinohara Intensity Ratio",calculateFN:e.Studies.calculateShinohara,inputs:{Period:26},outputs:{"Strong Ratio":"#E99B54","Weak Ratio":"#5F7CB8"}}}),t},__core_=function(t,e){t.SplinePlotter||(t.SplinePlotter={});var i=t.CIQ,n=t.$$$,r=t.SplinePlotter,a=function(t,e,i,n){window.splineWarning||console.log("Warning: Cannot find implementation of splining.  Try loading splines.js"),window.splineWarning=1;var r=0;i.moveTo(t[0],t[1]);for(var a=2;a<t.length;a+=2){if(n&&r<n.length){var o=n[r];o.coord[0]==t[a-2]&&o.coord[1]==t[a-1]&&(i.stroke(),i.strokeStyle=o.color,i.setLineDash(o.pattern),i.lineDashOffset=0,i.beginPath(),i.moveTo(t[a-2],t[a-1]),r++)}i.lineTo(t[a],t[a+1])}};return t.SplinePlotter.plotSpline||(t.SplinePlotter.plotSpline=a),i.getETDateTime=function(){var t=new Date;return i.convertTimeZone(new Date(t.getTime()+6e4*t.getTimezoneOffset()),"UTC","America/New_York")},i.fromET=function(t){var e=new Date,i=4;(e.getMonth()<2||2==e.getMonth()&&e.getDate()<11||e.getMonth()>10||10==e.getMonth()&&e.getDate()>=4)&&(i=5);var n=t.getTime()+36e5*i;return new Date(n)},i.convertFutureMonth=function(t){var e=t.toString();if(e.length<=0||e.length>2)return"";switch(e){case"1":return"F";case"2":return"G";case"3":return"H";case"4":return"J";case"5":return"K";case"6":return"M";case"7":return"N";case"8":return"Q";case"9":return"U";case"10":return"V";case"11":return"X";case"12":return"Z";case"F":return"1";case"G":return"2";case"H":return"3";case"J":return"4";case"K":return"5";case"M":return"6";case"N":return"7";case"Q":return"8";case"U":return"9";case"V":return"10";case"X":return"11";case"Z":return"12"}return e},i.money=function(t,e,n){return n||(n="$"),3==n.length&&(n+=" "),e||0===e||(e=2),n+i.commas((Math.round(1e4*t)/1e4).toFixed(e))},i.convertCurrencyCode=function(t){var e={JPY:"¥",USD:"$",AUD:"A$",BRL:"R$",CAD:"CA$",CNY:"CN¥",CZK:"Kč",DKK:"kr",EUR:"€",GBP:"£",HKD:"HK$",HUF:"Ft",ILS:"₪",INR:"₹",KRW:"₩",MXN:"MX$",NOK:"kr",NZD:"NZ$",PLN:"zł",RUB:"руб",SAR:"﷼",SEK:"kr",SGD:"S$",THB:"฿",TRY:"₺",TWD:"NT$",VND:"₫",XAF:"FCFA",XCD:"EC$",XOF:"CFA",XPF:"CFPF",ZAR:"R"},i=e[t];return i||t},i.commas=function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},i.alert=function(t){alert(t)},i.withinElement=function(t,e,i){var n=t.getBoundingClientRect();return!(e<=n.left)&&(!(i<=n.top)&&(!(e>=n.left+t.offsetWidth)&&!(i>=n.top+t.offsetHeight)))},i.efficientDOMUpdate=function(t,e,i){t[e]!==i&&(t[e]=i)},i.safeMouseOut=function(t,e){t.addEventListener("mouseout",function(t,e){return function(n){void 0===n.pageX&&(n.pageX=n.clientX,n.pageY=n.clientY),i.withinElement(t,n.pageX,n.pageY)||(t.stxMouseOver=!1,e(n))}}(t,e))},i.safeMouseOver=function(t,e){t.addEventListener("mouseover",function(t,e){return function(n){if(void 0===n.pageX&&(n.pageX=n.clientX,n.pageY=n.clientY),i.withinElement(t,n.pageX,n.pageY)){if(t.stxMouseOver)return;t.stxMouseOver=!0,e(n)}}}(t,e))},i.installTapEvent=function(t,e){var n=function(t){var i=document.createEvent("Event");i.initEvent("stxtap",!0,!0),void 0===t.pageX&&(t.pageX=t.clientX,t.pageY=t.clientY),i.pageX=t.pageX,i.pageY=t.pageY,t.target.dispatchEvent(i),e&&e.stopPropagation&&t.stopPropagation()};i.safeClickTouch(t,n,e)},i.safeClickTouch=function(t,e,n){function r(t,n,r){return function(a){if(!i.safeClickTouchEvent){if(!r.t)return;var o=r.t;if(r.t=null,o+1e3<(new Date).getTime())return}if(!(n.safety&&n.safety.recentlyDragged||(a||(a=event),a.which&&a.which>=2||a.button&&a.button>=2))){if(n.preventUnderlayClick)"INPUT"!==a.target.tagName&&a.preventDefault();else{if(n.lastType!=t&&Date.now()<n.allowAnotherDevice)return;n.lastType=t,n.allowAnotherDevice=Date.now()+1e3}e(a)}}}function a(t,e){return function(i){var n=i.clientX?i.clientX:i.pageX,r=i.clientY?i.clientY:i.pageY;e?(t.t=(new Date).getTime(),t.x=n,t.y=r):t.x&&Math.pow(t.x-n,2)+Math.pow(t.y-r,2)>16&&(t.t=null)}}n||(n={});var o={};n.allowMultiple||i.clearSafeClickTouches(t),!1!==n.preventUnderlayClick&&(n.preventUnderlayClick=!0),!1!==n.absorbDownEvent&&(n.absorbDownEvent=!0),n.allowAnotherDevice=0,n.registeredClick=!1;var s=t.safeClickTouchEvents;s||(s=t.safeClickTouchEvents=[]);var l=r("mouseup",n,o),h=r("touchend",n,o),c=r("pointerup",n,o),u=function(t){t.stopPropagation()},p={};if(i.safeClickTouchEvent){var d=r(i.safeClickTouchEvent,n);t.addEventListener(i.safeClickTouchEvent,d),p[i.safeClickTouchEvent]=d,s.push(p)}else"onpointerup"in document?(t.addEventListener("pointerdown",a(o,!0)),t.addEventListener("pointermove",a(o)),t.addEventListener("pointerup",c),p.pointerup=c,n.absorbDownEvent&&(t.addEventListener("pointerdown",u),p.pointerdown=u),s.push(p)):(t.addEventListener("mousedown",a(o,!0)),t.addEventListener("mousemove",a(o)),t.addEventListener("touchstart",a(o,!0)),t.addEventListener("touchmove",a(o)),t.addEventListener("mouseup",l),t.addEventListener("touchend",h),p.mouseup=l,p.touchend=h,n.absorbDownEvent&&(t.addEventListener("mousedown",u),p.mousedown=u,t.addEventListener("touchstart",u),p.touchstart=u),s.push(p))},i.clearSafeClickTouches=function(t){var e=t.safeClickTouchEvents;if(e){for(var i=0;i<e.length;i++){var n=e[i];for(var r in n){var a=n[r];t.removeEventListener(r,a)}}t.safeClickTouchEvents=null}},i.safeDrag=function(t,e,n,r){function a(t){function a(t){if(t.touches){if(t.touches.length>=1)return t.touches[0].pageX;if(t.changedTouches&&t.changedTouches.length>=1)return t.changedTouches[0].pageX}return void 0===t.pageX?t.clientX:t.pageX}function u(t){if(t.touches){if(t.touches.length>=1)return t.touches[0].pageY;if(t.changedTouches&&t.changedTouches.length>=1)return t.changedTouches[0].pageY}return void 0===t.pageY?t.clientY:t.pageY}var p={mousedown:{move:"mousemove",up:"mouseup"},pointerdown:{move:"pointermove",up:"pointerup"},touchstart:{move:"touchmove",up:"touchend"}};return function(d){if(!s){s=!0,i.ChartEngine.ignoreTouch=!0;var f=function(t){t&&t.preventDefault&&t.preventDefault(),c.recentlyDragged=!0,t.displacementX=a(t)-l,t.displacementY=u(t)-h,n(t)};n&&document.body.addEventListener(p[t].move,f),document.body.addEventListener(p[t].up,function(e){i.ChartEngine.ignoreTouch=!1,n&&document.body.removeEventListener(p[t].move,f),document.body.removeEventListener(p[t].up,arguments.callee),e.displacementX=a(e)-l,e.displacementY=u(e)-h,r&&r(e),setTimeout(function(t){return function(){t.recentlyDragged=!1}}(c),50)}),setTimeout(function(){s=!1},o),l=a(d),h=u(d),e&&e(d)}}}var o=100,s=!1,l=0,h=0,c={recentlyDragged:!1};return t.addEventListener("mousedown",a("mousedown")),t.addEventListener("pointerdown",a("pointerdown")),t.addEventListener("touchstart",a("touchstart")),c},i.isSurface&&(i.gesture=new MSGesture,i.gesture.target=document.body,i.gesturePointerId=null),i.inputKeyEvents=function(t,e){t.addEventListener("keyup",function(i){switch(window.event?event.keyCode:i.keyCode){case 13:e();break;case 27:t.value=""}},!1)},i.fixScreen=function(){window.scrollTo(0,0)},i.setCaretPosition=function(t,e){if(t.style.zIndex=5e3,t.setSelectionRange){i.focus(t);try{t.setSelectionRange(e,e)}catch(t){}}else if(t.createTextRange){var n=t.createTextRange();n.collapse(!0),n.moveEnd("character",e),n.moveStart("character",e),n.select()}},i.setValueIfNotActive=function(t,e){document.activeElement!=t&&(t.value=e)},i.hideKeyboard=function(t){var e=document.activeElement;"INPUT"!=e.tagName&&"TEXTAREA"!=e.tagName||(e.blur(),window.focus(),t&&(t===document.body||document.body.contains(t))&&t.focus())},i.boxIntersects=function(t,e,n,r,a,o,s,l,h,c){function u(t,e){return(o-l)*t+(s-a)*e+(a*l-s*o)}var p=a,d=s;if(a>s&&(p=s,d=a),d>n&&(d=n),p<t&&(p=t),"segment"==h&&p>d)return!1;c&&(o=i.log10(o),l=i.log10(l),e=i.log10(e),r=i.log10(r));var f=o,m=l,g=s-a;if(Math.abs(g)>1e-7){var v=(l-o)/g,y=o-v*a;f=v*p+y,m=v*d+y}if(f>m){var b=m;m=f,f=b}if(m>e&&(m=e),f<r&&(f=r),"segment"==h)return f<=m;var x={a:u(t,e),b:u(t,r),c:u(n,e),d:u(n,r)};return!(x.a>0&&x.b>0&&x.c>0&&x.d>0)&&!(x.a<0&&x.b<0&&x.c<0&&x.d<0)},i.linesIntersect=function(t,e,i,n,r,a,o,s,l){var h=(s-o)*(e-t)-(a-r)*(n-i),c=(a-r)*(i-o)-(s-o)*(t-r),u=(e-t)*(i-o)-(n-i)*(t-r);if(0===h)return 0===c&&0===u;var p=c/h,d=u/h;if("segment"==l){if(p>=0&&p<=1&&d>=0&&d<=1)return!0}else if("line"==l||"horizontal"==l||"vertical"==l){if(p>=0&&p<=1)return!0}else if("ray"==l&&p>=0&&p<=1&&d>=0)return!0;return!1},i.yIntersection=function(t,e){var i=t.x0,n=t.x1,r=e,a=e,o=t.y0,s=t.y1,l=1e4*(n-i)-(a-r)*(s-o),h=(a-r)*(o-0)-1e4*(i-r),c=h/l;if(0===l){if(0!==h)return null;c=1}return o+c*(s-o)},i.xIntersection=function(t,e){var i=t.x0,n=t.x1,r=t.y0,a=t.y1,o=e,s=e,l=(s-o)*(n-i)-1e4*(a-r),h=1e4*(r-o)-(s-o)*(i-0),c=h/l;if(0===l){if(0!==h)return null;c=1}return i+c*(n-i)},i.intersectLineLineX=function(t,e,i,n,r,a,o,s){return t+((a-r)*(i-o)-(s-o)*(t-r))/((s-o)*(e-t)-(a-r)*(n-i))*(e-t)},i.intersectLineLineY=function(t,e,i,n,r,a,o,s){return i+((a-r)*(i-o)-(s-o)*(t-r))/((s-o)*(e-t)-(a-r)*(n-i))*(n-i)},i.privateBrowsingAlert=!1,i.localStorage="undefined"!=typeof localStorage?localStorage:{},i.localStorageSetItem=function(t,e){try{i.localStorage.setItem(t,e)}catch(t){i.privateBrowsingAlert||(i.alert("No storage space available.  Possible causes include browser being in Private Browsing mode, or maximum storage space has been reached."),i.privateBrowsingAlert=!0)}},i.loadUI=function(t,e){var n=document.createElement("iframe"),r=function(){var t=null;try{t=n.contentDocument||n.contentWindow.document}catch(t){return e(t)}if(t&&!t.title){var r=t.body.innerHTML,a=document.createElement("div");document.body.removeChild(n),i.innerHTML(a,r);for(var o=0;o<a.children.length;o++){var s=a.children[o].cloneNode(!0);document.body.appendChild(s)}e(null)}else e(new Error("iFrame not found or document has a title"))};n.src=t+"?"+i.uniqueID(),n.hidden=!0,n.addEventListener("load",r,!1),document.body.appendChild(n)},i.loadScript=function(t,e){if(i.loadedScripts||(i.loadedScripts={}),i.loadedScripts[t])return void(e&&e());var n=document.createElement("SCRIPT");n.async=!0,n.onload=function(){i.loadedScripts[t]=!0,e&&e()},"undefined"!=typeof isIE8&&(n.onreadystatechange=function(){"loaded"==n.readyState&&(i.loadedScripts[t]=!0,e&&setTimeout(e,0))});var r=t;r=-1==r.indexOf("?")?r+"?"+Date.now():r+"&"+Date.now(),n.src=r;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(n,a.nextSibling)},i.loadStylesheet=function(t,e){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.media="screen",i.href=t+"?"+Date.now(),i.onload=function(){this.loaded||(this.loaded=!0,e&&e())};var n=document.getElementsByTagName("link"),r=n[n.length-1];r.parentNode.insertBefore(i,r.nextSibling)},i.loadWidget=function(t,e){i.loadStylesheet(t+".css",function(){i.loadUI(t+".html",function(n){n?e(n):i.loadScript(t+".js",e)})})},i.fillTransparentCanvas=function(t,e,i,n){var r=t.globalCompositeOperation;t.globalCompositeOperation="destination-over",t.fillStyle=e,t.fillRect(0,0,i,n),t.globalCompositeOperation=r},i.tickedRect=function(t){i.rect(t);var e=Math.round(t.top+t.height/2)+.5;t.ctx.beginPath(),t.ctx.moveTo(t.x-2,e),t.ctx.lineTo(t.x,e),t.ctx.stroke(),t.ctx.closePath()},i.roundRect=function(t,e){9===arguments.length&&(t={ctx:arguments[0],x:arguments[1],top:arguments[2],width:arguments[3],height:arguments[4],radius:arguments[5],fill:arguments[6],stroke:arguments[7],edge:arguments[8]});var n=t.stroke,r=t.x,a=t.top,o=t.width,s=t.height,l=t.radius,h=t.fill,c=t.ctx;void 0===n&&(n=!0),void 0===l&&(l=5,o<0&&(l=-5));var u=o<0?-1*l:l;l&&!e&&(r-=1);var p=r+l,d=r+o,f=a+u,m=a+s,g=d-l,v=m-u;if(c.beginPath(),c.moveTo(p,a),c.lineTo(g,a),c.quadraticCurveTo(d,a,d,f),c.lineTo(d,v),c.quadraticCurveTo(d,m,g,m),c.lineTo(p,m),"flush"==e)c.lineTo(r,m),c.lineTo(r,a);else if("arrow"==e){c.quadraticCurveTo(r,m,r-l,v);var y=o<0?1:-1;c.lineTo(r+s/2*y,a+s/2),c.lineTo(r-l,f),c.quadraticCurveTo(r,a,p,a)}else c.quadraticCurveTo(r,m,r,v),c.lineTo(r,f),c.quadraticCurveTo(r,a,p,a);c.closePath(),t.backgroundColor&&(c.fillStyle=t.backgroundColor),n&&c.stroke(),h&&c.fill(),t.txt&&i.createLabel(t)},i.createLabel=function(t){t.ctx.textBaseline="middle",t.ctx.fillStyle=t.color?t.color:i.chooseForegroundColor(t.backgroundColor),t.ctx.fillStyle===t.backgroundColor&&("#FFFFFF"==t.backgroundColor.toUpperCase()?t.ctx.fillStyle="#000000":t.ctx.fillStyle="#FFFFFF"),t.ctx.fillText(t.txt,t.x+t.margin.left,t.y+t.margin.top),t.ctx.textAlign="left"},i.roundRectArrow=function(t){i.roundRect(t,"arrow")},i.semiRoundRect=function(t){i.roundRect(t,"flush")},i.rect=function(t){t.radius=0,i.roundRect(t)},i.noop=function(t){i.createLabel(t)},i.getLines=function(t,e,i){for(var n=e.split(" "),r=[],a="",o=0,s=!1,l=0;l<n.length;l++){var h=n[l];if(o=t.measureText(a+h).width,o<i?(s&&(a+=" "),s=!0,a+=h):(r.push(a),a=h),l===n.length-1){r.push(a);break}}return r},i.readablePeriodicity=function(t){var e=t.layout.periodicity,i=t.layout.interval;return"number"==typeof t.layout.interval&&t.layout.timeUnit?(e=t.layout.interval*t.layout.periodicity,i=t.layout.timeUnit):"number"!=typeof t.layout.interval||t.layout.timeUnit||(e=t.layout.interval*t.layout.periodicity,i="minute"),e%60==0&&"minute"==i&&(e/=60,i="hour"),e+" "+t.translateIf(i.capitalize())},i.translatableTextNode=function(t,e,i){if(t.translationCallback){var n=document.createElement("translate");return n.setAttribute("original",e),n.innerHTML=t.translationCallback(e,i),n}return document.createTextNode(e)},i.clearCanvas=function(t,e){t.isDirty=!1;var n=t.context;if(n.clearRect(0,0,t.width,t.height),i.isAndroid&&!i.is_chrome){i.ChartEngine.useOldAndroidClear&&e&&(n.fillStyle=e.containerColor,n.fillRect(0,0,t.width,t.height),n.clearRect(0,0,t.width,t.height));var r=t.width;t.width=1,t.width=r}},i.monthLetters=["J","F","M","A","M","J","J","A","S","O","N","D"],i.monthAbv=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i.MILLISECOND=1,i.SECOND=1e3,i.MINUTE=60*i.SECOND,i.HOUR=60*i.MINUTE,i.DAY=24*i.HOUR,i.WEEK=7*i.DAY,i.MONTH=31*i.DAY,i.YEAR=366*i.DAY,i.DECADE=10*i.YEAR-7*i.DAY,i.monthAsDisplay=function(t,e,n){return e?n&&n.monthLetters?n.monthLetters[t]:i.monthLetters[t]:n&&n.monthAbv?n.monthAbv[t]:i.monthAbv[t]},i.timeAsDisplay=function(t,e,n){var r=e?e.internationalizer:null;if(r)return n==i.SECOND?r.hourMinuteSecond.format(t):n==i.MILLISECOND?r.hourMinuteSecond.format(t)+"."+t.getMilliseconds():r.hourMinute.format(t);var a=t.getMinutes();a<10&&(a="0"+a);var o=t.getHours()+":"+a,s="";if(n<=i.SECOND&&(s=t.getSeconds(),s<10&&(s="0"+s),o+=":"+s),n==i.MILLISECOND){var l=t.getMilliseconds();l<10?l="00"+l:l<100&&(l="0"+l),o+="."+l}return o},i.displayableDate=function(t,e,n){function r(t){return t<10?"0"+t:t}var a="",o=t.layout.interval,s=i.ChartEngine.isDailyInterval(o);if(e.xAxis.formatter)a=e.xAxis.formatter(n);else if(t.internationalizer)a=t.internationalizer.monthDay.format(n),s?a="month"==o?t.internationalizer.yearMonth.format(n):t.internationalizer.yearMonthDay.format(n):a+=" "+t.internationalizer.hourMinute.format(n);else{var l=r(n.getMonth()+1),h=r(n.getDate()),c=r(n.getHours()),u=r(n.getMinutes());if(s)a="month"==o?l+"-":l+"-"+h+"-",a+=n.getFullYear();else{a=l+"/"+h+" "+c+":"+u;var p=e.xAxis.activeTimeUnit&&e.xAxis.activeTimeUnit<=i.SECOND||"second"==t.layout.timeUnit,d=e.xAxis.activeTimeUnit&&e.xAxis.activeTimeUnit<=i.MILLISECOND||"millisecond"==t.layout.timeUnit;if(p||d){var f=r(n.getSeconds());if(a+=":"+f,d){var m=r(n.getMilliseconds());m<100&&(m="0"+m),a+=":"+m}}}}return a},i.fixPrice=function(t){if(!t&&0!==t)return null;for(var e=t.toFixed(10),i=e.length-1;i>1&&"0"==e.charAt(i);i--);return e=e.substring(0,i+1),parseFloat(e)},i.condenseInt=function(t){return null===t||void 0===t?"":t===1/0||t===-1/0?"n/a":t=t>0?t>1e12?Math.round(t/1e11)/10+"t":t>1e11?Math.round(t/1e9)+"b":t>1e10?(Math.round(t/1e8)/10).toFixed(1)+"b":t>1e9?(Math.round(t/1e7)/100).toFixed(2)+"b":t>1e8?Math.round(t/1e6)+"m":t>1e7?(Math.round(t/1e5)/10).toFixed(1)+"m":t>1e6?(Math.round(t/1e4)/100).toFixed(2)+"m":t>1e5?Math.round(t/1e3)+"k":t>1e4?(Math.round(t/100)/10).toFixed(1)+"k":t>1e3?(Math.round(t/10)/100).toFixed(2)+"k":t.toString():t<-1e12?Math.round(t/1e11)/10+"t":t<-1e9?Math.round(t/1e8)/10+"b":t<-1e6?Math.round(t/1e5)/10+"m":t<-1e3?Math.round(t/100)/10+"k":t.toString()},i.calculateTradingDecimalPlaces=function(t){var e=t.chart,i=2,n=e.masterData;if(n&&n.length>50)for(var r=2;r<50;r++){var a=n.length-r;if(a<0)break;var o=n[a];if(o.Close&&"number"==typeof o.Close){var s=o.Close.toString(),l=s.indexOf(".");if(-1!=l){var h=s.length-l-1;h>i&&(i=h)}}}var c=e.yAxis.maxDecimalPlaces;return i>c&&(i=c),i},i.fillArea=function(t,e,i){if(e.length){var n=t.chart.context,a=n.globalAlpha,o=arguments[2],s=arguments[3],l=arguments[4],h=0;i&&"object"==(void 0===i?"undefined":_typeof(i))&&(o=i.color,s=i.opacity,h=i.tension,l=i.panelName),s||0===s||(s=.2),"auto"==o&&(o=t.defaultColor),n.globalAlpha=s,o&&(n.fillStyle=o);var c=Number.MAX_VALUE,u=-1*c,p=t.panels[l];p&&(u=p.yAxis.top,c=p.yAxis.bottom,n.save(),n.beginPath(),n.rect(p.left,u,p.width,c-u),n.clip()),n.beginPath();var d;if(h){var f=[];for(d=0;d<e.length-2;d++)f.push(e[d][0],e[d][1]);for(r.plotSpline(f,h,n),d=e.length-2;d<e.length;d++)n.lineTo(Math.round(e[d][0]),Math.round(e[d][1]))}else for(n.moveTo(e[0][0],e[0][1]),d=1;d<e.length;d++)n.lineTo(e[d][0],e[d][1]);n.closePath(),n.fill(),p&&n.restore(),n.globalAlpha=a}},i.prepareChannelFill=function(t,e){(!e||e instanceof Array)&&(e=arguments[2]);for(var n=t.panels[e.panelName],r=(n.yAxis,t.chart),a=(r.context.strokeStyle,i.extend({noDraw:!0,gaps:{}},e)),o=t.plotDataSegmentAsLine(e.topBand,n,a),s=t.plotDataSegmentAsLine(e.bottomBand,n,a),l=[],h=0;h<o.points.length;h+=2)l.push([o.points[h],o.points[h+1]]);for(var c=s.points.length-1;c>=0;c-=2)l.push([s.points[c-1],s.points[c]]);i.fillArea(t,l,e)},i.preparePeakValleyFill=function(t,e){(!e||e instanceof Array)&&(e=arguments[2]);var n=t.panels[e.panelName],r=n.yAxis,a=t.chart,o=(a.context.strokeStyle,t.plotDataSegmentAsLine(e.band,n,i.extend({noDraw:!0,gaps:{}},e))),s=e.threshold,l=e.direction,h=e.reverse,c=e.gaps;e.yAxis&&(r=e.yAxis);var u=-Number.MAX_VALUE,p=Number.MAX_VALUE,d=h?u:p;(s||0===s)&&(d=t.pixelFromPrice(s,n,r));for(var f=[],m=o.points.length,g=0;g<m;g+=2){var v,y,b=o.points[g],x=o.points[g+1];x>d&&l>0||x<d&&l<0||(f.push([b,x]),u=Math.max(x,u),p=Math.min(x,p)),g<m-3&&(v=o.points[g+2],y=o.points[g+3],(x<d&&y>d||x>d&&y<d)&&(b+=(d-x)*(v-b)/(y-x),f.push([b,d])))}if(m=f.length){if(e.edgeHighlight){var w=e.edgeParameters;w.lineWidth>100&&(w.lineWidth=1);for(var C=0;C<m-1;C++){var S=f[C],T=f[C+1];if(S[1]!=d||T[1]!=d){if(S[0]==T[0]&&t.layout.candleWidth>=1){if(S[1]==d&&f[C-1]&&f[C-1][1]==d)continue;if(T[1]==d&&f[C+2]&&f[C+2][1]==d)continue}t.plotLine(S[0],T[0],S[1],T[1],e.edgeHighlight,"segment",a.context,!0,w)}}}s||0===s||(d=h?Math.min(p,r.top):Math.max(u,r.bottom)),f.push([f[m-1][0],d],[f[0][0],d]);var _=e.opacity;if(_||0===_||(e.opacity=.3),i.fillArea(t,f,e),c&&c.color&&c.fillMountain&&!e.tension&&!i.isTransparent(c.color)&&!i.isTransparent(e.color)){a.context.fillStyle instanceof CanvasGradient?a.context.fillStyle.addColorStop(0,c.color):a.context.fillStyle=c.color;var k=[],D={opacity:e.opacity,panelName:e.panelName};for(g=0;g<o.gapAreas.length;g++){var M=o.gapAreas[g],E=M.start,A=M.end,P=M.threshold;E?k=[[E[0],E[1]],[E[0],P]]:k.push([A[0],P],[A[0],A[1]]),4==k.length&&i.fillArea(t,k,D)}}e.opacity=_}},i.fillIntersecting=function(t,e,n){(!n||n instanceof Array)&&(n=arguments[3]);var r=n.topBand,a=n.bottomBand,o=n.topColor,s=n.bottomColor,l=e;l.panel&&(l.outputs&&l.outputMap&&(o||(o=l.outputs[l.outputMap[r]]),s||(s=l.outputs[l.outputMap[a]])),l=l.panel),l=t.panels[l];var h=t.chart.context,c=t.scratchContext;if(!c){var u=h.canvas.cloneNode(!0);c=t.scratchContext=u.getContext("2d"),c.canvas=u}c.canvas.height=h.canvas.height,c.canvas.width=h.canvas.width,c.drawImage(h.canvas,0,0),h.clearRect(0,0,h.canvas.width,h.canvas.height);var p=.3;n.opacity&&(p=n.opacity),h.save(),h.globalCompositeOperation="xor";var d={band:r,color:o,opacity:1,panelName:l.name,yAxis:n.topAxis,skipTransform:n.skipTransform};i.preparePeakValleyFill(t,d),i.extend(d,{band:a,color:s,yAxis:n.bottomAxis}),i.preparePeakValleyFill(t,d),h.globalAlpha=p,h.globalCompositeOperation="copy",h.scale(1/t.adjustedDisplayPixelRatio,1/t.adjustedDisplayPixelRatio),h.drawImage(h.canvas,0,0),h.globalAlpha=1,h.globalCompositeOperation="destination-over",h.drawImage(t.scratchContext.canvas,0,0),h.restore()},i.drawLegendItem=function(t,e,i,n,r){r||(r=1);var a=e[0],o=e[1],s=t.chart.context;return s.globalAlpha=r,s.fillStyle=n,s.fillRect(a,o,10,10),s.globalAlpha=1,a+=12,s.fillStyle=t.defaultColor,s.fillText(i,a,o),a+=s.measureText(i).width+6,[a,o]},i.drawLegend=function(t,e){var n=e.coordinates,r=t.chart.context;r.textBaseline="top";var a=r.font;t.canvasFont("stx-legend",r),n||(n=e.chart.legend);var o=[n.x,n.y],s=t.defaultColor,l=t.layout.chartType;if(t.chart.customChart&&t.chart.customChart.chartType&&(l=t.chart.customChart.chartType),!e.noBase){var h;if(t.chart.baseLegendColors instanceof Array){var c=t.chart.baseLegendColors;if(c.length>1){var u=r.createLinearGradient(o[0],o[1],o[0]+10,o[1]);for(h=0;h<c.length;h++)u.addColorStop(h/(c.length-1),c[h]);s=u}else s=c.length>0?c[0]:t.getCanvasColor("stx_line_chart")}else if("mountain"==l){h=t.canvasStyle("stx_mountain_chart");var p=h.borderTopColor;p&&"transparent"!=p&&(s=p)}else s=null;if(s){var d;d=e.chart.symbolDisplay?e.chart.symbolDisplay:e.chart.symbol,o=i.drawLegendItem(t,o,d,s)}}for(var f in e.legendColorMap){var m=f;e.legendColorMap[f].display&&(m=e.legendColorMap[f].display),o=i.drawLegendItem(t,o,m,e.legendColorMap[f].color,e.legendColorMap[f].opacity)}r.font=a},i.minMax=function(t,e){for(var i=Number.MAX_VALUE,n=-1*Number.MAX_VALUE,r=0;r<t.length;r++){var a=t[r];if(a){var o=a[e];(o||0===o)&&(isNaN(o)||(i=Math.min(i,o),n=Math.max(n,o)))}}return[i,n]},i.destroy=function(t,e){for(var r=i.ChartEngine.registeredContainers,a=0;a<r.length;a++)if(r[a]==t.chart.container){r.splice(a,1);break}if(t.styles={},t.destroy(),t=null,i.ThemeManager&&i.ThemeManager.destroy(),i.MenuManager&&i.MenuManager.destroy(),e){for(var o=n(".stx-wrapper").childNodes,s=n(".stx-wrapper").querySelectorAll(e),l=0;l<s.length;l++)s[l].parentNode==n(".stx-wrapper")&&i.appendClassName(s[l],"stx-passover");for(var h=o.length-1;h>=0;h--)i.hasClassName(o[h],"stx-passover")?i.unappendClassName(o[h],"stx-passover"):o[h].parentNode.removeChild(o[h])}else n(".stx-wrapper").parentNode.removeChild(n(".stx-wrapper"))},i.symbolEqual=function(t,e){if(!t||!e)return!1;if("object"!=(void 0===t?"undefined":_typeof(t))&&(t={symbol:t}),"object"!=(void 0===e?"undefined":_typeof(e))&&(e={symbol:e}),"function"==typeof t.equals)return t.equals(e);var i=t.symbol,n=e.symbol;return i&&(i=i.toUpperCase()),n&&(n=n.toUpperCase()),i==n&&t.source==e.source},i.addMemberToMasterdata=function(t){function e(t,e){if(o&&o.length)if("*"==o[0])i.extend(t,e);else for(var n=0;n<o.length;n++)t[o[n]]=e[o[n]];else s?t[r]=e:l?t[r]=e[l]:v&&g&&void 0!==e[g]?t[r]=e[g]:m.adj&&void 0!==e.Adj_Close?t[r]=e.Adj_Close:void 0!==e.Close?t[r]=e.Close:void 0!==e.Value?t[r]=e.Value:t[r]=e[r]}t.constructor===i.ChartEngine&&(t={stx:arguments[0],label:arguments[1],data:arguments[2],fields:arguments[3],createObject:arguments[4],fieldForLabel:arguments[5]});var n=t.stx,r=t.label,a=t.data,o=t.fields,s=t.createObject,l=t.fieldForLabel;if(a&&a.constructor==Object&&(a=[a]),a&&a.length){n.doCleanupDates(a,n.layout.interval);var h,c,u=t.chart?t.chart:n.chart,p=0,d=0,f=u.masterData,m=n.layout;f||(f=[]);for(var g=n.chart&&n.chart.defaultPlotField?n.chart.defaultPlotField:null,v=!n.highLowBars[n.layout.chartType];a&&p<f.length&&d<a.length;)c=a[d],h=f[p],c.DT&&void 0!==c.DT?("number"==typeof c.DT&&(c.DT=new Date(c.DT)),c.Date&&17==c.Date.length||(c.Date=i.yyyymmddhhmmssmmm(c.DT))):c.DT=i.strToDateTime(c.Date),+c.DT!=+h.DT?c.DT<h.DT?f.splice(p,0,{DT:c.DT,Date:c.Date}):p++:(e(h,c),d++,p++);if(p>=f.length)for(;a&&d<a.length;)c=a[d],c.DT&&void 0!==c.DT?("number"==typeof c.DT&&(c.DT=new Date(c.DT)),c.Date&&17==c.Date.length||(c.Date=i.yyyymmddhhmmssmmm(c.DT))):c.DT=i.strToDateTime(c.Date),h={DT:c.DT,Date:c.Date},e(h,c),f.push(h),d++;if(t.fillGaps&&f.length)for(var y=f[0],b=1;b<f.length;b++){var x=f[b];if(o)for(var w=0;w<o.length;w++){var C=o[w];void 0===x[C]&&(x[C]=y[C])}else void 0===x[r]&&(x[r]=y[r]);y=x}u.series[r]&&(u.series[r].lastQuote=h[r]),n.setMasterData(f,u)}},i.ThemeHelper=function(t){this.params=t;var e=t.stx,n="#FFFFFF";e.chart.container&&(n=getComputedStyle(e.chart.container).backgroundColor,i.isTransparent(n)&&(n=e.containerColor)),this.settings.chart.Background.color=i.hexToRgba(n),this.settings.chart["Grid Lines"].color=i.hexToRgba(e.canvasStyle("stx_grid").color),this.settings.chart["Grid Dividers"].color=i.hexToRgba(e.canvasStyle("stx_grid_dark").color),this.settings.chart["Axis Text"].color=i.hexToRgba(e.canvasStyle("stx_xaxis").color),this.settings.chartTypes["Candle/Bar"].up.color=i.hexToRgba(e.canvasStyle("stx_candle_up").color),this.settings.chartTypes["Candle/Bar"].down.color=i.hexToRgba(e.canvasStyle("stx_candle_down").color),this.settings.chartTypes["Candle/Bar"].up.wick=i.hexToRgba(e.canvasStyle("stx_candle_shadow_up").color),this.settings.chartTypes["Candle/Bar"].down.wick=i.hexToRgba(e.canvasStyle("stx_candle_shadow_down").color),this.settings.chartTypes["Candle/Bar"].up.border=i.hexToRgba(e.canvasStyle("stx_candle_up").borderLeftColor),this.settings.chartTypes["Candle/Bar"].down.border=i.hexToRgba(e.canvasStyle("stx_candle_down").borderLeftColor),i.isTransparent(e.canvasStyle("stx_candle_up").borderLeftColor)&&(this.settings.chartTypes["Candle/Bar"].up.border=null),i.isTransparent(e.canvasStyle("stx_candle_down").borderLeftColor)&&(this.settings.chartTypes["Candle/Bar"].down.border=null),this.settings.chartTypes.Line.color=i.hexToRgba(e.canvasStyle("stx_line_chart").color),this.settings.chartTypes.Mountain.color=i.hexToRgba(e.canvasStyle("stx_mountain_chart").backgroundColor)},i.ThemeHelper.prototype.settings={chart:{Background:{color:null},"Grid Lines":{color:null},"Grid Dividers":{color:null},"Axis Text":{color:null}},chartTypes:{"Candle/Bar":{up:{color:null,wick:null,border:null},down:{color:null,wick:null,border:null}},Line:{color:null},Mountain:{color:null}}},i.ThemeHelper.prototype.update=function(t){function e(e,i,r){var a=n[e];for(var o in a)t.setStyle(o,i,r)}t||(t=this.params.stx);var n={stx_candle_up:{stx_candle_up:!0,stx_bar_up:!0,stx_hollow_candle_up:!0,stx_line_up:!0,stx_baseline_up:!0},stx_candle_down:{stx_candle_down:!0,stx_bar_down:!0,stx_hollow_candle_down:!0,stx_line_down:!0,stx_baseline_down:!0},stx_shadow_up:{stx_candle_shadow_up:!0},stx_shadow_down:{stx_candle_shadow_down:!0},stx_line_chart:{stx_bar_chart:!0,stx_line_chart:!0},stx_grid:{stx_grid:!0},stx_grid_dark:{stx_grid_dark:!0},stx_xaxis:{stx_xaxis_dark:!0,stx_xaxis:!0,stx_yaxis:!0,stx_yaxis_dark:!0,stx_grid_border:!0},stx_mountain_chart:{stx_mountain_chart:!0},stx_market_session:{stx_market_session:!0}};t.chart.container.style.backgroundColor=this.settings.chart.Background.color,e("stx_grid","color",this.settings.chart["Grid Lines"].color),e("stx_grid_dark","color",this.settings.chart["Grid Dividers"].color),e("stx_xaxis","color",this.settings.chart["Axis Text"].color),e("stx_candle_up","color",this.settings.chartTypes["Candle/Bar"].up.color),e("stx_candle_down","color",this.settings.chartTypes["Candle/Bar"].down.color),e("stx_shadow_up","color",this.settings.chartTypes["Candle/Bar"].up.wick),e("stx_shadow_down","color",this.settings.chartTypes["Candle/Bar"].down.wick),t.setStyle("stx_candle_up","borderLeftColor",this.settings.chartTypes["Candle/Bar"].up.border),t.setStyle("stx_candle_down","borderLeftColor",this.settings.chartTypes["Candle/Bar"].down.border),e("stx_line_chart","color",this.settings.chartTypes.Line.color),t.setStyle("stx_mountain_chart","borderTopColor",this.settings.chartTypes.Mountain.color),t.setStyle("stx_mountain_chart","backgroundColor",i.hexToRgba(this.settings.chartTypes.Mountain.color,.8)),t.setStyle("stx_mountain_chart","color",i.hexToRgba(this.settings.chartTypes.Mountain.color,.1)),t.draw()},i.NameValueStore=function(){},i.NameValueStore.prototype.toJSONIfNecessary=function(t){if(t.constructor==String)return t;try{return JSON.stringify(t)}catch(e){return console.log("Cannot convert to JSON: "+t),null}},i.NameValueStore.prototype.fromJSONIfNecessary=function(t){try{return JSON.parse(t)}catch(e){return t}},i.NameValueStore.prototype.get=function(t,e){var n=i.localStorage.getItem(t);e&&e(null,this.fromJSONIfNecessary(n))},i.NameValueStore.prototype.set=function(t,e,n){i.localStorageSetItem(t,this.toJSONIfNecessary(e)),n&&n(null)},i.NameValueStore.prototype.remove=function(t,e){i.localStorage.removeItem(t),e&&e(null)},i.Plotter=function(){this.seriesArray=[],this.seriesMap={}},i.Plotter.prototype={Series:function(t,e,n,r,a,o){this.name=t,this.strokeOrFill=e,this.color=n,this.moves=[],this.text=[],(!r||r>1||r<0)&&(r=1),this.opacity=r,(!a||a>25||a<1)&&(a=1),this.width=a,this.pattern=i.borderPatternToArray(a,o)},newSeries:function(t,e,i,n,r){var a;a=i.constructor==String?new this.Series(t,e,i,n,r):new this.Series(t,e,i.color,i.opacity,r,i.borderTopStyle),this.seriesArray.push(a),this.seriesMap[t]=a},reset:function(t){for(var e in this.seriesMap)if(!t||t==e){var i=this.seriesMap[e];i&&(i.moves=[],i.text=[])}},moveTo:function(t,e,i){this.seriesMap[t].moves.push({action:"moveTo",x:e,y:i})},lineTo:function(t,e,i){var n=this.seriesMap[t],r=n.pattern;n.moves.push({action:"lineTo",x:e,y:i,pattern:r})},dashedLineTo:function(t,e,i,n){this.seriesMap[t].moves.push({action:"lineTo",x:e,y:i,pattern:n})},quadraticCurveTo:function(t,e,i,n,r){var a=this.seriesMap[t],o=a.pattern;a.moves.push({action:"quadraticCurveTo",x0:e,y0:i,x:n,y:r,pattern:o})},bezierCurveTo:function(t,e,i,n,r,a,o){var s=this.seriesMap[t],l=s.pattern;s.moves.push({action:"bezierCurveTo",x0:e,y0:i,x1:n,y1:r,x:a,y:o,pattern:l})},addText:function(t,e,i,n,r,a,o){this.seriesMap[t].text.push({text:e,x:i,y:n,bg:r})},drawText:function(t,e){for(var i=0;i<e.text.length;i++){var n=e.text[i];if(n.bg){var r=n.width?n.width:t.measureText(n.text).width,a=n.height?n.height:12,o=t.fillStyle;t.fillStyle=n.bg,"right"==t.textAlign?t.fillRect(n.x,n.y+a/2,-r,-a):t.fillRect(n.x,n.y+a/2,r,a),t.fillStyle=o}t.fillText(n.text,n.x,n.y)}},draw:function(t,e){for(var i=t.lineWidth,n=t.fillStyle,r=t.strokeStyle,a=t.globalAlpha,o=0;o<this.seriesArray.length;o++){var s=this.seriesArray[o];if(!e||s.name==e){t.beginPath(),t.lineWidth=s.width,t.globalAlpha=s.opacity,t.fillStyle=s.color,t.strokeStyle=s.color,t.save();for(var l=0;l<s.moves.length;l++){var h=s.moves[l];h.pattern?(t.setLineDash(h.pattern),t.lineDashOffset=0):t.setLineDash([]),"quadraticCurveTo"==h.action?t[h.action](h.x0,h.y0,h.x,h.y):"bezierCurveTo"==h.action?t[h.action](h.x0,h.y0,h.x1,h.y1,h.x,h.y):t[h.action](h.x,h.y)}"fill"==s.strokeOrFill?t.fill():t.stroke(),t.closePath(),t.restore(),this.drawText(t,s),t.lineWidth=1}}t.lineWidth=i,t.fillStyle=n,t.strokeStyle=r,t.globalAlpha=a}},i.EaseMachine=function(t,e,i,n){this.fc=t,this.ms=e,(i||0===i)&&this.reset(i,n)},i.EaseMachine.prototype.reset=function(t,e){t||0===t||(t=this.currentValues),this.hasCompleted=!1,this.running=!1,this.okayToRun=!0,this.useNameValuePairs="object"==(void 0===e?"undefined":_typeof(e)),this.startTime=Date.now(),this.useNameValuePairs?(this.startValues=t,this.endValues=e):(this.startValues={default:t},this.endValues={default:e}),this.changeValues={},this.currentValues={};for(var i in this.startValues)this.changeValues[i]=this.endValues[i]-this.startValues[i]},i.EaseMachine.prototype.next=function(){var t=Date.now();t>=this.startTime+this.ms&&(t=this.startTime+this.ms,this.hasCompleted=!0,this.running=!1),this.currentValues={};for(var e in this.changeValues)this.currentValues[e]=this.fc(t-this.startTime,this.startValues[e],this.changeValues[e],this.ms);return this.useNameValuePairs?this.currentValues:this.currentValues.default},i.EaseMachine.prototype.hasCompleted=!0,i.EaseMachine.prototype.run=function(t,e,i,n){function r(){if(a.afid=null,a.okayToRun){var e=a.next();t(e),a.hasCompleted||(a.afid=requestAnimationFrame(r))}}this.afid&&cancelAnimationFrame(this.afid),this.running=!0,e||0===e?this.reset(e,i):(i||0===i)&&this.reset(this.currentValues,i);var a=this;n?this.afid=requestAnimationFrame(r):r()},i.EaseMachine.prototype.stop=function(){return this.afid&&cancelAnimationFrame(this.afid),this.afid=null,this.okayToRun=!1,this.running=!1,void 0===this.useNameValuePairs?{}:this.useNameValuePairs?this.currentValues:this.currentValues.default},i.Renderer=function(){},i.Renderer.prototype.performCalculations=function(){},i.Renderer.prototype.draw=function(){},i.Renderer.prototype.construct=function(t){var e=t.params?t.params:{};e.name||(e.name=i.uniqueID()),e.heightPercentage||(e.heightPercentage=.7),e.opacity||(e.opacity=1),e.type||(e.type="line"),"legacy"!=e.type&&"line"!=e.type&&"mountain"!=e.type||(e.highlightable=!0),e.panel||(e.panel="chart"),this.cb=t.callback,this.params=e,this.seriesParams=[],this.caches={},this.colors={}},i.Renderer.prototype.attachSeries=function(t,e){if(!this.stx||!this.stx.chart.series[t])return this;var i={field:t,chartType:this.params.type,display:this.stx.chart.series[t].parameters.display,border_color_up:this.params.defaultBorders?"auto":null,fill_color_up:this.stx.chart.series[t].parameters.color,opacity_up:this.params.opacity,border_color_down:this.params.defaultBorders?"auto":null,fill_color_down:this.stx.chart.series[t].parameters.color,opacity_down:this.params.opacity,color:this.stx.chart.series[t].parameters.color};if("string"==typeof e)i.color=i.fill_color_down=i.fill_color_up=e;else if("object"==(void 0===e?"undefined":_typeof(e))){for(var n in e)i[n]=e[n];i.field=t,i.color&&(i.fill_color_up||(i.fill_color_up=i.color),i.fill_color_down||(i.fill_color_down=i.color))}return this.removeSeries(t,!0).seriesParams.push(i),i.fill_color_up!=i.fill_color_down?(this.colors[t+" up"]={color:i.fill_color_up,opacity:i.opacity_up,display:i.display?i.display+" up":t+" up"},this.colors[t+" dn"]={color:i.fill_color_down,opacity:i.opacity_down,display:i.display?i.display+" down":t+" down"}):this.colors[t]={color:i.fill_color_up,opacity:i.opacity_up,display:i.display?i.display:t},this.params.yAxis&&this.stx.addYAxis(this.stx.panels[this.params.panel],this.params.yAxis),this},i.Renderer.prototype.removeSeries=function(t,e){for(var i=0;i<this.seriesParams.length;i++)if(this.seriesParams[i].field==t){this.seriesParams.splice(i,1);break}if(delete this.colors[t+" up"],delete this.colors[t+" dn"],delete this.colors[t],!e){var n=!1;for(var r in this.stx.chart.seriesRenderers){for(var a=this.stx.chart.seriesRenderers[r],o=0;o<a.seriesParams.length;o++)if(a.seriesParams[o].field==t){n=!0;break}if(n)break}n||this.stx.deleteSeries(t,this.stx.chart)}return this.stx.deleteYAxisIfUnused(this.stx.panels[this.params.panel],this.params.yAxis),this},i.Renderer.prototype.removeAllSeries=function(t){if(t){for(var e=[],i=0;i<this.seriesParams.length;i++)e.push(this.seriesParams[i].field);for(var n=0;n<e.length;n++)this.removeSeries(e[n])}return this.seriesParams=[],this.colors={},this.stx.deleteYAxisIfUnused(this.stx.panels[this.params.panel],this.params.yAxis),this},i.Renderer.prototype.ready=function(){return this.stx.createDataSet(),this.stx.draw(),this},i.Renderer.Lines=function(t){this.construct(t)},i.Renderer.Lines.ciqInheritsFrom(i.Renderer,!1),i.Renderer.Lines.prototype.performCalculations=function(t){var e=this.params.yAxis,i=this.stx;if(e){for(var n=i.panels[this.params.panel],r=[],a=0;a<this.seriesParams.length;a++)r.push(this.seriesParams[a].field);var o=i.determineMinMax(i.chart.dataSegment,r,!1,!0);t&&t.length&&(o[0]=Math.min(t[0],o[0]),o[1]=Math.max(t[1],o[1])),i.calculateYAxisRange(n,e,o[0],o[1])}},i.Renderer.Lines.prototype.draw=function(){var t,e=this.stx.panels[this.params.panel].chart,n={},r=this.seriesParams;for(t=0;t<r.length;t++)if(e.series[r[t].field]){var a=i.clone(e.series[r[t].field].parameters);n[r[t].field]={parameters:i.extend(i.extend(a,this.params),r[t]),yValueCache:this.caches[r[t].field]}}this.stx.drawSeries(e,n,this.params.yAxis);for(t in n)this.caches[t]=n[t].yValueCache},t},__engine_=function(t,e){Math.easeOutCubic=function(t,e,i,n){return t/=n,t--,i*(t*t*t+1)+e};var i=t.CIQ,n=t.$$,r=t.$$$,a=t.SplinePlotter,o=t.timezoneJS;return i.ChartEngine=function(t){if(t||(t={container:null}),t.constructor==HTMLDivElement){t={container:t}}if(this.markers={},this.panels={},this.overlays={},this.charts={},this.eventListeners=[],this.animations={zoom:new i.EaseMachine(Math.easeOutCubic,400)},this.callbacks={studyOverlayEdit:null,studyPanelEdit:null,tap:null,rightClick:null,longhold:null,move:null,layout:null,drawing:null,preferences:null,theme:null,symbolChange:null,symbolImport:null,calculateTradingDecimalPlaces:i.calculateTradingDecimalPlaces},this.controls={},this.goneVertical=!1,this.pinchingScreen=!1,this.grabbingScreen=!1,this.grabStartX=0,this.grabStartY=0,this.grabStartScrollX=0,this.grabStartScrollY=0,this.swipe={},this.yTolerance=100,this.minimumLeftBars=1,this.grabStartCandleWidth=0,this.grabStartZoom=0,this.grabOverrideClick=!1,this.grabMode="",this.vectorsShowing=!1,this.mouseMode=!0,this.reverseMouseWheel=!1,this.mouseWheelAcceleration=!0,this.minimumCandleWidth=1,this.minimumZoomTicks=9,this.allowZoom=!0,this.allowScroll=!0,this.allowSideswipe=!0,this.bypassRightClick=!1,this.anyHighlighted=!1,this.accessoryTimer=null,this.lastAccessoryUpdate=(new Date).getTime(),this.displayCrosshairs=!0,this.hrPanel=null,this.editingAnnotation=!1,this.openDialog="",this.displayIconsUpDown=!0,this.displayIconsSolo=!0,this.displayIconsClose=!0,this.displayPanelResize=!0,this.soloPanelToFullScreen=!1,this.markerDelay=0,this.useBackingStore=!0,this.disableBackingStoreDuringTouch=i.isMobile,this.manageTouchAndMouse=!0,this.captureTouchEvents=!0,this.captureMouseWheelEvents=!0,this.touches=[],this.changedTouched=[],this.crosshairTick=null,this.crosshairValue=null,this.yaxisLabelStyle="roundRectArrow",this.axisBorders=null,this.pt={x1:-1,x2:-1,y1:-1,y2:-1},this.moveA=-1,this.moveB=-1,this.touchStartTime=-1,this.gestureStartDistance=-1,this.grabStartPeriodicity=1,this.grabEndPeriodicity=-1,this.scrollEvent=null,this.cmd=!1,this.ctrl=!1,this.shift=!1,this.userPointerDown=!1,this.cloneDrawing=!1,this.singleDrawingHighlight=!0,this.crosshairXOffset=-40,this.crosshairYOffset=-40,this.displayInitialized=!1,this.cx=null,this.cy=null,this.extendLastTick=!1,this.clicks={s1MS:-1,e1MS:-1,s2MS:-1,e2MS:-1},this.cancelTouchSingleClick=!1,this.layout={interval:"day",periodicity:1,timeUnit:null,candleWidth:8,volumeUnderlay:!1,adj:!0,crosshair:!1,chartType:"candle",extended:!1,marketSessions:{},aggregationType:"ohlc",chartScale:"linear",studies:{},panels:{},setSpan:{}},this.preferences={highlightsRadius:10,highlightsTapRadius:30,currentPriceLine:!1,magnet:!1,horizontalCrosshairField:null,labels:!0,language:null,timeZone:null,whitespace:50,zoomInSpeed:null,zoomOutSpeed:null,zoomAtCurrentMousePosition:!1},this.streamParameters={count:0,maxWait:1e3,maxTicks:100,timeout:-1,fillGaps:!0},this.translationCallback=null,this.locale=null,this.dataZone=null,this.displayZone=null,this.timeZoneOffset=0,this.changeCallback=null,this.masterData=null,this.transformDataSetPre=null,this.transformDataSetPost=null,this.transformMasterDataQuote=null,this.dataCallback=null,this.dontRoll=!1,this.allowEquations=!0,this.drawingObjects=[],this.undoStamps=[],this.cleanupGaps=!1,this.maxDataSetSize=2e4,this.maxMasterDataSize=0,this.resizeDetectMS=1e3,this.xAxisAsFooter=!0,this.xaxisHeight=30,this.displayGridLinesInStudies=!1,this.escapeOnSerialize=!0,this.chart=new i.ChartEngine.Chart,this.chart.name="chart",this.chart.canvas=null,this.chart.tempCanvas=null,this.chart.container=t.container,this.chart.market=new i.Market,this.candleWidthPercent=.65,this.colorByCandleDirection=!1,this.noWicksOnCandles={renko:!0,linebreak:!0},this.fetchMaximumBars={rangebars:!0,kagi:!0,renko:!0,linebreak:!0,pandf:!0},this.highLowBars={bar:!0,colored_bar:!0,candle:!0,hollow_candle:!0,volume_candle:!0,hlc:!0,colored_hlc:!0,hlc_box:!0,hlc_shaded_box:!0,wave:!0},this.standaloneBars={bar:!0,colored_bar:!0,candle:!0,hollow_candle:!0,volume_candle:!0,hlc:!0,colored_hlc:!0,hlc_box:!0,hlc_shaded_box:!0,histogram:!0,scatterplot:!0},this.barsHaveWidth={bar:!0,colored_bar:!0,candle:!0,hollow_candle:!0,volume_candle:!0,hlc:!0,colored_hlc:!0,hlc_box:!0,hlc_shaded_box:!0,histogram:!0,scatterplot:!0,wave:!0},this.autoPickCandleWidth={turnOn:!1,candleWidth:5},this.staticRangePeriodicityMap=[{rangeInMS:i.WEEK,periodicity:1,interval:5,timeUnit:"minute"},{rangeInMS:i.MONTH,periodicity:1,interval:30,timeUnit:"minute"},{rangeInMS:i.YEAR,periodicity:1,interval:"day"},{rangeInMS:i.DECADE,periodicity:1,interval:"week"},{rangeInMS:10*i.DECADE,periodicity:1,interval:"month"},{rangeInMS:Number.MAX_VALUE,periodicity:12,interval:"month"}],this.dynamicRangePeriodicityMap=[{interval:1,timeUnit:"minute",rangeInMS:i.MINUTE},{interval:5,timeUnit:"minute",rangeInMS:5*i.MINUTE},{interval:30,timeUnit:"minute",rangeInMS:30*i.MINUTE},{interval:60,timeUnit:"minute",rangeInMS:60*i.MINUTE},{interval:"day",rangeInMS:i.DAY},{interval:"month",rangeInMS:i.MONTH},{interval:"year",rangeInMS:i.YEAR}],this.charts.chart=this.chart,this.styles={},this.currentVectorParameters=i.clone(i.ChartEngine.currentVectorParameters),i.extend(this,t),t.container&&(this.registerHTMLElements(),this.chart.width=this.chart.container.clientWidth-this.chart.yAxis.width,this.setCandleWidth(this.layout.candleWidth,this.chart),this.chart.canvasHeight=this.chart.container.clientHeight,i.useOldWheelLogic&&!i.FireFoxWheelWorkaround)){var e;e=i.isIE?function(t){if(i.ChartEngine.insideChart){t.preventDefault();for(var e=0;e<i.ChartEngine.registeredContainers.length;e++){var n=i.ChartEngine.registeredContainers[e].stx;i.ChartEngine.crosshairX>=n.left&&i.ChartEngine.crosshairX<=n.right&&i.ChartEngine.crosshairY>=n.top&&i.ChartEngine.crosshairY<=n.bottom&&n.mouseWheel(t,"onmousewheel")}}}:function(t){i.ChartEngine.insideChart&&t.preventDefault()},this.addDomEventListener(document.body,"wheel",e),i.FireFoxWheelWorkaround=!0}this.construct()},i.ChartEngine.drawingLine=!1,i.ChartEngine.resizingPanel=null,i.ChartEngine.vectorType="",i.ChartEngine.crosshairX=0,i.ChartEngine.crosshairY=0,i.ChartEngine.insideChart=!1,i.ChartEngine.overXAxis=!1,i.ChartEngine.overYAxis=!1,i.ChartEngine.currentColor="auto",i.ChartEngine.drawingTools={},i.ChartEngine.useAnimation=!0,i.ChartEngine.ipadMaxTicks=1500,i.ChartEngine.enableCaching=!1,i.ChartEngine.ignoreTouch=!1,i.ChartEngine.useOldAndroidClear=!0,i.ChartEngine.currentVectorParameters={vectorType:null,pattern:"solid",lineWidth:1,fillColor:"#7DA6F5",currentColor:"auto",axisLabel:!0,fibonacci:{trend:{color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},fibs:[{level:-.786,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},{level:-.618,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:-.5,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},{level:-.382,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:-.236,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},{level:0,color:"auto",parameters:{pattern:"solid",lineWidth:1},display:!0},{level:.236,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},{level:.382,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:.5,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:.618,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:.786,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},{level:1,color:"auto",parameters:{pattern:"solid",lineWidth:1},display:!0},{level:1.382,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:1.618,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:2.618,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},{level:4.236,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}}],extendLeft:!1,printLevels:!0,printValues:!1,timezone:{color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}}},annotation:{font:{style:null,size:null,weight:null,family:null}}},i.ChartEngine.defaultDisplayTimeZone=null,i.ChartEngine.Chart=function(){this.xAxis=new i.ChartEngine.XAxis,this.yAxis=new i.ChartEngine.YAxis,this.symbolObject={symbol:null},this.series={},this.seriesRenderers={},this.xaxis=[],this.state={},this.defaultChartStyleConfig={},this.baseline=i.clone(this.baseline)},i.ChartEngine.YAxis=function(t){for(var e in t)this[e]=t[e]},i.ChartEngine.XAxis=function(t){for(var e in t)this[e]=t[e]},i.ChartEngine.Panel=function(t,e){this.yAxis=e||new i.ChartEngine.YAxis,this.name=t,this.state={}},i.ChartEngine.YAxis.prototype={high:null,low:null,shadow:null,logHigh:null,logLow:null,logShadow:null,multiplier:null,bottom:null,top:null,height:null,left:null,width:null},i.ChartEngine.YAxis.prototype.maxDecimalPlaces=5,i.ChartEngine.YAxis.prototype.max=null,i.ChartEngine.YAxis.prototype.min=null,i.ChartEngine.YAxis.prototype.decimalPlaces=null,i.ChartEngine.YAxis.prototype.idealTickSizePixels=null,i.ChartEngine.YAxis.prototype.minimumPriceTick=null,i.ChartEngine.YAxis.prototype.fractional=null,i.ChartEngine.YAxis.prototype.displayBorder=!0,i.ChartEngine.YAxis.prototype.displayGridLines=!0,i.ChartEngine.YAxis.prototype.noDraw=null,i.ChartEngine.YAxis.prototype.drawCurrentPriceLabel=!0,i.ChartEngine.YAxis.prototype.drawSeriesPriceLabels=!0,i.ChartEngine.YAxis.prototype.drawPriceLabels=!0,i.ChartEngine.YAxis.prototype.goldenRatioYAxis=!0,i.ChartEngine.YAxis.prototype.yaxisLabelStyle=null,i.ChartEngine.YAxis.prototype.justifyRight=null,i.ChartEngine.YAxis.prototype.textBackground=!1,i.ChartEngine.YAxis.prototype.priceFormatter=null,i.ChartEngine.YAxis.prototype.bottomOffset=0,i.ChartEngine.YAxis.prototype.topOffset=0,i.ChartEngine.YAxis.prototype.initialMarginTop=10,i.ChartEngine.YAxis.prototype.initialMarginBottom=10,i.ChartEngine.YAxis.prototype.zoom=0,i.ChartEngine.YAxis.prototype.scroll=0,i.ChartEngine.YAxis.prototype.width=50,i.ChartEngine.YAxis.prototype.textStyle=null,i.ChartEngine.YAxis.prototype.position=null,i.ChartEngine.YAxis.defaultShadowBreaks=[[1e3,2],[1,4]],i.ChartEngine.YAxis.smallChartShadowBreaks=[[10,2],[1,4]],i.ChartEngine.YAxis.prototype.pretty=!0,i.ChartEngine.YAxis.prototype.increments=[1,2.5,5],i.ChartEngine.YAxis.prototype.prettySemiLog=!0,i.ChartEngine.YAxis.prototype.shadowBreaks=i.ChartEngine.YAxis.defaultShadowBreaks,i.ChartEngine.Panel.prototype={name:null,display:null,chart:null,yAxis:null,shareChartXAxis:null,top:null,bottom:null,height:null,percent:null},i.ChartEngine.XAxis.prototype={formatter:null,adjustTimeZone:!0,idealTickSizePixels:null,timeUnit:null,timeUnitMultiplier:null,displayBorder:!0,displayGridLines:!0,noDraw:null,minimumLabelWidth:50,futureTicks:!0,futureTicksInterval:1},i.ChartEngine.Chart.prototype={symbol:null,symbolObject:{symbol:null},symbolDisplay:null,series:{},seriesRenderers:{},scroll:0,standStill:0,maxTicks:0,tension:null,masterData:null,dataSet:null,scrubbed:null,dataSegment:null,segmentImage:null,baseline:{includeInDataSegment:!1,defaultLevel:null,userLevel:null,actualLevel:null},xAxis:null,xaxis:[],xaxisFactor:30,decimalPlaces:2,roundit:100,legendRenderer:i.drawLegend,customChart:null,yaxisPaddingRight:null,yaxisPaddingLeft:null,tickCache:{},allowScrollPast:!0,allowScrollFuture:!0,hideDrawings:!1,defaultPlotField:"Close",defaultChartStyleConfig:{},lockScroll:!1,includeOverlaysInMinMax:!0,gaplines:null,lineStyle:null,lineApproximation:!0},i.ChartEngine.prototype.convertToDataZone=function(t){if(this.dataZone){var e=i.convertTimeZone(t,null,this.dataZone);t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}return t},i.ChartEngine.isDailyInterval=function(t){return"day"==t||("week"==t||"month"==t)},i.ChartEngine.prototype.needDifferentData=function(t){var e=this.layout,n=i.ChartEngine.isDailyInterval(t.interval),r=i.ChartEngine.isDailyInterval(e.interval),a=!1;return this.dontRoll||!r?e.interval!=t.interval&&(a=!0):n!=r&&(a=!0),n||t.timeUnit||(t.timeUnit="minute"),r||e.timeUnit||(e.timeUnit="minute"),t.timeUnit!=e.timeUnit&&(a=!0),a},i.ChartEngine.chartShowsHighs=function(t){return console.warn("CIQ.ChartEngine.chartShowsHighs() has been deprecated. Please check one of the appropriate CIQ.ChartEngine instance objects for chartType property instead: stxx.highLowBars, stxx.standaloneBars, or stxx.barsHaveWidth."),1!={line:1,colored_line:1,mountain:1,colored_mountain:1,baseline_delta:1,baseline_delta_mountain:1,histogram:1,scatterplot:1,step:1,colored_step:1}[t]},i.ChartEngine.prototype.debug=function(){},i.ChartEngine.prototype.fps=function(t,e){function n(){var s=((new Date).getTime()-r)/1e3;if(s>t){var l=a/s;return console.log("FPS="+l),void(e&&e(l))}o.draw(),a++,i.ChartEngine.useAnimation?requestAnimationFrame(n):setTimeout(n,0)}t=t||5;var r=(new Date).getTime(),a=0,o=this;console.log("Running fps() for "+t+" seconds"),n()},t.STXChart=i.ChartEngine,i.ChartEngine.DrawingDescriptor={name:"",render:null,intersected:null,click:null,abort:null},i.ChartEngine.prototype.prepend=function(t,e){var n,r="prepend"+t;return this instanceof i.ChartEngine?(n=this.hasOwnProperty(r)?this[r]:[],this[r]=[e].concat(n)):(n=i.ChartEngine.prototype[r]||[],i.ChartEngine.prototype[r]=[e].concat(n)),{method:r,func:e}},i.ChartEngine.prototype.append=function(t,e){var n,r="append"+t;return this instanceof i.ChartEngine?(n=this.hasOwnProperty(r)?this[r]:[],this[r]=n.concat(e)):(n=i.ChartEngine.prototype[r]||[],i.ChartEngine.prototype[r]=n.concat(e)),{method:r,func:e}},i.ChartEngine.prototype.removeInjection=function(t){var e,n=t.method;if(this instanceof i.ChartEngine){if(!this[n])return;for(e=0;e<this[n].length;e++)if(this[n][e]==t.func)return void this[n].splice(e,1)}else{if(!i.ChartEngine.prototype[n])return;for(e=0;e<i.ChartEngine.prototype[n].length;e++)if(i.ChartEngine.prototype[n][e]==t.func)return void i.ChartEngine.prototype[n].splice(e,1)}},i.ChartEngine.prototype.remove=function(t){this instanceof i.ChartEngine?(delete this["append"+t],delete this["prepend"+t]):(delete i.ChartEngine.prototype["append"+t],delete i.ChartEngine.prototype["prepend"+t])},i.ChartEngine.registeredContainers=[],i.ChartEngine.handleContextMenu=function(t){t||(t=event);for(var e=0;e<i.ChartEngine.registeredContainers.length;e++){var n=i.ChartEngine.registeredContainers[e].stx;if(n&&n.anyHighlighted)return t.preventDefault&&t.preventDefault(),!1}},i.ChartEngine.prototype.positionMarkers=function(){},i.ChartEngine.prototype.plugins={},i.ChartEngine.htmlControls={annotationSave:'<span class="stx-btn stx_annotation_save" style="display: none;">save</span>',annotationCancel:'<span class="stx-btn stx_annotation_cancel" style="display: none; margin-left:10px;">cancel</span>',mSticky:'<div id="mSticky"> <span id="mStickyInterior"></span> <span id="mStickyRightClick" class=""><span class="overlayEdit stx-btn" style="display:none"><span>&nbsp;</span></span> <span id="overlayTrashCan" class="stx-btn" style="display:none"><span>&nbsp;</span></span> <span id="mouseDeleteInstructions"><span>(</span><span id="mouseDeleteText">right-click to delete</span><span id="mouseManageText">right-click to manage</span><span>)</span></span></span></div>',crossX:'<div class="stx_crosshair stx_crosshair_x" style="display: none;"></div>',crossY:'<div class="stx_crosshair stx_crosshair_y" style="display: none;"></div>',chartControls:'<div class="stx_chart_controls" style="display: none; bottom: 22px;"><div id="chartSize"><span id="zoomOut" class="stx-zoom-out"></span><span id="zoomIn" class="stx-zoom-in"></span></div></div>',home:'<div id="home" class="stx_jump_today home" style="display:none"><span></span></div>',floatDate:'<div class="stx-float-date" style="visibility: hidden;"></div>',handleTemplate:'<div class="stx-ico-handle" style="display: none;"><span></span></div> ',iconsTemplate:'<div class="stx-panel-control"><div class="stx-panel-title"></div><div class="stx-btn-panel"><span class="stx-ico-up"></span></div><div class="stx-btn-panel"><span class="stx-ico-focus"></span></div><div class="stx-btn-panel"><span class="stx-ico-down"></span></div><div class="stx-btn-panel"><span class="stx-ico-edit"></span></div><div class="stx-btn-panel"><span class="stx-ico-close"></span></div></div>',baselineHandle:'<div class="stx-baseline-handle" style="display: none;"></div>'},i.ChartEngine.prototype.registerHTMLElements=function(){var t=this.chart.container;for(var e in i.ChartEngine.htmlControls)if(void 0===this.chart[e]&&void 0===this.controls[e]){if(!this.allowZoom&&"chartControls"==e)continue;var n=r("#"+e,t);if(n)this.chart[e]=n,this.controls[e]=n;else{var a=i.ChartEngine.htmlControls[e],o=document.createElement("DIV");o.innerHTML=a,n=o.firstChild,t.appendChild(n),this.chart[e]=n,this.controls[e]=n,n.id=e}}if(this.controls.chartControls){var s=r("#zoomIn",this.controls.chartControls),l=r("#zoomOut",this.controls.chartControls);i.safeClickTouch(s,function(t){return function(e){t.zoomIn(e),e.stopPropagation()}}(this)),i.safeClickTouch(l,function(t){return function(e){t.zoomOut(e),e.stopPropagation()}}(this)),i.touchDevice||(this.makeModal(s),this.makeModal(l))}this.controls.home&&(i.safeClickTouch(this.controls.home,function(t){return function(e){t.home({animate:!0}),e.stopPropagation()}}(this)),i.touchDevice||this.makeModal(this.controls.home))},i.ChartEngine.prototype.makeModal=function(t){var e=this;t.onmouseover=function(t){e.modalBegin()},t.onmouseout=function(t){e.modalEnd()}},i.ChartEngine.prototype.cloneStyle=function(t){function e(t){return t[1].toUpperCase()}var n={},r=!1;for(var a in t){var o=t[a];if("backgroundAttachment"==a&&(r=!0),r)o&&o.constructor==String&&isNaN(a)&&(n[a]=o);else if(isNaN(a)){var s=a.replace(i.camelCaseRegExp,e);n[s]=o}else{var l=t.getPropertyValue(o);if(l){o=o.split("-");for(var h=0,c=o.length,u=o[0];++h<c;)u+=o[h].charAt(0).toUpperCase()+o[h].slice(1);n[u]=l}}}return n},i.ChartEngine.prototype.canvasStyle=function(t){var e=this.styles[t];if(!e){var i=document.createElement("div");i.className=t,this.container.appendChild(i);var n=getComputedStyle(i);e=this.styles[t]=this.cloneStyle(n),this.container.removeChild(i),n||(this.styles[t]=null)}return e},i.ChartEngine.prototype.colorOrStyle=function(t){return-1!=t.indexOf("#")?t:-1!=t.indexOf("(")?t:"transparent"==t?t:this.canvasStyle(t)},i.ChartEngine.prototype.clearStyles=function(){this.styles={}},i.ChartEngine.prototype.setStyle=function(t,e,n){this.styles[t]||this.canvasStyle(t),this.styles[t]||(this.styles[t]={}),this.styles[t][i.makeCamelCase(e)]=n},i.ChartEngine.prototype.canvasFont=function(t,e){e||(e=this.chart.context);var i=this.canvasStyle(t);if(i){var n=i.fontStyle+" "+i.fontWeight+" "+i.fontSize+" "+i.fontFamily;-1==n.indexOf("undefined")?e.font=n:(this.styles[t]=null,console.log("bad css style for class "+t))}},i.ChartEngine.prototype.canvasColor=function(t,e){e||(e=this.chart.context);var i=this.canvasStyle(t);if(i){var n=i.color;n||(n=this.defaultColor),e.globalAlpha=1,e.fillStyle=n,e.strokeStyle=n;var r=i.opacity;void 0!==r&&(e.globalAlpha=r)}},i.ChartEngine.prototype.getCanvasFontSize=function(t){var e=this.canvasStyle(t),n=e.fontSize;return n||(n="12"),parseInt(i.stripPX(n),10)},i.ChartEngine.prototype.getCanvasColor=function(t){return this.canvasStyle(t).color},i.ChartEngine.hideDates=function(){return!1},i.ChartEngine.prototype.runPrepend=function(t,e,n){var r="prepend"+t,a=this.hasOwnProperty(r)?this[r]:[];if(a=a.concat(i.ChartEngine.prototype[r]||[]),!a.length)return!1;n||(n=this);for(var o=0;o<a.length;o++){var s=a[o].apply(n,e);if(s)return s}return!1},i.ChartEngine.prototype.runAppend=function(t,e,n){var r="append"+t,a=this.hasOwnProperty(r)?this[r]:[];if(a=a.concat(i.ChartEngine.prototype[r]||[]),!a.length)return!1;n||(n=this);for(var o=0;o<a.length;o++){var s=a[o].apply(n,e);if(s)return s}return!1},i.ChartEngine.registerDrawingTool=function(t,e){i.ChartEngine.drawingTools[t]=e},i.ChartEngine.prototype.createBlock=function(t,e,i,n,r,a){a||(a=this.chart.context),void 0!==n&&(this.canvasColor(r,a),a.fillRect(t,i,e,n),a.globalAlpha=1)},i.ChartEngine.prototype.changeOccurred=function(t){if(!this.currentlyImporting){this.changeCallback&&(console.warn("CIQ.ChartEngine.changeCallback has been deprecated. Please use addEventListener()"),this.changeCallback(this,t));var e={stx:this,symbol:this.chart.symbol,symbolObject:this.chart.symbolObject,layout:this.layout,drawings:this.drawingObjects};"layout"==t?this.dispatch("layout",e):"vector"==t?this.dispatch("drawing",e):"theme"==t?this.dispatch("theme",e):"preferences"==t&&this.dispatch("preferences",e)}},i.ChartEngine.prototype.setChartType=function(t){var e=this.layout,i=this.chart;"ohlc"!=e.aggregationType&&(e.aggregationType="ohlc",i.canvas&&this.createDataSet()),e.chartType=t,i.defaultChartStyleConfig={type:t},this.displayInitialized&&this.draw(),this.changeOccurred("layout")},i.ChartEngine.prototype.setAggregationType=function(t){this.layout.chartType="candle";var e=this.chart;!1!==e.baseline.userLevel&&(e.baseline.userLevel=e.baseline.defaultLevel,e.panel.yAxis.scroll=i.ChartEngine.YAxis.prototype.scroll),this.layout.aggregationType=t,e.canvas&&(this.createDataSet(),this.draw()),this.changeOccurred("layout")},i.ChartEngine.prototype.setChartScale=function(t){var e=this.chart;if(t||(t="linear"),"percent"==t)e.isComparison||this.setComparison(!0,e);else if("percent"==this.layout.chartScale){var i=!1;for(var n in e.series)e.series[n].parameters.isComparison&&(i=!0);i||this.setComparison(!1,e)}this.layout.chartScale=t,e.canvas&&this.draw(),this.changeOccurred("layout")},i.ChartEngine.prototype.setAdjusted=function(t){this.layout.adj=t,this.chart.canvas&&(this.createDataSet(),this.draw()),this.changeOccurred("layout")},i.ChartEngine.prototype.setVolumeUnderlay=function(t){this.layout.volumeUnderlay=t,this.chart.canvas&&this.draw(),this.changeOccurred("layout")},i.ChartEngine.prototype.serializeDrawings=function(){return console.warn("CIQ.ChartEngine.serializeDrawings() has been deprecated. Please use exportDrawings()"),this.exportDrawings()},i.ChartEngine.prototype.exportDrawings=function(){for(var t=[],e=0;e<this.drawingObjects.length;e++)t.push(this.drawingObjects[e].serialize());return t},i.ChartEngine.prototype.abortDrawings=function(){for(var t=0;t<this.drawingObjects.length;t++)this.drawingObjects[t].abort(!0);this.drawingObjects=[]},i.ChartEngine.prototype.reconstructDrawings=function(t){console.warn("CIQ.ChartEngine.reconstructDrawings() has been deprecated. Please use importDrawings()"),this.importDrawings(t)},i.ChartEngine.prototype.importDrawings=function(t){if(i.Drawing)for(var e=0;e<t.length;e++){var n=t[e];"fibonacci"==n.name&&(n.name="retracement");var r=i.ChartEngine.drawingTools[n.name];if(r||i.Drawing[n.name]&&(r=i.Drawing[n.name],i.ChartEngine.registerDrawingTool(n.name,r)),r){var a=new r;a.reconstruct(this,n),this.drawingObjects.push(a)}}},i.ChartEngine.prototype.clearDrawings=function(t){var e=i.shallowClone(this.drawingObjects);this.abortDrawings(),t?this.undoStamps=[]:this.undoStamp(e,i.shallowClone(this.drawingObjects)),this.changeOccurred("vector"),this.cancelTouchSingleClick=!0,i.clearCanvas(this.chart.tempCanvas,this),this.draw(),this.controls.mSticky&&(this.controls.mSticky.style.display="none",this.controls.mSticky.children[0].innerHTML="")},i.ChartEngine.prototype.createDrawing=function(t,e){if(i.Drawing){var n=new i.Drawing[t];n.reconstruct(this,e);var r=new i.Drawing[t];r.stx=this,r.copyConfig();for(var a in r)n[a]=n[a]||r[a];return this.drawingObjects.push(n),this.draw(),n}},i.ChartEngine.prototype.removeDrawing=function(t){for(var e=0;e<this.drawingObjects.length;e++)if(this.drawingObjects[e]==t)return this.drawingObjects.splice(e,1),this.changeOccurred("vector"),void this.draw()},i.ChartEngine.prototype.dateFromTick=function(t,e,n){e||(e=this.chart);var r,a,o,s=e.dataSet.length,l=!1;return 0===s&&(e.dataSet[0]={},e.dataSet[0].DT=new Date,s=e.dataSet.length,l=!0),t<0?(a=this.standardMarketIterator(e.dataSet[0].DT),r=a.previous(Math.abs(t))):t>=s?(a=this.standardMarketIterator(e.dataSet[s-1].DT),r=a.next(t-(s-1))):r=e.dataSet[t].DT,o=n?new Date(r.getTime()):i.yyyymmddhhmm(r),l&&delete e.dataSet[0].DT,o},i.ChartEngine.prototype.calculateYAxisMargins=function(t){t.zoom=t.initialMarginTop+t.initialMarginBottom,t.scroll=(t.initialMarginTop-t.initialMarginBottom)/2,t.zoom>t.height&&(t.zoom=0,t.scroll=0)},i.ChartEngine.prototype.getLabelOffsetInPixels=function(t,e,i){var n=!this.standaloneBars[i];if(!("roundRectArrow"!=t.yaxisLabelStyle||n&&t.extendLastTick&&0!==e.yaxisPaddingRight)){return.66*(t.getCanvasFontSize("stx_yaxis")+6)}return 0},i.ChartEngine.prototype.home=function(t){function e(t){for(var e in t.panels)"chart"!=e&&t.calculateYAxisMargins(t.panels[e].yAxis)}this.swipe.amplitude=0,this.grabbingScreen=!1;var n=this.layout;if(i.ChartEngine.insideChart&&i.unappendClassName(this.container,"stx-drag-chart"),"object"!=(void 0===t?"undefined":_typeof(t))&&(t={maintainWhitespace:t}),void 0===t.maintainWhitespace&&(t.maintainWhitespace=!0),this.cancelTouchSingleClick=!0,!this.chart.dataSet||!this.chart.dataSet.length)return void this.draw();this.micropixels=0;var r=Math.floor(this.chart.width/n.candleWidth);for(var a in this.charts){var o=this.charts[a];if(!t.chart||t.chart==o){var s=0;t.maintainWhitespace&&this.preferences.whitespace>=0&&(s=this.preferences.whitespace),(t.whitespace||0===t.whitespace)&&(s=t.whitespace);var l=this.getLabelOffsetInPixels(this,o,n.chartType);l>s&&(s=l);var h=Math.min(r,o.dataSet.length);for(this.chart.allowScrollPast&&(h=r),this.micropixels=this.chart.width-h*n.candleWidth-s,this.preferences.whitespace=s;this.micropixels>n.candleWidth;)h++,this.micropixels-=n.candleWidth;for(;this.micropixels<0;)h--,this.micropixels+=n.candleWidth;if(this.micropixels-=n.candleWidth,h++,this.standaloneBars[n.chartType]||(this.micropixels+=n.candleWidth/2),t.animate){var c=this;this.scrollTo(o,h,function(t,i,n){return function(){t.calculateYAxisMargins(i.panel.yAxis),e(t),i.scroll=n,t.draw()}}(c,o,h))}else o.scroll=h,this.calculateYAxisMargins(o.panel.yAxis),e(this)}}this.draw()},i.ChartEngine.prototype.isHome=function(){var t=this.chart,e=t.dataSet,i=t.animatingHorizontalScroll;return this.pixelFromTick(e.length-(i?2:1),t)<t.width+t.panel.left},i.ChartEngine.prototype.tickFromDate=function(t,e,n,r){if(e||(e=this.chart),!e.dataSet||!e.dataSet.length)return 0;n||(n=0),e||(e=this.chart);var a=t.constructor==Date?t:i.strToDateTime(t);i.ChartEngine.isDailyInterval(this.layout.interval)||a.setMinutes(a.getMinutes()+n);var o=a.getTime(),s=e.tickCache[o];if(s||0===s)return s;var l=e.dataSet[0].DT,h=e.dataSet[e.dataSet.length-1].DT;if(a>=l&&a<=h)for(var c=0;c<e.dataSet.length;c++){var u=e.dataSet[c].DT;if(u.getTime()==a.getTime())return e.tickCache[o]=c,c;if(u>a)return e.tickCache[o]=r?c:c-1,e.tickCache[o]}var p=a<l,d=p?l:h,f=this.standardMarketIterator(d),m=f.futureTick({end:a});return s=p?-1*m:e.dataSet.length-1+m,e.tickCache[o]=s,s},i.ChartEngine.XAxisLabel=function(t,e,i){this.hz=t,this.grid=e,this.text=i},i.ChartEngine.prototype.createXAxis=function(t){if(t.dataSegment.length<=0)return null;if(i.ChartEngine.hideDates())return null;var e=[t],n=this.runPrepend("createXAxis",e);return n||(n=this.createTickXAxisWithDates(t),this.headsUpHR(),this.runAppend("createXAxis",e),n)},i.ChartEngine.prototype.adjustYAxisHeightOffset=function(t,e){e.bottomOffset=0,this.xaxisHeight||0===this.xaxisHeight||(this.xaxisHeight=this.getCanvasFontSize("stx_xaxis")+4,(this.chart.xAxis.displayBorder||this.axisBorders)&&(this.xaxisHeight+=3)),!0===this.xAxisAsFooter&&t.bottom>this.chart.canvasHeight-this.xaxisHeight?e.bottomOffset=this.xaxisHeight:!0!==this.xAxisAsFooter&&"chart"==t.name&&(e.bottomOffset=this.xaxisHeight),e.bottom=t.bottom-e.bottomOffset},i.ChartEngine.prototype.plotYAxisGrid=function(t){if(!this.runPrepend("plotYAxisGrid",arguments)){var e=this.chart.context;t.yAxis.yAxisPlotter.draw(e,"grid"),this.runAppend("plotYAxisGrid",arguments)}},i.ChartEngine.prototype.plotYAxisText=function(t){if(!this.runPrepend("plotYAxisText",arguments)){for(var e=t.yaxisLHS.concat(t.yaxisRHS),i=0;i<e.length;i++){var n=e[i];if(n.yAxisPlotter&&!n.noDraw){this.canvasFont("stx_yaxis"),this.canvasColor("stx_yaxis");var r=this.chart.context;r.textBaseline="middle",n.justifyRight?r.textAlign="right":r.textAlign="left",n.yAxisPlotter.draw(r,"text"),r.textBaseline="alphabetic",r.textAlign="left"}}this.runAppend("plotYAxisText",arguments)}},i.ChartEngine.prototype.formatYAxisPrice=function(t,e,n,r){if(null===t||void 0===t||isNaN(t))return"";var a=r||e.yAxis,o=n;if(o||0===o||(o=a.printDecimalPlaces),o||0===o||(o=a.priceTick<.01?4:a.priceTick<.1?2:a.priceTick<1?1:0),e.name!=e.chart.name&&a.priceTick>=1e3)return i.condenseInt(t);var s=this.internationalizer;if(s){var l=s.priceFormatters.length;o>=l&&(o=l-1),t=s.priceFormatters[o].format(t)}else t=t.toFixed(o);return t},i.ChartEngine.prototype.padOutPrice=function(t,e){if(0!==t&&(!t||"number"!=typeof t))return"";e||0===e||(e=t);var i=""+e,n=i.substring(i.indexOf(".")).length-1;n=e>=1e3?Math.max(n,0):e<2?Math.max(n,4):Math.max(n,2);var r=this.internationalizer;if(r){var a=r.priceFormatters.length;n>=a&&(n=a-1),t=r.priceFormatters[n].format(t)}else t=t.toFixed(n);return t},i.ChartEngine.prototype.formatPrice=function(t,e){if(0!==t&&(!t||void 0===t))return"";if(e||(e=this.currentPanel),e||(e=this.chart.panel),!e)return t;var i=e.decimalPlaces;if(i||0===i||(i=e.chart.decimalPlaces),!i&&0!==i)return t;var n=this.internationalizer;if(n){var r=n.priceFormatters.length;i>=r&&(i=r-1),t=n.priceFormatters[i].format(t)}else t=t.toFixed(i);return t},i.ChartEngine.prototype.createCrosshairs=function(){this.runPrepend("createCrosshairs",arguments)||this.controls.crossX.onmousedown||(this.controls.crossY.onmousedown=function(t){return t||(t=event),t.preventDefault&&t.preventDefault(),!1},this.controls.crossX.onmousedown=function(t){return t||(t=event),t.preventDefault&&t.preventDefault(),!1},this.runAppend("createCrosshairs",arguments))},i.ChartEngine.prototype.determineMinMax=function(t,e,i,n,r){var a=-1*Number.MAX_VALUE,o=Number.MAX_VALUE,s=!1,l=t.length;r&&(l=r);for(var h=0;h<=l+1;h++){var c;if(c=h==l?this.getPreviousBar(this.chart,e[0],0):h==l+1?this.getNextBar(this.chart,e[0],l-1):t[h]){if(!n)if(c.transform)s=!0,c=c.transform;else if(s)continue;for(var u=0,p=0;p<e.length;p++){var d=c[e[p]];if(d){"number"==typeof d&&(d=[d]);for(var f=0;f<d.length;f++){var m=d[f];(m||0===m)&&(i?(u+=m,u>a&&(a=u),u<o&&(o=u)):(m>a&&(a=m),m<o&&(o=m)))}}}}}return a==-1*Number.MAX_VALUE&&(a=0),o==Number.MAX_VALUE&&(o=0),[o,a]},i.ChartEngine.prototype.calculateYAxisRange=function(t,e,i,n){i==Number.MAX_VALUE&&(i=0,n=0);var r=t.height,a=null,o=null;this.adjustYAxisHeightOffset(t,e),e.top=t.top,e.height=e.bottom-e.top;var s=Math.round(Math.abs(r/5));if(r-Math.abs(e.scroll)<s&&(e.scroll=(r-s)*(e.scroll<0?-1:1)),i||0===i){if(n-i==0){var l=Math.pow(10,-(i.toString()+".").split(".")[1].length);1==l&&(l=100),a=i+l,o=i-l}else if((this.layout.semiLog||"log"==this.layout.chartScale)&&a){var h=Math.log(i)/Math.LN10,c=Math.log(n)/Math.LN10;a=Math.pow(10,c),o=Math.pow(10,h)}else a=n,o=i;e.high=a,e.low=o}if((e.max||0===e.max)&&(e.high=e.max),(e.min||0===e.min)&&(e.low=e.min),e.shadow=e.high-e.low,t.chart.name===t.name&&t.yAxis===e){var u=this.layout.semiLog||"log"==this.layout.chartScale;(t.chart.isComparison||"pandf"==this.layout.aggregationType)&&(u=!1),e.semiLog!=u&&(this.clearPixelCache(),e.semiLog=u)}},i.ChartEngine.prototype.renderYAxis=function(t){if(!this.runPrepend("renderYAxis",arguments)){var e,i=t.panel,n=i.yaxisRHS.concat(i.yaxisLHS);for(e=0;e<n.length;e++){var r=n[e],a=null,o=null;i.yAxis===r&&(a=t.lowValue,o=t.highValue),this.calculateYAxisRange(i,r,a,o)}var s={};for(e=0;e<n.length;e++)s.yAxis=n[e],this.createYAxis(i,s),this.drawYAxis(i,s);this.runAppend("renderYAxis",arguments)}},i.ChartEngine.prototype.initializeDisplay=function(t){if(!this.runPrepend("initializeDisplay",arguments)){var e=[];for(var i in t.seriesRenderers){var n=t.seriesRenderers[i],r=n.params,a=r.panel;this.panels[a];if(!r.yAxis||a!=t.panel.name)for(var o=0;o<n.seriesParams.length;o++){var s=n.seriesParams[o];s.shareYAxis&&e.push(s.field)}}if(t.panel=this.panels[t.name],t.includeOverlaysInMinMax)for(var l in this.overlays){var h=this.overlays[l];if(h.panel==t.name)for(var c in h.outputMap)e.push(c)}var u,p=null,d=Math.floor((t.width-this.micropixels)/this.layout.candleWidth);if(t.scroll>t.maxTicks&&t.maxTicks>d+1&&(p=t.dataSegment.length-1),this.highLowBars[this.layout.chartType])e.push("Close","Open","High","Low"),u=this.determineMinMax(t.dataSegment,e,null,!this.chart.transformFunc,p);else{var f=this.chart.defaultPlotField||"Close";if(e.push(f),u=this.determineMinMax(t.dataSegment,e,null,!t.transformFunc,p),"baseline_delta"==this.layout.chartType){var m=t.baseline.actualLevel;if(m||0===m){t.transformFunc&&(m=t.transformFunc(this,t,m));var g=Math.max(m-u[0],u[1]-m);this.repositioningBaseline?u=[t.lowValue,t.highValue]:(u[0]=m-g,u[1]=m+g)}}}t.lowValue=u[0],t.highValue=u[1];var v=t.state.aggregation;v&&v.box&&(t.lowValue-=v.box/2,t.highValue+=v.box/2),this.runAppend("initializeDisplay",arguments)}},i.ChartEngine.prototype.computePosition=function(t,e){return void 0===e&&(e=0),t*this.layout.candleWidth+e+this.micropixels},i.ChartEngine.prototype.computeColor=function(t,e){return t<e?"stx_candle_up":t>e?"stx_candle_down":"stx_candle_shadow"},i.ChartEngine.prototype.computeLength=function(t,e){var i=this.pixelFromPrice(t);return this.pixelFromPrice(e)-i},i.ChartEngine.prototype.setSeriesRenderer=function(t){var e=t.params;return this.chart.seriesRenderers[t.params.name]?this.chart.seriesRenderers[t.params.name]:(e.yAxis&&this.addYAxis(this.panels[e.panel],e.yAxis),t.stx=this,this.chart.seriesRenderers[t.params.name]=t,t)},i.ChartEngine.prototype.setMarket=function(t,e){e||(e=this.chart),e.market=new i.Market(t);for(var n in this.layout.marketSessions)e.market.disableSession(n,this.layout.marketSessions[n])},i.ChartEngine.prototype.setMarketFactory=function(t){this.marketFactory=t},i.ChartEngine.prototype.removeSeriesRenderer=function(t){for(var e in this.chart.seriesRenderers)if(t.params.name===this.chart.seriesRenderers[e].params.name){var i=this.chart.seriesRenderers[t.params.name],n=i.params.yAxis,r=this.panels[i.params.panel];return delete this.chart.seriesRenderers[t.params.name],void this.deleteYAxisIfUnused(r,n)}},i.ChartEngine.prototype.getSeriesRenderer=function(t){return this.chart.seriesRenderers[t]},i.ChartEngine.prototype.startClip=function(t,e){t||(t="chart");var i=this.panels[t],n=i.yAxis;this.chart.context.save(),this.chart.context.beginPath();var r=i.left,a=i.width;e&&(r=0,a=this.width),this.chart.context.rect(r,i.top,a,n.height),this.chart.context.clip()},i.ChartEngine.prototype.endClip=function(){this.chart.context.restore()},i.ChartEngine.prototype.setLineStyle=function(t,e){var n={};t&&"object"==(void 0===t?"undefined":_typeof(t))?n=t:n.color=t,n.color||n.pattern||n.width||(n=null),e||(e=this.chart);var r=1;n&&n.width&&(r=n.width),n&&n.pattern&&(n.pattern=i.borderPatternToArray(r,n.pattern)),e.lineStyle=n},i.ChartEngine.prototype.setGapLines=function(t,e){var n={};t&&"object"==(void 0===t?"undefined":_typeof(t))?n=t:n.color=t,n.color||n.pattern||n.fillMountain||(n=null),e||(e=this.chart),n&&n.pattern&&(n.pattern=i.borderPatternToArray(n.pattern)),e.gaplines=n},i.ChartEngine.prototype.getGapColorFunction=function(t,e,i,n,r){return function(a,o,s){var l=r?r(a,o,s):e;return l.color&&(l=l.color),s||!o[t]&&0!==o[t]?n?("object"!=(void 0===n?"undefined":_typeof(n))&&(n="string"==typeof n?{color:n}:{}),{color:n.color||l,pattern:n.pattern||i}):null:{color:l,pattern:i}}},i.ChartEngine.prototype.drawLineChart=function(t,e,n,r){var a=n,o=this.chart,s=o.context,l=o.lineStyle||{},h=this.canvasStyle(e);this.startClip(t.name);var c=l.width||h.width;c&&parseInt(c,10)<=25?s.lineWidth=Math.max(1,i.stripPX(c)):s.lineWidth=1,r||(r={});var u=r.pattern||l.pattern||h.borderTopStyle;u=i.borderPatternToArray(s.lineWidth,u),s.setLineDash(u),s.lineDashOffset=0,this.canvasColor(e);var p=r.color||l.color;p&&(s.strokeStyle=p),r.skipProjections=!0;var d=r.field||t.chart.defaultPlotField,f=r.gaps;f||(f=o.gaplines),f&&(a=this.getGapColorFunction(d,s.strokeStyle,u,f,n)),t.chart.tension&&(r.tension=t.chart.tension);var m=this.plotDataSegmentAsLine(d,t,r,a);return s.lineWidth=1,this.endClip(),r.returnObject?m:m.colors},i.ChartEngine.prototype.getPreviousBar=function(t,e,i){return this.getNextBarInternal(t,e,i,-1)},i.ChartEngine.prototype.getNextBar=function(t,e,i){return this.getNextBarInternal(t,e,i,1)},i.ChartEngine.prototype.getNextBarInternal=function(t,e,i,n){var r=t.dataSegment&&t.dataSegment[i];if(r)for(var a=r.tick;a>0&&a<t.dataSet.length-1;){a+=n;var o=t.dataSet[a];if(o&&o[e])return o}return null},i.ChartEngine.prototype.updateFloatHRLabel=function(t){var e=t.yaxisLHS.concat(t.yaxisRHS),n=this.crossYActualPos?this.crossYActualPos:this.cy;if(this.floatCanvas.isDirty&&i.clearCanvas(this.floatCanvas,this),"none"!=this.controls.crossX.style.display){if(this.controls.crossY){var r=t.width;"roundRectArrow"==this.yaxisLabelStyle&&(r-=7),this.controls.crossY.style.left=t.left+"px",this.controls.crossY.style.width=r+"px"}for(var a=0;a<e.length;a++){var o=e[a],s=this.transformedPriceFromPixel(n,t,o);if(!isNaN(s)&&!((t.min||0===t.min)&&s<t.min||(t.max||0===t.max)&&s>t.max)){var l=null;o!==t.chart.yAxis&&(l=0,o.shadow<1e3&&(l=2),o.shadow<5&&(l=4),(o.decimalPlaces||0===o.decimalPlaces)&&(l=o.decimalPlaces)),s=o.priceFormatter?o.priceFormatter(this,t,s,l):this.formatYAxisPrice(s,t,l,o);var h=this.canvasStyle("stx-float-price");this.createYAxisLabel(t,s,n,h.backgroundColor,h.color,this.floatCanvas.context,o),this.floatCanvas.isDirty=!0}}}},i.ChartEngine.prototype.headsUpHR=function(){function t(t){i.efficientDOMUpdate(r,"innerHTML",t)}if(!this.runPrepend("headsUpHR",arguments)){var e=this.currentPanel;if(e){var n=e.chart;this.updateFloatHRLabel(e);var r=this.controls.floatDate;if(r&&!i.ChartEngine.hideDates()){var a=this.barFromPixel(this.cx),o=n.xaxis[a];t(o&&o.DT?i.displayableDate(this,n,o.DT):o&&o.index?o.index:"")}this.runAppend("headsUpHR",arguments)}}},i.ChartEngine.prototype.setCrosshairColors=function(){},i.ChartEngine.prototype.magnetize=function(){if(this.magnetizedPrice=null,!this.runPrepend("magnetize",arguments)){var t=this.currentVectorParameters.vectorType;if(("annotation"!=t&&"callout"!=t||!i.ChartEngine.drawingLine)&&"projection"!=t&&"freeform"!=t){var e=this.currentPanel;if(e.name==e.chart.name){var n=e.chart,r=this.tickFromPixel(i.ChartEngine.crosshairX-this.left,n);if(r>n.dataSet.length)return;var a=n.dataSet[r];if(!a)return;var o=this.valueFromPixel(this.cy,e);this.magnetizedPrice=a.Close;var s=this.layout.chartType;if("bar"==s||"candle"==s||"colored_bar"==s||"hollow_candle"==s||"volume_candle"==s)for(var l=["Open","High","Low","Close"],h=1e9,c=0;c<l.length;c++){var u=a[l[c]];Math.abs(o-u)<h&&(h=Math.abs(o-u),this.magnetizedPrice=u)}var p=this.pixelFromTick(r,n),d=this.pixelFromPrice(this.magnetizedPrice,this.currentPanel),f=this.chart.tempCanvas.context;f.beginPath(),f.lineWidth=1;var m=Math.max(this.layout.candleWidth,12)/3;f.arc(p,d,Math.min(m,8),0,2*Math.PI,!1),f.fillStyle="#FFFFFF",f.strokeStyle="#000000",f.fill(),f.stroke(),f.closePath(),this.chart.tempCanvas.style.display="block"}this.runAppend("magnetize",arguments)}}},i.ChartEngine.prototype.positionCrosshairsAtPointer=function(){var t=this.currentPanel;if(t&&!this.runPrepend("positionCrosshairsAtPointer",arguments)){var e=t.chart,n=this.container.getBoundingClientRect();this.top=n.top,this.left=n.left,this.right=this.left+this.width,this.bottom=this.top+this.height,this.cy=this.crossYActualPos=this.backOutY(i.ChartEngine.crosshairY),this.cx=this.backOutX(i.ChartEngine.crosshairX);var r=this.crosshairTick=this.tickFromPixel(this.cx,e),a=this.pixelFromTick(r,e)-1;if(this.controls.crossX.style.left=a+"px",a>=t.right||a<=t.left)return void this.undisplayCrosshairs();var o="chart"==t.name?this.preferences.horizontalCrosshairField:t.horizontalCrosshairField,s=e.dataSet;o&&s&&r<s.length&&r>-1&&(this.crossYActualPos=this.pixelFromPrice(s[r][o],t)),this.controls.crossY.style.top=this.crossYActualPos+"px",this.runAppend("positionCrosshairsAtPointer",arguments)}},i.ChartEngine.prototype.doDisplayCrosshairs=function(){if(!this.runPrepend("doDisplayCrosshairs",arguments)){if(this.displayInitialized){var t=this.floatCanvas,e=this.currentVectorParameters.vectorType;if(this.layout.crosshair||""!==e&&e)if(i.Drawing&&i.Drawing[e]&&(new i.Drawing[e]).dragToDraw)this.undisplayCrosshairs();else if(this.overXAxis||this.overYAxis||!i.ChartEngine.insideChart&&!this.grabbingScreen)this.undisplayCrosshairs();else if(""!==this.openDialog)this.undisplayCrosshairs();else{var n=this.controls,r=n.crossX,a=n.crossY;""!==r.style.display&&(r.style.display="",a.style.display="",this.preferences.magnet&&e?(i.unappendClassName(this.container,"stx-crosshair-on"),this.chart.tempCanvas.style.display="block"):i.appendClassName(this.container,"stx-crosshair-on")),n.floatDate&&!i.ChartEngine.hideDates()&&(n.floatDate.style.visibility="",this.currentPanel&&this.updateFloatHRLabel(this.currentPanel)),t&&(t.style.display="block")}else this.undisplayCrosshairs()}this.runAppend("doDisplayCrosshairs",arguments)}},i.ChartEngine.prototype.undisplayCrosshairs=function(){if(!this.runPrepend("undisplayCrosshairs",arguments)){var t=this.controls,e=t.crossX,n=t.crossY;e&&"none"!=e.style.display&&(e.style.display="none",n.style.display="none"),this.displayInitialized&&t.floatDate&&(t.floatDate.style.visibility="hidden"),i.unappendClassName(this.container,"stx-crosshair-on");var r=this.floatCanvas;if(r&&r.isDirty&&(i.clearCanvas(r,this),"none"!=r.style.display&&(r.style.display="none")),!this.activeDrawing&&!this.repositioningDrawing&&!this.editingAnnotation){var a=this.chart.tempCanvas;a&&"none"!=a.style.display&&(a.style.display="none")}this.runAppend("undisplayCrosshairs",arguments)}},i.ChartEngine.prototype.modalBegin=function(){this.openDialog="modal",this.undisplayCrosshairs()},i.ChartEngine.prototype.modalEnd=function(){this.cancelTouchSingleClick=!0,this.openDialog="",this.doDisplayCrosshairs()},i.ChartEngine.prototype.updateChartAccessories=function(){if(null!==this.accessoryTimer&&clearTimeout(this.accessoryTimer),!i.ChartEngine.drawingLine&&i.touchDevice&&(new Date).getTime()-this.lastAccessoryUpdate<100)return void(this.accessoryTimer=setTimeout(function(t){return function(){t.updateChartAccessories()}}(this),10));if(this.chart.dataSet&&!this.runPrepend("updateChartAccessories",arguments)){this.positionCrosshairsAtPointer(),this.accessoryTimer=null,this.lastAccessoryUpdate=(new Date).getTime();var t=this.controls.floatDate;if(t){var e=this.currentPanel;if(e||(e=this.chart.panel),e){var n=e.chart,r=!0===this.xAxisAsFooter?0:this.chart.canvasHeight-e.chart.bottom,a=this.pixelFromTick(this.crosshairTick,n)-t.offsetWidth/2-.5;a<0&&(a=0),i.efficientDOMUpdate(t.style,"left",a+"px"),i.efficientDOMUpdate(t.style,"bottom",r+"px")}}this.headsUpHR(),this.runAppend("updateChartAccessories",arguments)}},i.ChartEngine.prototype.mousemove=function(t){var e=t||event;i.ChartEngine.crosshairX=e.clientX,i.ChartEngine.crosshairY=e.clientY,this.runPrepend("mousemove",arguments)||this.displayInitialized&&""===this.openDialog&&(this.mousemoveinner(e.clientX,e.clientY),this.runAppend("mousemove",arguments))},i.ChartEngine.prototype.setResizeTimer=function(t){this.resizeDetectMS=t,t?(this.resizeTimeout&&window.clearInterval(this.resizeTimeout),this.resizeTimeout=window.setInterval(function(t){return function(){t.chart.canvas&&(i.isAndroid||t.chart.canvas.height==Math.floor(t.devicePixelRatio*t.chart.container.clientHeight)&&t.chart.canvas.width==Math.floor(t.devicePixelRatio*t.chart.container.clientWidth)||t.resizeChart())}}(this),t)):(this.resizeTimeout&&window.clearInterval(this.resizeTimeout),this.resizeTimeout=null)},i.ChartEngine.prototype.whichYAxis=function(t,e){if(void 0===e&&(e=this.cx),t)for(var i=t.yaxisLHS.concat(t.yaxisRHS),n=0;n<i.length;n++){var r=i[n];if(r.left<=e&&r.left+r.width>=e)return r}return this.chart.panel.yAxis},i.ChartEngine.prototype.findHighlights=function(t,e){function n(t,e,n,r,a){function o(t){return t?s.transformFunc&&r==s.yAxis?t.transform&&t.transform[n]?t.transform[n]:s.transformFunc(this,s,t[n]):t[n]:null}var s=this.chart,l=this.currentPanel;r||(r=s.yAxis);var h,c,u,p,d,f=s.dataSegment[w],m=null,g=null,v=null,y=new Array(3);if(f&&a){u=a[w],m=f.tick,(u||0===u)&&(y[0]=1);var b;for(b=w-1;b>=0;b--)if(a[b]||0===a[b]){p=a[b],g=m-(w-b),y[1]=1;break}for(b=w+1;b<s.dataSegment.length;b++)if(a[b]||0===a[b]){d=a[b],v=m-(w-b),y[2]=1;break}}if(null===g&&(h=this.getPreviousBar.call(this,s,n,w))&&(g=h.tick,p=o(h)),null===v&&(c=this.getNextBar.call(this,s,n,w))&&(v=c.tick,d=o(c)),null===g&&null===v)return!1;a||(u=o(f),p=o(h),d=o(c),m=f.tick,h&&(g=h.tick),c&&(v=c.tick)),p||0===p||(p=0,g=0),d||0===d||(u||0===u?(d=u,y[2]=y[0]):(d=p,y[2]=y[1]),v=s.dataSet.length-1),u||0===u||(u=d,m=v,y[0]=y[2],0===p&&0===g&&(p=u,g=m,y[1]=y[0]));var x=this.pixelFromTransformedValue.bind(this),C=this.valueFromPixel.bind(this);return u=C(y[0]?u:x(u,l,r),l),p=C(y[1]?p:x(p,l,r),l),d=C(y[2]?d:x(d,l,r),l),!(!i.boxIntersects(e.x0,e.y0,e.x1,e.y1,g,p,m,u,"segment")&&!i.boxIntersects(e.x0,e.y0,e.x1,e.y1,m,u,v,d,"segment"))}var r=this.preferences.highlightsRadius;t&&(r=this.preferences.highlightsTapRadius);var a=this.cy,o=this.cx;if(this.anyHighlighted=!1,this.currentPanel){this.preferences.magnet&&!this.activeDrawing&&i.clearCanvas(this.chart.tempCanvas,this),this.activeDrawing&&(e=!0);var s=!1,l=null,h=e?null:["","",!0,null,"drawing"],c=this.currentPanel.chart,u={x0:this.tickFromPixel(o-r,c),x1:this.tickFromPixel(o+r,c),y0:this.valueFromPixel(a-r,this.currentPanel),y1:this.valueFromPixel(a+r,this.currentPanel)};this.repositioningDrawing&&u.x1-u.x0<2?(u.x1++,u.x0--):u.x1==u.x0&&(u.x0-=.5,u.x1+=.5);for(var p=this.drawingObjects.length-1;p>=0;p--){var d=this.drawingObjects[p];if(!d.permanent&&(this.panels[d.panelName]&&(!this.repositioningDrawing||this.repositioningDrawing==d))){var f=d.highlighted,m=d.panelName==this.currentPanel.name;d.repositioner=d.intersected(this.crosshairTick,this.crosshairValue,u),m=m&&d.repositioner,!e&&m?(f?(l=d,this.anyHighlighted&&this.singleDrawingHighlight&&(d.highlighted=!1)):f!=d.highlight(!0)&&(l||(l=d),this.anyHighlighted&&this.singleDrawingHighlight&&(d.highlighted=!1),s=!0),this.anyHighlighted=!0):f!=d.highlight(!1)&&(s=!0)}}var g,v,y;for(g in this.overlays)v=this.overlays[g],v.prev=v.highlight,v.highlight=!1;for(g in c.seriesRenderers)for(var b=c.seriesRenderers[g],x=0;x<b.seriesParams.length;x++)y=b.seriesParams[x],y.prev=y.highlight,y.highlight=!1;if(!e){var w=this.barFromPixel(o);if(w<c.dataSegment.length){var C;for(g in this.overlays)if(v=this.overlays[g],v.panel==this.currentPanel.name&&!1!==v.study.isHighlighted)if("function"!=typeof v.study.isHighlighted){var S=c.dataSegment[w];if(S){for(var T in v.outputMap)if(n.call(this,w,u,T,this.panels[v.panel].yAxis)){v.highlight=!0,this.anyHighlighted=!0;break}if(v.highlight)break}}else v.study.isHighlighted(this,o,a)&&(v.highlight=!0,this.anyHighlighted=!0);for(g in c.seriesRenderers){var _=c.seriesRenderers[g],k=_.params.panel;if(_.params.highlightable&&k==this.currentPanel.name)for(var D=0;D<_.seriesParams.length;D++){y=_.seriesParams[D];var M=_.params.yAxis;if(!M&&k&&(M=this.panels[k].yAxis),("step"==_.params.subtype||"step"==y.type)&&w>0){if(!_.caches[y.field])continue;if(!(C=_.caches[y.field][w])&&0!==C)continue;var E=_.caches[y.field][w-1];((E||0===E)&&a+r>=C&&a-r<=E||a-r<=C&&a+r>=E)&&(y.highlight=!0,this.anyHighlighted=!0)}else n.call(this,w,u,y.field,M,_.caches[y.symbol])&&(y.highlight=!0,this.anyHighlighted=!0)}}}}for(g in this.overlays){if(v=this.overlays[g],v.highlight){this.anyHighlighted=!0;var A=v.inputs.display||v.name;A=this.translateIf(A),h=[A,null,null,v.permanent,"study"],l=null}v.prev!=v.highlight&&(s=!0)}for(g in c.seriesRenderers){var P=c.seriesRenderers[g];if(P.params.highlightable)for(var L=0;L<P.seriesParams.length;L++)y=P.seriesParams[L],y.highlight&&(this.anyHighlighted=!0,h=[y.display?y.display:y.symbol,y.color,!1,y.permanent,"series"],l=null),y.prev!=y.highlight&&(s=!0)}s&&(this.draw(),this.displaySticky.apply(this,this.anyHighlighted?h:null),this.clearMeasure(),l&&l.measure()),this.anyHighlighted||this.setMeasure()}},i.ChartEngine.prototype.positionSticky=function(t){var e=Math.max(this.cy-t.offsetHeight-60,0),i=Math.min(this.chart.canvasWidth-(this.cx-50),this.chart.canvasWidth-t.offsetWidth);t.style.top=e+"px",t.style.right=i+"px"},i.ChartEngine.prototype.displaySticky=function(t,e,n,a,o){var s=this.controls.mSticky;if(s){var l=r("#mStickyInterior",s);if(l){var h=r("#overlayTrashCan",s),c=r(".overlayEdit",s),u=r("#mouseDeleteInstructions",s);n||t?(t||(t=""),n&&!t?(l.style.backgroundColor="",l.style.color="",l.style.display="none"):e?(l.style.backgroundColor=e,l.style.color=i.chooseForegroundColor(e),l.style.display="inline-block"):(l.style.backgroundColor="",l.style.color="",l.style.display="inline-block"),l.innerHTML=t,o&&(r("#mStickyRightClick",s).className="rightclick_"+o),s.style.display="inline-block",this.positionSticky(s),a||this.bypassRightClick?this.controls.mSticky.style.display="none":i.touchDevice?(h&&(h.style.display="inline-block"),c&&(c.style.display="inline-block"),u&&(u.style.display="none")):u&&(u.style.display="block")):(l.innerHTML="",s.style.display="none",i.touchDevice?(h&&(h.style.display="none"),c&&(c.style.display="none")):i.touchDevice||u&&(u.style.display="none"))}}},i.ChartEngine.prototype.setMeasure=function(t,e,i,r,a){if(!this.runPrepend("setMeasure",arguments)){var o=n("mMeasure"),s="";if(t){var l=Math.round(Math.abs(t-e)*this.chart.roundit)/this.chart.roundit;l=l.toFixed(this.chart.yAxis.printDecimalPlaces),this.internationalizer?s+=this.internationalizer.numbers.format(l):s+=l;var h=(e-t)/t;h=Math.abs(h)>.1?Math.round(100*h):Math.abs(h)>.01?Math.round(1e3*h)/10:Math.round(1e4*h)/100,this.internationalizer?h=this.internationalizer.percent.format(h/100):h+="%",s+=" ("+h+")";var c=Math.abs(r-i);c=Math.round(c)+1;s+=" "+c+" "+this.translateIf("Bars"),o&&("measureLit"!=o.className&&(o.className="measureLit"),o.innerHTML=s)}else o&&"measureUnlit"!=o.className&&(o.className="measureUnlit"),this.anyHighlighted||""!==this.currentVectorParameters.vectorType||this.clearMeasure();this.activeDrawing||(o=this.controls.mSticky,o&&(a?(o.style.display="inline-block",o.children[0].style.display="inline-block",t&&(o.children[0].innerHTML=s),this.positionSticky(o)):(o.style.display="none",o.children[0].innerHTML="")),this.runAppend("setMeasure",arguments))}},i.ChartEngine.prototype.clearMeasure=function(){var t=n("mMeasure");t&&("measureUnlit"!=t.className&&(t.className="measureUnlit"),t.innerHTML="")},i.ChartEngine.prototype.pixelFromBar=function(t,e){e||(e=this.chart);var i=0,n=this.chart.segmentImage;return i=n&&n[t]&&n[t].leftOffset?n[t].leftOffset:(t+.5)*this.layout.candleWidth,i=e.panel.left+Math.floor(i+this.micropixels)-1},i.ChartEngine.prototype.barFromPixel=function(t,e){e||(e=this.chart);var i=this.chart.segmentImage,n=this.micropixels,r=this.layout.candleWidth;if(i){var a,o,s,l=t-e.panel.left-n,h=2,c=i.length,u=Math.round(c/h),p=i[c-1].leftOffset+i[c-1].candleWidth/2;if(l>p)return c+Math.floor((t-p-e.panel.left-n)/r);for(var d=1;d<c&&(h*=2,a=i[u]);d++){o=a.leftOffset,s=a.candleWidth/2;var f=o-s,m=o+s;if(0===u||l>=f&&l<m)break;l<f?u-=Math.max(1,Math.round(c/h)):u+=Math.max(1,Math.round(c/h)),u=Math.max(0,Math.min(c-1,u))}if(!i[u])for(d=0;d<c;d++)if(a=i[d]){if(o=a.leftOffset,s=a.candleWidth/2,l<o-s)return Math.max(0,d-1);if(l<o+s)return d;if(l>=o+s)return d+1}return u}return Math.floor((t-e.panel.left-n)/r)},i.ChartEngine.prototype.tickFromPixel=function(t,e){e||(e=this.chart);var i=e.dataSet.length-e.scroll;return e.segmentImage?i+=this.barFromPixel(t,e):i+=Math.floor((t-e.panel.left-this.micropixels)/this.layout.candleWidth),i},i.ChartEngine.prototype.pixelFromTick=function(t,e){e||(e=this.chart);var i=e.dataSegment,n=e.dataSet,r=e.segmentImage,a=this.micropixels,o=i?i.length:0,s=e.panel,l=e.scroll,h=t-n.length+l,c=o?i[h]:null;if(r&&(c=r[h]),c&&c.leftOffset)return s.left+Math.floor(c.leftOffset+a);var u=0,p=0;return c=o?i[o-1]:null,r&&(c=r[o-1]),c&&c.leftOffset&&o<t-n.length+l&&(u=c.leftOffset-c.candleWidth/2,p=o),u+s.left+Math.floor((t-p-n.length+l+.5)*this.layout.candleWidth+a)},i.ChartEngine.prototype.pixelFromDate=function(t,e){return this.pixelFromTick(this.tickFromDate(t,e),e)},i.ChartEngine.prototype.transformedPriceFromPixel=function(t,e,i){e||(e=this.chart.panel);var n=i||e.yAxis;if(t=n.bottom-t,!n.multiplier)return null;var r=n.low+t/n.multiplier;if(n.semiLog){var a=n.logLow+t*n.logShadow/n.height;r=Math.pow(10,a)}return r},i.ChartEngine.prototype.priceFromPixel=function(t,e,i){e||(e=this.chart.panel);var n=this.transformedPriceFromPixel(t,e,i);return this.charts[e.name]&&e.chart.untransformFunc&&(n=e.chart.untransformFunc(this,e.chart,n,i)),n},i.ChartEngine.prototype.valueFromPixel=function(t,e,n){return e||(e=this.whichPanel(t)),e||(e=t<=0?this.panels[i.first(this.panels)]:this.panels[i.last(this.panels)]),this.priceFromPixel(t,e,n)},i.ChartEngine.prototype.valueFromPixelUntransform=function(t,e,i){return this.valueFromPixel(t,e,i)},i.ChartEngine.prototype.pixelFromPriceTransform=function(t,e,i){return this.pixelFromPrice(t,e,i)},i.ChartEngine.prototype.pixelFromTransformedValue=function(t,e,i){e||(e=this.chart.panel);var n=i||e.yAxis,r=(n.high-t)*n.multiplier;if(n.semiLog){var a=Math.max(t,0),o=Math.log(a)/Math.LN10,s=n.height;r=s-s*(o-n.logLow)/n.logShadow}return r+=n.top},i.ChartEngine.prototype.pixelFromPrice=function(t,e,i){return e||(e=this.chart.panel),this.charts[e.name]&&e.chart.transformFunc&&(t=e.chart.transformFunc(this,e.chart,t,i)),this.pixelFromTransformedValue(t,e,i)},i.ChartEngine.prototype.pixelFromValueAdjusted=function(t,e,i,n){if(this.layout.adj||!this.charts[t.name])return this.pixelFromPrice(i,t,n);var r,a=Math.round(e);return a>0&&a<t.chart.dataSet.length&&(r=t.chart.dataSet[a].ratio)?this.pixelFromPrice(i*r,t,n):this.pixelFromPrice(i,t,n)},i.ChartEngine.prototype.adjustIfNecessary=function(t,e,i){if(this.layout.adj)return i;if(!t||!this.charts[t.name])return i;var n,r=Math.round(e);return r>0&&r<t.chart.dataSet.length&&(n=t.chart.dataSet[r].ratio)?i/n:i},i.ChartEngine.prototype.setTransform=function(t,e,i){t.transformFunc=e,t.untransformFunc=i},i.ChartEngine.prototype.unsetTransform=function(t){delete t.transformFunc,delete t.untransformFunc;for(var e=0;e<t.dataSet.length;e++)t.dataSet[e].transform=null},i.ChartEngine.prototype.undo=function(){this.runPrepend("undo",arguments)||(this.activeDrawing&&(this.activeDrawing.abort(),this.activateDrawing(null),i.clearCanvas(this.chart.tempCanvas,this),this.draw(),i.swapClassName(this.controls.crossX,"stx_crosshair","stx_crosshair_drawing"),i.swapClassName(this.controls.crossY,"stx_crosshair","stx_crosshair_drawing"),i.ChartEngine.drawingLine=!1),this.runAppend("undo",arguments))},i.ChartEngine.prototype.undoStamp=function(t,e){this.undoStamps.push(t),this.dispatch("undoStamp",{before:t,after:e,stx:this})},i.ChartEngine.prototype.undoLast=function(){this.activeDrawing?this.undo():this.undoStamps.length&&(this.drawingObjects=this.undoStamps.pop(),this.changeOccurred("vector"),this.draw())},i.ChartEngine.prototype.addDrawing=function(t){var e=i.shallowClone(this.drawingObjects);this.drawingObjects.push(t),this.undoStamp(e,i.shallowClone(this.drawingObjects))},i.ChartEngine.prototype.connectTheDots=function(t,e,n,r,a,o){if(o||(o={}),"none"!=o.pattern&&(!0===a&&(a=this.chart.panel),null!==r&&void 0!==r||(r=this.chart.context),!(t.length<4))){var s=0,l=this.chart.canvasHeight,h=this.chart.width;a&&(l=a.yAxis.bottom,s=a.yAxis.top),r.lineWidth=1.1,"object"==(void 0===e?"undefined":_typeof(e))?(r.strokeStyle=e.color,e.opacity?r.globalAlpha=e.opacity:r.globalAlpha=1,r.lineWidth=parseInt(i.stripPX(e.width),10)):!e||"auto"==e||i.isTransparent(e)?r.strokeStyle=this.defaultColor:r.strokeStyle=e,o.opacity&&(r.globalAlpha=o.opacity),o.lineWidth&&(r.lineWidth=o.lineWidth);var c=i.borderPatternToArray(r.lineWidth,o.pattern);r.beginPath();for(var u=0;u<t.length-2;u+=2){var p=t[u],d=t[u+1],f=t[u+2],m=t[u+3];if(isNaN(p)||isNaN(f)||isNaN(d)||isNaN(m))return;for(var g,v,y,b=0,x=1,w=f-p,C=m-d,S=0;S<4;S++){if(0===S&&(g=-w,v=-(0-p)),1==S&&(g=w,v=h-p),2==S&&(g=-C,v=-(s-d)),3==S&&(g=C,v=l-d),y=v/g,(m||0===m)&&0===g&&v<0)return!1;if(g<0){if(y>x)return!1;y>b&&(b=y)}else if(g>0){if(y<b)return!1;y<x&&(x=y)}}var T=p+b*w,_=d+b*C,k=p+x*w,D=d+x*C;try{c&&c.length?r.dashedLineTo(T,_,k,D,c):(r.moveTo(T,_),r.lineTo(k,D))}catch(t){}}r.stroke(),r.closePath(),r.globalAlpha=1,r.lineWidth=1}},i.ChartEngine.prototype.plotSpline=function(t,e,n,r,o,s,l){if(l||(l={}),"none"!=l.pattern){!0===s&&(s=this.chart.panel),null!==o&&void 0!==o||(o=this.chart.context),o.save(),o.lineWidth=1.1,"object"==(void 0===n?"undefined":_typeof(n))?(o.strokeStyle=n.color,n.opacity?o.globalAlpha=n.opacity:o.globalAlpha=1,o.lineWidth=parseInt(i.stripPX(n.width),10)):!n||"auto"==n||i.isTransparent(n)?o.strokeStyle=this.defaultColor:o.strokeStyle=n,l.opacity&&(o.globalAlpha=l.opacity),l.lineWidth&&(o.lineWidth=l.lineWidth);var h=i.borderPatternToArray(o.lineWidth,l.pattern);l.pattern&&o.setLineDash&&(o.setLineDash(h),o.lineDashOffset=0),o.beginPath(),a.plotSpline(t,e,o),o.stroke(),o.closePath(),o.restore()}},i.ChartEngine.prototype.repositionDrawing=function(t,e){var n=this.panels[t.panelName],r=this.adjustIfNecessary(n,this.crosshairTick,this.valueFromPixel(this.backOutY(i.ChartEngine.crosshairY),n));this.preferences.magnet&&this.magnetizedPrice&&n.name==n.chart.name&&(r=this.adjustIfNecessary(n,this.crosshairTick,this.magnetizedPrice));var a=this.chart.tempCanvas;i.clearCanvas(a,this),e?t.render(a.context):t.reposition(a.context,t.repositioner,this.crosshairTick,r),t.measure&&t.measure()},i.ChartEngine.prototype.activateRepositioning=function(t){this.repositioningDrawing=t;t&&(this.draw(),this.repositionDrawing(t,!0)),this.chart.tempCanvas.style.display=t?"block":"none"},i.ChartEngine.prototype.activateDrawing=function(t,e){if(!t)return this.activeDrawing=null,this.chart.tempCanvas.style.display="none",!1;e||(e=this.chart.panel);var n=i.ChartEngine.drawingTools[t];return n||i.Drawing[t]&&(n=i.Drawing[t],i.ChartEngine.registerDrawingTool(t,n)),n&&(this.activeDrawing=new n,this.activeDrawing.construct(this,e),!this.charts[e.name]&&this.activeDrawing.chartsOnly)?(this.activeDrawing=null,!1):(this.chart.tempCanvas.style.display="block",!0)},i.ChartEngine.prototype.drawingClick=function(t,e,n){if(i.Drawing&&""===this.openDialog){if(!this.activeDrawing){if(!t)return;if(!this.activateDrawing(this.currentVectorParameters.vectorType,t))return}if(this.activeDrawing){if(this.userPointerDown&&!this.activeDrawing.dragToDraw)return void(i.ChartEngine.drawingLine||this.activateDrawing(null));var r=this.tickFromPixel(e,t.chart),a=this.panels[this.activeDrawing.panelName],o=this.adjustIfNecessary(a,r,this.valueFromPixel(n,a));return this.preferences.magnet&&this.magnetizedPrice&&(o=this.adjustIfNecessary(a,r,this.magnetizedPrice)),this.activeDrawing.click(this.chart.tempCanvas.context,r,o)?this.activeDrawing&&(i.ChartEngine.drawingLine=!1,i.clearCanvas(this.chart.tempCanvas,this),this.addDrawing(this.activeDrawing),this.activateDrawing(null),this.adjustDrawings(),this.draw(),this.changeOccurred("vector"),i.swapClassName(this.controls.crossX,"stx_crosshair","stx_crosshair_drawing"),i.swapClassName(this.controls.crossY,"stx_crosshair","stx_crosshair_drawing")):(this.changeOccurred("drawing"),i.ChartEngine.drawingLine=!0,i.swapClassName(this.controls.crossX,"stx_crosshair_drawing","stx_crosshair"),i.swapClassName(this.controls.crossY,"stx_crosshair_drawing","stx_crosshair")),!0}return!1}},i.ChartEngine.prototype.whichPanel=function(t){for(var e in this.panels){var i=this.panels[e];if(!i.hidden&&(t>i.top&&t<i.bottom))return i}return null},i.ChartEngine.prototype.mouseup=function(t){if(!this.runPrepend("mouseup",arguments)){if(this.swipe.end=!0,this.cancelLongHold=!0,this.repositioningDrawing){if(!this.currentVectorParameters.vectorType||Date.now()-this.mouseTimer>250)return this.changeOccurred("vector"),i.clearCanvas(this.chart.tempCanvas,this),this.activateRepositioning(null),this.adjustDrawings(),void this.draw();this.activateRepositioning(null)}if(this.repositioningBaseline)return this.repositioningBaseline=null,"baseline_delta"==this.layout.chartType&&(this.chart.panel.yAxis.scroll=this.pixelFromPrice(this.chart.baseline.userLevel,this.chart.panel)-(this.chart.panel.yAxis.top+this.chart.panel.yAxis.bottom)/2),void this.draw();var e=this.userPointerDown;if(this.userPointerDown=!1,this.displayInitialized){if(this.grabbingScreen=!1,""!==this.openDialog)return void(i.ChartEngine.insideChart&&i.unappendClassName(this.container,"stx-drag-chart"));if(this.grabOverrideClick)return this.swipeRelease(),i.unappendClassName(this.container,"stx-drag-chart"),this.grabOverrideClick=!1,this.doDisplayCrosshairs(),void this.updateChartAccessories();if(i.ChartEngine.insideChart&&i.unappendClassName(this.container,"stx-drag-chart"),i.ChartEngine.resizingPanel)return void this.releaseHandle({});if(t||(t=event),t.which&&t.which>=2||t.button&&t.button>=2||t.ctrlKey)return this.anyHighlighted&&!this.bypassRightClick?(this.rightClickHighlighted(),t.preventDefault&&this.captureTouchEvents&&t.preventDefault(),t.stopPropagation(),!1):(this.dispatch("rightClick",{stx:this,panel:this.currentPanel,x:r,y:n}),!0);if(!(t.clientX<this.left||t.clientX>this.right||t.clientY<this.top||t.clientY>this.bottom)){var n=this.backOutY(t.clientY),r=this.backOutX(t.clientX);!e||this.longHoldTookEffect&&!this.activeDrawing||this.drawingClick(this.currentPanel,r,n),this.activeDrawing||this.longHoldTookEffect||this.dispatch("tap",{stx:this,panel:this.currentPanel,x:r,y:n}),this.runAppend("mouseup",arguments)}}}},i.ChartEngine.prototype.grabbingHand=function(){this.allowScroll&&this.grabbingScreen&&(i.touchDevice||i.appendClassName(this.container,"stx-drag-chart"))},i.ChartEngine.prototype.mousedown=function(t){if(!this.runPrepend("mousedown",arguments)&&(this.grabOverrideClick=!1,this.displayInitialized&&this.displayCrosshairs&&!this.repositioningDrawing&&!(this.editingAnnotation||(t||(t=event),t.which&&t.which>=2||t.button&&t.button>=2)))){var e=this.container.getBoundingClientRect();if(this.top=e.top,this.left=e.left,this.right=this.left+this.width,this.bottom=this.top+this.height,!(t.clientX>=this.left&&t.clientX<=this.right&&t.clientY>=this.top&&t.clientY<=this.bottom))return void(i.ChartEngine.insideChart=!1);if(i.ChartEngine.insideChart=!0,this.currentPanel){this.manageTouchAndMouse&&t&&t.preventDefault&&this.captureTouchEvents&&t.preventDefault(),this.mouseTimer=Date.now(),this.longHoldTookEffect=!1,this.hasDragged=!1,this.userPointerDown=!0;for(var n=this.currentPanel.chart,r=0;r<this.drawingObjects.length;r++){var a=this.drawingObjects[r];if(a.highlighted){if(this.cloneDrawing){var o=i.ChartEngine.drawingTools[a.name],s=new o;return s.reconstruct(this,a.serialize()),this.drawingObjects.push(s),this.activateRepositioning(s),void(s.repositioner=a.repositioner)}var l=this.currentVectorParameters.vectorType;if(!(i.Drawing&&l&&i.Drawing[l]&&(new i.Drawing[l]).dragToDraw))return void this.activateRepositioning(a)}}if(("baseline_delta"==this.layout.chartType||"baseline_delta_mountain"==this.layout.chartType)&&!1!==n.baseline.userLevel){var h=this.valueFromPixel(this.cy-5,this.currentPanel),c=this.valueFromPixel(this.cy+5,this.currentPanel),u=this.chart.right-parseInt(getComputedStyle(this.controls.baselineHandle).width,10);if(n.baseline.actualLevel<h&&n.baseline.actualLevel>c&&this.cx>u)return void(this.repositioningBaseline={lastDraw:Date.now()})}this.drawingClick(this.currentPanel,this.cx,this.cy),this.activeDrawing&&this.activeDrawing.dragToDraw||(this.grabbingScreen=!0,n.spanLock=!1,this.yToleranceBroken=!1,t||(t=event),this.grabStartX=t.clientX,this.grabStartY=t.clientY,this.grabStartMicropixels=this.micropixels,this.grabStartScrollX=n.scroll,this.grabStartScrollY=this.currentPanel.yAxis.scroll,this.grabStartCandleWidth=this.layout.candleWidth,this.grabStartYAxis=this.whichYAxis(this.currentPanel),this.grabStartZoom=this.grabStartYAxis.zoom,this.grabStartPanel=this.currentPanel,setTimeout(function(t){return function(){t.grabbingHand()}}(this),100),this.swipeStart(n),this.longHoldTime&&this.startLongHoldTimer(),this.runAppend("mousedown",arguments))}}},i.ChartEngine.prototype.startLongHoldTimer=function(){var t=this;this.cancelLongHold=!1,this.longHoldTimeout&&clearTimeout(this.longHoldTimeout),this.longHoldTimeout=setTimeout(function(){t.cancelLongHold||(t.dispatch("longhold",{stx:t,panel:t.currentPanel,x:t.cx,y:t.cy}),t.longHoldTookEffect=!0)},this.longHoldTime)},i.ChartEngine.prototype.changeVectorType=function(t){this.currentVectorParameters.vectorType=t,i.ChartEngine.drawingLine&&this.undo(),this.setCrosshairColors(),i.ChartEngine.insideChart&&this.doDisplayCrosshairs()},i.ChartEngine.prototype.changeVectorParameter=function(t,e){"axisLabel"==t?e="true"===e.toString()||Number(e):"lineWidth"==t?e=Number(e):"fontSize"==t&&(e=parseInt(e,10)+"px");var i=this.currentVectorParameters;return void 0!==i[t]?(i[t]=e,!0):"font"==t.substr(0,4)&&(t=t.substr(4).toLowerCase(),"family"==t&&"default"==e.toLowerCase()&&(e=null),i=i.annotation.font,void 0!==i[t])&&(i[t]=e,!0)},i.ChartEngine.prototype.rightClickOverlay=function(t,e){if(!this.runPrepend("rightClickOverlay",arguments)){var i=this.overlays[t];i.editFunction?i.editFunction(e):this.removeOverlay(t),this.runAppend("rightClickOverlay",arguments)}},i.ChartEngine.prototype.removeOverlay=function(t){if(!this.runPrepend("removeOverlay",arguments)){var e=this.overlays[t];for(var n in this.overlays){var r=this.overlays[n],a=["Field"];i.Studies&&(a=i.Studies.getFieldInputs(r));for(var o=0;o<a.length;o++)e.outputMap[r.inputs[a[o]]]&&this.removeOverlay(r.name)}if(i.Studies){var s=this.layout.studies[t];i.deleteRHS(i.Studies.studyPanelMap,s),e&&this.cleanupRemovedStudy(e)}delete this.overlays[t],this.displaySticky(),this.createDataSet(),this.changeOccurred("layout"),this.runAppend("removeOverlay",arguments)}},i.ChartEngine.prototype.addSeries=function(t,e,n){function r(e,n){if(n.parameters.color){var r=e.getSeriesRenderer("_generic_series");r||(r=e.setSeriesRenderer(new i.Renderer.Lines({params:{panel:n.parameters.panel,type:"legacy",name:"_generic_series",overChart:!0,useChartLegend:!0}}))),r.attachSeries(t,n.parameters).ready()}}function a(t){return function(a){a.error||(i.addMemberToMasterdata({stx:p,label:l,fieldForLabel:e.field,data:a.quotes,fillGaps:e.fillGaps}),r(p,s)),null===e.action||u||p.dispatch("symbolChange",{stx:p,symbol:t.symbol,symbolObject:t.symbolObject,action:e.action}),n&&n.call(p,a.error,s)}}if(!this.runPrepend("addSeries",arguments)){var o=t||null;t||(t=i.uniqueID());var s={parameters:e?i.clone(e):{},yValueCache:[],display:o,id:t};e=s.parameters;var l=t;e.symbol&&(l=e.symbol),i.ensureDefaults(e,{chartName:this.chart.name,symbolObject:{symbol:l},chartType:"line",panel:this.chart.panel.name,action:"add-series"}),"display"in e&&(s.display=e.display),e.isComparison&&(e.shareYAxis=!0);var h=this.charts[e.chartName],c=e.symbolObject;l=e.symbol=c.symbol,s.display||(s.display=l);var u=this.getSeries({symbolObject:c,chart:h,includeMaster:!0}).length;h.series[t]=s;var p=this;e.isComparison&&this.setComparison(!0,h);var d=h.masterData;d||(d=h.masterData=this.masterData=[]);var f=d.length;if(e.data&&!e.data.useDefaultQuoteFeed)i.addMemberToMasterdata({stx:this,label:l,fieldForLabel:e.field,data:e.data,fillGaps:e.fillGaps}),r(this,s),n&&n.call(this,null,s);else if(u)r(this,s),n&&setTimeout(function(){n.call(p,null,s)},0);else if(this.quoteDriver&&!1!==e.loadData){var m=this.quoteDriver,g=m.makeParams(l,c,h);f&&(g.startDate=d[0].DT,g.endDate=this.convertToDataZone(new Date)),g.stx.isEquationChart(g.symbol)?i.fetchEquationChart(g,a(g)):i.ChartEngine.Driver.fetchData(i.QuoteFeed.SERIES,m.quoteFeed,g,a(g))}else r(this,s),n&&n.call(this,null,s);return this.runAppend("addSeries",arguments),s}},i.ChartEngine.prototype.getSeries=function(t){var e=t.chart?t.chart:this.chart,n=e.series,r=t.symbolObject;r||(r={symbol:t.symbol});var a=[];for(var o in n){var s=n[o];i.symbolEqual(r,s.parameters.symbolObject)&&a.push(s)}return t.includeMaster&&i.symbolEqual(r,e.symbolObject)&&a.push({}),a},i.ChartEngine.prototype.isEquationChart=function(t){return!(!this.allowEquations||!i.computeEquationChart)&&!(!t||"="!=t[0])},i.ChartEngine.prototype.getDataFields=function(t){t||(t=this.chart);var e=t.defaultPlotField;e||(e="Close");var i=["Open","High","Low"];i.push(e);for(var n in t.series){var r=t.series[n].parameters;i.push(r.symbol)}return i},i.ChartEngine.prototype.cleanMasterData=function(t,e){function i(t,e){for(var i=0;i<e.length;i++){if(void 0!==t[e[i]])return!1}return!0}var n=t.symbol,r=e.masterData;if(r&&r.length){var a=this.getDataFields(e),o=0;do{var s=r[o];delete s[n],i.call(this,s,a)?r.splice(o,1):o++}while(o<r.length);r=this.doCleanupGaps(r),this.setMasterData(r,e)}},i.ChartEngine.prototype.deleteSeries=function(t,e,i){if(!this.runPrepend("deleteSeries",arguments)){i=i||{};var n=i.action?i.action:"remove-series",r="object"==(void 0===t?"undefined":_typeof(t))?t.id:t;e||(e=this.chart);var a=e.series[r];if(a){var o=a.parameters.symbolObject;delete e.series[r];var s=this.getSeries({symbolObject:o,includeMaster:!0});if(s.length||this.cleanMasterData(o,e),"percent"!=this.layout.chartScale){var l=!1;for(var h in e.series)e.series[h].parameters.isComparison&&(l=!0);l||this.setComparison(!1,e)}this.createDataSet(),s.length||this.dispatch("symbolChange",{stx:this,symbol:o.symbol,symbolObject:o,action:n}),this.quoteDriver&&this.quoteDriver.updateSubscriptions(),this.runAppend("deleteSeries",arguments)}}},i.ChartEngine.prototype.removeSeries=function(t,e){if(!this.runPrepend("removeSeries",arguments)){var i="object"==(void 0===t?"undefined":_typeof(t))?t.id:t;e||(e=this.chart);var n=!1;for(var r in e.seriesRenderers)for(var a=e.seriesRenderers[r],o=a.seriesParams.length-1;o>=0;o--){var s=a.seriesParams[o];s.field===i&&(a.removeSeries(i),a.seriesParams.length<1&&this.removeSeriesRenderer(a),n=!0)}n||this.deleteSeries(i,e),this.draw(),this.runAppend("removeSeries",arguments)}},i.ChartEngine.prototype.isDailyInterval=function(t){return console.warn("CIQ.ChartEngine.prototype.isDailyInterval has been deprecated. Use use static version insted"),i.ChartEngine.isDailyInterval(t)},i.ChartEngine.prototype.setPeriodicity=function(t,e){if(!this.runPrepend("setPeriodicity",arguments)){var n,r,a=null;if(t&&"object"==(void 0===t?"undefined":_typeof(t))?(n=t.period,r=t.interval,a=t.timeUnit):(n=t,r=e,e=arguments[arguments.length-1],arguments.length>3&&(a=arguments[2])),"function"!=typeof e&&(e=null),r||(r=1),!isNaN(r)&&a&&"minute"!=a&&"second"!=a&&"millisecond"!=a&&(r=a),n){var o=this.layout,s=o.candleWidth;o.setSpan={},"year"==r&&(r="month",n||(n=1),n*=12),i.ChartEngine.isDailyInterval(r)?a=null:"tick"==r?a=null:a||isNaN(r)||(a="minute");var l=!1;if(this.chart.symbol&&(l=this.needDifferentData({periodicity:n,interval:r,timeUnit:a})),o.periodicity=n,o.interval=r,o.timeUnit=a,l)if(this.changeOccurred("layout"),this.quoteDriver)for(var h in this.charts)this.charts[h].symbol&&(this.displayInitialized?this.quoteDriver.newChart({symbol:this.charts[h].symbol,symbolObject:this.charts[h].symbolObject,chart:this.charts[h]},e):this.newChart(this.charts[h].symbol,null,this.charts[h],e));else this.dataCallback?(this.dataCallback(),e&&e(null)):console.log("cannot change periodicity because neither dataCallback or quoteDriver are set");else{var c,u;for(c in this.charts){u=this.charts[c];var p,d=u.dataSegment,f=u.dataSet,m=u.maxTicks,g=u.scroll,v=d?d.length:0,y=f?f.length:0,b=Math.round(u.maxTicks/2);this.setCandleWidth(s,u);var x=!0,w=!1;if(g<=m?x=!1:d&&!d[b]&&(x=!1,w=g-y),x&&v>0&&(m<(Math.round(this.chart.width/s-.499)-1)/2&&(b=v-1),b>=v?(p=d[v-1].DT,b=v-1):p=d[b].DT),this.createDataSet(),x){if(v>0)for(var C=y-1;C>=0;C--){var S=f[C].DT;if(S.getTime()<p.getTime()){u.scroll=y-C+b;break}}}else if(w)u.scroll=f.length+w;else{var T=Math.round(this.preferences.whitespace/s);u.scroll=m-T-1}}if(this.displayInitialized&&this.draw(),this.changeOccurred("layout"),this.quoteDriver)for(c in this.charts)u=this.charts[c],u.symbol&&u.moreAvailable&&this.quoteDriver.checkLoadMore(u);e&&e(null),this.runAppend("setPeriodicity",arguments)}}}},i.ChartEngine.prototype.setPeriodicityV2=function(t,e,i,n){"function"==typeof i&&(n=i,i=null),this.runPrepend("setPeriodicityV2",arguments)||(this.setPeriodicity(t,e,i,n),this.runAppend("setPeriodicityV2",arguments))},i.ChartEngine.prototype.drawVectors=function(){if(!this.vectorsShowing&&!this.runPrepend("drawVectors",arguments)){if(this.vectorsShowing=!0,!this.chart.hideDrawings){var t,e,i={};for(e=0;e<this.drawingObjects.length;e++){var n=this.drawingObjects[e];this.repositioningDrawing!==n&&(t=n.panelName,this.panels[n.panelName]&&!this.panels[n.panelName].hidden&&(i[t]||(i[t]=[]),i[t].push(n)))}for(t in i){this.startClip(t);var r=i[t];for(e=0;e<r.length;e++)r[e].render(this.chart.context);this.endClip()}}this.runAppend("drawVectors",arguments)}},i.ChartEngine.NONE=0,i.ChartEngine.CLOSEUP=1,i.ChartEngine.CLOSEDOWN=2,i.ChartEngine.CLOSEEVEN=4,i.ChartEngine.CANDLEUP=8,i.ChartEngine.CANDLEDOWN=16,i.ChartEngine.CANDLEEVEN=32,i.ChartEngine.prototype.displayChart=function(t){function e(t,e,n,r){var a=e.color;if(n&&!(a=e.borderLeftColor||e["border-left-color"]))return null;if(!r)return a;var o=t.pixelFromTransformedValue(s.chart.highValue,s);isNaN(o)&&(o=0);var l=e.backgroundColor;if(a&&!i.isTransparent(a)){var h=t.chart.context.createLinearGradient(0,o,0,2*s.yAxis.bottom-o);return h.addColorStop(0,a),h.addColorStop(1,l),h}return l}var n=this.layout.candleWidth-t.tmpWidth<=2&&t.tmpWidth<=3;if(!t.panel.hidden&&!this.runPrepend("displayChart",arguments)){var r=this.layout,a=r.chartType,o=null,s=t.panel,l=this.containerColor,h=this.colorByCandleDirection;this.controls.baselineHandle.style.display="none";var c,u,p,d,f,m=this.noWicksOnCandles;t.customChart&&(t.customChart.chartType&&(a=t.customChart.chartType),t.customChart.colorFunction&&(o=t.customChart.colorFunction));var g=this.chart.baseLegendColors=[];t.state.chartType||(t.state.chartType={});var v,y=t.state.chartType.pass={},b=this.chart.defaultPlotField;if("kagi"==r.aggregationType&&"none"!=a)this.drawKagiSquareWave(s,"stx_kagi_up","stx_kagi_down"),g.push(this.getCanvasColor("stx_kagi_up")),g.push(this.getCanvasColor("stx_kagi_down"));else if("pandf"==r.aggregationType&&"none"!=a)this.drawPointFigureChart(s,"stx_pandf_up","X"),g.push(this.getCanvasColor("stx_pandf_up")),this.drawPointFigureChart(s,"stx_pandf_down","O"),g.push(this.getCanvasColor("stx_pandf_down"));else if("line"==a||"step"==a)this.drawLineChart(s,"stx_line_chart",null,{step:"step"==a});else if("mountain"==a)g=null,this.drawMountainChart(s);else if("colored_mountain"==a||"colored_line"==a||"colored_step"==a){v="colored_mountain"==a?"drawMountainChart":"drawLineChart";var x="colored_mountain"==a?"stx_colored_mountain_chart":"stx_line_chart";c=this.getCanvasColor("stx_line_up"),u=this.getCanvasColor("stx_line_down"),p=this.getCanvasColor("stx_line_chart"),o||(o=function(t,e,i){return e.iqPrevClose||0===e.iqPrevClose?e.Close>e.iqPrevClose?c:e.Close<e.iqPrevClose?u:p:p});var w=this[v](s,x,o,{step:"colored_step"==a});for(var C in w)g.push(C)}else if("wave"==a)this.drawWaveChart(s);else if("bar"==a||"hlc"==a)this.startClip(s.name),v="bar"==a?"drawBarChartHighPerformance":"drawHLCChart",this[v](s,"stx_bar_chart"),this.endClip();else if("colored_bar"==a||"colored_hlc"==a){if(this.startClip(s.name),v="colored_bar"==a?"drawBarChartHighPerformance":"drawHLCChart",o){var S="colored_hlc"==a?"hlc":null,T=this.drawBarChart(s,"stx_bar_chart",o,{type:S});for(var _ in T)g.push(_)}else this[v](s,"stx_bar_up",h?8:1),g.push(this.getCanvasColor("stx_bar_up")),this[v](s,"stx_bar_down",h?16:2),g.push(this.getCanvasColor("stx_bar_down")),y.even&&(this[v](s,"stx_bar_even",h?32:4),g.push(this.getCanvasColor("stx_bar_even")));this.endClip()}else if("hollow_candle"==a||"volume_candle"==a){if(this.startClip(s.name),o)m[r.aggregationType]||this.drawShadows(s,o),this.drawCandles(s,o,!1),this.drawCandles(s,o,!0);else{m[r.aggregationType]||(this.drawShadowsHighPerformance(s,"stx_hollow_candle_up",1),this.drawShadowsHighPerformance(s,"stx_hollow_candle_down",2),y.even&&this.drawShadowsHighPerformance(s,"stx_hollow_candle_even",4));var k=this.getCanvasColor("stx_hollow_candle_up"),D=this.getCanvasColor("stx_hollow_candle_down"),M=this.getCanvasColor("stx_hollow_candle_even"),E=this.styles.stx_hollow_candle_up.borderColor,A=this.styles.stx_hollow_candle_down.borderColor,P=this.styles.stx_hollow_candle_even.borderColor,L=i.isTransparent(k),O=i.isTransparent(D),F=i.isTransparent(M);this.drawCandlesHighPerformance(s,k,L?E:"transparent",17),this.drawCandlesHighPerformance(s,D,O?A:"transparent",18),y.even&&this.drawCandlesHighPerformance(s,M,F?P:"transparent",20),this.drawCandlesHighPerformance(s,l,L?E:k,9),this.drawCandlesHighPerformance(s,l,O?A:D,10),y.even&&this.drawCandlesHighPerformance(s,l,F?P:M,12),g.push(k),g.push(D),y.even&&g.push(M)}this.endClip()}else if("candle"==a){if(this.startClip(s.name),o)m[r.aggregationType]||this.drawShadows(s,o),this.drawCandles(s,o,!1),n||this.drawCandles(s,o,!0);else{if(!m[r.aggregationType]){var I=this.getCanvasColor("stx_candle_shadow_up"),j=this.getCanvasColor("stx_candle_shadow_down");i.colorsEqual(I,j)&&i.colorsEqual(I,this.defaultColor)?this.drawShadowsHighPerformance(s,"stx_candle_shadow"):(this.drawShadowsHighPerformance(s,"stx_candle_shadow_up",8),this.drawShadowsHighPerformance(s,"stx_candle_shadow_down",16),this.drawShadowsHighPerformance(s,"stx_candle_shadow",32))}f=this.canvasStyle("stx_candle_up");var N=f.color;n&&i.isTransparent(f.color)&&(f.color=f.borderLeftColor),this.drawCandlesHighPerformance(s,e(this,f,!1),e(this,f,!n),8),g.push(f.color),f.color=N,f=this.canvasStyle("stx_candle_down"),N=f.color,n&&i.isTransparent(f.color)&&(f.color=f.borderLeftColor),this.drawCandlesHighPerformance(s,e(this,f,!1),e(this,f,!n),16),g.push(f.color),f.color=N}this.endClip()}else if("histogram"==a){if(this.startClip(s.name),o)this.drawCandles(s,o,!1,!0),n||this.drawCandles(s,o,!0,!0);else for(var R=[["stx_histogram_up",8],["stx_histogram_down",16],["stx_histogram_even",32]],V=0;V<R.length;V++){var H=R[V][1],z=R[V][0];f=this.canvasStyle(z),this.drawCandlesHighPerformance(s,e(this,f,!1,!0),e(this,f,!n,!0),H,!0),g.push(f.color)}this.endClip()}else if("baseline_delta"==a||"baseline_delta_mountain"==a){var B="baseline_delta_mountain"==a;if(null!==(d=t.baseline.actualLevel)&&!isNaN(d)){B&&this.drawMountainChart(s,"stx_baseline_delta_mountain"),this.startClip(s.name),d=this.pixelFromPrice(d,t.panel);var W={over:"stx_baseline_up",under:"stx_baseline_down"},q=0;for(var U in W){var Y={panelName:"chart",band:b,threshold:t.baseline.actualLevel,color:B?"transparent":this.getCanvasColor(W[U]),direction:"over"==U?1:-1,edgeHighlight:this.getCanvasColor(W[U]),edgeParameters:{pattern:"solid",lineWidth:parseInt(this.canvasStyle(W[U]).width,10)+.1,opacity:1},gaps:t.gaplines},X=Y.color;if(!B&&X&&"transparent"!=X){var K=t.context.createLinearGradient(0,"over"==U?0:2*d,0,d);K.addColorStop(0,i.hexToRgba(X,60)),K.addColorStop(1,i.hexToRgba(X,10)),Y.color=K,Y.opacity=1}g.push(X),i.preparePeakValleyFill(this,Y),t.gaplines&&(t.gaplines.fillMountain||(this.setStyle("stx_baseline_trace","color","transparent"),this.drawLineChart(s,"stx_baseline_trace",null,{width:Y.edgeParameters.lineWidth,gaps:this.containerColor})),t.gaplines.color||(t.gaplines.color=this.defaultColor)),q+=Y.edgeParameters.lineWidth}this.setStyle("stx_baseline_trace","color","transparent"),this.drawLineChart(s,"stx_baseline_trace",null,{width:Math.round(q/2)+.1}),this.plotLine(0,1,d,d,l,"line",t.context,!0,{pattern:"solid",lineWidth:"1.1",opacity:1}),this.plotLine(0,1,d,d,this.getCanvasColor("stx_baseline"),"line",t.context,!0,{pattern:"dotted",lineWidth:"2.1",opacity:.5}),!1!==this.chart.baseline.userLevel&&(this.controls.baselineHandle.style.top=d-parseInt(getComputedStyle(this.controls.baselineHandle).height,10)/2+"px",this.controls.baselineHandle.style.left=this.chart.right-parseInt(getComputedStyle(this.controls.baselineHandle).width,10)+"px",this.controls.baselineHandle.style.display="block"),this.endClip()}}else"scatterplot"==a?(this.startClip(s.name),this.scatter(s),this.endClip()):a&&"none"!=a?(console.log('Invalid chart layout.chartType: "'+a+'". Defaulting to Line Chart.'),r.chartType="line",this.drawLineChart(s,"stx_line_chart")):this.chart.baseLegendColors=null;this.runAppend("displayChart",arguments)}},i.ChartEngine.prototype.calculateATR=function(t,e,i){i||(i=t.dataSet);var n=t.state.calculations.atr;n||(n=t.state.calculations.atr={}),e||(e=20);var r=[];n.accum&&(r=n.accum);for(var a,o=0;o<i.length;o++){var s=i[o];if(a=o?i[o-1]:n.q1){var l=Math.max(s.High-s.Low,Math.abs(s.High-a.Close),Math.abs(s.Low-a.Close));if(r.length<e){if(r.push(l)==e){for(var h=0,c=0;c<r.length;c++)h+=r[c];s.atr=h/e}}else s.atr=(a.atr*(e-1)+l)/e;s.trueRange=l}}t.state.calculations.atr={accum:r,q1:a}},i.ChartEngine.prototype.calculateMedianPrice=function(t,e){e||(e=t.dataSet);for(var i,n=0;n<e.length;++n)i=e[n],i["hl/2"]=(i.High+i.Low)/2},i.ChartEngine.prototype.calculateTypicalPrice=function(t,e){e||(e=t.dataSet);for(var i,n=0;n<e.length;++n)i=e[n],i["hlc/3"]=(i.High+i.Low+i.Close)/3},i.ChartEngine.prototype.calculateWeightedClose=function(t,e){e||(e=t.dataSet);for(var i,n=0;n<e.length;++n)i=e[n],i["hlcc/4"]=(i.High+i.Low+2*i.Close)/4},i.ChartEngine.prototype.calculateOHLC4=function(t,e){e||(e=t.dataSet);for(var i,n=0;n<e.length;++n)i=e[n],i["ohlc/4"]=(i.Open+i.High+i.Low+i.Close)/4},i.ChartEngine.prototype.currentQuote=function(){if(!this.chart.dataSet)return null;for(var t=this.chart.dataSet.length-1;t>=0;t--)if(this.chart.dataSet[t])return this.chart.dataSet[t];return null},i.ChartEngine.prototype.correctIfOffEdge=function(t){if(!this.runPrepend("correctIfOffEdge",arguments)){for(var e in this.charts){var i=this.charts[e],n=i.dataSet,r=i.maxTicks,a=this.layout,o=this.minimumLeftBars;this.standaloneBars[a.chartType]||o--;var s=Math.min(o,r);if(i.allowScrollPast){var l=r-s;s>n.length&&(l=r-n.length),i.scroll-l>=n.length&&(i.scroll=n.length+l-1,this.micropixels=0),i.scroll<=s&&(i.scroll=s,this.micropixels=0)}else i.scroll<s&&(i.scroll=s),i.scroll>n.length&&(i.scroll=n.length);if(!1===i.allowScrollFuture){var h=this.getLabelOffsetInPixels(this,i,a.chartType),c=r-Math.round(h/a.candleWidth)-1;(this.micropixels<0?i.scroll-1:i.scroll)<c&&(i.scroll=c,this.micropixels=0)}}this.runAppend("correctIfOffEdge",arguments)}},i.ChartEngine.prototype.createDataSegment=function(t){if(!this.runPrepend("createDataSegment",arguments)){var e;for(var n in this.charts){e=this.charts[n],t&&(e=t),e.isComparison&&i.Comparison.createComparisonSegmentInner(this,e);var r=e.dataSet,a=e.baseline,o=e.scroll,s=e.maxTicks,l=this.layout,h=l.candleWidth;a.actualLevel=a.userLevel?a.userLevel:a.defaultLevel;for(var c,u=a.includeInDataSegment&&!this.standaloneBars[l.chartType],p=e.dataSegment=[],d=r.length-1-o-1,f=e.defaultPlotField,m=-1;m<o&&m<s;m++)if(d++,-1!=m||u)if(d<r.length&&d>=0){if(c=r[d],c.candleWidth=null,p.push(c),null===a.actualLevel&&m>=0)if(f&&"Close"!=f){var g=r[d-1];(g[f]||0===g[f])&&(a.actualLevel=g[f])}else(c.iqPrevClose||0===c.iqPrevClose)&&(a.actualLevel=c.iqPrevClose)}else d<0&&p.push(null);if(e.segmentImage=null,"volume_candle"==l.chartType){for(var v=0,y=e.width-(s-p.length-1)*l.candleWidth,b=0;b<p.length;b++)(c=p[b])&&(v+=c.Volume);var x=0;e.segmentImage=[];for(var w=0;w<p.length;w++){c=p[w],e.segmentImage[w]={};var C=null;c?(c.Volume?(c.candleWidth=y*c.Volume/v,C=x+c.candleWidth/2,x+=c.candleWidth):(c.candleWidth=h,C=x+h/2,x+=h),e.segmentImage[w]={tick:c.tick,candleWidth:c.candleWidth,leftOffset:C}):x+=h}}if(t)break}e&&e.isComparison&&this.clearPixelCache(),this.positionCrosshairsAtPointer(),this.runAppend("createDataSegment",arguments)}},i.ChartEngine.prototype.leftTick=function(){return this.chart.dataSet.length-this.chart.scroll},i.ChartEngine.prototype.getStartDateOffset=function(){for(var t=0;t<this.chart.dataSegment.length;t++)if(this.chart.dataSegment[t])return t;return 0},i.ChartEngine.prototype.setStartDate=function(t){for(var e=0;e<this.chart.dataSet.length;e++){if(this.chart.dataSet[e].DT.getTime()==t.getTime())return this.chart.scroll=this.chart.dataSet.length-e,void this.draw()}},i.ChartEngine.prototype.updateListeners=function(t){for(var e in this.plugins){var i=this.plugins[e];i.display&&i.listener&&i.listener(this,t)}},i.ChartEngine.prototype.clearPixelCache=function(){for(var t in this.panels){var e=this.panels[t];e.cacheHigh=null,e.cacheLow=null,e.cacheLeft=1e6,e.cacheRight=-1}for(var i in this.charts){var n=this.charts[i];if(n.dataSet)for(var r=0;r<n.dataSet.length;r++)n.dataSet[r].cache={}}},i.ChartEngine.prototype.createYAxisLabel=function(t,e,n,r,a,o,s){if(!1!==t.yAxis.drawPriceLabels&&!t.yAxis.noDraw){var l=s||t.yAxis,h=o||this.chart.context,c=this.getCanvasFontSize("stx_yaxis")+6;this.canvasFont("stx_yaxis",h);var u=l.displayBorder;!1===this.axisBorders&&(u=!1),!0===this.axisBorders&&(u=!0);var p,d=u?3:0;try{p=h.measureText(e).width+d+6}catch(t){p=l.width}var f=l.left-3+3,m=f+3+d,g=3;"left"===(null===l.position?t.chart.yAxis.position:l.position)&&(f=l.left+l.width+3-3,p*=-1,m=f,g=-3,h.textAlign="right"),n+c/2>l.bottom&&(n=l.bottom-c/2),n-c/2<l.top&&(n=l.top+c/2),void 0===i[this.yaxisLabelStyle]&&(this.yaxisLabelStyle="roundRectArrow");var v=this.yaxisLabelStyle;l.yaxisLabelStyle&&(v=l.yaxisLabelStyle);var y={ctx:h,x:f,y:n,top:n-c/2,width:p,height:c,radius:g,backgroundColor:r,fill:!0,stroke:!1,margin:{left:m-f,top:1},txt:e,color:a};i[v](y)}},i.ChartEngine.prototype.createXAxisLabel=function(t,e,n,r,a,o){var s=this.chart.context,l=this.getCanvasFontSize("stx-float-date")+4;this.canvasFont("stx-float-date",s);var h;try{h=s.measureText(e).width+4}catch(t){h=0}var c=t.top+t.height-l;if(!(n+h/2<t.left||n-h/2>t.right)){o||(n+h/2>t.right&&(n=t.right-h/2),n-h/2<t.left&&(n=t.left+h/2)),s.fillStyle=r,i.roundRect({ctx:s,x:n-h/2,top:c,width:h,height:l,radius:3,fill:!0});var u=t.bottom-t.yAxis.bottom-l;s.beginPath(),o?(s.moveTo(n-u,c),s.lineTo(n,c-u-1),s.lineTo(n+u,c),s.closePath(),s.fill()):(s.moveTo(n,c),s.lineTo(n,c-u),s.strokeStyle=r,s.stroke()),s.textBaseline="top",s.fillStyle=a||i.chooseForegroundColor(r),s.fillStyle==r&&("#FFFFFF"==r.toUpperCase()?s.fillStyle="#000000":s.fillStyle="#FFFFFF"),s.fillText(e,n-h/2+2,c+2)}},i.ChartEngine.prototype.drawCurrentHR=function(){if(!this.runPrepend("drawCurrentHR",arguments)){var t,e;for(var i in this.charts){var n=this.charts[i],r=n.panel,a=r.yAxis;if(!r.hidden&&!(!1===a.drawCurrentPriceLabel||a.noDraw||n.customChart&&"none"==n.customChart.chartType)){var o=a.whichSet;o||(o="dataSet");var s=n[o].length,l=this.layout.candleWidth;if("dataSegment"==o)for(;s>(n.width-this.micropixels+l/2+1)/l;)s--;if(s&&n[o][s-1]){var h=n.defaultPlotField;h&&!this.highLowBars[this.layout.chartType]||(h="Close");var c,u;do{if(c=n[o][s-1][h],u=c,0==--s)break}while(null===u);if("dataSet"==o&&n.currentQuote)u=n.currentQuote[h];else if(n[o].length>=2){var p=n[o][s-2];p&&(c=p[h])}u<c?(t=this.canvasStyle("stx_current_hr_down").backgroundColor,e=this.canvasStyle("stx_current_hr_down").color):(t=this.canvasStyle("stx_current_hr_up").backgroundColor,e=this.canvasStyle("stx_current_hr_up").color),n.transformFunc&&(u=n.transformFunc(this,n,u));var d,f=Math.max(r.yAxis.printDecimalPlaces,r.chart.decimalPlaces);(a.maxDecimalPlaces||0===a.maxDecimalPlaces)&&(f=Math.min(f,a.maxDecimalPlaces)),d=a.priceFormatter?a.priceFormatter(this,r,u,f):this.formatYAxisPrice(u,r,f);var m=this.pixelFromTransformedValue(u,r);this.createYAxisLabel(r,d,m,t,e),!0===this.preferences.currentPriceLine&&this.isHome()&&(r.chart.context.globalCompositeOperation="destination-over",this.plotLine(r.left,r.right,m,m,t,"line",r.chart.context,r,{pattern:"dashed",lineWidth:1,opacity:.8}),r.chart.context.globalCompositeOperation="source-over")}}}this.runAppend("drawCurrentHR",arguments)}},i.ChartEngine.prototype.getDefaultColor=function(){this.defaultColor="#000000";for(var t=null,e=this.chart.container;!t||i.isTransparent(t);){var n=getComputedStyle(e);if(!n)return;if(t=n.backgroundColor,i.isTransparent(t)&&(t="transparent"),!(e=e.parentNode)||!e.tagName)break}if(t)if("transparent"==t&&(t="#FFFFFF"),this.containerColor=t,i.isTransparent(t))this.defaultColor="#000000";else{var r=i.hsv(t),a=r[2];this.defaultColor=a>.65?"#000000":"#FFFFFF"}else this.containerColor="#FFFFFF"},i.ChartEngine.prototype.startAsyncAction=function(){this.pendingAsyncs||(this.pendingAsyncs=[]),this.pendingAsyncs.push(!0)},i.ChartEngine.prototype.registerChartDrawnCallback=function(t){return this.asyncCallbacks||(this.asyncCallbacks=[]),this.asyncCallbacks.push(t),{fc:t}},i.ChartEngine.prototype.unregisterChartDrawnCallback=function(t){for(var e=0;e<this.asyncCallbacks.length;e++)if(this.asyncCallbacks[e]==t.fc)return void this.asyncCallbacks.splice(e,1)},i.ChartEngine.prototype.makeAsyncCallbacks=function(){if(this.asyncCallbacks&&(!this.pendingAsyncs||!this.pendingAsyncs.length))for(var t=0;t<this.asyncCallbacks.length;t++)this.asyncCallbacks[t]()},i.ChartEngine.prototype.completeAsyncAction=function(){this.pendingAsyncs.pop(),this.makeAsyncCallbacks()},i.ChartEngine.prototype.draw=function(){if(this.debug(),this.chart.canvas&&this.chart.dataSet&&this.chart.canvasHeight&&(this.offset=this.layout.candleWidth*this.candleWidthPercent/2,i.clearCanvas(this.chart.canvas,this),this.masterData&&this.masterData.length&&!this.runPrepend("draw",arguments))){this.getDefaultColor(),this.vectorsShowing=!1,this.drawPanels(),this.yAxisLabels=[];var t,e,n,r;for(n in this.charts){e=this.charts[n],this.correctIfOffEdge(),this.createDataSegment();var a=this.createXAxis(e);this.initializeDisplay(e),this.rendererAction(e,"calculate"),this.renderYAxis(e),this.drawXAxis(e,a),e.tmpWidth=Math.floor(this.layout.candleWidth*this.candleWidthPercent),e.tmpWidth%2==0&&(e.tmpWidth+=1,e.tmpWidth>this.layout.candleWidth&&(e.tmpWidth-=2)),e.tmpWidth<.5&&(e.tmpWidth=.5);for(t in this.plugins)r=this.plugins[t],r.display&&r.drawUnder&&r.drawUnder(this,e);this.chart.legend&&(this.chart.legend.colorMap=null),this.rendererAction(e,"yaxis"),this.rendererAction(e,"underlay"),i.Studies&&i.Studies.displayStudies(this,e,!0),this.displayChart(e),i.Studies&&i.Studies.displayStudies(this,e,!1),this.rendererAction(e,"overlay"),e.legend&&e.legend.colorMap&&e.legendRenderer&&e.legendRenderer(this,{chart:e,legendColorMap:e.legend.colorMap,coordinates:{x:e.legend.x,y:e.legend.y+e.panel.yAxis.top}})}for(n in this.charts){e=this.charts[n];for(t in this.plugins)r=this.plugins[t],r.display&&r.drawOver&&r.drawOver(this,e)}for(var o in this.panels)this.panels[o].hidden||this.plotYAxisText(this.panels[o]);for(var s=0;s<this.yAxisLabels.length;s++){var l=this.yAxisLabels[s];"series"==l.src&&l.args[6]&&!1===l.args[6].drawSeriesPriceLabels||this.createYAxisLabel.apply(this,l.args)}this.createCrosshairs(),this.drawVectors(),this.drawCurrentHR(),this.displayInitialized=!0,this.controls.home&&(this.controls.home.style.display=this.isHome()?"none":"block"),this.positionMarkers();for(n in this.charts)e=this.charts[n],this.quoteDriver&&this.quoteDriver.checkLoadMore(e);this.runAppend("draw",arguments),this.makeAsyncCallbacks()}},i.ChartEngine.prototype.adjustBackingStore=function(t,e){this.devicePixelRatio=window.devicePixelRatio||1,this.devicePixelRatio<1&&(this.devicePixelRatio=1);var n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1,r=this.devicePixelRatio/n;if(!this.useBackingStore)return void(this.devicePixelRatio=this.adjustedDisplayPixelRatio=1);if(!i.isAndroid||i.is_chrome){var a=t.width,o=t.height;t.width=a*r,t.height=o*r,t.style.width=a+"px",t.style.height=o+"px",e.scale(r,r),this.adjustedDisplayPixelRatio=r,this.backing={ratio:r,width:t.width,height:t.height,styleWidth:a,styleHeight:o}}},i.ChartEngine.prototype.reconstituteBackingStore=function(){if(this.useBackingStore){var t=this.chart.canvas;t.width!=this.backing.width&&(t.width=this.backing.width,t.height=this.backing.height,t.context.scale(this.backing.ratio,this.backing.ratio),this.adjustedDisplayPixelRatio=this.backing.ratio,this.draw())}},i.ChartEngine.prototype.disableBackingStore=function(){if(this.useBackingStore){var t=this.chart.canvas;t.width!=this.backing.styleWidth&&(t.width=this.backing.styleWidth,t.height=this.backing.styleHeight,t.context.scale(1,1),this.adjustedDisplayPixelRatio=1,this.draw())}},i.ChartEngine.prototype.resizeCanvas=function(){this.chart.panel||(this.chart.panel=this.panels.chart);var t=this.chart.canvas,e=this.chart.context;t&&e&&(this.floatCanvas.height=this.chart.tempCanvas.height=t.height=this.chart.container.clientHeight,this.floatCanvas.width=this.chart.tempCanvas.width=t.width=this.chart.container.clientWidth,this.adjustBackingStore(t,e),this.adjustBackingStore(this.chart.tempCanvas,this.chart.tempCanvas.context),this.adjustBackingStore(this.floatCanvas,this.floatCanvas.context));var i=this.container.getBoundingClientRect();this.top=i.top,this.left=i.left,this.canvasWidth=this.chart.canvasWidth=this.chart.container.clientWidth,this.right=this.left+this.canvasWidth,this.height=this.chart.container.clientHeight,this.width=this.right-this.left,0!==this.width||this.container.dimensionlessCanvas||console.log("warning: zero width chart. Check CSS for chart container."),this.bottom=this.top+this.height,this.calculateYAxisPositions(),this.chart.canvasRight=this.right,this.chart.canvasHeight=this.height;var n=this.layout.candleWidth;void 0===n&&(n=8);for(var r in this.charts){var a=this.charts[r];if(this.setCandleWidth(n,a),a.scroll<a.width/n){a.scroll=Math.floor(a.width/n);var o=Math.round(this.preferences.whitespace/this.layout.candleWidth);a.scroll-=o}var s,l=10;try{s=2*e.measureText("10:00").width}catch(t){s=100}for(;l>1&&!(this.chart.width/s>l);)l/=1.5;a.xAxis.autoComputedTickSizePixels=Math.round(this.chart.width/l),a.xAxis.autoComputedTickSizePixels<1&&(a.xAxis.autoComputedTickSizePixels=1)}},i.ChartEngine.prototype.setCandleWidth=function(t,e){e||(e=this.chart),t<this.minimumCandleWidth&&(t=this.minimumCandleWidth),this.layout.candleWidth=t,e.maxTicks=Math.round(e.width/t)+1},i.ChartEngine.prototype.resizeChart=function(t){if(!this.runPrepend("resizeChart",arguments)){!1!==t&&(t=!0),t&&this.preAdjustScroll();var e=this.chart.canvasHeight;this.resizeCanvas(),t&&this.postAdjustScroll(),this.displayInitialized?(this.adjustPanelPositions(),this.draw()):0!==this.chart.canvasHeight&&0===e&&(this.adjustPanelPositions(),this.draw()),this.doDisplayCrosshairs(),this.updateChartAccessories(),this.runAppend("resizeChart",arguments)}},i.ChartEngine.prototype.newChart=function(t,e,n,r,a){n||(n=this.chart),a||(a={});var o=this.layout,s=a.periodicity;s&&(s.interval&&(o.interval=s.interval),s.period&&(o.periodicity=s.period),s.periodicity&&(o.periodicity=s.periodicity),o.timeUnit=s.timeUnit);var l=n.symbol,h=i.clone(n.symbolObject),c=n.market,u=n.dataSet,p=n.moreAvailable;if(n.dataSet=[],n.moreAvailable=null,t?"object"==(void 0===t?"undefined":_typeof(t))?(n.symbol=t.symbol,n.symbolObject=t):(n.symbol=t,n.symbolObject.symbol=t):(n.symbol=null,n.symbolObject={symbol:null}),this.marketFactory){var d=this.marketFactory(n.symbolObject);this.setMarket(d,n)}var f=this;if(!e&&this.quoteDriver){var m=function(t){t&&"orphaned"!=t&&(n.symbol=l,n.symbolObject=h,n.market=c,n.dataSet=u,n.moreAvailable=p),f.dispatch(f.currentlyImporting?"symbolImport":"symbolChange",{stx:f,symbol:f.chart.symbol,symbolObject:f.chart.symbolObject,action:"master"}),r&&r.call(f,t)},g=a.span;!g&&o&&(g=o.setSpan),g&&g.base?(g.multiplier=g.multiplier||1,this.chart.masterData=null,this.displayInitialized=!1,s&&(g.maintainPeriodicity=!0),g.forceLoad=!0,this.setSpan(g,m)):this.quoteDriver.newChart({symbol:n.symbol,symbolObject:n.symbolObject,chart:n,initializeChart:!0},function(t){t||(f.adjustPanelPositions(),f.quoteDriver.updateSubscriptions(),a.stretchToFillScreen&&f.fillScreen()),m.apply(f,arguments)})}else{e||console.log("Warning: No masterData specified and no QuoteFeed configured"),n.symbol||(n.symbol=""),this.doCleanupDates(e,o.interval),this.setMasterData(e,n),this.createDataSet(),this.initializeChart();var v=a.span;v&&v.multiplier&&v.base?this.setSpan({maintainPeriodicity:!0,multiplier:v.multiplier,base:v.base}):a.stretchToFillScreen?this.fillScreen():e&&e.length?this.draw():this.clear(),this.adjustPanelPositions(),r&&r.call(f)}},i.ChartEngine.prototype.clear=function(){this.displayInitialized=!1;for(var t in this.layout.studies){var e=this.layout.studies[t];i.Studies.removeStudy(this,e)}this.controls.chartControls.style.display="none",this.panels.chart.title.innerHTML="",this.panels.chart.title.appendChild(document.createTextNode(this.panels.chart.display))},i.ChartEngine.prototype.fillScreen=function(){var t=this.chart,e=this.layout.candleWidth,i=t.width-this.preferences.whitespace,n=t.dataSet.length;if(n*e>=i)return void this.draw();this.standaloneBars[this.layout.chartType]||n--;var r=i/n;this.setCandleWidth(r,t),this.home({maintainWhitespace:!0})},i.ChartEngine.prototype.setMasterData=function(t,e){if(e||(e=this.chart),this.marketFactory){var n=this.marketFactory(e.symbolObject);this.setMarket(n,e)}e.masterData=t,"chart"==e.name&&(this.masterData=t);var r;for(r=0;t&&r<t.length;r++){this.transformMasterDataQuote&&(t[r]=this.transformMasterDataQuote(t[r]));var a=t[r];a.DT?("[object Date]"!=Object.prototype.toString.call(a.DT)&&(a.DT=new Date(a.DT)),a.Date&&17==a.Date.length||(a.Date=i.yyyymmddhhmmssmmm(a.DT))):a.Date?a.DT=i.strToDateTime(a.Date):console.log("setMasterData : Missing DT and Date on masterData object"),a.Volume&&"number"!=typeof a.Volume&&(a.Volume=parseInt(a.Volume,10))}e.decimalPlaces=this.callbacks.calculateTradingDecimalPlaces({stx:this,chart:e,symbol:e.symbolObject.symbol,symbolObject:e.symbolObject}),i.ChartEngine.isDailyInterval(this.layout.interval)||this.setDisplayDates(t),this.chart.roundit=Math.pow(10,e.decimalPlaces);for(r in this.plugins){var o=this.plugins[r];o.display&&o.setMasterData&&o.setMasterData(this,e)}},i.ChartEngine.prototype.setMasterDataRender=function(t,e,i){i||(i=this.chart),i.symbol||(i.symbol=""),this.setMasterData(e,i),e&&e.length&&(i.symbol=t),this.createDataSet(),this.initializeChart(),this.draw(),e&&e.length||(i.symbol=null,this.clear()),this.adjustPanelPositions()},i.ChartEngine.prototype.getSymbols=function(t){function e(t,e,i){return{symbol:t,symbolObject:e,periodicity:i.periodicity,interval:i.interval,timeUnit:i.timeUnit,setSpan:i.setSpan}}t||(t={});var n,r,a,o=[],s=this.layout;for(var l in this.charts){var h=this.charts[l];h.symbolObject&&h.symbolObject.symbol&&o.push(e(h.symbol,h.symbolObject,s));for(var c in h.series){var u=h.series[c],p=u.parameters;p.data&&!p.data.useDefaultQuoteFeed||(a=p.symbolObject,r=p.symbol,n=e(r,a,s),t["include-parameters"]&&(n.parameters=p),t["exclude-studies"]&&"study"==p.bucket||o.push(n))}}for(var d=o.length-1;d>=0;d--)if(r=o[d].symbol,this.isEquationChart(r)){var f=i.formatEquation(r);if(f){for(var m=0;m<f.symbols.length;m++)n=e(f.symbols[m],o[d].symbolObject,o[d]),o.push(n);o.splice(d,1)}}return o},i.ChartEngine.prototype.setDisplayDate=function(t){var e,i=t.DT,n=1e3*i.getSeconds()+i.getMilliseconds();this.dataZone&&(e=new o.Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),this.dataZone),i=new Date(e.getTime()+n)),this.displayZone&&(e=new o.Date(i.getTime(),this.displayZone),i=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes()),i=new Date(i.getTime()+n)),t.displayDate=i},i.ChartEngine.prototype.setDisplayDates=function(t){if(t)for(var e=0;e<t.length;e++){var i=t[e];i.DT&&this.setDisplayDate(i)}},i.ChartEngine.prototype.streamTrade=function(t,e,i,n){var r=this.chart;n||(n={}),n.chart&&(r=n.chart),n.fillGaps=this.streamParameters.fillGaps;var a="object"==(void 0===t?"undefined":_typeof(t)),o=a?t.last:arguments[0],s=a?t.volume:arguments[1],l=a?t.bid:null,h=a?t.ask:null;a||(e=arguments[2],i=arguments[3]),i&&(n.secondarySeries=i);var c={DT:e,Last:o,Volume:s,Bid:l,Ask:h};this.appendMasterData(c,r,n)},i.ChartEngine.prototype.appendMasterData=function(t,e,n){n||(n={}),e||(e=this.chart);var r=!1,a=!1,o=e.masterData,s=this.layout,l=this.dataZone;if(this.doCleanupDates(t,s.interval),n.useAsLastSale||t.constructor==Object&&void 0!==t.Last&&null!==t.Last){if(r=!0,n.useAsLastSale&&n.useAsLastSale.aggregatedVolume&&(a=!0),t.constructor===Array){var h=t[t.length-1];t={},h.DT?t.DT=h.DT:t.DT=i.strToDateTime(h.Date),t.Close=h.Close,t.Volume=h.Volume}else t.Last&&(t.Close=t.Last,delete t.Last);if(t.DT&&(t.DT=new Date(+t.DT)),t.DT&&"Invalid Date"!=t.DT||(t.DT=this.convertToDataZone(new Date)),"tick"!=s.interval){var c,u,p=new i.Market({}),d={begin:o&&o.length?o[o.length-1].DT:t.DT,interval:s.interval,periodicity:1,timeUnit:s.timeUnit,inZone:l,outZone:l},f=p.newIterator(d),m=f.next();if(o){if(t.DT<m){c=0;var g=f.previous();for(u=t.DT,n.appending=!0;u<g&&c<1e3;)n.appending=!1,g=f.previous(),c++;t.DT=g,n.updating=!n.appending}else if(t.DT>=m){for(c=0,u=t.DT;u>m&&c<1e3;)t.DT=m,m=f.next(),c++;n.appending=!0}}else t.DT=new Date(+f.previous())}t.Open=t.Close,t.High=t.Close,t.Low=t.Close}if(n.secondarySeries)i.addMemberToMasterdata(this,n.secondarySeries,t);else{if(t&&t.constructor==Object&&(t=[t]),!t||!t.length)return;if(this.runPrepend("appendMasterData",[t,e,n]))return;var v=t[0].DT;v&&"[object Date]"!=Object.prototype.toString.call(v)&&(t[0].DT=v=new Date(v)),v||(v=i.strToDateTime(t[0].Date));var y,b,x;if(o&&o.length){for(y=o.length-1;y>=0;){var w=o[y].DT;if(w||(w=i.strToDateTime(o[y].Date)),w.getTime()<=v.getTime()){var C=0;w.getTime()<v.getTime()&&(C=1,n.fillGaps&&(t.unshift(o[y]),t=this.doCleanupGaps(t,e),t.shift()));for(var S=0;S<t.length;S++){if(!C){b=t[S],x=o.length>y+S?o[y+S]:null,x&&(r?(b.Volume&&(b.Volume=parseInt(b.Volume,10)),a||(b.Volume+=x.Volume)):!b.Volume&&x.Volume&&(b.Volume=x.Volume),n.allowReplaceOHL||(isNaN(x.Open)||(b.Open=x.Open),!isNaN(x.High)&&x.High>b.High&&(b.High=x.High),!isNaN(x.Low)&&x.Low<b.Low&&(b.Low=x.Low)),isNaN(b.Close)&&!isNaN(x.Close)&&(b.Close=x.Close),isNaN(b.Bid)&&!isNaN(x.Bid)&&(b.Bid=x.Bid),isNaN(b.Ask)&&!isNaN(x.Ask)&&(b.Ask=x.Ask));for(var T in e.series){var _=e.series[T].parameters.symbolObject.symbol;void 0===b[_]&&x&&(b[_]=x[_])}}b=o[y+S+C]=t[S],b.DT&&"[object Date]"!=Object.prototype.toString.call(b.DT)&&(b.DT=new Date(b.DT)),b.DT?b.Date&&17==b.Date.length||(b.Date=i.yyyymmddhhmmssmmm(b.DT)):b.DT=i.strToDateTime(b.Date),b.Volume&&"number"!=typeof b.Volume&&(b.Volume=parseInt(b.Volume,10)),i.ChartEngine.isDailyInterval(s.interval)||this.setDisplayDate(b)}break}y--}this.maxMasterDataSize&&(o=e.masterData=this.masterData=o.slice(-this.maxMasterDataSize));for(y in this.plugins){var k=this.plugins[y];k.display&&k.appendMasterData&&k.appendMasterData(this,t,e)}}else o=i.clone(t),this.setMasterData(o,e);this.masterData&&this.masterData.length||(this.masterData=o)}if(!n.noCreateDataSet){var D=this.streamParameters;if(++D.count>D.maxTicks||n.bypassGovernor)clearTimeout(D.timeout),this.createDataSet(null,null,n),this.draw(),this.updateChartAccessories(),D.count=0,D.timeout=-1;else{var M=this;-1==D.timeout&&(D.timeout=setTimeout(function(){M.createDataSet(null,null,n),M.draw(),M.updateChartAccessories(),M.streamParameters.count=0,M.streamParameters.timeout=-1},D.maxWait))}}this.runAppend("appendMasterData",arguments)},i.ChartEngine.prototype.setMaxTicks=function(t,e){e||(e={}),(t=Math.round(t))<2&&(t=2);var i=e.padding?e.padding:0;this.layout.candleWidth=(this.chart.width-i)/t,this.layout.candleWidth||(this.layout.candleWidth=8),this.chart.maxTicks=Math.round(this.chart.width/this.layout.candleWidth-.499),(e.padding||0===e.padding)&&(this.chart.scroll=t+1)},i.ChartEngine.prototype.construct=function(){this.stackPanel("chart","chart",1),this.adjustPanelPositions(),this.chart.panel=this.panels[this.chart.name],this.cx=0,this.cy=0,this.micropixels=0,this.chart.panel.subholder.appendChild(this.controls.home),this.callbackListeners={doubleTap:[],drawing:[],layout:[],longhold:[],move:[],newChart:[],preferences:[],rightClick:[],studyOverlayEdit:[],studyPanelEdit:[],symbolChange:[],symbolImport:[],tap:[],theme:[],undoStamp:[]},this.longHoldTime=1e3},i.ChartEngine.prototype.addDomEventListener=function(t,e,i,n){t.addEventListener(e,i,n),this.eventListeners.push({element:t,event:e,function:i,options:n})},i.ChartEngine.prototype.addEventListener=function(t,e){if("*"===t)for(var i in this.callbackListeners)this.callbackListeners[i].push(e);else if(t instanceof Array)for(var n=0;n<t.length;n++)this.callbackListeners[t[n]].push(e);else{var r=this.callbackListeners[t];if(!r)throw new Error("Attempted to add an invalid listener.");r.push(e)}return{type:t,cb:e}},i.ChartEngine.prototype.removeEventListener=function(t,e){t&&"object"==(void 0===t?"undefined":_typeof(t))||(t={type:t,cb:e});var i=function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return void t.splice(i,1)},n=this.callbackListeners;if("*"!==t.type){if(!n[t.type])throw new Error("Attempted to remove an invalid listener.");i(n[t.type],t.cb)}else for(var r in n)i(n[r],t.cb)},i.ChartEngine.prototype.dispatch=function(t,e){this.callbacks[t]&&this.callbacks[t].call(this,e);var i,n=this.callbackListeners[t];if(n){for(var r=0;r<n.length;r++)i=n[r].call(this,e);if(i)return i}if(n=this.callbackListeners["*"]){for(var a=0;a<n.length;a++)i=n[a].call(this,e);if(i)return i}return!1},i.ChartEngine.prototype.deleteYAxisIfUnused=function(t,e){if(e&&e!==t.yAxis){for(var i in this.chart.seriesRenderers){var n=this.chart.seriesRenderers[i];if(n.params.yAxis===e&&0!==n.seriesParams.length)return}var r;for(r=0;r<t.yaxisLHS.length;r++)t.yaxisLHS[r]===e&&t.yaxisLHS.splice(r,1);for(r=1;r<t.yaxisRHS.length;r++)t.yaxisRHS[r]===e&&t.yaxisRHS.splice(r,1);this.resizeCanvas(),this.adjustPanelPositions()}},i.ChartEngine.prototype.addYAxis=function(t,e){if(e){t.yaxisLHS||(t.yaxisLHS=[],t.yaxisRHS=[],"left"==t.yAxis.position?t.yaxisLHS.push(t.yAxis):t.yaxisRHS.push(t.yAxis));for(var i=t.yaxisLHS.concat(t.yaxisRHS),n=0;n<i.length;n++)if(i[n]===e)return;"left"===e.position?t.yaxisLHS.unshift(e):(e.position="right",t.yaxisRHS.push(e)),this.preAdjustScroll(),this.resizeCanvas(),this.adjustPanelPositions(),this.postAdjustScroll()}},i.ChartEngine.prototype.calculateYAxisPositions=function(){var t=[];for(var e in this.charts)t.push(e);for(var i in this.panels){var n=this.panels[i];n.name!==n.chart.name&&t.push(i)}var r,a,o,s,l=0,h=0;for(a=0;a<t.length;a++)if(o=this.panels[t[a]]){if(!o.yaxisLHS){o.yaxisLHS=[],o.yaxisRHS=[];var c=o.yAxis.position;c||(c=o.chart.panel.yAxis.position),o["left"==c?"yaxisLHS":"yaxisRHS"].push(o.yAxis)}o.yAxis.width||0===o.yAxis.width||(o.yAxis.width=this.yaxisWidth),o.yaxisTotalWidthRight=0,o.yaxisTotalWidthLeft=0;var u=o.yaxisLHS.concat(o.yaxisRHS);for(r=0;r<u.length;r++)s=u[r],!s.noDraw&&s.width&&("left"==s.position?(o.yaxisTotalWidthLeft+=s.width,s.justifyRight=null===s.justifyRight?o.chart.yAxis.justifyRight:s.justifyRight,null===s.justifyRight&&(s.justifyRight=!0)):o.yaxisTotalWidthRight+=s.width);o.yaxisTotalWidthLeft>l&&(l=o.yaxisTotalWidthLeft),o.yaxisTotalWidthRight>h&&(h=o.yaxisTotalWidthRight)}for(a=0;a<t.length;a++)if(o=this.panels[t[a]]){var p=o.name===o.chart.name,d=l;for(r=o.yaxisLHS.length-1;r>=0;r--)s=o.yaxisLHS[r],s.noDraw||(d-=s.width,s.left=d);for(d=this.width-h,r=0;r<o.yaxisRHS.length;r++)s=o.yaxisRHS[r],s.noDraw||(s.left=d,d+=s.width);void 0!==this.yaxisLeft&&(o.chart.yaxisPaddingRight=this.yaxisLeft),o.yaxisCalculatedPaddingRight=h,(o.chart.yaxisPaddingRight||0===o.chart.yaxisPaddingRight)&&(o.yaxisCalculatedPaddingRight=o.chart.yaxisPaddingRight),o.yaxisCalculatedPaddingLeft=l,(o.chart.yaxisPaddingLeft||0===o.chart.yaxisPaddingLeft)&&(o.yaxisCalculatedPaddingLeft=o.chart.yaxisPaddingLeft),p?(o.left=o.yaxisCalculatedPaddingLeft,o.right=this.width-o.yaxisCalculatedPaddingRight):(o.left=o.chart.panel.left,o.right=o.chart.panel.right),o.width=o.right-o.left,o.handle.style.left=o.left+"px",o.handle.style.width=o.width+"px",p&&(o.chart.left=o.left,o.chart.right=o.right,o.chart.width=Math.max(o.right-o.left,0))}},i.ChartEngine.prototype.initializeChart=function(t){if(!this.runPrepend("initializeChart",arguments)){this.chart.symbolObject.symbol||(this.chart.symbolObject.symbol=this.chart.symbol),this.locale&&this.setLocale(this.locale),!this.displayZone&&i.ChartEngine.defaultDisplayTimeZone&&this.setTimeZone(null,i.ChartEngine.defaultDisplayTimeZone),this.calculateYAxisPositions(),this.micropixels=0,t?this.chart.container=t:t=this.chart.container,t.stx=this,t.CIQRegistered||(t.CIQRegistered=!0,i.ChartEngine.registeredContainers.push(t)),i.isSurface&&(this.gesture||(this.gesture=new MSGesture,this.manageTouchAndMouse?this.gesture.target=t:this.gesture.target=document.body,this.gesturePointerId=null)),this.registerHTMLElements();var e=this.chart.canvas,n=this.chart.tempCanvas,a=this.floatCanvas;e&&document.createElement("canvas").getContext?(e.id||(t.removeChild(e),this.chart.canvas=null),n&&!n.id&&(t.removeChild(n),this.chart.tempCanvas=null),a&&!a.id&&(t.removeChild(a),this.floatCanvas=null)):(this.layout.candleWidth<this.minimumCandleWidth&&(this.layout.candleWidth=this.minimumCandleWidth),this.layout.candleWidth>200&&(this.layout.candleWidth=8)),this.chart.canvas||(e=this.chart.canvas=document.createElement("canvas")),this.chart.canvas.getContext?t.appendChild(e):(e=this.chart.canvas=t.querySelectorAll("#ie8canvas")[0],e.getContext||window.G_vmlCanvasManager&&G_vmlCanvasManager.initElement(e),e.style.display="block"),e.style.position="absolute",e.style.left="0px";(e.context=this.chart.context=e.getContext("2d")).lineWidth=1,this.chart.tempCanvas||(n=this.chart.tempCanvas=document.createElement("canvas")),this.chart.tempCanvas.getContext?t.appendChild(n):(n=this.chart.tempCanvas=t.querySelectorAll("#ie8canvasTemp")[0],n.getContext||window.G_vmlCanvasManager&&G_vmlCanvasManager.initElement(n)),n.style.position="absolute",n.style.left="0px",n.context=this.chart.tempCanvas.getContext("2d"),n.context.lineWidth=1,n.style.display="none",this.floatCanvas||(a=this.floatCanvas=document.createElement("canvas")),this.floatCanvas.getContext?t.appendChild(a):(a=this.floatCanvas=t.querySelectorAll("#ie8canvasFloat")[0],a.getContext||window.G_vmlCanvasManager&&G_vmlCanvasManager.initElement(a)),a.style.position="absolute",a.style.left="0px",a.context=a.getContext("2d"),a.context.lineWidth=1,a.style.display="none",this.resizeCanvas(),i.isAndroid&&(this.chart.tempCanvas.ontouchstart=function(t){t.preventDefault&&t.preventDefault()},this.floatCanvas.ontouchstart=function(t){t.preventDefault&&t.preventDefault()});var o=this.chart,s=this.panels;if(s.chart.display=o.symbol,o.symbolDisplay&&(s.chart.display=o.symbolDisplay),this.adjustPanelPositions(),this.chart.panel=s[o.name],this.calculateYAxisMargins(o.panel.yAxis),this.initialWhitespace=this.preferences.whitespace,o.dataSet&&o.dataSet.length>0){o.scroll=Math.floor(o.width/this.layout.candleWidth);var l=Math.round(this.preferences.whitespace/this.layout.candleWidth);o.scroll-=l}if(i.touchDevice){var h=r(".overlayEdit",t),c=r("#overlayTrashCan",t),u=r("#vectorTrashCan",t);h?(i.safeClickTouch(h,function(t){return function(e){t.deleteHighlighted(!0,!0)}}(this)),c&&i.safeClickTouch(c,function(t){return function(e){t.deleteHighlighted(!1)}}(this))):c&&i.safeClickTouch(c,function(t){return function(e){t.deleteHighlighted(!0)}}(this)),u&&i.safeClickTouch(u,function(t){return function(e){t.deleteHighlighted(!0)}}(this))}this.manageTouchAndMouse&&(this.registerTouchAndMouseEvents(),this.controls.chartControls&&(this.controls.chartControls.style.display="block")),t.onmouseout=function(t){return function(e){t.handleMouseOut(e)}}(this),this.abortDrawings(),this.undoStamps=[];for(var p in s){var d=s[p];d.markerHolder&&(t.removeChild(d.markerHolder),d.markerHolder=null)}for(var f in this.plugins){var m=this.plugins[f];m.display&&m.initializeChart&&m.initializeChart(this)}if(!this.resizeListenerInitialized){var g=this;this.resizeListenerInitialized=!0;this.addDomEventListener(window,"resize",function(){return function(t){g.resizeChart()}}(),!0)}o.baseline.userLevel&&(o.baseline.userLevel=null),this.setResizeTimer(this.resizeDetectMS),this.runAppend("initializeChart",arguments)}},i.ChartEngine.prototype.destroy=function(){this.setResizeTimer(0),this.quoteDriver&&this.quoteDriver.die(),this.styles={};for(var t=0;t<this.eventListeners.length;t++){var e=this.eventListeners[t];e.element.removeEventListener(e.event,e.function,e.options)}this.streamParameters.timeout&&clearTimeout(this.streamParameters.timeout)},i.ChartEngine.prototype.handleMouseOut=function(t){if(t=t||window.event,!i.withinElement(this.chart.container,t.pageX,t.pageY)){if(this.runPrepend("handleMouseOut",arguments))return;if(this.undisplayCrosshairs(),this.grabbingScreen=!1,this.touches=[],this.touching=!1,this.activeDrawing&&this.userPointerDown){this.userPointerDown=!1,this.drawingLine=!1;var e=this.backOutY(t.pageY),n=this.backOutX(t.pageX);this.drawingClick(this.currentPanel,n,e)}i.ChartEngine.insideChart=!1,this.displaySticky(),this.findHighlights(!1,!0),this.runAppend("handleMouseOut",arguments)}},i.ChartEngine.prototype.registerTouchAndMouseEvents=function(){if(!this.touchAndMouseEventsRegistered){this.touchAndMouseEventsRegistered=!0;var t=r("#zoomIn",this.controls.chartControls),e=r("#zoomOut",this.controls.chartControls),n=this.chart.container,a=this,o=function(t,e){a.addDomEventListener(n,t,e)};i.touchDevice?i.isSurface?(o("mousemove",function(t){a.msMouseMoveProxy(t)}),o("mousedown",function(t){a.msMouseDownProxy(t)}),o("mouseup",function(t){a.msMouseUpProxy(t)}),window.navigator.msPointerEnabled?(o("MSPointerDown",function(t){return a.startProxy(t)}),o("MSGestureStart",function(t){a.gestureInEffect=!0}),o("MSGestureChange",function(t){return a.touchmove(t)}),o("MSGestureEnd",function(t){return a.gestureInEffect=!1,a.touchend(t)}),o("MSPointerMove",function(t){a.moveProxy(t)}),o("MSPointerUp",function(t){return a.endProxy(t)})):(o("pointerdown",function(t){return a.startProxy(t)}),o("MSGestureStart",function(t){a.gestureInEffect=!0}),o("MSGestureChange",function(t){return a.touchmove(t)}),o("MSGestureEnd",function(t){return a.gestureInEffect=!1,a.touchend(t)}),o("pointermove",function(t){a.moveProxy(t)}),o("pointerup",function(t){return a.endProxy(t)}))):(i.isAndroid||i.ipad||i.iphone||(o("mousemove",function(t){a.iosMouseMoveProxy(t)}),o("mousedown",function(t){a.iosMouseDownProxy(t)}),o("mouseup",function(t){a.iosMouseUpProxy(t)})),o("touchstart",function(t){a.touchstart(t)}),o("touchmove",function(t){a.touchmove(t)}),o("touchend",function(t){a.touchend(t)}),t&&(t.removeAttribute("onMouseOver"),t.removeAttribute("onMouseOut")),e&&(e.removeAttribute("onMouseOver"),e.removeAttribute("onMouseOut"))):(o("mousemove",function(t){a.mousemove(t)}),o("mousedown",function(t){a.mousedown(t)}),o("mouseup",function(t){a.mouseup(t)}));var s=i.wheelEvent;this.captureMouseWheelEvents&&this.addDomEventListener(n,s,function(t){a.mouseWheel(t)})}},i.ChartEngine.prototype.rightClickHighlighted=function(){this.runPrepend("rightClickHighlighted",arguments)||(this.deleteHighlighted(!0),this.runAppend("rightClickHighlighted",arguments))},i.ChartEngine.prototype.deleteHighlighted=function(t,e){if(!this.runPrepend("deleteHighlighted",arguments)){this.cancelTouchSingleClick=!0,i.clearCanvas(this.chart.tempCanvas,this);for(var n=this.drawingObjects.length-1;n>=0;n--){var r=this.drawingObjects[n];if(r.highlighted&&!r.permanent){if(!r.abort()){var a=i.shallowClone(this.drawingObjects);this.drawingObjects.splice(n,1),this.undoStamp(a,i.shallowClone(this.drawingObjects))}this.changeOccurred("vector")}}for(var o in this.overlays){var s=this.overlays[o];s.highlight&&!s.permanent&&(t||e?this.rightClickOverlay(o,e):this.removeOverlay(o))}var l=this.currentPanel.chart;for(var h in l.seriesRenderers)for(var c=l.seriesRenderers[h],u=c.seriesParams.length-1;u>=0;u--){var p=c.seriesParams[u];p.highlight&&!p.permanent&&(c.removeSeries(p.field),c.seriesParams.length<1&&this.removeSeriesRenderer(c))}this.draw(),this.clearMeasure(),this.controls.mSticky&&(this.controls.mSticky.style.display="none",this.controls.mSticky.children[0].innerHTML=""),this.runAppend("deleteHighlighted",arguments)}},i.ChartEngine.prototype.panelExists=function(t){for(var e in this.panels){if(this.panels[e].name==t)return!0}return!1},i.ChartEngine.prototype.hideCrosshairs=function(){this.displayCrosshairs=!1},i.ChartEngine.prototype.showCrosshairs=function(){this.displayCrosshairs=!0},i.ChartEngine.prototype.grabHandle=function(t){this.runPrepend("grabHandle",arguments)||t&&(i.ChartEngine.crosshairY=t.top+this.top,i.ChartEngine.resizingPanel=t,i.appendClassName(t.handle,"stx-grab"),this.runAppend("grabHandle",arguments))},i.ChartEngine.prototype.releaseHandle=function(){this.runPrepend("releaseHandle",arguments)||(i.clearCanvas(this.chart.tempCanvas,this),this.resizePanels(),i.ChartEngine.resizingPanel&&i.unappendClassName(i.ChartEngine.resizingPanel.handle,"stx-grab"),i.ChartEngine.resizingPanel=null,this.runAppend("releaseHandle",arguments))},i.ChartEngine.prototype.storePanels=function(){this.layout||(this.layout={});var t=this.layout;t.panels={};for(var e in this.panels){var i=this.panels[e];t.panels[i.name]={percent:i.percent,display:i.display}}},i.ChartEngine.prototype.savePanels=function(t){this.storePanels(),!1!==t&&this.changeOccurred("layout")},i.ChartEngine.prototype.resolveY=function(t){return this.top+t},i.ChartEngine.prototype.resolveX=function(t){return this.left+t},i.ChartEngine.prototype.backOutY=function(t){return t-this.top},i.ChartEngine.prototype.backOutX=function(t){return t-this.left},i.ChartEngine.prototype.cleanupRemovedStudy=function(t){t.study.removeFN&&t.study.removeFN(this,t),t.study.feed&&this.detachTagAlongQuoteFeed(t.study.feed);for(var e in this.plugins)e.indexOf("{"+t.id+"}")>-1&&delete this.plugins[e];this.layout.studies&&delete this.layout.studies[t.name],i.Studies.removeStudySymbols(t,this),this.quoteDriver&&this.quoteDriver.updateSubscriptions()},i.ChartEngine.prototype.privateDeletePanel=function(t){if(this.layout.studies){var e=this.layout.studies[t.name];e&&this.cleanupRemovedStudy(e)}if(delete this.panels[t.name],i.Studies)for(var n in i.Studies.studyPanelMap)i.Studies.studyPanelMap[n].panel==t.name&&delete i.Studies.studyPanelMap[n];for(var r in this.overlays)this.overlays[r].panel==t.name&&(this.cleanupRemovedStudy(this.layout.studies[r]),delete this.overlays[r]);if(t.holder&&(this.chart.container.removeChild(t.holder),this.getMarkerArray))for(var a=this.getMarkerArray("panelName",t.name),o=0;o<a.length;o++)this.removeFromHolder(a[o]);t.handle.parentNode.removeChild(t.handle),this.currentPanel=null},i.ChartEngine.prototype.panelClose=function(t){if(t&&!this.runPrepend("panelClose",arguments)){if(this.cancelTouchSingleClick=!0,i.ChartEngine.drawingLine=!1,t.soloing&&this.panelSolo(t),this.charts[t.name]){for(var e in this.panels){var n=this.panels[e];n.chart.name==t.name&&this.privateDeletePanel(n)}delete this.charts[t.name]}else this.privateDeletePanel(t);this.showCrosshairs(),this.createDataSet(),this.adjustPanelPositions(),this.draw(),this.savePanels(),this.openDialog&&(this.openDialog=""),this.runAppend("panelClose",arguments)}},i.ChartEngine.prototype.deleteAllPanels=function(){for(var t in this.panels){var e=this.panels[t];this.privateDeletePanel(e)}this.layout.panels={},this.panels={}},i.ChartEngine.prototype.panelUp=function(t){this.cancelTouchSingleClick=!0,i.ChartEngine.drawingLine=!1,this.showCrosshairs();var e,n={},r=0;for(e in this.panels){if(e==t.name)break;r++}if(r){var a=0;for(e in this.panels)a==r-1&&(n[t.name]=t),e!=t.name&&(n[e]=this.panels[e],a++);this.panels=n,this.adjustPanelPositions(),this.draw(),this.savePanels()}},i.ChartEngine.prototype.panelDown=function(t){this.cancelTouchSingleClick=!0,i.ChartEngine.drawingLine=!1,this.showCrosshairs();var e,n={},r=0;for(e in this.panels){if(e==t.name)break;r++}var a=0;for(e in this.panels)a++;if(r!=a-1){var o=0;for(e in this.panels)e!=t.name?(n[e]=this.panels[e],o==r+1&&(n[t.name]=t),o++):o++;this.panels=n,this.adjustPanelPositions(),this.draw(),this.savePanels()}},i.ChartEngine.prototype.panelSolo=function(t){this.cancelTouchSingleClick=!0,i.ChartEngine.drawingLine=!1,this.showCrosshairs();var e=!0;t.soloing?(e=!1,t.soloing=!1,i.unappendClassName(t.solo,"stx_solo_lit"),t.percent=t.oldPercent,"chart"==t.name||this.soloPanelToFullScreen||(this.panels.chart.percent=this.panels.chart.oldPercent),this.soloPanelToFullScreen&&(this.xAxisAsFooter=this.panels.chart.oldXAxisAsFooter,this.panels.chart.subholder.appendChild(this.controls.home))):(t.soloing=!0,i.appendClassName(t.solo,"stx_solo_lit"),t.oldPercent=t.percent,"chart"!=t.name&&(this.soloPanelToFullScreen?(this.panels.chart.oldXAxisAsFooter=this.xAxisAsFooter,this.xAxisAsFooter=!0,t.subholder.appendChild(this.controls.home)):(this.panels.chart.oldPercent=this.panels.chart.percent,t.percent=1-this.panels.chart.percent)));for(var n in this.panels)this.panels[n].hidden=e;this.soloPanelToFullScreen||(this.panels.chart.hidden=!1),t.hidden=!1,this.adjustPanelPositions(),this.draw(),this.savePanels()},i.ChartEngine.prototype.calculatePanelPercent=function(t){var e=t.bottom-t.top;t.percent=e/this.chart.canvasHeight},i.ChartEngine.prototype.resizePanels=function(){if(i.ChartEngine.resizingPanel){var t,e,n,r=!0;if(i.ChartEngine.crosshairY>this.resolveY(i.ChartEngine.resizingPanel.top)&&(r=!1),r){n=null;for(t in this.panels){if(this.panels[t]==i.ChartEngine.resizingPanel)break;this.panels[t].hidden||(n=this.panels[t])}e=this.backOutY(i.ChartEngine.crosshairY),e<n.top+30&&(e=n.top+30,i.ChartEngine.crosshairY=this.resolveY(e)),n.bottom=e,i.ChartEngine.resizingPanel.top=e,this.calculatePanelPercent(n),this.calculatePanelPercent(i.ChartEngine.resizingPanel)}else{n=null;for(t in this.panels){if(this.panels[t]==i.ChartEngine.resizingPanel)break;this.panels[t].hidden||(n=this.panels[t])}e=this.backOutY(i.ChartEngine.crosshairY),e>i.ChartEngine.resizingPanel.bottom-30&&(e=i.ChartEngine.resizingPanel.bottom-30,i.ChartEngine.crosshairY=this.resolveY(e)),n.bottom=e,i.ChartEngine.resizingPanel.top=e,this.calculatePanelPercent(n),this.calculatePanelPercent(i.ChartEngine.resizingPanel)}this.adjustPanelPositions(),this.draw(),this.savePanels()}},i.ChartEngine.prototype.adjustPanelPositions=function(){if(this.chart.symbol&&!this.runPrepend("adjustPanelPositions",arguments)){var t,e,i=0,n=this.chart.canvasHeight,r=!1,a=0,o=0,s=!1;for(t in this.panels)e=this.panels[t],(isNaN(e.percent)||e.percent<=0)&&(e.percent=.05),e.hidden||(a+=e.percent,o++,e.soloing&&(s=!0));for(t in this.panels){var l=0;if(e=this.panels[t],e.hidden)e.markerHolder&&(e.markerHolder.style.display="none");else{r?this.displayIconsUpDown&&(e.up.style.display=""):(r=!0,e.up.style.display="none"),s?e.soloing?this.displayIconsSolo&&(e.solo.style.display=""):e.solo.style.display="none":1==o?e.solo.style.display="none":2!=o||this.soloPanelToFullScreen?this.displayIconsSolo&&(e.solo.style.display=""):e.solo.style.display="none",1==o?e.down.style.display="none":this.displayIconsUpDown&&(e.down.style.display=""),e.editFunction?e.edit.style.display="":e.edit.style.display="none",e.percent=e.percent/a,e.top=i,e.bottom=e.top+n*e.percent,e.height=e.bottom-e.top,e.chart.name==e.name&&(e.chart.top=e.top,e.chart.bottom=e.bottom,e.chart.height=e.height);var h=e.yAxis;h.zoom&&h.height>0&&(l=h.zoom/h.height),this.adjustYAxisHeightOffset(e,h),h.top=e.top+h.topOffset,h.bottom=e.bottom-h.bottomOffset,h.height=h.bottom-h.top,l&&(h.zoom=l*h.height,h.zoom>h.height&&(h.zoom=0,h.scroll=0)),i=e.bottom,h.high||0===h.high||(h.high=100,h.low=0,h.shadow=100),h.multiplier=h.height/h.shadow,e.holder&&(e.holder.style.right="0px",e.holder.style.top=e.top+"px",e.holder.style.left="0px",e.holder.style.height=e.height+"px",e.subholder.style.left=e.left+"px",e.subholder.style.width=e.width+"px",e.subholder.style.top="0px",h.height>=0&&(e.subholder.style.height=h.height+"px"))}}if(t&&(this.panels[t].down.style.display="none"),2!=o||s||(this.panels.chart.solo.style.display=""),this.controls.chartControls&&this.panels.chart){var c;c=s&&this.soloPanelToFullScreen?this.chart.canvasHeight-e.yAxis.bottom+12:this.chart.canvasHeight-this.panels.chart.yAxis.bottom+12,this.controls.chartControls.style.bottom=c+"px"}this.clearPixelCache(),this.adjustDrawings(),this.runAppend("adjustPanelPositions",arguments)}},i.ChartEngine.prototype.addChart=function(t,e){e.name=t,this.charts[t]=e},i.ChartEngine.prototype.createPanel=function(t,e,i,n){if(!this.runPrepend("createPanel",arguments)){n||(n="chart");var r=this.chart.canvasHeight;i||(i=.2*r);var a=i/r,o=1-a;for(var s in this.panels){this.panels[s].percent*=o}this.stackPanel(t,e,a,n),this.adjustPanelPositions(),this.savePanels(!1),this.runAppend("createPanel",arguments)}},i.ChartEngine.prototype.configurePanelControls=function(t){var e=t.name==t.chart.name;t.icons=r(".stx-panel-control",t.holder),t.close=t.icons.children[4],t.close=r(".stx-ico-close",t.icons).parentNode,i.appendClassName(t.icons,"stx-show"),t.title=r(".stx-panel-title",t.icons),t.up=r(".stx-ico-up",t.icons).parentNode,t.solo=r(".stx-ico-focus",t.icons).parentNode,t.down=r(".stx-ico-down",t.icons).parentNode,t.edit=r(".stx-ico-edit",t.icons).parentNode,this.displayIconsUpDown||(t.up.style.display="none"),this.displayIconsUpDown||(t.down.style.display="none"),this.displayIconsSolo||(t.solo.style.display="none"),this.displayIconsClose||(t.close.style.display="none"),this.displayPanelResize||(t.handle.style.display="none"),t.title.innerHTML="",t.display&&t.title.appendChild(document.createTextNode(t.display)),e&&(i.appendClassName(t.title,"chart-title"),i.appendClassName(t.icons,"stx-chart-panel")),i.touchDevice&&!i.isSurface||this.makeModal(t.icons),i.touchDevice&&!i.isSurface||(t.handle.onmouseover=function(t){return function(){t.hideCrosshairs()}}(this)),i.touchDevice&&!i.isSurface||(t.handle.onmouseout=function(t){return function(){t.showCrosshairs()}}(this)),i.touchDevice&&(t.handle.ontouchstart=function(t,e){return function(i){t.resizingPanel||(i.preventDefault(),t.grabHandle(e))}}(this,t),t.handle.ontouchend=function(t){return function(e){e.preventDefault(),t.releaseHandle()}}(this)),t.handle.onmousedown=function(t,e){return function(i){i||(i=event),t.grabHandle(e)}}(this,t),t.handle.onmouseup=function(t){return function(e){e||(e=event),t.releaseHandle()}}(this),i.safeClickTouch(t.close,function(t,e){return function(){t.panelClose(e)}}(this,t)),i.safeClickTouch(t.up,function(t,e){return function(){t.panelUp(e)}}(this,t)),i.safeClickTouch(t.down,function(t,e){return function(){t.panelDown(e)}}(this,t)),i.safeClickTouch(t.solo,function(t,e){return function(){t.panelSolo(e)}}(this,t)),"chart"==t.name&&(t.close.style.display="none")},i.ChartEngine.prototype.stackPanel=function(t,e,n,r){if(!this.runPrepend("stackPanel",arguments)){r||(r="chart");var a=this.charts[r],o=e==r,s=null;o&&(t=a.symbol,a.symbolDisplay&&(t=a.symbolDisplay),s=a.yAxis);var l=this.panels[e]=new i.ChartEngine.Panel(e,s);!o&&a.yAxis&&(l.yAxis.width=a.yAxis.width),l.percent=n,l.chart=a,l.display=t,l.holder=i.newChild(this.container,"div","stx-holder"),l.subholder=i.newChild(l.holder,"div","stx-subholder"),l.subholder.style.zIndex=1,l.holder.setAttribute("cq-panel-name",e),l.subholder.setAttribute("cq-panel-name",e);var h=o?"stx-panel-chart":"stx-panel-study";i.appendClassName(l.holder,h),l.subholder.appendChild(this.controls.iconsTemplate.cloneNode(!0)),l.handle=this.controls.handleTemplate.cloneNode(!0),this.container.appendChild(l.handle),l.handle.id=null,l.handle.panel=l,this.configurePanelControls(l),this.resizeCanvas(),this.runAppend("stackPanel",arguments)}},i.ChartEngine.prototype.setPanelEdit=function(t,e){t.editFunction=e,i.safeClickTouch(t.edit,e),this.adjustPanelPositions()},i.ChartEngine.prototype.drawPanels=function(){if(!this.runPrepend("drawPanels",arguments)){var t=!1;for(var e in this.panels){var n=this.panels[e];n.axisDrawn=!1,n.state={};var r=this.translateIf(n.display);if(n.title.textContent!=r&&(n.title.innerHTML="",n.title.appendChild(document.createTextNode(r))),i.appendClassName(n.icons,"stx-show"),n.hidden)i.unappendClassName(n.icons,"stx-show"),n.handle.style.display="none",n.holder.style.display="none";else if(this.displayIconsUpDown||(n.up.style.display="none"),this.displayIconsUpDown||(n.down.style.display="none"),this.displayIconsSolo||(n.solo.style.display="none"),n.holder.style.display="block",t){var a=n.top;a=Math.round(a)+.5,this.plotLine(n.left,n.right,a,a,this.canvasStyle("stx_panel_border"),"segment",this.chart.context,!1,{}),this.displayPanelResize?n.handle.style.display="":n.handle.style.display="none",n.handle.style.top=a-n.handle.offsetHeight/2+"px"}else n.handle.style.display="none",t=!0}this.runAppend("drawPanels",arguments)}},i.ChartEngine.prototype.touchSingleClick=function(t,e,n){var r=this,a=arguments;return function(){(function(){if(!this.cancelTouchSingleClick){if(this.runPrepend("touchSingleClick",a))return;if(this.editingAnnotation)return;if(this.clicks={s1MS:-1,e1MS:-1,s2MS:-1,e2MS:-1},!this.displayCrosshairs)return;if(!this.displayInitialized)return;if(""!==this.openDialog)return;if(e<this.left||e>this.right||n<this.top||n>this.bottom)return;var t=this.backOutY(i.ChartEngine.crosshairY),o=this.backOutX(i.ChartEngine.crosshairX);this.currentPanel=this.whichPanel(t);var s=this.currentVectorParameters.vectorType;if(!(i.Drawing&&s&&i.Drawing[s]&&(new i.Drawing[s]).dragToDraw)){if(!this.drawingClick(this.currentPanel,o,t)&&!this.layout.crosshair){i.ChartEngine.crosshairY=0,i.ChartEngine.crosshairX=0,this.cx=this.backOutX(i.ChartEngine.crosshairX),this.cy=this.backOutY(i.ChartEngine.crosshairY),this.findHighlights(),i.ChartEngine.crosshairY=n,i.ChartEngine.crosshairX=e;var l=this.container.getBoundingClientRect();this.top=l.top,this.left=l.left,this.right=this.left+this.width,this.bottom=this.top+this.height,this.cx=this.backOutX(i.ChartEngine.crosshairX),this.cy=this.backOutY(i.ChartEngine.crosshairY),this.currentPanel&&this.currentPanel.chart.dataSet&&(this.crosshairTick=this.tickFromPixel(this.cx,this.currentPanel.chart),this.crosshairValue=this.adjustIfNecessary(this.currentPanel,this.crosshairTick,this.valueFromPixel(this.cy,this.currentPanel))),this.headsUpHR(),this.findHighlights(!0)}this.currentVectorParameters.vectorType||this.dispatch("tap",{stx:this,panel:this.currentPanel,x:o,y:t})}}r.cancelTouchSingleClick=!1,this.runAppend("touchSingleClick",a)}).apply(r,a)}},i.ChartEngine.prototype.touchDoubleClick=function(t,e,n){if(!this.runPrepend("touchDoubleClick",arguments)&&!this.dispatch("doubleTap",{stx:this,finger:t,x:e,y:n})&&!(e<this.left||e>this.right||n<this.panels.chart.top||n>this.panels.chart.bottom||this.editingAnnotation)){if(i.ChartEngine.drawingLine)this.undo();else if(this.anyHighlighted)this.deleteHighlighted();else{var r=this.currentPanel.yAxis;r.scroll==(r.initialMarginTop-r.initialMarginBottom)/2&&r.zoom==r.initialMarginTop+r.initialMarginBottom?this.home():this.calculateYAxisMargins(this.currentPanel.yAxis),this.draw()}this.clicks={s1MS:-1,e1MS:-1,s2MS:-1,e2MS:-1},this.runAppend("touchDoubleClick",arguments)}},i.ChartEngine.prototype.startProxy=function(t){if(4==t.pointerType||"mouse"==t.pointerType?this.mouseMode=!0:this.mouseMode=!1,!this.mouseMode)if(this.touches[this.touches.length]={pointerId:t.pointerId,pageX:t.clientX,pageY:t.clientY},this.changedTouches=[{pointerId:t.pointerId,pageX:t.clientX,pageY:t.clientY}],this.gestureInEffect||1!=this.touches.length)this.gesture.stop(),this.touchstart(t);else{if(this.gesturePointerId=t.pointerId,this.overrideGesture=!1,!this.gesture)return;this.gesture.addPointer(t.pointerId),this.touchstart(t)}},i.ChartEngine.prototype.moveProxy=function(t){4==t.pointerType||"mouse"==t.pointerType?this.mouseMode=!0:this.mouseMode=!1,this.mouseMode||this.gestureInEffect||this.touchmove(t)},i.ChartEngine.prototype.endProxy=function(t){if(!this.mouseMode){for(var e=this.touches.length,i=0;i<this.touches.length;i++)if(this.touches[i].pointerId==t.pointerId){this.touches.splice(i,1);break}if(i==e)return this.touches=[],this.grabbingScreen=!1,void(this.touching=!1);this.changedTouches=[{pointerId:t.pointerId,pageX:t.clientX,pageY:t.clientY}],this.gestureInEffect||this.touchend(t)}},i.ChartEngine.prototype.msMouseMoveProxy=function(t){!this.touches.length&&this.mouseMode&&this.mousemove(t)},i.ChartEngine.prototype.msMouseDownProxy=function(t){this.mouseMode&&this.mousedown(t)},i.ChartEngine.prototype.msMouseUpProxy=function(t){this.mouseMode&&this.mouseup(t)},i.ChartEngine.prototype.iosMouseMoveProxy=function(t){this.touching||this.mousemove(t)},i.ChartEngine.prototype.iosMouseDownProxy=function(t){if(this.touching)return void(this.mouseMode=!1);this.mouseMode=!0,this.mousedown(t)},i.ChartEngine.prototype.iosMouseUpProxy=function(t){this.touching||this.mouseup(t)},i.ChartEngine.prototype.rawWatermark=function(t,e,i,n){this.canvasFont("stx_watermark",t),t.fillStyle=this.defaultColor,t.globalAlpha=.5,this.chart.context.textBaseline="alphabetic",t.fillText(n,e,i),t.globalAlpha=1},i.ChartEngine.prototype.watermark=function(t,e){if(e&&"object"!=(void 0===e?"undefined":_typeof(e))&&(e={h:arguments[1],v:arguments[2],text:arguments[3]}),e={h:e.h||"left",v:e.v||"bottom",text:e.text||"",hOffset:e.hOffset||10,vOffset:e.vOffset||20},this.chart.context){var i=this.panels[t];if(i&&!i.hidden){var n=i.yAxis.bottom-e.vOffset;"top"==e.v?n=i.top+e.vOffset:"middle"==e.v&&(n=(i.top+i.yAxis.bottom)/2),this.chart.context.save(),this.canvasFont("stx_watermark"),this.canvasColor("stx_watermark"),this.chart.context.textBaseline="alphabetic";var r=i.left+e.hOffset;"right"==e.h?r=i.right-e.hOffset:"center"==e.h&&(r=(i.right+i.left-this.chart.context.measureText(e.text).width)/2),this.chart.context.globalAlpha=.5,this.chart.context.fillText(e.text,r,n),this.chart.context.globalAlpha=1,this.chart.context.restore()}}},i.ChartEngine.prototype.preAdjustScroll=function(t){t||(t=this.chart),this.previousAdjust={chart:t,scroll:t.scroll,maxTicks:t.maxTicks}},i.ChartEngine.prototype.postAdjustScroll=function(){if(this.previousAdjust){var t=this.previousAdjust.chart;t.scroll=this.previousAdjust.scroll+(t.maxTicks-this.previousAdjust.maxTicks),this.displayInitialized&&this.draw()}},i.ChartEngine.prototype.adjustDrawings=function(){for(var t=0;t<this.drawingObjects.length;t++){var e=this.drawingObjects[t];this.panels[e.panelName]&&e.adjust()}},i.ChartEngine.prototype.getNextInterval=function(t,e,i){e||(e=1),!1!==i&&(i=!0);var n=this.standardMarketIterator(t,i?this.dataZone:this.displayZone);return e<1?n.previous(-1*e):n.next(e)},i.ChartEngine.prototype.standardMarketIterator=function(t,e,i){var n=e||this.dataZone,r=i||this.chart,a={begin:t,interval:"tick"==this.layout.interval?1:this.layout.interval,periodicity:"tick"==this.layout.interval?this.chart.xAxis.futureTicksInterval:this.layout.periodicity,timeUnit:this.layout.timeUnit,inZone:this.dataZone,outZone:n};return r.market.newIterator(a)},i.ChartEngine.prototype.zoomSet=function(t,e){if("volume_candle"!==this.layout.chartType){var i;i=this.preferences.zoomAtCurrentMousePosition&&this.zoomInitiatedByMouseWheel&&this.crosshairTick<e.dataSet.length?this.crosshairTick||this.tickFromPixel(this.cx,e):this.isHome()?e.dataSet.length-1:this.chart.scroll>this.chart.dataSet.length?0:this.tickFromPixel(this.chart.width/2,e),this.animations.zoom.hasCompleted&&(this.zoomInitiatedByMouseWheel=!1);var n=e.dataSet.length-1-i,r=e.scroll;e.scroll=Math.floor(this.pixelFromTick(i,e)/t)+1+n,this.micropixels+=(r-n)*this.layout.candleWidth-(e.scroll-n)*t}this.setCandleWidth(t),e.spanLock=!1,this.draw(),this.doDisplayCrosshairs(),this.updateChartAccessories()},i.ChartEngine.prototype.zoomOut=function(t,e){if(!this.runPrepend("zoomOut",arguments)){this.grabbingScreen=!1,i.ChartEngine.insideChart&&i.unappendClassName(this.container,"stx-drag-chart"),this.preferences.zoomOutSpeed?e=this.preferences.zoomOutSpeed:e||(e=1.3),t&&t.preventDefault&&t.preventDefault(),this.cancelTouchSingleClick=!0;var n=this;for(var r in this.charts){var a=this.charts[r];if(i.ipad&&a.maxTicks>i.ChartEngine.ipadMaxTicks)return;var o=Math.floor(a.maxTicks*e);!1===a.allowScrollFuture&&!1===a.allowScrollPast&&o>a.dataSet.length&&(o=a.dataSet.length);var s=this.chart.width/o;s<this.minimumCandleWidth&&(s=this.minimumCandleWidth),this.layout.setSpan=null,this.animations.zoom.run(function(t){return function(e){if(n.zoomSet(e,t),n.animations.zoom.hasCompleted){if(n.runAppend("zoomOut",arguments))return;n.changeOccurred("layout")}}}(a),this.layout.candleWidth,s)}}},i.ChartEngine.prototype.mouseWheel=function(t){if(!this.runPrepend("mouseWheel",arguments)){t||(t=event),t.preventDefault&&t.preventDefault();var e=t.deltaX,n=t.deltaY;if(Math.abs(n)>Math.abs(e)?e=0:n=0,this.lastMouseWheelEvent=Date.now(),0!==Math.abs(e)||0!==Math.abs(n)){if(this.allowSideswipe&&0!==e){this.lastMove="horizontal";var r=e;return r>50&&(r=50),r<-50&&(r=-50),this.grabbingScreen=!0,this.currentPanel||(this.currentPanel=this.chart.panel),this.grabStartX=i.ChartEngine.crosshairX,this.grabStartY=i.ChartEngine.crosshairY,this.grabStartScrollX=this.chart.scroll,this.grabStartScrollY=this.currentPanel.yAxis.scroll,this.grabStartMicropixels=this.micropixels,this.grabStartPanel=this.currentPanel,this.mousemoveinner(i.ChartEngine.crosshairX-r,i.ChartEngine.crosshairY),this.updateChartAccessories(),void(this.grabbingScreen=!1)}if(this.lastMove="vertical",this.allowZoom&&this.displayInitialized){n||("onmousewheel"==i.wheelEvent?(n=-.025*t.wheelDelta,t.wheelDeltaX&&(e=-.025*t.wheelDeltaX)):n=t.detail),void 0===t.deltaMode&&(t.deltaMode="MozMousePixelScroll"==t.type?0:1);var a=-n;1==t.deltaMode&&(a*=33);var o=null,s=null;if(this.mouseWheelAcceleration){var l=Math.max(Math.pow(Math.abs(a),.3),1);o=1-.1*l,s=1+.2*l}if(this.zoomInitiatedByMouseWheel=!0,a>0?this.reverseMouseWheel?this.zoomOut(null,s):this.zoomIn(null,o):a<0&&(this.reverseMouseWheel?this.zoomIn(null,o):this.zoomOut(null,s)),!this.runAppend("mouseWheel",arguments))return!1}}}},i.ChartEngine.prototype.zoomIn=function(t,e){if(!this.runPrepend("zoomIn",arguments)){this.grabbingScreen=!1,i.ChartEngine.insideChart&&i.unappendClassName(this.container,"stx-drag-chart"),this.preferences.zoomInSpeed?e=this.preferences.zoomInSpeed:e||(e=.7),t&&t.preventDefault&&t.preventDefault(),this.cancelTouchSingleClick=!0;var n=this;for(var r in this.charts){var a=this.charts[r],o=Math.floor(a.maxTicks*e);a.maxTicks-o<1&&(o=a.maxTicks-1),o<this.minimumZoomTicks&&(o=this.minimumZoomTicks);var s=this.chart.width/o;this.layout.setSpan=null,this.animations.zoom.run(function(t){return function(e){if(n.zoomSet(e,t),n.animations.zoom.hasCompleted){if(n.runAppend("zoomIn",arguments))return;n.changeOccurred("layout")}}}(a),this.layout.candleWidth,s)}}},i.ChartEngine.prototype.translateIf=function(t){return this.translationCallback?this.translationCallback(t):t},i.ChartEngine.prototype.setTimeZone=function(t,e){if(void 0===o)return void(this.timeZoneOffset=0);var n=new Date,r=n.getTimezoneOffset(),a=r,s=r;t&&(this.dataZone=t),this.dataZone&&(a=new o.Date(n,this.dataZone).getTimezoneOffset()),e&&(this.displayZone=e),this.displayZone&&(s=new o.Date(n,this.displayZone).getTimezoneOffset()),this.timeZoneOffset=a-r-(s-r);for(var l in this.charts){var h=this.charts[l];h.masterData&&!i.ChartEngine.isDailyInterval(this.layout.interval)&&this.setDisplayDates(h.masterData)}this.preferences.timeZone=e,this.changeOccurred("preferences"),this.createDataSet()},i.ChartEngine.prototype.setLocale=function(t,e){if("undefined"!=typeof Intl&&this.locale!=t){this.locale=t;var n,r=this.internationalizer={};for(r.hourMinute=new Intl.DateTimeFormat(this.locale,{hour:"numeric",minute:"numeric",hour12:!1}),r.hourMinuteSecond=new Intl.DateTimeFormat(this.locale,{hour:"numeric",minute:"numeric",second:"numeric",hour12:!1}),r.mdhm=new Intl.DateTimeFormat(this.locale,{year:"2-digit",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),r.monthDay=new Intl.DateTimeFormat(this.locale,{month:"numeric",day:"numeric"}),r.yearMonthDay=new Intl.DateTimeFormat(this.locale,{year:"numeric",month:"numeric",day:"numeric"}),r.yearMonth=new Intl.DateTimeFormat(this.locale,{year:"numeric",month:"numeric"}),r.month=new Intl.DateTimeFormat(this.locale,{month:"short"}),r.numbers=new Intl.NumberFormat(this.locale),r.priceFormatters=[],e||(e=5),n=0;n<e+1;n++)r.priceFormatters.push(new Intl.NumberFormat(this.locale,{maximumFractionDigits:n,minimumFractionDigits:n}));for(n=0;n<5;n++){var a=n,o=n;n||(a="",o=2),r["percent"+a]=new Intl.NumberFormat(this.locale,{style:"percent",minimumFractionDigits:o,maximumFractionDigits:o})}i.I18N.createMonthArrays&&i.I18N.createMonthArrays(this,r.month,this.locale)}},i.ChartEngine.prototype.importLayout=function(t,e){"object"!==(void 0===e?"undefined":_typeof(e))&&(e={managePeriodicity:arguments[1],preserveTicksAndCandleWidth:arguments[2]});var n=this.layout,r=i.shallowClone(n),a=e.managePeriodicity,o=e.cb,s=e.seriesCB,l=e.noDataLoad,h=this.minimumCandleWidth,c=e.preserveTicksAndCandleWidth;c||!1===c||(c=!0);var u=this.exportDrawings();if(this.abortDrawings(),this.currentlyImporting=!0,i.Studies)for(var p in n.studies){var d=n.studies[p];i.Studies.removeStudy(this,d)}this.overlays={};var f=i.clone(t);if(f){var m=i.shallowClone(this.panels);this.panels={};var g=i.clone(f);a||(delete g.periodicity,delete g.interval,delete g.timeUnit,delete g.setSpan),i.dataBindSafeAssignment(n,g),a||(n.periodicity=r.periodicity,n.interval=r.interval,n.timeUnit=r.timeUnit,n.setSpan=r.setSpan),c?n.candleWidth=r.candleWidth:n.candleWidth||(n.candleWidth=8),n.candleWidth<h&&(n.candleWidth=h),this.setCandleWidth(n.candleWidth),"percent"==n.chartScale&&this.setComparison(!0);var v,y,b,x=f.panels,w=[];for(y in x){if(!("top"in x[y]))break;for(b=x[y],b.name=y,v=w.length-1;v>=0&&w[v].top>b.top;--v);w.splice(v+1,0,b)}if(n.panels={},w.length>0)for(var C=0;C<w.length;++C)b=w[C],this.stackPanel(b.display,b.name,b.percent,b.chartName);else for(y in x)b=x[y],this.stackPanel(b.display,y,b.percent,b.chartName);i.isEmpty(x)&&this.stackPanel("chart","chart",1,"chart");for(var S in m){var T=m[S],_=this.panels[S];if(_){this.container.removeChild(_.holder),this.container.removeChild(T.handle);var k={holder:!0,subholder:!0,display:!0};for(var D in k)_[D]=T[D];this.configurePanelControls(_),T.chart.panel==T&&(T.chart.panel=_)}else this.privateDeletePanel(T)}if(this.adjustPanelPositions(),this.storePanels(),i.Studies){var M=i.clone(n.studies);delete n.studies;for(var E in M){var A=M[E];i.Studies.addStudy(this,A.type,A.inputs,A.outputs,A.parameters,A.panel)}}}this.extendedHours&&this.extendedHours.prepare(n.extended,n.marketSessions),void 0===n.chartType&&(n.chartType="line"),this.adjustPanelPositions();var P=this;if(t.symbols&&t.symbols.length){var L={};a&&(t.setSpan?L.span=t.setSpan:t.interval&&(L.periodicity={interval:t.interval,periodicity:t.periodicity,timeUnit:t.timeUnit}));var O=t.symbols[0].symbolObject||t.symbols[0].symbol;return void(l?P.currentlyImporting=!1:this.newChart(O,null,this.chart,function(e){if(!e)for(var n,r=1;r<t.symbols.length;++r){n=t.symbols[r],n.parameters||(n.parameters={});var a=i.clone(n.parameters);a.action=null,P.addSeries(n.symbol,a,s)}P.importDrawings(u),P.draw(),P.currentlyImporting=!1,P.updateListeners("layout"),o&&o.apply(null,arguments)},L))}if(f&&a&&!l){if(f.setSpan&&"{}"!=JSON.stringify(f.setSpan)&&this.chart.symbol)return void this.setSpan(f.setSpan,function(){P.importDrawings(u),P.draw(),P.currentlyImporting=!1,P.updateListeners("layout"),o&&o()});var F=f.interval,I=f.periodicity,j=f.timeUnit;if(isNaN(I)&&(I=1),F||(F="day"),F!=r.interval||I!=r.periodicity||j!=r.timeUnit)return n.periodicity=r.periodicity,n.interval=r.interval,n.timeUnit=r.timeUnit,n.setSpan=r.setSpan,void this.setPeriodicity({period:I,interval:F,timeUnit:j},function(){P.importDrawings(u),P.draw(),P.currentlyImporting=!1,P.updateListeners("layout"),e.cb&&e.cb()})}this.createDataSet(),this.importDrawings(u),this.draw(),c||this.home(),this.currentlyImporting=!1,this.updateListeners("layout"),e.cb&&e.cb()},i.ChartEngine.prototype.exportLayout=function(t){var e={};for(var n in this.layout)"studies"!=n&&"panels"!=n?e[n]=i.clone(this.layout[n]):"studies"==n?e.studies={}:"panels"==n&&(e.panels={});for(var r in this.panels){var a=e.panels[r]={},o=this.panels[r];a.percent=o.percent,a.display=o.display,a.chartName=o.chart.name,a.top=o.top}for(var s in this.layout.studies){var l=e.studies[s]={},h=this.layout.studies[s];l.type=h.type,l.inputs=i.clone(h.inputs),l.outputs=i.clone(h.outputs),l.panel=h.panel,l.parameters=i.clone(h.parameters)}return t?e.symbols=this.getSymbols({"include-parameters":!0,"exclude-studies":!0}):delete e.symbols,e},i.ChartEngine.prototype.doCleanupDates=function(t,e){if(i.ChartEngine.isDailyInterval(e)&&t&&t.length)for(var n=0;n<t.length;n++){var r=t[n].DT;r&&("[object Date]"!=Object.prototype.toString.call(r)&&(r=new Date(r)),r&&r.setHours(0,0,0,0))}},i.ChartEngine.prototype.doCleanupGaps=function(t,e,n){function r(t,e){var n=t[f];void 0!==n&&i.ensureDefaults(e,{Close:n,Open:n,High:n,Low:n,Volume:0,Adj_Close:t.Adj_Close})}var a=this.layout.interval;n=n||{};var o=n.cleanupGaps?n.cleanupGaps:this.cleanupGaps,s="gap"==o;if(!o)return t;if("tick"==a)return t;if(!t||!t.length)return t;if(e||(e=this.chart),"month"==a||"week"==a){if(this.dontRoll)return t;a="day"}var l=function(t){return t.DT?new Date(+t.DT):i.strToDateTime(t.Date)},h=[],c=t[0];h.push(c);for(var u,p={begin:l(c),interval:a,periodicity:1,timeUnit:this.layout.timeUnit,inZone:this.dataZone,outZone:this.dataZone},d=e.market.newIterator(p),f=e.defaultPlotField,m=0;m<t.length;m++){var g=t[m];u=d.next();var v=l(g);for(function(t,e){for(;+t<+e;){var i=s?null:c[f],n=s?null:c.Adj_Close;h.push({DT:t,Open:i,High:i,Low:i,Close:i,Volume:0,Adj_Close:n}),t=d.next()}}(u,v);v<u;){if(++m==t.length)return h;s||r(c,g),h.push(g),c=g,g=t[m],v=l(g)}u<v?(m--,u=d.previous()):(s||r(c,g),h.push(g),c=g)}return h},i.Comparison=function(){},i.Comparison.priceToPercent=function(t,e,n){var r=i.Comparison.baseline||n;return Math.round((n-r)/r*100*1e4)/1e4},i.Comparison.percentToPrice=function(t,e,n){return(i.Comparison.baseline||1)*(1+n/100)},i.Comparison.createComparisonSegmentInner=function(t,e){var n,r=[];for(n in e.series){var a=e.series[n].parameters;a.isComparison&&r.push(a.symbol)}var o=["Close","Open","High","Low","iqPrevClose"];e.defaultPlotField&&!t.highLowBars[t.layout.chartType]&&o.unshift(e.defaultPlotField);var s=o[0],l=t.layout.studies;if(l)for(var h in l){var c=l[h];if(t.panels[c.panel]&&t.panels[c.panel].name==c.chart.name){for(n in c.outputMap)o.push(n);c.referenceOutput&&o.push(c.referenceOutput+" "+c.name)}}for(var u in t.plugins){var p=t.plugins[u];if(p.transformOutputs)for(n in p.transformOutputs)o.push(n)}e.dataSegment=[];var d=null,f=e.dataSet.length-e.scroll;t.micropixels+t.layout.candleWidth/2<0&&f++;for(var m=e.maxTicks+3,g=0;g<=m;g++){g==m&&(g=-1);var v=f+g;if(v<e.dataSet.length&&v>=0){var y=e.dataSet[v],b=y[s];if(!d){if(0===b||null===b){if(g<0)break;continue}d=i.clone(y)}y.transform||(y.transform={cache:{},DT:y.DT,Date:y.Date}),!i.Comparison.baseline&&b&&(d=i.clone(y)),i.Comparison.baseline=d[s];var x;for(x=0;x<o.length;x++)n=o[x],(y[n]||0===y[n])&&(y.transform[n]=e.transformFunc(t,e,y[n]));for(x=0;x<r.length;x++){n=r[x];var w=e.series[n];if(-1==g&&w&&w.parameters.isComparison)delete y.transform[n];else{var C=y[n];if(C||0===C){var S=d[n];if(S||0===S||(d[n]=S=C/(1+y.transform[s]/100)),0!==S){var T=i.Comparison.baseline||1,_=C*(T/S);y.transform[n]=e.transformFunc(t,e,_)}}}}e.dataSegment.push(y)}else v<0&&e.dataSegment.push(null);if(g<0)break}},i.Comparison.priceFormat=function(t,e,i){if(null===i||void 0===i)return"";var n=e.yAxis.priceTick,r=t.internationalizer;return i=r?n>=1?r.percent.format(i/100):n>=.1?r.percent1.format(i/100):n>=.01?r.percent2.format(i/100):n>=.001?r.percent3.format(i/100):r.percent4.format(i):n>=1?i.toFixed(0)+"%":n>=.1?i.toFixed(1)+"%":n>=.01?i.toFixed(2)+"%":n>=.001?i.toFixed(3)+"%":i.toFixed(4)+"%",0===parseFloat(i)&&"-"==i.charAt(0)&&(i=i.substring(1)),i},i.ChartEngine.prototype.setComparison=function(t,e){e||(e=this.chart),"string"==typeof e&&(e=this.charts[e]);var n=e.panel.yAxis;!e.isComparison&&t?(this.setTransform(e,i.Comparison.priceToPercent,i.Comparison.percentToPrice),n.originalPriceFormatter={func:n.priceFormatter},n.priceFormatter=i.Comparison.priceFormat,n.whichSet="dataSegment"):e.isComparison&&!t&&(this.unsetTransform(e),n.priceFormatter=n.originalPriceFormatter?n.originalPriceFormatter.func:null,n.originalPriceFormatter=null,n.whichSet="dataSet"),e.isComparison=t},i.ChartEngine.prototype.importPreferences=function(t){this.preferences=t,t.timeZone&&this.setTimeZone(this.dataZone,t.timeZone),t.language&&i.I18N&&(i.I18N.setLanguage(this,t.language),i.I18N.translateUI(t.language))},i.ChartEngine.prototype.exportPreferences=function(){return this.preferences},"undefined"!=typeof document&&document.addEventListener("contextmenu",i.ChartEngine.handleContextMenu),t},__market_=function(t){t||(t={});var e=t.CIQ,i=t.timezoneJS;e||(e=function(){},t.CIQ=e);e.Market=function(t){this.market_def=!1,this.rules=!1,this.normalHours=[],this.extraHours=[],this.class_name="Market",this.tz_lib=void 0===i?Date:i.Date,this.market_tz="",this.hour_aligned=!1,this.convertOnDaily=!1,this.enabled_by_default=!1,void 0!==t&&t&&t!={}&&(t.market_definition&&(t=t.market_definition),t.rules&&(this.rules=t.rules),t.market_tz&&(this.market_tz=t.market_tz),t.convertOnDaily&&(this.convertOnDaily=t.convertOnDaily),_typeof(t.hour_aligned)&&(this.hour_aligned=t.hour_aligned),void 0!==t.enabled_by_default&&t.enabled_by_default instanceof Array&&(this.enabled_by_default=t.enabled_by_default),this.market_def=t,void 0===this.market_def.name&&(this.market_def.name="no market name specified"),e.Market._createTimeSegments(this))},e.Market.GLOBEX={name:"GLOBEX",market_tz:"America/Chicago",hour_aligned:!0,rules:[{dayofweek:0,open:"15:00",close:"24:00"},{dayofweek:1,open:"00:00",close:"24:00"},{dayofweek:2,open:"00:00",close:"24:00"},{dayofweek:3,open:"00:00",close:"24:00"},{dayofweek:4,open:"00:00",close:"24:00"},{dayofweek:5,open:"00:00",close:"18:00"}]},e.Market.FOREX={name:"FOREX",market_tz:"America/New_York",hour_aligned:!0,rules:[{dayofweek:0,open:"15:00",close:"24:00"},{dayofweek:1,open:"00:00",close:"17:00"},{dayofweek:1,open:"17:00",close:"24:00"},{dayofweek:2,open:"00:00",close:"17:00"},{dayofweek:2,open:"17:00",close:"24:00"},{dayofweek:3,open:"00:00",close:"17:00"},{dayofweek:3,open:"17:00",close:"24:00"},{dayofweek:4,open:"00:00",close:"17:00"},{dayofweek:4,open:"17:00",close:"24:00"},{dayofweek:5,open:"00:00",close:"17:00"}]},e.Market.METALS={name:"METALS",market_tz:"America/New_York",hour_aligned:!0,rules:[{dayofweek:0,open:"18:00",close:"24:00"},{dayofweek:1,open:"00:00",close:"17:15"},{dayofweek:1,open:"18:00",close:"24:00"},{dayofweek:2,open:"00:00",close:"17:15"},{dayofweek:2,open:"18:00",close:"24:00"},{dayofweek:3,open:"00:00",close:"17:15"},{dayofweek:3,open:"18:00",close:"24:00"},{dayofweek:4,open:"00:00",close:"17:15"},{dayofweek:4,open:"18:00",close:"24:00"},{dayofweek:5,open:"00:00",close:"17:15"}]},e.Market.NYSE={name:"NYSE",market_tz:"America/New_York",hour_aligned:!1,rules:[{dayofweek:1,open:"09:30",close:"16:00"},{dayofweek:2,open:"09:30",close:"16:00"},{dayofweek:3,open:"09:30",close:"16:00"},{dayofweek:4,open:"09:30",close:"16:00"},{dayofweek:5,open:"09:30",close:"16:00"},{dayofweek:1,open:"04:00",close:"09:30",name:"pre"},{dayofweek:2,open:"04:00",close:"09:30",name:"pre"},{dayofweek:3,open:"04:00",close:"09:30",name:"pre"},{dayofweek:4,open:"04:00",close:"09:30",name:"pre"},{dayofweek:5,open:"04:00",close:"09:30",name:"pre"},{dayofweek:1,open:"16:00",close:"20:00",name:"post"},{dayofweek:2,open:"16:00",close:"20:00",name:"post"},{dayofweek:3,open:"16:00",close:"20:00",name:"post"},{dayofweek:4,open:"16:00",close:"20:00",name:"post"},{dayofweek:5,open:"16:00",close:"20:00",name:"post"},{date:"*-12-25",open:"00:00",close:"00:00"},{date:"*-07-04",open:"00:00",close:"00:00"},{date:"*-01-01",open:"00:00",close:"00:00"},{date:"2012-01-02",open:"00:00",close:"00:00"},{date:"2018-01-15"},{date:"2018-02-19"},{date:"2018-03-30"},{date:"2018-05-28"},{date:"2018-07-03",open:"4:00",close:"9:30",name:"pre"},{date:"2018-07-03",open:"9:30",close:"13:00"},{date:"2018-09-03"},{date:"2018-11-22"},{date:"2018-11-23",open:"4:00",close:"9:30",name:"pre"},{date:"2018-11-23",open:"9:30",close:"13:00"},{date:"2018-12-24",open:"4:00",close:"9:30",name:"pre"},{date:"2018-12-24",open:"9:30",close:"13:00"},{date:"2017-01-02"},{date:"2017-01-16"},{date:"2017-02-20"},{date:"2017-04-14"},{date:"2017-05-29"},{date:"2017-07-03",open:"4:00",close:"9:30",name:"pre"},{date:"2017-07-03",open:"9:30",close:"13:00"},{date:"2017-09-04"},{date:"2017-11-23"},{date:"2017-11-24",open:"4:00",close:"9:30",name:"pre"},{date:"2017-11-24",open:"9:30",close:"13:00"},{date:"2016-01-18"},{date:"2016-02-15"},{date:"2016-03-25"},{date:"2016-05-30"},{date:"2016-09-05"},{date:"2016-11-24"},{date:"2016-11-25",open:"4:00",close:"9:30",name:"pre"},{date:"2016-11-25",open:"9:30",close:"13:00"},{date:"2016-12-26"},{date:"2015-01-19"},{date:"2015-02-16"},{date:"2015-04-03"},{date:"2015-05-25"},{date:"2015-07-03"},{date:"2015-09-07"},{date:"2015-11-26"},{date:"2015-11-27",open:"4:00",close:"9:30",name:"pre"},{date:"2015-11-27",open:"9:30",close:"13:00"},{date:"2015-12-24",open:"4:00",close:"9:30",name:"pre"},{date:"2015-12-24",open:"9:30",close:"13:00"},{date:"2014-01-20"},{date:"2014-02-17"},{date:"2014-04-18"},{date:"2014-05-26"},{date:"2014-09-01"},{date:"2014-11-27"},{date:"2014-07-03",open:"4:00",close:"9:30",name:"pre"},{date:"2014-07-03",open:"9:30",close:"13:00"},{date:"2014-11-28",open:"4:00",close:"9:30",name:"pre"},{date:"2014-11-28",open:"9:30",close:"13:00"},{date:"2014-12-24",open:"4:00",close:"9:30",name:"pre"},{date:"2014-12-24",open:"9:30",close:"13:00"},{date:"2013-01-21"},{date:"2013-02-18"},{date:"2013-03-29"},{date:"2013-05-27"},{date:"2013-09-02"},{date:"2013-11-28"},{date:"2013-07-03",open:"4:00",close:"9:30",name:"pre"},{date:"2013-07-03",open:"9:30",close:"13:00"},{date:"2013-11-29",open:"4:00",close:"9:30",name:"pre"},{date:"2013-11-29",open:"9:30",close:"13:00"},{date:"2013-12-24",open:"4:00",close:"9:30",name:"pre"},{date:"2013-12-24",open:"9:30",close:"13:00"},{date:"2012-01-16"},{date:"2012-02-20"},{date:"2012-04-06"},{date:"2012-05-28"},{date:"2012-09-03"},{date:"2012-10-29"},{date:"2012-10-30"},{date:"2012-11-22"},{date:"2012-07-03",open:"4:00",close:"9:30",name:"pre"},{date:"2012-07-03",open:"9:30",close:"13:00"},{date:"2012-11-23",open:"4:00",close:"9:30",name:"pre"},{date:"2012-11-23",open:"9:30",close:"13:00"},{date:"2012-12-24",open:"4:00",close:"9:30",name:"pre"},{date:"2012-12-24",open:"9:30",close:"13:00"}]},e.Market.Symbology=function(){},e.Market.Symbology.isForeignSymbol=function(t){return!!t&&-1!=t.indexOf(".")},e.Market.Symbology.isFuturesSymbol=function(t){return!!t&&(0===t.indexOf("/")&&"/"!=t)},e.Market.Symbology.isForexSymbol=function(t){return!!t&&(!e.Market.Symbology.isForeignSymbol(t)&&(!e.Market.Symbology.isFuturesSymbol(t)&&(!(t.length<6||t.length>7)&&((6!=t.length||"X"!=t[5])&&!!/\^?[A-Za-z]{6}/.test(t)))))},e.Market.Symbology.isForexMetal=function(t,i){return!!t&&(!!e.Market.Symbology.isForexSymbol(t)&&("^"!=t.charAt(0)&&(t="^"+t),-1!=",XAU,XPD,XPT,XAG,".indexOf(","+t.substr(4,3)+",")||!i&&-1!=",XAU,XPD,XPT,XAG,".indexOf(","+t.substr(1,3)+",")))},e.Market.Symbology.isForexFuturesSymbol=function(t){return!!e.Market.Symbology.isForexSymbol(t)||!!e.Market.Symbology.isFuturesSymbol(t)},e.Market.Symbology.factory=function(t){var i=t.symbol;return e.Market.Symbology.isForeignSymbol(i)?null:e.Market.Symbology.isFuturesSymbol(i)?e.Market.GLOBEX:e.Market.Symbology.isForexMetal(i)?e.Market.METALS:e.Market.Symbology.isForexSymbol(i)?e.Market.FOREX:e.Market.NYSE},e.Market.prototype._find_next_segment=function(t,e){if(!this.market_def)return null;if(!this.rules)return null;var i=new Date(+t),n=this.newIterator({begin:i,interval:1,inZone:this.market_tz,outZone:this.market_tz});if(this._wasOpenIntraDay(i)){var r=this.zseg_match.close_parts.hours,a=this.zseg_match.close_parts.minutes;i.setHours(r),i.setMinutes(a),n=this.newIterator({begin:i,interval:1,inZone:this.market_tz,outZone:this.market_tz})}return n.next()},e.Market.prototype._find_prev_segment=function(t,e){if(!this.market_def)return null;if(!this.rules)return null;var i=new Date(+t),n=this.newIterator({begin:i,interval:1,inZone:this.market_tz,outZone:this.market_tz}),r=this._wasOpenIntraDay(i);if(null===r?(i=new Date(i-6e4),r=this._wasOpenIntraDay(i)):(e&&i.getHours()===this.zseg_match.open_parts.hours&&i.getMinutes()===this.zseg_match.open_parts.minutes||!e&&i.getHours()===this.zseg_match.close_parts.hours&&i.getMinutes()===this.zseg_match.close_parts.minutes)&&(i=n.previous()),r){var a=this.zseg_match.open_parts.hours,o=this.zseg_match.open_parts.minutes;return i.setHours(a),i.setMinutes(o),n=this.newIterator({begin:i,interval:1,inZone:this.market_tz,outZone:this.market_tz}),i=n.previous(),this.zseg_match.close_parts.hours===a&&this.zseg_match.close_parts.minutes===o?e?n.next():i:this.zseg_match.adjacent_child?i:e?n.next():i}return n.previous()},e.Market.prototype.disableSession=function(t,e){var i=!1;if(void 0!==e&&e&&(i=!0),t){for(var n=0;n<this.normalHours.length;n++)this.normalHours[n].name===t&&(this.normalHours[n].enabled=i);for(n=0;n<this.extraHours.length;n++)this.extraHours[n].name===t&&(this.extraHours[n].enabled=i)}},e.Market.prototype.enableSession=function(t){this.disableSession(t,"enable_instead")},e.Market.prototype.getClose=function(t,e,i,n){if(!this.market_def)return null;if(!this.rules)return null;var r=t;if(t||(r=new Date,i=null),r=this._convertToMarketTZ(r,i),void 0!==e){if(this._wasOpenIntraDay(r)&&this.zseg_match.name===e)return r.setHours(this.zseg_match.close_parts.hours,this.zseg_match.close_parts.minutes,0,0),r=this._convertFromMarketTZ(r,n)}else if(this._wasOpenDaily(r)){for(var a=this.zseg_match;a.child_;)a=a.child_;for(;!a.enabled;)a=a.parent_;return r.setHours(a.close_parts.hours,a.close_parts.minutes,0,0),r=this._convertFromMarketTZ(r,n)}return null},e.Market.prototype.getNextClose=function(t,e,i){if(!this.market_def)return null;if(!this.rules)return null;var n=t;if(t||(n=new Date,e=null),n=this._convertToMarketTZ(n,e),!this._wasOpenIntraDay(n)){n=this.newIterator({begin:n,interval:1,inZone:this.market_tz,outZone:this.market_tz}).next()}for(var r=n.getDate(),a=this.zseg_match;a.adjacent_child;)a=a.adjacent_child,r+=1;return n.setDate(r),n.setHours(a.close_parts.hours,a.close_parts.minutes,0,0),n=this._convertFromMarketTZ(n,i)},e.Market.prototype.getNextOpen=function(t,e,i){if(!this.market_def)return null;if(!this.rules)return null;var n=t;return t||(n=new Date,e=null),n=this._convertToMarketTZ(n,e),n=this._find_next_segment(n),this.zseg_match.adjacent_parent?(n=this.getNextOpen(n,this.market_tz,this.market_tz),n=this._convertFromMarketTZ(n,i)):(n.setHours(this.zseg_match.open_parts.hours),n.setMinutes(this.zseg_match.open_parts.minutes),n=this._convertFromMarketTZ(n,i))},e.Market.prototype.getOpen=function(t,e,i,n){if(!this.market_def)return null;if(!this.rules)return null;var r=t;if(t||(r=new Date,i=null),r=this._convertToMarketTZ(r,i),void 0!==e){if(this._wasOpenIntraDay(r)&&this.zseg_match.name==e)return r.setHours(this.zseg_match.open_parts.hours,this.zseg_match.open_parts.minutes,0,0),r=this._convertFromMarketTZ(r,n)}else if(this._wasOpenDaily(r)){for(var a=this.zseg_match;a.parent_;)a=a.parent_;for(;!a.enabled;)a=a.child_;return r.setHours(a.open_parts.hours,a.open_parts.minutes,0,0),r=this._convertFromMarketTZ(r,n)}return null},e.Market.prototype.getPreviousClose=function(t,e,i){if(!this.market_def)return null;if(!this.rules)return null;var n=t;return t||(n=new Date,e=null),n=this._convertToMarketTZ(n,e),n=this._find_prev_segment(n,!1),this.zseg_match.adjacent_child?this.getPreviousClose(n,this.market_tz,this.market_tz):(n.setHours(this.zseg_match.close_parts.hours),n.setMinutes(this.zseg_match.close_parts.minutes),n=this._convertFromMarketTZ(n,i))},e.Market.prototype.getPreviousOpen=function(t,e,i){if(!this.market_def)return null;if(!this.rules)return null;var n=t;return t||(n=new Date,e=null),n=this._convertToMarketTZ(n,e),n=this._find_prev_segment(n,!0),this.zseg_match.adjacent_parent?this.getPreviousOpen(this.market_tz,this.market_tz):(n.setHours(this.zseg_match.open_parts.hours),n.setMinutes(this.zseg_match.open_parts.minutes),n=this._convertFromMarketTZ(n,i))},e.Market.prototype.getSession=function(t,e){return t=this._convertToMarketTZ(t,e),this._wasOpenIntraDay(t)&&this.zseg_match?this.zseg_match.name:null},e.Market.prototype.marketZoneNow=function(){return this._convertToMarketTZ(new Date)},e.Market.prototype.isHourAligned=function(){return this.hour_aligned},e.Market.prototype.isOpen=function(){var t=new Date;return this.market_tz&&(t=new this.tz_lib(t.getTime(),this.market_tz)),this._wasOpenIntraDay(t)},e.Market.prototype.isMarketDay=function(){var t=new Date;return this.market_tz&&(t=new this.tz_lib(t.getTime(),this.market_tz)),this._wasOpenDaily(t)},e.Market.prototype.isMarketDate=function(t){return this._wasOpenDaily(t)},e.Market.prototype.newIterator=function(t){var i=!1;t.periodicity?i=t.periodicity:t.multiple&&(i=t.multiple);var n=t.interval;return n||(n="minute"),"hour"==n&&(n=60),i||(i=1),t.begin||(t.begin=new Date,t.inZone=null),n==parseInt(n,10)&&(n=parseInt(n,10),t.periodicity<1/60?(i=i*n*6e4,n="millisecond"):t.periodicity<1?(i=i*n*60,n="second"):(i*=n,n="minute")),t.timeUnit&&("millisecond"===t.timeUnit?n=t.timeUnit:"second"===t.timeUnit&&(n=t.timeUnit)),t.interval=n,t.multiple=i,t.market=this,new e.Market.Iterator(t)},e.Market.prototype._wasOpenDaily=function(t){return this._was_open(t,!1)},e.Market.prototype._wasOpenIntraDay=function(t){return this._was_open(t,!0)},e.Market.prototype._was_open=function(t,e){if(this.zopen_hour=0,this.zopen_minute=0,this.zclose_hour=0,this.zclose_minute=0,this.zmatch_open=!1,this.zseg_match=null,!this.market_def||!this.rules)return this.zclose_hour=24,!0;var i,n=!1,r=!1,a=t.getFullYear(),o=t.getMonth()+1,s=t.getDay(),l=t.getDate(),h=t.getHours(),c=t.getMinutes(),u=t.getSeconds(),p=60*h*60+60*c+u;void 0===e&&(e=!0);var d;for(d=0;d<this.normalHours.length;d++)if(i=this.normalHours[d],i.enabled&&(n=i.dayofweek===s,n&&e&&(n=p>=i.open&&p<i.close),n)){if(!e&&this.zseg_match&&(i.open_parts.hours>this.zopen_hour||i.open_parts.hours==this.zopen_hour&&i.open_parts.minutes>this.zopen_minute))continue;if(this.zopen_hour=i.open_parts.hours,this.zopen_minute=i.open_parts.minutes,this.zclose_hour=i.close_parts.hours,this.zclose_minute=i.close_parts.minutes,this.zmatch_open=p===i.open,this.zseg_match=i,e)break}for(d=0;d<this.extraHours.length;d++)if(i=this.extraHours[d],i.enabled&&("*"===i.year||a===i.year)&&o===i.month&&l===i.day&&(r=!e&&i.open||p>=i.open&&p<i.close,!r&&this.zseg_match&&(n=!1,this.zopen_hour=0,this.zopen_minute=0,this.zclose_hour=0,this.zclose_minute=0,this.zmatch_open=!1,this.zseg_match=null),r)){if(!e&&this.zseg_match&&(i.open_parts.hours>this.zopen_hour||i.open_parts.hours==this.zopen_hour&&i.open_parts.minutes>this.zopen_minute))continue;if(this.zopen_hour=i.open_parts.hours,this.zopen_minute=i.open_parts.minutes,this.zclose_hour=i.close_parts.hours,this.zclose_minute=i.close_parts.minutes,this.zmatch_open=p===i.open,this.zseg_match=i,e)break}return this.zseg_match},e.Market.prototype._wasClosed=function(t){return!this._was_open(t,!0)},e.Market.prototype._wasOpen=function(t){return this._was_open(t,!0)},e.Market.prototype._tzDifferenceMillis=function(t,e,i){var n=t,r=t;return 60*(n.getTimezoneOffset()-r.getTimezoneOffset())*1e3},e.Market._createTimeSegments=function(t){for(var e,i=0;i<t.rules.length;i++){var r=JSON.parse(JSON.stringify(t.rules[i]));void 0===r.open&&void 0===r.close&&(r.open="00:00",r.close="00:00"),r.hasOwnProperty("name")||(r.name="");try{var a;if(void 0!==r.dayofweek?(r.year="*",a=n._createDayOfWeekSegment(t,r),e&&(e.dayofweek===a.dayofweek?(e.child_=a,a.parent_=e):function(t,i){if(24===t.close_parts.hours&&0===i.open_parts.hours&&0===i.open_parts.minutes){if(e.dayofweek===a.dayofweek-1)return!0;if(6===e.dayofweek&&0===a.dayofweek)return!0}return!1}(e,a)&&(e.adjacent_child=a,a.adjacent_parent=e)),e=a):void 0!==r.date?(r.isDayOfWeek=!1,r.dayofweek=-1,a=n._createDateTimeSegment(t,r)):console.log("Error, unknown rule type "+r),t.enabled_by_default)for(var o=0;o<t.enabled_by_default.length;o++){var s=t.enabled_by_default[o];if(a.name===s){a.enabled=!0;break}}}catch(t){console.log("Error, creating market rules "+t)}}},e.Market._timeSegment={};var n=e.Market._timeSegment;n.re_wild_card_iso=/^(\*)-(\d\d)-(\d\d)$/,n.re_regular_iso=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,n.re_split_hours_minutes=/^(\d\d):(\d\d)$/,n.re_split_hour_minutes=/^(\d):(\d\d)$/,n._hashCode=function(t){var e,i,n,r=0;if(0===t.length)return r;for(e=0,n=t.length;e<n;e++)i=t.charCodeAt(e),r=(r<<5)-r+i,r|=0;return r},n._splitHoursMinutes=function(t){var e=n.re_split_hour_minutes.exec(t),i={hours:NaN,minutes:NaN};return null===e&&null===(e=n.re_split_hours_minutes.exec(t))?i:(i.hours=parseInt(e[1],10),i.minutes=parseInt(e[2],10),i)},n._createDayOfWeekSegment=function(t,e){var i={name:e.name,isDayOfWeek:!0,dayofweek:e.dayofweek,date_str:"*",open_parts:n._splitHoursMinutes(e.open),close_parts:n._splitHoursMinutes(e.close),open:n._secSinceMidnight(t,e.open,!0),close:n._secSinceMidnight(t,e.close,!1),child_:!1,parent_:!1,adjacent_child:!1,adjacent_parent:!1,enabled:!1};return""===i.name&&(i.enabled=!0),i.hash_code=this._hashCode((i.open+i.close).toString()),t.normalHours.push(i),i},n._createDateTimeSegment=function(t,e){var i,r=this.re_regular_iso.exec(e.date);if(null===r){if(null===(r=this.re_wild_card_iso.exec(e.date)))return void console.log("Warning: invalid date format on rule -> "+e.date);i="*"}else i=parseInt(r[1],10);var a={name:e.name,isDayOfWeek:!1,dayofweek:-1,year:i,month:parseInt(r[2],10),day:parseInt(r[3],10),date_str:e.date,open_parts:n._splitHoursMinutes(e.open),close_parts:n._splitHoursMinutes(e.close),open:n._secSinceMidnight(t,e.open,!0),close:n._secSinceMidnight(t,e.close,!1),enabled:!1};return""===a.name&&(a.enabled=!0),a.hash_key=this._hashCode(a.date_str+a.open+a.close),t.extraHours.push(a),a},n._secSinceMidnight=function(t,e,i){var n=e.split(":"),r=parseInt(n[0],10),a=parseInt(n[1],10),o=60*r*60+60*a;return i||24===r&&(o=60*r*60+1),o},e.Market.prototype._convertToMarketTZ=function(t,e){if(!this.market_tz)return t;var i;return i=e?new this.tz_lib(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds(),e):new this.tz_lib(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),i.setTimezone&&i.setTimezone(this.market_tz),new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds())},e.Market.prototype._convertFromMarketTZ=function(t,e){if(!this.market_tz)return t;var i=new this.tz_lib(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds(),this.market_tz);return e?(i.setTimezone&&i.setTimezone(e),new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds())):new Date(i.getTime())},e.Market.Iterator=function(t){this.market=t.market,this.begin=t.begin,this.interval=t.interval,this.multiple=t.multiple,this.inZone=t.inZone,this.outZone=t.outZone,this.clock=new e.Market.Iterator._Clock(t.market,t.interval,t.multiple),this.intraDay=this.clock.intra_day,this.intraDay&&(this.begin=this.market._convertToMarketTZ(this.begin,t.inZone)),this.clock._setStart(this.begin),this.clock.minutes_aligned=!1},e.Market.Iterator.prototype.date=function(){return this.clock._date()},e.Market.Iterator.prototype.futureTick=function(t){this.clock.skip=1;var e,i=0;e=this.intraDay?this.market._convertToMarketTZ(t.end,this.inZone).getTime():t.end.getTime();var n=this.clock.ctime;if(e===n)return i;var r=2,a=0;t.sample_size&&(r=t.sample_size);var o,s=(new Date).getTime();if(e>n){for(this.clock.forward=!0;this.clock.ctime<e;)if(i+=1,a+=1,this.clock._findNext(),1e3===a&&(a=0,(new Date).getTime()-s>=r)){o=(this.clock.ctime-n)/i,i=Math.floor((e-n)/o);break}this.clock.ctime>e&&i--}else for(this.clock.forward=!1;this.clock.ctime>e;)if(i+=1,a+=1,this.clock._findPrevious(),1e3===a&&(a=0,(new Date).getTime()-s>=r)){o=(n-this.clock.ctime)/i,i=Math.floor((n-e)/o);break}return i},e.Market.Iterator.prototype.isHourAligned=function(){return!this.intraDay||this.market.isHourAligned()},e.Market.Iterator.prototype.isOpen=function(){return this.market.isOpen()},e.Market.Iterator.prototype.next=function(t){this.clock.skip=1,t&&(this.clock.skip=t),this.clock.forward=!0;for(var e=0;e<this.clock.skip;e++)this.begin=this.clock._findNext();return this.intraDay||this.market.convertOnDaily?this.market._convertFromMarketTZ(this.clock.display_date,this.outZone):this.clock.display_date},e.Market.Iterator.prototype.peek=function(){return this.clock._peek()},e.Market.Iterator.prototype.previous=function(t){this.clock.skip=1,t&&(this.clock.skip=t),this.clock.forward=!1;for(var e=0;e<this.clock.skip;e++)this.begin=this.clock._findPrevious();return this.intraDay||this.market.convertOnDaily?this.market._convertFromMarketTZ(this.clock.display_date,this.outZone):this.clock.display_date},e.Market.Iterator._Clock=function(t,e,i){i%60==0&&"second"===e&&(e="minute",i/=60),this.market=t,this.interval=e,this.multiple=i,this.intra_day=!1,this.intervals=[],this.max_iters=10080;var n=864e5,r=this._dayImpl;"millisecond"===e?(r=this._millisImpl,n=1):"second"===e?(r=this._secondImpl,n=1e3):"minute"===e?(r=this._minuteImpl,n=6e4):"hour"===e?(r=this._hourImpl,n=36e5):"day"===e?(r=this._dayImpl,n=864e5):"week"===e?(r=this._weekImpl,n=6048e5):"month"===e?(r=this._monthImpl,n=2592e6):console.log('Periodicity ERROR: "'+e+'" is not a valid interval. Please see setPeriodicity() for details.'),this.tick_time=n*i,this.intra_day=this.tick_time<864e5,this._findPrevious=this._findNext=r};var r=e.Market.Iterator._Clock.prototype;return r._total_minutes=function(t,e,i,n){return 60*(i-t)-e+n},r._alignMinutes=function(){if(void 0===this.market.zopen_minute)return[];var t=this.market.zopen_minute;this.market.isHourAligned()&&this.multiple%60==0&&(t=0);for(var e=this._total_minutes(this.market.zopen_hour,t,this.market.zclose_hour,this.market.zclose_minute),i=[],n=0;n<e;)i.push(t+n),n+=this.multiple;return i},r._alignBaseZero=function(t){for(var e=0,i=[e];;){if((e+=this.multiple)>=t)break;i.push(e)}return i},r._date=function(){var t=Math.round(this.ctime),e=new Date(t);return this.intra_day?this.display_date=new Date(t+this.shift_millis):this.display_date=e,e},r._alignToBoundary=function(t,e){for(var i=0,n=0,r=e,a=0;a<t.length-1&&(i=t[a],n=t[a+1],e!==i&&e!==n);a++){if(e>i&&e<n){r=i;break}a+1===t.length-1&&(r=n)}return r},r._peek=function(){return this._date().toString()},r._seekHr=function(){this.forward?this.ctime-=36e5:this.ctime+=36e5},r._setStart=function(t){var e=this.market._tzDifferenceMillis(t),i=new Date(t.getTime()+e);this.shift_millis=e,this.ctime=i.getTime(),this.shift_millis=0,this.ctime=t.getTime()},r._tickTock=function(){this.forward?this.ctime+=this.tick_time:this.ctime-=this.tick_time},r._tockTick=function(){this.forward?this.ctime-=this.tick_time:this.ctime+=this.tick_time},r._tickTock24=function(){this.ctime+=864e5},r._tockTick24=function(){this.ctime-=864e5},r._windMaybe=function(t,e){for(var i=0,n=new Date(this.ctime),r=!1;!t.call(this.market,n);)if(e.call(this),r=!0,n=new Date(this.ctime),(i+=1)>this.max_iters){var a="Warning! max iterations ("+this.max_iters;a+=") reached with no rule match.",console.log(a);break}return r},r._millisImpl=function(){var t=!1;if(!this.mperiods_aligned){var e=this._alignBaseZero(1e3),i=new Date(this.ctime),n=i.getMilliseconds();n=this._alignToBoundary(e,n),i.setMilliseconds(0),this.ctime=i.getTime()+n,this.mperiods_aligned=!0,t=!0}var r=this._date().getMinutes();this._tickTock();var a=this._date().getMinutes();if((t||r!=a)&&!this.market._wasOpenIntraDay(this._date())){var o=this.tick_time;this.tick_time=6e4;var s=this.multiple;this.multiple=1,this._minuteImpl(),this.tick_time=o,this.multiple=s}return this._date()},r._secondImpl=function(){var t=!1;if(!this.speriod_aligned){var e=this._alignBaseZero(60),i=new Date(this.ctime),n=i.getSeconds();n=this._alignToBoundary(e,n),i.setSeconds(n),i.setMilliseconds(0),this.ctime=i.getTime(),this.speriod_aligned=!0,t=!0}var r=this._date().getMinutes();this._tickTock();var a=this._date().getMinutes();if((t||r!=a)&&!this.market._wasOpenIntraDay(this._date())){var o=this.tick_time;this.tick_time=6e4;var s=this.multiple;this.multiple=1,this._minuteImpl(),this.tick_time=o,this.multiple=s}return this._date()},r._minuteImpl=function(){var t=this._windMaybe(this.market._wasOpenIntraDay,this._tockTick),e=new Date(this.ctime),i=e.getTimezoneOffset(),n=e.getMinutes(),r=e.getHours(),a=this._alignMinutes(),o=this._total_minutes(this.market.zopen_hour,this.market.zopen_minute,r,n)+this.market.zopen_minute;o=t?this.forward?a[a.length-1]:a[0]:this._alignToBoundary(a,o),r=Math.floor(o/60)+this.market.zopen_hour,e.setHours(r,o%60,0,0);var s=e.getTimezoneOffset()-i;(this.forward&&s<0||!this.forward&&s>0)&&e.setTime(e.getTime()-6e4*s),this.ctime=e.getTime(),this._tickTock();var l=this.market.zseg_match,h=this.market.hour_aligned&&this.multiple%60==0;if(this._windMaybe(this.market._wasOpenIntraDay,this._tickTock)||!h&&l!=this.market.zseg_match){if(e=new Date(this.ctime),this.forward)e.setMinutes(this.market.zopen_minute),e.setHours(this.market.zopen_hour);else{a=this._alignMinutes();var c=a[a.length-1];e.setMinutes(c%60),e.setHours(Math.floor(c/60)+this.market.zopen_hour)}this.ctime=e.getTime()}return this._date()},r._hourImpl=function(){this._windMaybe(this.market._wasOpenIntraDay,this._tockTick);var t=new Date(this.ctime);this.market.isHourAligned()?t.setMinutes(0):t.setMinutes(this.market.zopen_minute),t.setSeconds(0),t.setMilliseconds(0),this.ctime=t.getTime(),this._tickTock();var e=this.market.zseg_match;if(this._windMaybe(this.market._wasOpenIntraDay,this._tickTock)||!this.market.hour_aligned&&e!=this.market.zseg_match){if(current_date=new Date(this.ctime),this.forward)current_date.setMinutes(this.market.zopen_minute),current_date.setHours(this.market.zopen_hour);else{periods=this._alignMinutes();var i=periods[periods.length-1];current_date.setMinutes(i%60),current_date.setHours(Math.floor(i/60)+this.market.zopen_hour)}this.ctime=current_date.getTime()}return this._date()},r._dayImpl=function(){this._windMaybe(this.market._wasOpenDaily,this._seekHr);var t=new Date(this.ctime);t.setHours(12,0,0,0),this.ctime=t.getTime();for(var e=0;e<this.multiple;)this.forward?this._tickTock24():this._tockTick24(),this.market._wasOpenDaily(this._date())&&(e+=1);return t=new Date(this.ctime),t.setHours(0),this.ctime=t.getTime(),this._date()},r._weekImpl=function(){var t=new Date(this.ctime);for(t.setHours(12),this.ctime=t.getTime(),this._tickTock(),t=new Date(this.ctime);0!==t.getDay();)this._tockTick24(),t=new Date(this.ctime);return this._windMaybe(this.market._wasOpenDaily,this._tickTock24),t=new Date(this.ctime),t.setHours(0,0,0,0),this.ctime=t.getTime(),this._date()},r._monthImpl=function(){var t=new Date(this.ctime);return t.setDate(15),this.ctime=t.getTime(),this._tickTock(),t=new Date(this.ctime),t.setDate(1),t.setHours(12),this.ctime=t.getTime(),this._windMaybe(this.market._wasOpenDaily,this._tickTock24),t=new Date(this.ctime),t.setHours(0,0,0,0),this.ctime=t.getTime(),this._date()},r._findNext=null,r._findPrevious=null,t},__polyfills_=function(){Math.easeInOutQuad=function(t,e,i,n){return(t/=n/2)<1?i/2*t*t+e:(t--,-i/2*(t*(t-2)-1)+e)},Math.easeInOutCubic=function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t+e:(t-=2,i/2*(t*t*t+2)+e)}},__timezone_=function __timezone_(_exports){var CIQ=_exports.CIQ;return CIQ.timeZoneMap={"(UTC-11:00) American Samoa, Midway Island":"Pacific/Pago_Pago","(UTC-10:00) Hawaii":"Pacific/Honolulu","(UTC-09:00) Alaska":"America/Juneau","(UTC-08:00) Pacific Time (US and Canada)":"America/Los_Angeles","(UTC-08:00) Tijuana":"America/Tijuana","(UTC-07:00) Arizona":"America/Phoenix","(UTC-07:00) Chihuahua, Mazatlan":"America/Chihuahua","(UTC-07:00) Mountain Time (US and Canada)":"America/Denver","(UTC-06:00) Central America":"America/Costa_Rica","(UTC-06:00) Central Time (US and Canada)":"America/Chicago","(UTC-06:00) Guadalajara, Mexico City, Monterrey":"America/Mexico_City","(UTC-06:00) Saskatchewan":"America/Regina","(UTC-05:00) Bogota, Lima, Quito, Rio Branco":"America/Bogota","(UTC-05:00) Eastern Time (US and Canada)":"America/New_York","(UTC-05:00) Indiana (East)":"America/Indiana/Indianapolis","(UTC-04:00) Asuncion":"America/Asuncion","(UTC-04:00) Santiago":"America/Santiago","(UTC-04:00) Caracas":"America/Caracas","(UTC-04:00) Atlantic Time (Canada)":"America/Halifax","(UTC-04:00) Georgetown, La Paz, Manaus, San Juan":"America/Puerto_Rico","(UTC-03:30) Newfoundland and Labrador":"America/St_Johns","(UTC-03:00) Buenos Aires":"America/Argentina/Buenos_Aires","(UTC-03:00) Punta Arenas":"America/Punta_Arenas","(UTC-03:00) Montevideo":"America/Montevideo","(UTC-03:00) Sao Paulo":"America/Sao_Paulo","(UTC-02:00) Mid-Atlantic":"Atlantic/South_Georgia","(UTC-01:00) Azores":"Atlantic/Azores","(UTC-01:00) Cape Verde Islands":"Atlantic/Cape_Verde","(UTC) Greenwich Mean Time, Reykjavik":"UTC","(UTC) Casablanca":"Africa/Casablanca","(UTC) Dublin, Lisbon, London":"Europe/London","(UTC+01:00) Algiers, Tunis":"Africa/Tunis","(UTC+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna":"Europe/Amsterdam","(UTC+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague":"Europe/Belgrade","(UTC+01:00) Brussels, Copenhagen, Madrid, Paris":"Europe/Brussels","(UTC+01:00) Sarajevo, Skopje, Warsaw, Zagreb":"Europe/Sarajevo","(UTC+02:00) Kaliningrad":"Europe/Kaliningrad","(UTC+02:00) Athens, Bucharest":"Europe/Bucharest","(UTC+02:00) Cairo":"Africa/Cairo","(UTC+02:00) Harare, Johannesburg":"Africa/Johannesburg","(UTC+02:00) Helsinki, Kiev, Riga, Sofia, Tallinn, Vilnius":"Europe/Helsinki","(UTC+02:00) Cyprus":"Asia/Nicosia","(UTC+02:00) Jerusalem":"Asia/Jerusalem","(UTC+03:00) Istanbul":"Europe/Istanbul","(UTC+03:00) Baghdad, Kuwait, Qatar, Riyadh":"Asia/Riyadh","(UTC+03:00) Minsk, Moscow, Kirov, Volgograd":"Europe/Moscow","(UTC+03:00) Simferopol":"Europe/Simferopol","(UTC+03:00) Nairobi":"Africa/Nairobi","(UTC+03:30) Tehran":"Asia/Tehran","(UTC+04:00) Baku":"Asia/Baku","(UTC+04:00) Dubai, Muscat":"Asia/Dubai","(UTC+04:00) Astrakhan, Samara, Saratov, Ulyanovsk":"Europe/Samara","(UTC+04:30) Kabul":"Asia/Kabul","(UTC+05:00) Karachi, Tashkent":"Asia/Karachi","(UTC+05:00) Yekaterinburg":"Asia/Yekaterinburg","(UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi":"Asia/Kolkata","(UTC+05:45) Kathmandu":"Asia/Kathmandu","(UTC+06:00) Almaty":"Asia/Almaty","(UTC+06:00) Omsk":"Asia/Omsk","(UTC+06:00) Astana, Dhaka":"Asia/Dhaka","(UTC+06:30) Yangon":"Asia/Yangon","(UTC+07:00) Bangkok, Jakarta, Vietnam":"Asia/Bangkok","(UTC+07:00) Hovd":"Asia/Hovd","(UTC+07:00) Krasnoyarsk":"Asia/Krasnoyarsk","(UTC+07:00) Novokuznetsk":"Asia/Novokuznetsk","(UTC+07:00) Barnaul, Novosibirsk, Tomsk":"Asia/Novosibirsk","(UTC+08:00) Beijing, Chongqing, Hong Kong SAR":"Asia/Hong_Kong","(UTC+08:00) Brunei, Kuala Lumpur, Singapore":"Asia/Kuala_Lumpur","(UTC+08:00) Irkutsk":"Asia/Irkutsk","(UTC+08:00) Choibalsan, Ulaanbaatar":"Asia/Ulaanbaatar","(UTC+08:00) Manila, Taipei":"Asia/Taipei","(UTC+08:00) Perth":"Australia/Perth","(UTC+08:30) Pyongyang":"Asia/Pyongyang","(UTC+08:45) Eucla":"Australia/Eucla","(UTC+09:00) Osaka, Sapporo, Tokyo":"Asia/Tokyo","(UTC+09:00) Seoul":"Asia/Seoul","(UTC+09:00) Chita, Khandyga, Yakutsk":"Asia/Yakutsk","(UTC+09:30) Adelaide":"Australia/Adelaide","(UTC+09:30) Darwin":"Australia/Darwin","(UTC+10:00) Brisbane":"Australia/Brisbane","(UTC+10:00) Canberra, Melbourne, Sydney":"Australia/Sydney","(UTC+10:00) Guam, Port Moresby":"Pacific/Guam","(UTC+10:00) Ust-Nera, Vladivostok":"Asia/Vladivostok","(UTC+11:00) Noumea, Solomon Islands":"Pacific/Noumea","(UTC+11:00) Magadan":"Asia/Magadan","(UTC+11:00) Sakhalin, Srednekolymsk":"Asia/Srednekolymsk","(UTC+12:00) Anadyr, Kamchatka":"Asia/Kamchatka","(UTC+12:00) Auckland, Wellington":"Pacific/Auckland","(UTC+12:45) Chatham":"Pacific/Chatham","(UTC+13:00) Tonga":"Pacific/Tongatapu","(UTC+13:00) Samoa":"Pacific/Apia","(UTC+14:00) Kiritimati":"Pacific/Kiritimati"},function(){"use strict";var root=this,timezoneJS={};_exports.timezoneJS=timezoneJS,timezoneJS.VERSION="0.4.11";for(var ajax_lib=root.$||root.jQuery||root.Zepto,fleegix=root.fleegix,DAYS=timezoneJS.Days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],MONTHS=timezoneJS.Months=["January","February","March","April","May","June","July","August","September","October","November","December"],SHORT_MONTHS={},SHORT_DAYS={},EXACT_DATE_TIME={},i=0;i<MONTHS.length;i++)SHORT_MONTHS[MONTHS[i].substr(0,3)]=i;for(i=0;i<DAYS.length;i++)SHORT_DAYS[DAYS[i].substr(0,3)]=i;var _arrIndexOf=Array.prototype.indexOf||function(t){if(null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if(0===i)return-1;var n=0;if(arguments.length>1&&(n=Number(arguments[1]),n!=n?n=0:0!==n&&n!==1/0&&n!==-1/0&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=i)return-1;for(var r=n>=0?n:Math.max(i-Math.abs(n),0);r<i;r++)if(r in e&&e[r]===t)return r;return-1},_fixWidth=function(t,e){if("number"!=typeof t)throw"not a number: "+t;var i=t>1e3,n=t.toString(),r=n.length;if(i&&r>e)return n.substr(r-e,r);for(n=[n];r<e;)n.unshift("0"),r++;return n.join("")},_transport=function(t){if(t){if(!t.url)throw new Error("URL must be specified");if("async"in t||(t.async=!0),!(fleegix&&void 0!==fleegix.xhr||ajax_lib&&void 0!==ajax_lib.ajax))throw new Error("Please use the Fleegix.js XHR module, jQuery ajax, Zepto ajax, or define your own transport mechanism for downloading zone files.");return t.async?fleegix&&fleegix.xhr?fleegix.xhr.send({url:t.url,method:"get",handleSuccess:t.success,handleErr:t.error}):ajax_lib.ajax({url:t.url,dataType:"text",method:"GET",error:t.error,success:t.success}):fleegix&&fleegix.xhr?fleegix.xhr.doReq({url:t.url,async:!1}):ajax_lib.ajax({url:t.url,async:!1,dataType:"text"}).responseText}};timezoneJS.ruleCache={},timezoneJS.Date=function(){if(this===timezoneJS)throw"timezoneJS.Date object must be constructed with 'new'";var t=Array.prototype.slice.apply(arguments),e=null,i=null,n=[],r=!1;"[object Array]"===Object.prototype.toString.call(t[0])&&(t=t[0]),"string"==typeof t[t.length-1]&&(r=Date.parse(t[t.length-1].replace(/GMT[+-]\d+/,"")),(isNaN(r)||null===r)&&(i=t.pop()));var a=!1;switch(t.length){case 0:e=new Date;break;case 1:e=new Date(t[0]),"string"==typeof t[0]&&-1==t[0].search(/[+-][0-9]{4}/)&&-1==t[0].search(/Z/)&&-1==t[0].search(/T/)&&(a=!0);break;case 2:e=new Date(t[0],t[1]),a=!0;break;default:for(var o=0;o<7;o++)n[o]=t[o]||0;e=new Date(n[0],n[1],n[2],n[3],n[4],n[5],n[6]),a=!0}if(isNaN(e.getTime()))throw new Error("Invalid date");this._useCache=!1,this._tzInfo={},this._day=0,this.year=0,this.month=0,this.date=0,this.hours=0,this.minutes=0,this.seconds=0,this.milliseconds=0,this.timezone=i||null,a?this.setFromDateObjProxy(e):this.setFromTimeProxy(e.getTime(),i)},timezoneJS.Date.prototype={getDate:function(){return this.date},getDay:function(){return this._day},getFullYear:function(){return this.year},getMonth:function(){return this.month},getYear:function(){return this.year-1900},getHours:function(){return this.hours},getMilliseconds:function(){return this.milliseconds},getMinutes:function(){return this.minutes},getSeconds:function(){return this.seconds},getUTCDate:function(){return this.getUTCDateProxy().getUTCDate()},getUTCDay:function(){return this.getUTCDateProxy().getUTCDay()},getUTCFullYear:function(){return this.getUTCDateProxy().getUTCFullYear()},getUTCHours:function(){return this.getUTCDateProxy().getUTCHours()},getUTCMilliseconds:function(){return this.getUTCDateProxy().getUTCMilliseconds()},getUTCMinutes:function(){return this.getUTCDateProxy().getUTCMinutes()},getUTCMonth:function(){return this.getUTCDateProxy().getUTCMonth()},getUTCSeconds:function(){return this.getUTCDateProxy().getUTCSeconds()},getTime:function(){return this._timeProxy+60*this.getTimezoneOffset()*1e3},getTimezone:function(){return this.timezone},getTimezoneOffset:function(){return this.getTimezoneInfo().tzOffset},getTimezoneAbbreviation:function(){return this.getTimezoneInfo().tzAbbr},getTimezoneInfo:function(){if(this._useCache)return this._tzInfo;var t;return t=this.timezone?"Etc/UTC"===this.timezone||"Etc/GMT"===this.timezone?{tzOffset:0,tzAbbr:"UTC"}:timezoneJS.timezone.getTzInfo(this._timeProxy,this.timezone):{tzOffset:this.getLocalOffset(),tzAbbr:null},this._tzInfo=t,this._useCache=!0,t},getUTCDateProxy:function(){var t=new Date(this._timeProxy);return t.setUTCMinutes(t.getUTCMinutes()+this.getTimezoneOffset()),t},setDate:function(t){return this.setAttribute("date",t),this.getTime()},setFullYear:function(t,e,i){return void 0!==i&&this.setAttribute("date",1),this.setAttribute("year",t),void 0!==e&&this.setAttribute("month",e),void 0!==i&&this.setAttribute("date",i),this.getTime()},setMonth:function(t,e){return this.setAttribute("month",t),void 0!==e&&this.setAttribute("date",e),this.getTime()},setYear:function(t){return t=Number(t),0<=t&&t<=99&&(t+=1900),this.setUTCAttribute("year",t),this.getTime()},setHours:function(t,e,i,n){return this.setAttribute("hours",t),void 0!==e&&this.setAttribute("minutes",e),void 0!==i&&this.setAttribute("seconds",i),void 0!==n&&this.setAttribute("milliseconds",n),this.getTime()},setMinutes:function(t,e,i){return this.setAttribute("minutes",t),void 0!==e&&this.setAttribute("seconds",e),void 0!==i&&this.setAttribute("milliseconds",i),this.getTime()},setSeconds:function(t,e){return this.setAttribute("seconds",t),void 0!==e&&this.setAttribute("milliseconds",e),this.getTime()},setMilliseconds:function(t){return this.setAttribute("milliseconds",t),this.getTime()},setTime:function(t){if(isNaN(t))throw new Error("Units must be a number.");return this.setFromTimeProxy(t,this.timezone),this.getTime()},setUTCFullYear:function(t,e,i){return void 0!==i&&this.setUTCAttribute("date",1),this.setUTCAttribute("year",t),void 0!==e&&this.setUTCAttribute("month",e),void 0!==i&&this.setUTCAttribute("date",i),this.getTime()},setUTCMonth:function(t,e){return this.setUTCAttribute("month",t),void 0!==e&&this.setUTCAttribute("date",e),this.getTime()},setUTCDate:function(t){return this.setUTCAttribute("date",t),this.getTime()},setUTCHours:function(t,e,i,n){return this.setUTCAttribute("hours",t),void 0!==e&&this.setUTCAttribute("minutes",e),void 0!==i&&this.setUTCAttribute("seconds",i),void 0!==n&&this.setUTCAttribute("milliseconds",n),this.getTime()},setUTCMinutes:function(t,e,i){return this.setUTCAttribute("minutes",t),void 0!==e&&this.setUTCAttribute("seconds",e),void 0!==i&&this.setUTCAttribute("milliseconds",i),this.getTime()},setUTCSeconds:function(t,e){return this.setUTCAttribute("seconds",t),void 0!==e&&this.setUTCAttribute("milliseconds",e),this.getTime()},setUTCMilliseconds:function(t){return this.setUTCAttribute("milliseconds",t),this.getTime()},setFromDateObjProxy:function(t){this.year=t.getFullYear(),this.month=t.getMonth(),this.date=t.getDate(),this.hours=t.getHours(),this.minutes=t.getMinutes(),this.seconds=t.getSeconds(),this.milliseconds=t.getMilliseconds(),this._day=t.getDay(),this._dateProxy=t,this._timeProxy=Date.UTC(this.year,this.month,this.date,this.hours,this.minutes,this.seconds,this.milliseconds),this._useCache=!1},setFromTimeProxy:function(t,e){var i=new Date(t),n=e?timezoneJS.timezone.getTzInfo(t,e,!0).tzOffset:i.getTimezoneOffset();i.setTime(t+6e4*(i.getTimezoneOffset()-n)),this.setFromDateObjProxy(i)},setAttribute:function(t,e){if(isNaN(e))throw new Error("Units must be a number.");var i=this._dateProxy;i["set"+("year"===t?"FullYear":t.substr(0,1).toUpperCase()+t.substr(1))](e),this.setFromDateObjProxy(i)},setUTCAttribute:function(t,e){if(isNaN(e))throw new Error("Units must be a number.");var i="year"===t?"FullYear":t.substr(0,1).toUpperCase()+t.substr(1),n=this.getUTCDateProxy();n["setUTC"+i](e),n.setUTCMinutes(n.getUTCMinutes()-this.getTimezoneOffset()),this.setFromTimeProxy(n.getTime()+6e4*this.getTimezoneOffset(),this.timezone)},setTimezone:function(t){var e=this.getTimezoneInfo().tzOffset;this.timezone=t,this._useCache=!1,this.setUTCMinutes(this.getUTCMinutes()-this.getTimezoneInfo().tzOffset+e)},removeTimezone:function(){this.timezone=null,this._useCache=!1},valueOf:function(){return this.getTime()},clone:function(){return this.timezone?new timezoneJS.Date(this.getTime(),this.timezone):new timezoneJS.Date(this.getTime())},toGMTString:function(){return this.toString("EEE, dd MMM yyyy HH:mm:ss Z","Etc/GMT")},toLocaleStringIntl:function(){},toLocaleDateString:function(){},toLocaleTimeString:function(){},toSource:function(){},toISOString:function(){return this.toString("yyyy-MM-ddTHH:mm:ss.SSS","Etc/UTC")+"Z"},toJSON:function(){return this.toISOString()},toDateString:function(){return this.toString("EEE MMM dd yyyy")},toTimeString:function(){return this.toString("H:mm k")},toString:function(t,e){t||(t="yyyy-MM-ddTHH:mm:ss.SSS");var i=t,n=e?timezoneJS.timezone.getTzInfo(this.getTime(),e):this.getTimezoneInfo(),r=this;e&&(r=this.clone(),r.setTimezone(e));var a=r.getHours();return i.replace(/a+/g,function(){return"k"}).replace(/y+/g,function(t){return _fixWidth(r.getFullYear(),t.length)}).replace(/d+/g,function(t){return _fixWidth(r.getDate(),t.length)}).replace(/m+/g,function(t){return _fixWidth(r.getMinutes(),t.length)}).replace(/s+/g,function(t){return _fixWidth(r.getSeconds(),t.length)}).replace(/S+/g,function(t){return _fixWidth(r.getMilliseconds(),t.length)}).replace(/h+/g,function(t){return _fixWidth(a%12==0?12:a%12,t.length)}).replace(/M+/g,function(t){var e=r.getMonth(),i=t.length;return i>3?timezoneJS.Months[e]:i>2?timezoneJS.Months[e].substring(0,i):_fixWidth(e+1,i)}).replace(/k+/g,function(){return a>=12?(a>12&&(a-=12),"PM"):"AM"}).replace(/H+/g,function(t){return _fixWidth(a,t.length)}).replace(/E+/g,function(t){return DAYS[r.getDay()].substring(0,t.length)}).replace(/Z+/gi,function(){return n.tzAbbr})},toUTCString:function(){return this.toGMTString()},civilToJulianDayNumber:function(t,e,i){var n;e++,e>12&&(n=parseInt(e/12,10),e%=12,t+=n),e<=2&&(t-=1,e+=12),n=Math.floor(t/100);var r=2-n+Math.floor(n/4);return Math.floor(365.25*(t+4716))+Math.floor(30.6001*(e+1))+i+r-1524},getLocalOffset:function(){return this._dateProxy.getTimezoneOffset()}},timezoneJS.timezone=new function(){function invalidTZError(t){throw new Error("Timezone '"+t+"' is either incorrect, or not loaded in the timezone registry.")}function builtInLoadZoneFile(t,e){var i=_this.zoneFileBasePath+"/"+t;return e&&e.async?_this.transport({async:!0,url:i,success:function(t){return _this.parseZones(t)&&"function"==typeof e.callback&&e.callback()},error:function(){throw new Error("Error retrieving '"+i+"' zoneinfo files")}}):_this.parseZones(_this.transport({url:i,async:!1}))}function getRegionForTimezone(t){var e,i,n=regionExceptions[t];if(n)return n;if(e=t.split("/")[0],i=regionMap[e])return i;var r=_this.zones[t];return"string"==typeof r?getRegionForTimezone(r):_this.loadedZones.backward?void invalidTZError(t):(_this.loadZoneFile("backward"),getRegionForTimezone(t))}function parseTimeString(t){var e=/(\d+)(?::0*(\d*))?(?::0*(\d*))?([wsugz])?$/,i=t.match(e);return i[1]=parseInt(i[1],10),i[2]=i[2]?parseInt(i[2],10):0,i[3]=i[3]?parseInt(i[3],10):0,i.slice(1,5)}function processZone(t){if(t[3]){var e=parseInt(t[3],10),i=11,n=31;t[4]&&(i=SHORT_MONTHS[t[4].substr(0,3)],n=parseInt(t[5],10)||1);var r=t[6]?parseTimeString(t[6]):[0,0,0];return[e,i,n,r[0],r[1],r[2]]}}function getZone(t,e){for(var i="number"==typeof t?t:new Date(+t).getTime(),n=e,r=_this.zones[n];"string"==typeof r;)n=r,r=_this.zones[n];if(!r){if(!_this.loadedZones.backward)return _this.loadZoneFile("backward"),getZone(t,e);if(n&&n!==e)return _this.lazyLoadZoneFiles(n),getZone(t,n);invalidTZError(n)}if(0===r.length)throw new Error("No Zone found for '"+e+"' on "+t);for(var a=r.length-1;a>=0;a--){var o=r[a];if(o[3]&&i>o[3])break}return r[a+1]}function getBasicOffset(t){var e=parseTimeString(t);return(e=("-"===t.charAt(0)?-1:1)*(1e3*(60*(60*e[0]+e[1])+e[2])))/60/1e3}function getAdjustedOffset(t,e){return-Math.ceil(e-t)}function getRule(t,e,i,n){var r="number"==typeof t?new Date(t):t,a=e[1],o=e[0],s=a.match(/^([0-9]):([0-9][0-9])$/);if(s)return[-1e6,"max","-","Jan",1,[0,0,0],60*parseInt(s[1],10)+parseInt(s[2],10),"-"];var l,h=function(t,e,i){var n=0;if("u"===e||"g"===e||"z"===e)n=0;else if("s"===e)n=o;else{if("w"!==e&&e)throw new Error("unknown type "+e);n=getAdjustedOffset(o,i[6])}return n*=6e4,new Date(t.getTime()+n)},c=function(t,e){var i,n=t[0],r=t[1],a=r[5];if(EXACT_DATE_TIME[n]||(EXACT_DATE_TIME[n]={}),EXACT_DATE_TIME[n][r])i=EXACT_DATE_TIME[n][r];else{if(isNaN(r[4])){var o,s;"last"===r[4].substr(0,4)?(i=new Date(Date.UTC(n,SHORT_MONTHS[r[3]]+1,1,a[0]-24,a[1],a[2],0)),o=SHORT_DAYS[r[4].substr(4,3)],s="<="):(i=new Date(Date.UTC(n,SHORT_MONTHS[r[3]],r[4].substr(5),a[0],a[1],a[2],0)),o=SHORT_DAYS[r[4].substr(0,3)],s=r[4].substr(3,2));var l=i.getUTCDay();">="===s?i.setUTCDate(i.getUTCDate()+(o-l+(o<l?7:0))):i.setUTCDate(i.getUTCDate()+(o-l-(o>l?7:0)))}else i=new Date(Date.UTC(n,SHORT_MONTHS[r[3]],r[4],a[0],a[1],a[2],0));EXACT_DATE_TIME[n][r]=i}return e&&(i=h(i,a[3],e)),i},u=function(t,e){for(var i=[],n=0;e&&n<e.length;n++)e[n][0]<=t&&(e[n][1]>=t||e[n][0]===t&&"only"===e[n][1]||"max"===e[n][1])&&i.push([t,e[n]]);return i},p=function(t,e,n){var r,a;return t instanceof Date?n&&(t=h(t,i?"u":"w",n)):(r=t[0],a=t[1],t=!n&&EXACT_DATE_TIME[r]&&EXACT_DATE_TIME[r][a]?EXACT_DATE_TIME[r][a]:c(t,n)),e instanceof Date?n&&(e=h(e,i?"u":"w",n)):(r=e[0],a=e[1],e=!n&&EXACT_DATE_TIME[r]&&EXACT_DATE_TIME[r][a]?EXACT_DATE_TIME[r][a]:c(e,n)),t=Number(t),e=Number(e),t-e},d=r.getUTCFullYear(),f=timezoneJS.ruleCache[n];if(f||(f=timezoneJS.ruleCache[n]={}),l=f[d],l||(l=u(d-1,_this.rules[a]),l=l.concat(u(d,_this.rules[a])),l.sort(p),f[d]=l),!l||!l.length)return null;for(var m,g=l.length-1;g>=0;g--){m=g>0?l[g-1][1]:null;var v=l[g];if(v[2]||(v[2]=c(v,m)),p(r,v,m)>=0)return v[1]}return null}function getAbbreviation(t,e){var i=t[2];if(i.indexOf("%s")>-1){var n;return n=e?"-"===e[7]?"":e[7]:"S",i.replace("%s",n)}return i.indexOf("/")>-1?i.split("/",2)[e&&e[6]?1:0]:i}var _this=this,regionMap={Etc:"etcetera",EST:"northamerica",MST:"northamerica",HST:"northamerica",EST5EDT:"northamerica",CST6CDT:"northamerica",MST7MDT:"northamerica",PST8PDT:"northamerica",America:["northamerica","southamerica"],Pacific:"australasia",Atlantic:"europe",Africa:"africa",Indian:"africa",Antarctica:"antarctica",Asia:"asia",Australia:"australasia",Europe:"europe",WET:"europe",CET:"europe",MET:"europe",EET:"europe"},regionExceptions={"Pacific/Honolulu":"northamerica","Atlantic/Bermuda":"northamerica","Atlantic/Cape_Verde":"africa","Atlantic/St_Helena":"africa","Indian/Kerguelen":"antarctica","Indian/Chagos":"asia","Indian/Maldives":"asia","Indian/Christmas":"australasia","Indian/Cocos":"australasia","America/Danmarkshavn":"europe","America/Scoresbysund":"europe","America/Godthab":"europe","America/Thule":"europe","Asia/Istanbul":"europe","Asia/Yekaterinburg":"europe","Asia/Omsk":"europe","Asia/Novosibirsk":"europe","Asia/Krasnoyarsk":"europe","Asia/Irkutsk":"europe","Asia/Yakutsk":"europe","Asia/Vladivostok":"europe","Asia/Sakhalin":"europe","Asia/Magadan":"europe","Asia/Kamchatka":"europe","Asia/Anadyr":"europe","Africa/Ceuta":"europe",GMT:"etcetera","Europe/Nicosia":"asia"};this.zoneFileBasePath=null,this.zoneFiles=["africa","antarctica","asia","australasia","backward","etcetera","europe","northamerica","pacificnew","southamerica"],this.loadingSchemes={PRELOAD_ALL:"preloadAll",LAZY_LOAD:"lazyLoad",MANUAL_LOAD:"manualLoad"},this.getRegionForTimezone=getRegionForTimezone,this.loadingScheme=this.loadingSchemes.LAZY_LOAD,this.loadedZones={},this.zones={},this.rules={},this.init=function(t){var e={async:!0},i=this.loadingScheme===this.loadingSchemes.PRELOAD_ALL?this.zoneFiles:this.defaultZoneFile||"northamerica";for(var n in t)e[n]=t[n];return this.loadZoneFiles(i,e)},this.loadZoneFiles=function(t,e){var i,n=0;if("string"==typeof t)return this.loadZoneFile(t,e);e=e||{},i=e.callback,e.callback=function(){++n===t.length&&"function"==typeof i&&i()};for(var r=0;r<t.length;r++)this.loadZoneFile(t[r],e)},this.loadZoneFile=function(t,e){if(void 0===this.zoneFileBasePath)throw new Error("Please define a base path to your zone file directory -- timezoneJS.timezone.zoneFileBasePath.");if(!this.loadedZones[t])return this.loadedZones[t]=!0,builtInLoadZoneFile(t,e)},this.loadZoneJSONData=function(url,sync){var processData=function processData(data){data=eval("("+data+")");for(var z in data.zones)_this.zones[z]=data.zones[z];for(var r in data.rules)_this.rules[r]=data.rules[r]};return sync?processData(_this.transport({url:url,async:!1})):_this.transport({url:url,success:processData})},this.loadZoneDataFromObject=function(t){if(t){for(var e in t.zones)_this.zones[e]=t.zones[e];for(var i in t.rules)_this.rules[i]=t.rules[i]}},this.getAllZones=function(){var t=[];for(var e in this.zones)t.push(e);return t.sort()},this.parseZones=function(t){if(!t)return!1;for(var e,i=t.split("\n"),n=[],r=null,a=null,o=0;o<i.length;o++)if(e=i[o],e.match(/^\s/)&&(e="Zone "+r+e),e=e.split("#")[0],e.length>3)switch(n=e.split(/\s+/),n.shift()){case"Zone":if(r=n.shift(),_this.zones[r]||(_this.zones[r]=[]),n.length<3)break;n.splice(3,n.length,processZone(n)),n[3]&&(n[3]=Date.UTC.apply(null,n[3])),n[0]=-getBasicOffset(n[0]),_this.zones[r].push(n);break;case"Rule":a=n.shift(),_this.rules[a]||(_this.rules[a]=[]),n[0]=parseInt(n[0],10),n[1]=parseInt(n[1],10)||n[1],n[5]=parseTimeString(n[5]),n[6]=getBasicOffset(n[6]),_this.rules[a].push(n);break;case"Link":if(_this.zones[n[1]])throw new Error("Error with Link "+n[1]+". Cannot create link of a preexisted zone.");isNaN(n[0])?_this.zones[n[1]]=n[0]:_this.zones[n[1]]=parseInt(n[0],10)}return!0},this.transport=_transport,this.getTzInfo=function(t,e,i){this.lazyLoadZoneFiles(e);var n=getZone(t,e),r=+n[0],a=getRule(t,n,i,e);return a&&(r=getAdjustedOffset(r,a[6])),{tzOffset:r,tzAbbr:getAbbreviation(n,a)}},this.lazyLoadZoneFiles=function(t){if(this.loadingScheme===this.loadingSchemes.LAZY_LOAD){var e=getRegionForTimezone(t);if(!e)throw new Error("Not a valid timezone ID.");this.loadZoneFiles(e)}}}}.call("undefined"!=typeof window?window:this),_exports.timezoneJS.timezone.loadingScheme=_exports.timezoneJS.timezone.loadingSchemes.MANUAL_LOAD,_exports.timezoneJS.timezone.loadZoneDataFromObject({zones:{"Atlantic/Cape_Verde":[[60,"-","-01",null]],"Africa/Cairo":[[-120,"Egypt","EE%sT",null]],"Africa/Nairobi":[[-180,"-","EAT",null]],"Africa/Casablanca":[[0,"Morocco","WE%sT",null]],"Africa/Johannesburg":[[-120,"SA","SAST",null]],"Africa/Tunis":[[-60,"Tunisia","CE%sT",null]],"Asia/Kabul":[[-270,"-","+0430",null]],"Asia/Baku":[[-240,"Azer","+04/+05",null]],"Asia/Dhaka":[[-360,"Dhaka","+06/+07",null]],"Asia/Yangon":[[-390,"-","+0630",null]],"Asia/Shanghai":[[-480,"PRC","C%sT",null]],"Asia/Hong_Kong":[[-480,"HK","HK%sT",null]],"Asia/Taipei":[[-480,"Taiwan","C%sT",null]],"Asia/Nicosia":[[-120,"EUAsia","EE%sT",null]],"Asia/Kolkata":[[-330,"-","IST",null]],"Asia/Tehran":[[-210,"Iran","+0330/+0430",null]],"Asia/Jerusalem":[[-120,"Zion","I%sT",null]],"Asia/Tokyo":[[-540,"Japan","J%sT",null]],"Asia/Almaty":[[-360,"-","ALMT",null]],"Asia/Seoul":[[-540,"ROK","K%sT",null]],"Asia/Pyongyang":[[-540,"-","KST",14395968e5],[-510,"-","KST",null]],"Asia/Kuala_Lumpur":[[-480,"-","+08",null]],"Asia/Hovd":[[-420,"Mongol","+07/+08",null]],"Asia/Ulaanbaatar":[[-480,"Mongol","+08/+09",null]],"Asia/Kathmandu":[[-345,"-","+0545",null]],"Asia/Karachi":[[-300,"Pakistan","PK%sT",null]],"Asia/Riyadh":[[-180,"-","+03",null]],"Asia/Bangkok":[[-420,"-","+07",null]],"Asia/Dubai":[[-240,"-","+04",null]],"Australia/Darwin":[[-570,"Aus","CST",null]],"Australia/Perth":[[-480,"AW","WST",null]],"Australia/Eucla":[[-525,"AW","+0845/+0945",null]],"Australia/Brisbane":[[-600,"AQ","EST",null]],"Australia/Adelaide":[[-570,"AS","CST",null]],"Australia/Sydney":[[-600,"AN","EST",null]],"Pacific/Guam":[[-600,"-","ChST",null]],"Pacific/Kiritimati":[[-840,"-","+14",null]],"Pacific/Noumea":[[-660,"NC","+11/+12",null]],"Pacific/Auckland":[[-720,"NZ","NZ%sT",null]],"Pacific/Chatham":[[-765,"Chatham","+1245/+1345",null]],"Pacific/Pago_Pago":[[660,"-","SST",null]],"Pacific/Apia":[[-780,"WS","+13/+14",null]],"Pacific/Tongatapu":[[-780,"Tonga","+13/+14",null]],"Etc/UTC":[[0,"-","UTC",null]],UTC:"Etc/UTC","Europe/London":[[0,"EU","GMT/BST",null]],WET:[[0,"EU","WE%sT",null]],CET:[[-60,"C-Eur","CE%sT",null]],MET:[[-60,"C-Eur","ME%sT",null]],EET:[[-120,"EU","EE%sT",null]],"Europe/Brussels":[[-60,"EU","CE%sT",null]],"Europe/Helsinki":[[-120,"EU","EE%sT",null]],"Europe/Berlin":[[-60,"EU","CE%sT",null]],"Europe/Amsterdam":[[-60,"EU","CE%sT",null]],"Atlantic/Azores":[[60,"EU","AZO%sT",null]],"Europe/Bucharest":[[-120,"EU","EE%sT",null]],"Europe/Kaliningrad":[[-180,"-","+03",14142888e5],[-120,"-","EET",null]],"Europe/Moscow":[[-240,"-","MSK",14142888e5],[-180,"-","MSK",null]],"Europe/Simferopol":[[-120,"EU","EE%sT",13961448e5],[-240,"-","MSK",14142888e5],[-180,"-","MSK",null]],"Europe/Samara":[[-240,"-","+04",null]],"Asia/Yekaterinburg":[[-360,"-","+06",14142888e5],[-300,"-","+05",null]],"Asia/Omsk":[[-420,"-","+07",14142888e5],[-360,"-","+06",null]],"Asia/Novosibirsk":[[-420,"-","+07",14142888e5],[-360,"-","+06",14693256e5],[-420,"-","+07",null]],"Asia/Novokuznetsk":[[-420,"-","+07",null]],"Asia/Krasnoyarsk":[[-480,"-","+08",14142888e5],[-420,"-","+07",null]],"Asia/Irkutsk":[[-540,"-","+09",14142888e5],[-480,"-","+08",null]],"Asia/Yakutsk":[[-600,"-","+10",14142888e5],[-540,"-","+09",null]],"Asia/Vladivostok":[[-660,"-","+11",14142888e5],[-600,"-","+10",null]],"Asia/Magadan":[[-720,"-","+12",14142888e5],[-600,"-","+10",14614632e5],[-660,"-","+11",null]],"Asia/Srednekolymsk":[[-720,"-","+12",14142888e5],[-660,"-","+11",null]],"Asia/Kamchatka":[[-720,"-","+12",null]],"Europe/Belgrade":[[-60,"EU","CE%sT",null]],"Europe/Sarajevo":"Europe/Belgrade","Europe/Istanbul":[[-120,"EU","EE%sT",13961412e5],[-120,"-","EET",13962276e5],[-120,"EU","EE%sT",14457348e5],[-120,"1:00","EEST",14469444e5],[-120,"EU","EE%sT",14732064e5],[-180,"-","+03",null]],"America/New_York":[[300,"US","E%sT",null]],"America/Chicago":[[360,"US","C%sT",null]],"America/Denver":[[420,"US","M%sT",null]],"America/Los_Angeles":[[480,"US","P%sT",null]],"America/Juneau":[[540,"US","AK%sT",null]],"Pacific/Honolulu":[[600,"-","HST",null]],"America/Phoenix":[[420,"-","MST",null]],"America/Indiana/Indianapolis":[[300,"US","E%sT",null]],"America/St_Johns":[[210,"Canada","N%sT",null]],"America/Halifax":[[240,"Canada","A%sT",null]],"America/Regina":[[360,"-","CST",null]],"America/Mexico_City":[[360,"Mexico","C%sT",null]],"America/Chihuahua":[[420,"Mexico","M%sT",null]],"America/Tijuana":[[480,"US","P%sT",null]],"America/Costa_Rica":[[360,"CR","C%sT",null]],"America/Puerto_Rico":[[240,"-","AST",null]],"America/Argentina/Buenos_Aires":[[180,"Arg","-03/-02",null]],"America/Sao_Paulo":[[180,"Brazil","-03/-02",null]],"America/Santiago":[[240,"Chile","-04/-03",null]],"America/Punta_Arenas":[[240,"Chile","-04/-03",14808096e5],[180,"-","-03",null]],"America/Bogota":[[300,"CO","-05/-04",null]],"America/Asuncion":[[240,"Para","-04/-03",null]],"Atlantic/South_Georgia":[[120,"-","-02",null]],"America/Montevideo":[[180,"Uruguay","-03/-02",null]],"America/Caracas":[[270,"-","-0430",14620698e5],[240,"-","-04",null]],"Europe/Athens":"Europe/Bucharest","Asia/Rangoon":"Asia/Yangon","Atlantic/Reykjavik":"UTC","Asia/Kuwait":"Asia/Riyadh","Asia/Muscat":"Asia/Riyadh","Asia/Istanbul":"Europe/Istanbul","Pacific/Midway":"Pacific/Pago_Pago"},rules:{Egypt:[[2014,"only","-","May","16",[0,0,0,null],60,"S"],[2014,"only","-","Jun","27",[0,0,0,null],0,"-"],[2014,"only","-","Aug","1",[0,0,0,null],60,"S"],[2014,"only","-","Sep","lastThu",[23,0,0,"s"],0,"-"]],Morocco:[[2012,2013,"-","Apr","lastSun",[2,0,0,null],60,"S"],[2012,"only","-","Jul","20",[3,0,0,null],0,"-"],[2012,"only","-","Aug","20",[2,0,0,null],60,"S"],[2012,"only","-","Sep","30",[3,0,0,null],0,"-"],[2013,"only","-","Jul","7",[3,0,0,null],0,"-"],[2013,"only","-","Aug","10",[2,0,0,null],60,"S"],[2013,"max","-","Oct","lastSun",[3,0,0,null],0,"-"],[2014,2021,"-","Mar","lastSun",[2,0,0,null],60,"S"],[2014,"only","-","Jun","28",[3,0,0,null],0,"-"],[2014,"only","-","Aug","2",[2,0,0,null],60,"S"],[2015,"only","-","Jun","14",[3,0,0,null],0,"-"],[2015,"only","-","Jul","19",[2,0,0,null],60,"S"],[2016,"only","-","Jun","5",[3,0,0,null],0,"-"],[2016,"only","-","Jul","10",[2,0,0,null],60,"S"],[2017,"only","-","May","21",[3,0,0,null],0,"-"],[2017,"only","-","Jul","2",[2,0,0,null],60,"S"],[2018,"only","-","May","13",[3,0,0,null],0,"-"],[2018,"only","-","Jun","17",[2,0,0,null],60,"S"],[2019,"only","-","May","5",[3,0,0,null],0,"-"],[2019,"only","-","Jun","9",[2,0,0,null],60,"S"],[2020,"only","-","Apr","19",[3,0,0,null],0,"-"],[2020,"only","-","May","24",[2,0,0,null],60,"S"],[2021,"only","-","Apr","11",[3,0,0,null],0,"-"],[2021,"only","-","May","16",[2,0,0,null],60,"S"],[2022,"only","-","May","8",[2,0,0,null],60,"S"]],SA:[],Tunisia:[],EUAsia:[[1981,"max","-","Mar","lastSun",[1,0,0,"u"],60,"S"],[1996,"max","-","Oct","lastSun",[1,0,0,"u"],0,"-"]],Azer:[[1997,2015,"-","Mar","lastSun",[4,0,0,null],60,"S"],[1997,2015,"-","Oct","lastSun",[5,0,0,null],0,"-"]],Dhaka:[],PRC:[],HK:[],Taiwan:[],Iran:[[2012,"only","-","Mar","21",[0,0,0,null],60,"D"],[2012,"only","-","Sep","21",[0,0,0,null],0,"S"],[2013,2015,"-","Mar","22",[0,0,0,null],60,"D"],[2013,2015,"-","Sep","22",[0,0,0,null],0,"S"],[2016,"only","-","Mar","21",[0,0,0,null],60,"D"],[2016,"only","-","Sep","21",[0,0,0,null],0,"S"],[2017,2019,"-","Mar","22",[0,0,0,null],60,"D"],[2017,2019,"-","Sep","22",[0,0,0,null],0,"S"],[2020,"only","-","Mar","21",[0,0,0,null],60,"D"],[2020,"only","-","Sep","21",[0,0,0,null],0,"S"],[2021,2023,"-","Mar","22",[0,0,0,null],60,"D"],[2021,2023,"-","Sep","22",[0,0,0,null],0,"S"]],Zion:[[2012,"only","-","Mar","Fri>=26",[2,0,0,null],60,"D"],[2012,"only","-","Sep","23",[2,0,0,null],0,"S"],[2013,"max","-","Mar","Fri>=23",[2,0,0,null],60,"D"],[2013,"max","-","Oct","lastSun",[2,0,0,null],0,"S"]],Japan:[],ROK:[],Mongol:[[2015,2016,"-","Mar","lastSat",[2,0,0,null],60,"S"],[2015,2016,"-","Sep","lastSat",[0,0,0,null],0,"-"]],Pakistan:[],Aus:[],AW:[],AQ:[],AS:[[2008,"max","-","Apr","Sun>=1",[2,0,0,"s"],0,"-"],[2008,"max","-","Oct","Sun>=1",[2,0,0,"s"],60,"-"]],AN:[[2008,"max","-","Apr","Sun>=1",[2,0,0,"s"],0,"-"],[2008,"max","-","Oct","Sun>=1",[2,0,0,"s"],60,"-"]],NC:[],NZ:[[2007,"max","-","Sep","lastSun",[2,0,0,"s"],60,"D"],[2008,"max","-","Apr","Sun>=1",[2,0,0,"s"],0,"S"]],Chatham:[[2007,"max","-","Sep","lastSun",[2,45,0,"s"],60,"D"],[2008,"max","-","Apr","Sun>=1",[2,45,0,"s"],0,"S"]],WS:[[2012,"max","-","Apr","Sun>=1",[4,0,0,null],0,"-"],[2012,"max","-","Sep","lastSun",[3,0,0,null],60,"D"]],Tonga:[[2016,"max","-","Nov","Sun>=1",[2,0,0,null],60,"S"],[2017,"max","-","Jan","Sun>=15",[3,0,0,null],0,"S"]],EU:[[1981,"max","-","Mar","lastSun",[1,0,0,"u"],60,"S"],[1996,"max","-","Oct","lastSun",[1,0,0,"u"],0,"-"]],"C-Eur":[[1981,"max","-","Mar","lastSun",[2,0,0,"s"],60,"S"],[1996,"max","-","Oct","lastSun",[2,0,0,"s"],0,"-"]],US:[[2007,"max","-","Mar","Sun>=8",[2,0,0,null],60,"D"],[2007,"max","-","Nov","Sun>=1",[2,0,0,null],0,"S"]],Canada:[[2007,"max","-","Mar","Sun>=8",[2,0,0,null],60,"D"],[2007,"max","-","Nov","Sun>=1",[2,0,0,null],0,"S"]],Mexico:[[2002,"max","-","Apr","Sun>=1",[2,0,0,null],60,"D"],[2002,"max","-","Oct","lastSun",[2,0,0,null],0,"S"]],CR:[],Arg:[],Brazil:[[2008,"max","-","Oct","Sun>=15",[0,0,0,null],60,"S"],[2012,"only","-","Feb","Sun>=22",[0,0,0,null],0,"-"],[2013,2014,"-","Feb","Sun>=15",[0,0,0,null],0,"-"],[2015,"only","-","Feb","Sun>=22",[0,0,0,null],0,"-"],[2016,2022,"-","Feb","Sun>=15",[0,0,0,null],0,"-"]],Chile:[[2012,2014,"-","Apr","Sun>=23",[3,0,0,"u"],0,"-"],[2012,2014,"-","Sep","Sun>=2",[4,0,0,"u"],60,"S"],[2016,"max","-","May","Sun>=9",[3,0,0,"u"],0,"-"],[2016,"max","-","Aug","Sun>=9",[4,0,0,"u"],60,"S"]],CO:[],Para:[[2010,"max","-","Oct","Sun>=1",[0,0,0,null],60,"S"],[2010,2012,"-","Apr","Sun>=8",[0,0,0,null],0,"-"],[2013,"max","-","Mar","Sun>=22",[0,0,0,null],0,"-"]],Uruguay:[[2006,"max","-","Oct","Sun>=1",[2,0,0,null],60,"S"],[2007,"max","-","Mar","Sun>=8",[2,0,0,null],0,"-"]]}}),CIQ.convertTimeZone=function(t,e,i){var n=new _exports.timezoneJS.Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds(),e);return n.setTimezone(i),n},CIQ.convertToLocalTime=function(t,e){var i=t.getSeconds(),n=t.getMilliseconds(),r=new _exports.timezoneJS.Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),e);return new Date(r.getTime()+1e3*i+n)},_exports},__utility_=function(t){function e(t,i){if(!i)return document.getElementById(t);if(i.id==t)return i;if(!i.hasChildNodes)return null;for(var n=0;n<i.childNodes.length;n++){var r=e(t,i.childNodes[n]);if(r)return r}return null}function i(t,e){return e||(e=document),e.querySelectorAll(t)[0]}function n(){}void 0!==global&&void 0===global.CanvasRenderingContext2D&&(global.CanvasRenderingContext2D=function(){}),t.$$=e,t.$$$=i,String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},Function.prototype.ciqInheritsFrom||(Function.prototype.ciqInheritsFrom=function(t,e){if(!1!==e)this.prototype=new t;else{this.prototype=Object.create(t);for(var i in t.prototype)this.prototype[i]=t.prototype[i]}this.prototype.constructor=this,this.prototype.parent=t.prototype},Function.prototype.stxInheritsFrom=Function.prototype.ciqInheritsFrom),CanvasRenderingContext2D.prototype.dashedLineTo=function(t,e,i,n,r){if(!(r instanceof Array))return r&&console.log('WARNING: Unsupported drawing pattern "'+r+'"; defaulting to "solid"'),void this.stxLine(t,e,i,n,this.strokeStyle,this.globalAlpha,this.lineWidth);var a=function(t,e){return t-e<=1e-8},o=function(t,e){return t-e>=-1e-8},s=function(t,e){return Math.min(t,e)},l=function(t,e){return Math.max(t,e)},h={thereYet:o,cap:s},c={thereYet:o,cap:s};if(e-n>0&&(c.thereYet=a,c.cap=l),t-i>0&&(h.thereYet=a,h.cap=l),this.moveTo(t,e),!isNaN(t)&&!isNaN(e))for(var u=t,p=e,d=0,f=!0;!h.thereYet(u,i)||!c.thereYet(p,n);){var m=Math.atan2(n-e,i-t),g=r[d];u=h.cap(i,u+Math.cos(m)*g),p=c.cap(n,p+Math.sin(m)*g),f?this.lineTo(u,p):this.moveTo(u,p),d=(d+1)%r.length,f=!f}},CanvasRenderingContext2D.prototype.stxLine=function(t,e,i,n,r,a,o,s){this.beginPath(),this.lineWidth=o,this.strokeStyle=r,this.globalAlpha=a,s&&s.length?this.dashedLineTo(t,e,i,n,s):(this.moveTo(t,e),this.lineTo(i,n)),this.stroke(),this.closePath(),this.lineWidth=1},CanvasRenderingContext2D.prototype.stxCircle=function(t,e,i,n){this.beginPath(),this.arc(t,e,i,0,2*Math.PI,!1),n&&this.fill(),this.stroke(),this.closePath()},t.CIQ=n,t.STX=n;var r="undefined"!=typeof navigator?navigator:{userAgent:""},a=r.userAgent,o="undefined"!=typeof window?window:{},s="undefined"!=typeof document?document:{};return n.ipad=-1!=a.indexOf("iPad"),n.iphone=-1!=a.indexOf("iPhone"),n.isSurface=r.msMaxTouchPoints&&r.msMaxTouchPoints>1,n.touchDevice=void 0!==s.ontouchstart||n.isSurface,n.is_chrome=a.toLowerCase().indexOf("chrome")>-1,n.isAndroid=a.toLowerCase().indexOf("android")>-1,n.isIE=a.toLowerCase().indexOf("msie")>-1||a.indexOf("Trident")>-1,n.isIE9=a.indexOf("Trident/5")>-1||a.indexOf("MSIE 9.0")>-1,n.isIE8=o.isIE8||a.indexOf("MSIE 8.0")>-1,n.isIOS7=a.match(/(iPad|iPhone);.*CPU.*OS 7_\d/i),n.isIOS8=a.match(/(iPad|iPhone);.*CPU.*OS 8_\d/i),n.isIOS9=a.match(/(iPad|iPhone);.*CPU.*OS 9_\d/i),n.isIOS10=a.match(/(iPad|iPhone);.*CPU.*OS 10_\d/i),n.isIOS7or8=n.isIOS7||n.isIOS8||n.isIOS9||n.isIOS10,n.isMobile=n.isAndroid||n.ipad||n.iphone,n.isSurfaceApp=o.MSApp,n.noKeyboard=n.ipad||n.iphone||n.isAndroid||n.isSurfaceApp,n.wheelEvent="wheel"in document.createElement("div")||"onwheel"in document?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",n.isIE&&(n.wheelEvent="wheel"),n.log10=function(t){return Math.log(t)/Math.LN10},n.deleteRHS=function(t,e){var i=!1;for(var n in t)t[n]==e&&(delete t[n],i=!0);return i},n.scrub=function(t,e){for(var i in t)void 0===t[i]&&delete t[i],e&&null===t[i]&&delete t[i]},n.dataBindSafeAssignment=function(t,e){n.extend(t,e);for(var i in t)void 0===e[i]&&delete t[i]},n.clone=function(t,e){if(null===t||"object"!=(void 0===t?"undefined":_typeof(t)))return t;var i=t.constructor;if(i==Date||i==RegExp||i==Function||i==String||i==Number||i==Boolean)return new t.constructor(t);e=e||new t.constructor;for(var r in t)e[r]=void 0===e[r]?n.clone(t[r],null):e[r];return e},n.shallowClone=function(t){if(!t)return t;var e;if(t.constructor==Array){e=new Array(t.length);for(var i=0;i<t.length;i++)e[i]=t[i];return e}e={};for(var n in t)e[n]=t[n];return e},n.extend=function(t,e,i){for(var r in e){var a=e[r];a?a.constructor==Object?(t[r]||(t[r]={}),i?t[r]=e[r]:(t[r].constructor!=Object&&(t[r]={}),n.extend(t[r],e[r]))):a.constructor==Array?t[r]=a.slice():t[r]=a:t[r]=a}return t},n.ensureDefaults=function(t,e){for(var i in e)void 0===t[i]&&(t[i]=e[i]);return t},n.equals=function(t,e,i){if(!t&&e)return!1;if(t&&!e)return!1;if((void 0===t?"undefined":_typeof(t))!==(void 0===e?"undefined":_typeof(e)))return!1;for(var r in t)if(!i||!i[r])if("object"!==_typeof(t[r])){if(e[r]!=t[r])return!1}else{var a=n.equals(t[r],e[r]);if(!a)return!1}return!0},n.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},n.first=function(t){for(var e in t)return e;return null},n.last=function(t){var e=null;for(var i in t)e=i;return e},n.objLength=function(t){if(!t)return 0;var e=0;for(var i in t)e++;return e},n.deriveFromObjectChain=function(t,e){var i=e.split(".");if(1===i.length)return{obj:t,member:e};for(var n=0;n<i.length-1;n++)t[i[n]]||(t[i[n]]={}),t=t[i[n]];return{obj:t,member:i[n]}},n.derivedFrom=function(t,e){return!!e.isPrototypeOf(t)||t instanceof e},n.replaceFields=function(t,e){if(!t)return t;var i={};for(var r in t){var a=t[r],o=e[r];if(o||(o=r),a&&"object"==(void 0===a?"undefined":_typeof(a)))if(a.constructor==Array)for(var s=i[o]=new Array(a.length),l=0;l<s.length;l++){var h=a[l];"object"==(void 0===h?"undefined":_typeof(h))?s[l]=n.replaceFields(h,e):s[l]=h}else i[o]=n.replaceFields(a,e);else i[o]=a}return i},n.removeNullValues=function(t){var e=n.clone(t);for(var i in e)e[i]||delete e[i];return e},n.reverseObject=function(t){var e={};for(var i in t)e[t[i]]=i;return e},n.camelCaseRegExp=/-([a-z])/g,n.makeCamelCase=function(t){return t.replace(n.camelCaseRegExp,function(t){return t[1].toUpperCase()})},n.appendClassName=function(t,e){if(t.className!=e){for(var i=t.className.split(" "),n=0;n<i.length;n++)if(i[n]==e)return;t.className?t.className+=" "+e:t.className=e}},n.unappendClassName=function(t,e){if(t&&-1!=t.className.indexOf(e))if(t.className==e)t.className="";else{for(var i=t.className.split(" "),n="",r=0;r<i.length;r++)i[r]!=e&&(""!==n&&(n+=" "),n+=i[r]);t.className=n}},n.swapClassName=function(t,e,i){n.unappendClassName(t,i),n.appendClassName(t,e)},n.hasClassName=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")>-1},n.toggleClassName=function(t,e){n.hasClassName(t,e)?n.unappendClassName(t,e):n.appendClassName(t,e)},n.newChild=function(t,e,i,n){var r=document.createElement(e);return i&&(r.className=i),t.appendChild(r),n&&(r.innerHTML=n),r},n.innerHTML=function(t,e){window.MSApp?window.MSApp.execUnsafeLocalFunction(function(){t.innerHTML=e}):t.innerHTML=e},n.focus=function(t,e){if(n.isSurface||e){var i=0;isNaN(parseInt(e,10))||(i=e),setTimeout(function(){t.focus()},i)}else t.focus()},n.blur=function(t){t||(t=document.activeElement),t&&t.blur(),window.focus()},n.findNodesByText=function(t,e){if(t.innerHTML==e)return[t];for(var i=[],r=0;r<t.childNodes.length;r++){var a=n.findNodesByText(t.childNodes[r],e);a&&(i=i.concat(a))}return i.length?i:null},n.hideByText=function(t,e){for(var i=n.findNodesByText(t,e),r=0;r<i.length;r++)i[r].style.display="none"},n.outerWidth=function(t){var e=t.offsetWidth;return e+=n.stripPX(getComputedStyle(t).marginLeft),e+=n.stripPX(getComputedStyle(t).marginRight)},n.clearNode=function(t){if(t.hasChildNodes())for(;t.childNodes.length>=1;)t.removeChild(t.firstChild)},n.getEventDOM=function(t){return t?t.target:window.event.srcElement},n.convertClickToTouchEnd=function(t){var i=e(t),n=i.getAttribute("onClick");n&&(i.removeAttribute("onClick"),i.setAttribute("onTouchEnd",n))},n.pageHeight=function(){var t=window.innerHeight;if(top!=self)try{t>parent.innerHeight&&(t=parent.innerHeight)}catch(t){}return t},n.pageWidth=function(){var t=window.innerWidth;if(top!=self)try{t>parent.innerWidth&&(t=parent.innerWidth)}catch(t){}return t},n.stripPX=function(t){return t?"number"==typeof t?t:parseInt(t.substr(0,t.indexOf("p")),10):0},n.colorsEqual=function(t,e){if(t==e)return!0;if(!t&&!e)return!0;if(!t||!e)return!1;"transparent"==t&&(t="rgba(0,0,0,0)"),"transparent"==e&&(e="rgba(0,0,0,0)");var i=/^rgba\(.*,(.+)\)/,r=t.match(i),a=e.match(i);if(r=r?parseFloat(r[1]):1,a=a?parseFloat(a[1]):1,r!=a)return!1;var o=n.colorToHex(t),s=n.colorToHex(e);return o.toLowerCase()==s.toLowerCase()},n.colorToHex=function(t){if(n.colorToHexMapping||(n.colorToHexMapping={}),t&&"transparent"!=t||(t="#000000"),n.colorToHexMapping[t])return n.colorToHexMapping[t];if("#"===t.substr(0,1))return 4==t.length&&(t=n.colorToHexMapping[t]="#"+Array(3).join(t.substr(1,1))+Array(3).join(t.substr(2,1))+Array(3).join(t.substr(3,1))),t;var i=/(.*?)rgb\((\d+), ?(\d+), ?(\d+)\)/.exec(t);if(i||(i=/(.*?)rgba\((\d+), ?(\d+), ?(\d+),.*\)/.exec(t)),!i){var r=function(t){if("undefined"==typeof document)return"#000000";var r=e("color_converter");r||(r=document.createElement("textarea"),r.id="color_converter",r.style.display="none",document.body.appendChild(r)),r.style.color="#000000",r.style.color=t;var a;return n.isIE8?(a=r.createTextRange().queryCommandValue("ForeColor"),a=(255&a)<<16|65280&a|(16711680&a)>>>16,a=a.toString(16),"#000000".slice(0,7-a.length)+a):(a=getComputedStyle(r).getPropertyValue("color"),i=/(.*?)rgb\((\d+), ?(\d+), ?(\d+)\)/.exec(a),i?n.colorToHex(a):"#"===a.substr(0,1)?a:t)}(t);return n.colorToHexMapping[t]=r,r}for(var a=parseFloat(i[2]),o=parseFloat(i[3]),s=parseFloat(i[4]),l=s|o<<8|a<<16,h=l.toString(16),c=h.length;c<6;c++)h="0"+h;var u=i[1]+"#"+h;return n.colorToHexMapping[t]=u,u},n.hexToRgba=function(t,e){if(t&&"transparent"!=t||(t="rgba(0,0,0,0)"),"rgba"===t.substr(0,4)){var i=/(.*?)rgba\((\d+), ?(\d+), ?(\d+), ?(\d*\.?\d*)\)/.exec(t),r=i[5];return(e||0===e)&&(r=e),r>1&&(r/=100),"rgba("+i[2]+","+i[3]+","+i[4]+","+r+")"}"rgb"===t.substr(0,3)&&(t=n.colorToHex(t)),e||0===e||(e=100),e<=1&&(e*=100),t=t.replace("#","");var a=parseInt(t.slice(0,2),16),o=parseInt(t.slice(2,4),16),s=parseInt(t.slice(4,6),16);return isNaN(a)||isNaN(o)||isNaN(s)?(console.log("CIQ.hexToRgba: invalid hex :",t),null):"rgba("+a+","+o+","+s+","+e/100+")"},n.convertToNativeColor=function(t){var e=document.createElement("DIV");e.style.color=t,e.style.display="none",document.body.appendChild(e);var i=getComputedStyle(e).color;return document.body.removeChild(e),i},n.isTransparent=function(t){if(!t)return!1;if("transparent"==t)return!0;var e=/(.*?)rgba\((\d+), ?(\d+), ?(\d+), ?(\d*\.?\d*)\)/.exec(t);return null!==e&&0===parseFloat(e[5])},n.hsv=function(t){var e=n.colorToHex(t);"#"===e.substr(0,1)&&(e=e.slice(1));for(var i=e.length;i<6;i++)e="0"+e;var r=parseInt(e.slice(0,2),16),a=parseInt(e.slice(2,4),16),o=parseInt(e.slice(4,6),16),s=0,l=0,h=0;if(r=parseInt((""+r).replace(/\s/g,""),10),a=parseInt((""+a).replace(/\s/g,""),10),o=parseInt((""+o).replace(/\s/g,""),10),null===r||null===a||null===o||isNaN(r)||isNaN(a)||isNaN(o))return console.log("CIQ.hsv: invalid color :",t),null;if(r<0||a<0||o<0||r>255||a>255||o>255)return null;r/=255,a/=255,o/=255;var c=Math.min(r,Math.min(a,o)),u=Math.max(r,Math.max(a,o));if(c==u)return h=c,[0,0,h];var p=r==c?a-o:o==c?r-a:o-r;return s=60*((r==c?3:o==c?1:5)-p/(u-c)),l=(u-c)/u,h=u,[s,l,h]},n.hsl=function(t){var e=n.colorToHex(t);"#"===e.substr(0,1)&&(e=e.slice(1));for(var i=e.length;i<6;i++)e="0"+e;var r=parseInt(e.slice(0,2),16),a=parseInt(e.slice(2,4),16),o=parseInt(e.slice(4,6),16);r/=255,a/=255,o/=255;var s,l,h=Math.max(r,a,o),c=Math.min(r,a,o),u=(h+c)/2;if(h==c)s=l=0;else{var p=h-c;switch(l=u>.5?p/(2-h-c):p/(h+c),h){case r:s=(a-o)/p+(a<o?6:0);break;case a:s=(o-r)/p+2;break;case o:s=(r-a)/p+4}s/=6}return[s,l,u]},n.chooseForegroundColor=function(t){var e=n.hsl(t);return e[2]>=e[0]?"#000000":"#FFFFFF"},n.borderPatternToArray=function(t,e){return e?e instanceof Array?e:"dotted"==e?[t,t]:"dashed"==e?[5*t,5*t]:("solid"!=e&&"none"!=e&&console.log('Unsupported pattern "'+e+'"; defaulting to "solid"'),[]):[]},n.getBackgroundColor=function(t){for(var e=null;!e||n.isTransparent(e);){var i=getComputedStyle(t);if(!i)return;if(e=i.backgroundColor,n.isTransparent(e)&&(e="transparent"),!(t=t.parentNode)||!t.tagName)break}return e&&"transparent"!=e||(e="#FFFFFF"),e},n.yyyymmddhhmmssmmmrx=new RegExp("\\d{17}"),n.strToDateTime=function(t){if(!t||t.getFullYear)return t;var e,i,r,a,o,s,l,h=[];if(12==t.length)return e=parseFloat(t.substring(0,4)),i=parseFloat(t.substring(4,6))-1,r=parseFloat(t.substring(6,8)),a=parseFloat(t.substring(8,10)),o=parseFloat(t.substring(10,12)),new Date(e,i,r,a,o,0,0);if(n.yyyymmddhhmmssmmmrx.test(t))return e=parseFloat(t.substring(0,4)),i=parseFloat(t.substring(4,6))-1,r=parseFloat(t.substring(6,8)),a=parseFloat(t.substring(8,10)),o=parseFloat(t.substring(10,12)),s=parseFloat(t.substring(12,14)),l=parseFloat(t.substring(14,17)),new Date(e,i,r,a,o,s,l);var c=[t],u=t.indexOf("T");if(-1!=u){var p=t.substring(u);if(!n.isIE8&&(-1!=p.indexOf("Z")||-1!=p.indexOf("-")||-1!=p.indexOf("+")))return new Date(t);c=t.split("T")}else-1!=t.indexOf(" ")&&(c=t.split(" "));if(-1!=c[0].indexOf("/"))h=c[0].split("/");else{if(-1==c[0].indexOf("-"))return n.strToDate(t);h=c[0].split("-")}var d=parseFloat(h[2],10);if(h[0]&&4==h[0].length&&(d=parseFloat(h[0],10),h[0]=h[1],h[1]=h[2]),c.length>1){var f=c[2];c=c[1].split(":"),f&&("12"==c[0]&&"AM"==f.toUpperCase()?c[0]=0:"12"!=c[0]&&"PM"==f.toUpperCase()&&(c[0]=parseInt(c[0],10)+12));var m=0,g=0;if(3==c.length)if(-1==c[2].indexOf("."))m=parseInt(c[2],10);else{if(m=c[2].split("."),3!=m[1].length){g=m[1].substr(0,3);var v=parseInt(m[1].substr(3),10);m=m[0];var y=new Date(d,h[0]-1,h[1],c[0],c[1],m,g);return y.setMinutes(y.getMinutes()-y.getTimezoneOffset()-v%100-60*Math.round(v/100)),y}g=m[1],m=m[0]}return new Date(d,h[0]-1,h[1],c[0],c[1],m,g)}return new Date(d,h[0]-1,h[1],0,0,0,0)},n.strToDate=function(t){var e;if(-1!=t.indexOf("/"))e=t.split("/");else{if(-1==t.indexOf("-"))return t.length>=8?new Date(parseFloat(t.substring(0,4)),parseFloat(t.substring(4,6))-1,parseFloat(t.substring(6,8))):new Date;e=t.split("-")}if(e.length<3)return new Date;-1!=e[2].indexOf(" ")?e[2]=e[2].substring(0,e[2].indexOf(" ")):-1!=e[2].indexOf("T")&&(e[2]=e[2].substring(0,e[2].indexOf("T")));var i=parseFloat(e[2],10);return i<20&&(i+=2e3),4==e[0].length&&(i=parseFloat(e[0],10),e[0]=e[1],e[1]=e[2]),new Date(i,e[0]-1,e[1])},n.mmddyyyy=function(t){"string"==typeof t&&(t=n.strToDate(t));var e=t.getMonth()+1;e<10&&(e="0"+e);var i=t.getDate();return i<10&&(i="0"+i),e+"/"+i+"/"+t.getFullYear()},n.yyyymmdd=function(t){var e=t.getMonth()+1;e<10&&(e="0"+e);var i=t.getDate();return i<10&&(i="0"+i),t.getFullYear()+"-"+e+"-"+i},n.yyyymmddhhmm=function(t){var e=t.getMonth()+1;e<10&&(e="0"+e);var i=t.getDate();i<10&&(i="0"+i);var n=t.getHours();n<10&&(n="0"+n);var r=t.getMinutes();return r<10&&(r="0"+r),""+t.getFullYear()+e+i+n+r},n.yyyymmddhhmmssmmm=function(t){var e=t.getMonth()+1;e<10&&(e="0"+e);var i=t.getDate();i<10&&(i="0"+i);var n=t.getHours();n<10&&(n="0"+n);var r=t.getMinutes();r<10&&(r="0"+r);var a=t.getSeconds();a<10&&(a="0"+a);var o=t.getMilliseconds();return o<10?o="00"+o:o<100&&(o="0"+o),""+t.getFullYear()+e+i+n+r+a+o},n.friendlyDate=function(t){var e=t.getMonth()+1;e<10&&(e="0"+e);var i=t.getDate();i<10&&(i="0"+i);var n=t.getHours();n<10&&(n="0"+n);var r=t.getMinutes();return r<10&&(r="0"+r),t.getFullYear()+"/"+e+"/"+i+" "+n+":"+r},n.standardUTCDate=function(t){var e=t.getUTCMonth()+1;e<10&&(e="0"+e);var i=t.getUTCDate();i<10&&(i="0"+i);var n=t.getUTCHours();n<10&&(n="0"+n);var r=t.getUTCMinutes();r<10&&(r="0"+r);var a=t.getUTCSeconds();return a<10&&(a="0"+a),t.getUTCFullYear()+"-"+e+"-"+i+"T"+n+":"+r+":"+a+"Z"},n.mmddhhmm=function(t){var e=n.strToDateTime(t),i=e.getMonth()+1;i<10&&(i="0"+i);var r=e.getDate();r<10&&(r="0"+r);var a=e.getHours();a<10&&(a="0"+a);var o=e.getMinutes();if(o<10&&(o="0"+o),"00"==a&&"00"==o)return i+"-"+r+"-"+e.getFullYear();var s=e.getSeconds();if(s<10&&(s="0"+s),"00"==s)return i+"-"+r+" "+a+":"+o;var l=e.getMilliseconds();return l<10?l="00"+l:l<100&&(l="0"+l),"000"==l?i+"-"+r+" "+a+":"+o+":"+s:i+"-"+r+" "+a+":"+o+":"+s+":"+l},n.getYearDay=function(t){var e=t;e||(e=new Date),e.setHours(0,0,0,0);var i=new Date(e.getFullYear(),0,0),n=e-i;return Math.round(n/864e5)},n.isDST=function(t){t||(t=new Date);var e=new Date(t.getFullYear(),0,1),i=new Date(t.getFullYear(),6,1),n=Math.max(e.getTimezoneOffset(),i.getTimezoneOffset());return t.getTimezoneOffset()!=n},n.uniqueID=function(){var t=new Date,e=t.getTime().toString(36);return e+=Math.floor(Math.random()*Math.pow(36,2)).toString(36),e.toUpperCase()},n.getHostName=function(t){try{return t.match(/:\/\/(.[^\/]+)/)[1]}catch(t){return""}},n.getAjaxServer=function(t){var e=!1,i=!0;if((n.isIE9||n.isIE8)&&t&&(""===n.getHostName(t)&&(i=!1),n.getHostName(t)==n.getHostName(window.location.href)&&(i=!1)),(n.isIE9||n.isIE8)&&i)return e=new XDomainRequest;try{e=new XMLHttpRequest}catch(t){alert("ajax not supported in browser")}return e},n.qs=function(t){var e={};t||(t=window.location.search.substring(1));for(var i=t.split("&"),n=0;n<i.length;n++){var r,a=i[n].indexOf("=");a>0?(r=i[n].substring(0,a),e[r]=i[n].substring(a+1)):(r=i[n],e[r]=null)}return e},n.postAjax=function(t,e,i,r,a){function o(e){var i={};if(t.responseHeaders){for(var n=e.getAllResponseHeaders(),r=n.split("\n"),a=0;a<r.length;a++){for(var o=r[a].split(":");o[1]&&" "==o[1].charAt(0);)o[1]=o[1].substring(1);""!==o[0]&&(i[o.shift()]=o.join(":"))}return i}}function s(t){for(var e=0;e<n.ajaxes.length;e++)if(n.ajaxes[e]==t)return void n.ajaxes.splice(e,1)}"string"==typeof t&&(t={url:t,payload:e,cb:i,contentType:r,noEpoch:a,method:null,responseHeaders:!1});var l=t.url,h=t.cb,c=t.payload;if(h||(h=function(){}),!t.ungovernable&&n.Extras&&n.Extras.RequestLimiter&&n.Extras.RequestLimiter.hitRequestLimit(l))return void h(429,null,{});var u=n.getAjaxServer(l);if(!u)return!1;n.ajaxes||(n.ajaxes=[]),n.ajaxes.unshift(u);var p=new Date;t.noEpoch||(-1==l.indexOf("?")?l+="?ciqrandom="+p.getTime():l+="&ciqrandom="+p.getTime());var d=t.method,f=t.headers;if(d||(d=c?"POST":"GET"),!n.isIE9&&!n.isIE8||u.constructor==XMLHttpRequest){if(u.open(d,l,!0),t.contentType||(t.contentType="application/x-www-form-urlencoded"),c&&u.setRequestHeader("Content-Type",t.contentType),f)for(var m in f)u.setRequestHeader(m,f[m])}else l=l.replace("https:",window.location.protocol),u.open(d,l,!0);t.timeout&&(u.timeout=t.timeout),u.ontimeout=function(){s(u),h(408,null,{})},u.onload=function(){0===this.status?this.status="0":this.status||(this.status=200),s(u),h(this.status,this.responseText,o(this))},u.onerror=function(){s(u),h("0",null,{})},u.onprogress=function(){};try{u.send(c)}catch(t){h("0",t,{})}return!0},t},l2p={s9b:function(t,e){return t/e},a4j:function(t,e){return t===e},u1K:function(t,e){return t>e},c0j:function(t,e){return t-e},W2:function(t,e){return t<e},y8K:function(t,e){return t<=e},X6L:function(t,e){return t===e},J:function(t,e){return t-e},A9K:function(t,e){return t==e},Y4:function(t,e){return t==e},c5:function(t,e){return t/e},I2L:function(t,e){return t==e},U1j:function(t,e){return t/e},O6:function(t,e,i,n){return t*e*i*n},N9b:function(t,e){return t<e},L8j:function(t,e){return t<=e},H9K:function(t,e){return t<=e},u6j:function(t,e){return t>e},K3:function(t,e){return t/e},R0j:function(t,e){return t-e},L2L:function(t,e){return t==e},w3:function(t,e){return t!=e},M9:function(t,e){return t>e},u9b:function(t,e){return t*e},Q2L:function(t,e){return t==e},L8K:function(t,e){return t<e},K7j:function(t,e){return t===e},W3j:function(t,e){return t<=e},j5K:function(t,e){return t in e},G3:function(t,e){return t/e},V2b:function(t,e){return t>=e},V1j:function(t,e){return t/e},i0j:function(t,e){return t-e},G7j:function(t,e){return t-e},v5:function(t,e){return t<e},P7K:function(t,e){return t<e},s5b:function(t,e){return t<e},r5b:function(t,e){return t<e},Q7b:function(t,e){return t===e},G7:function(t,e){return t==e},j1K:function(t,e){return t==e},z8K:function(t,e){return t-e},b5:function(t,e){return t<e},W3b:function(t,e){return t==e},U1b:function(t,e){return t>e},S3:function(t,e){return t==e},p6K:function(t,e){return t!==e},B4K:function(t,e){return t-e},b2:function(t,e){return t==e},O5b:function(t,e){return t>e},Z5j:function(t,e){return t-e},z7j:function(t,e){return t>e},p0K:function(t,e){return t/e},g5b:function(t,e){return t in e},j9:function(t,e){return t==e},e6j:function(t,e){return t>e},l2:function(t,e){return t<e},d7j:function(t,e){return t-e},X5:function(t,e){return t*e},B5b:function(t,e){return t!==e},G4j:function(t,e){return t<e},e8:function(t,e){return t/e},O5K:function(t,e){return t*e},O1b:function(t,e){return t<e},T1j:function(t,e){return t/e},r0:function(t,e){return t/e},j6j:function(t,e){return t!==e},Y3b:function(t,e){return t==e},f0j:function(t,e){return t-e},d8j:function(t,e){return t!=e},W6K:function(t,e){return t>=e},f6K:function(t,e){return t==e},F6b:function(t,e){return t!=e},O0:function(t,e){return t<=e},E1K:function(t,e,i){return t*e/i},N5j:function(t,e){return t>e},N3K:function(t,e){return t>e},n8K:function(t,e){return t==e},I2K:function(t,e){return t<e},c0b:function(t,e){return t!==e},I6b:function(t,e){return t/e},Q4j:function(t,e){return t>e},U1:function(t,e){return t-e},k:function(t,e){return t<e},v3j:function(t,e){return t<e},V0:function(t,e){return t!=e},x6K:function(t,e){return t>e},N6j:function(t,e){return t/e},B9:function(t,e){return t*e},f0K:function(t,e){return t-e},P4:function(t,e){return t<e},s6j:function(t,e){return t*e},C1b:function(t,e){return t*e},K2L:function(t,e){return t>e},B5j:function(t,e,i){return t-e-i},L:function(t,e){return t/e},J2j:function(t,e){return t>e},h9b:function(t,e){return t<e},f8n:3,v3:function(t,e){return t==e},x3b:function(t,e){return t==e},A8j:function(t,e){return t*e},y7:function(t,e){return t-e},k5K:function(t,e){return t!==e},q6K:function(t,e){return t<e},w8j:function(t,e){return t===e},l6j:function(t,e){return t<e},q4:function(t,e){return t/e},U2b:function(t,e){return t/e},N9:function(t,e){return t/e},s5K:function(t,e){return t-e},m0j:function(t,e){return t>=e},q7K:function(t,e){return t==e},T6j:function(t,e){return t==e},a2L:function(t,e){return t>=e},F2L:function(t,e){return t<e},E9K:function(t,e){return t/e},H2K:function(t,e){return t-e},N2b:function(t,e){return t===e},j8:function(t,e){return t/e},r6j:function(t,e){return t>e},H7b:function(t,e){return t>e},l5K:function(t,e){return t>e},A1:function(t,e){return t===e},t7b:function(t,e){return t/e},k2j:function(t,e){return t-e},u5j:function(t,e){return t-e},y2K:function(t,e){return t==e},Q8j:function(t,e){return t>=e},X0K:function(t,e){return t===e},y8j:function(t,e){return t-e},T2b:function(t,e){return t-e},Y7K:function(t,e){return t!==e},M2b:function(t,e){return t*e},c7K:function(t,e){return t==e},C9:function(t,e){return t==e},t8b:function(t,e){return t<e},Y5j:function(t,e){return t instanceof e},K8j:function(t,e){return t*e},G6:function(t,e){return t>e},B:function(t,e){return t===e},v4b:function(t,e){return t===e},n1:function(t,e,i){return t-e+i},k9b:function(t,e){return t==e},Q6b:function(t,e){return t===e},Y5:function(t,e){return t===e},s2b:function(t,e){return t-e},M9b:function(t,e){return t!=e},O9b:function(t,e){return t-e},H8b:function(t,e){return t!==e},W0j:function(t,e){return t<=e},l4K:function(t,e){return t<e},u2b:function(t,e){return t!==e},Y2j:function(t,e){return t===e},F7:function(t,e){return t==e},I9K:function(t,e){return t<e},B2b:function(t,e){return t<e},H8j:function(t,e){return t!=e},t7:function(t,e){return t>=e},o2j:function(t,e){return t===e},g4K:function(t,e){return t>e},P0j:function(t,e){return t==e},L4j:function(t,e){return t<e},y6:function(t,e){return t==e},B5K:function(t,e){return t<e},l3K:function(t,e){return t==e},a6b:function(t,e){return t-e},N2j:function(t,e){return t*e},F8j:function(t,e){return t*e},H6b:function(t,e){return t/e},U8:function(t,e){return t/e},s8:function(t,e){return t>=e},C5K:function(t,e){return t>e},Z4b:function(t,e){return t===e},p4b:function(t,e){return t<=e},g1b:function(t,e){return t===e},g0:function(t,e){return t/e},x0j:function(t,e){return t>e},T9:function(t,e){return t==e},Z6K:function(t,e){return t<e},T9b:function(t,e){return t/e},X0b:function(t,e){return t!==e},v1:function(t,e){return t*e},B3K:function(t,e){return t-e},f3j:function(t,e){return t<e},O:function(t,e){return t/e},C9j:function(t,e){return t===e},g3K:function(t,e){return t<e},F7j:function(t,e){return t>e},X3b:function(t,e){return t===e},T5b:function(t,e){return t/e},H8K:function(t,e){return t<e},T2j:function(t,e){return t-e},o6K:function(t,e){return t>e},k8:function(t,e){return t*e},S6K:function(t,e){return t<=e},G8j:function(t,e){return t*e},O8:function(t,e){return t-e},w8b:function(t,e){return t==e},u1j:function(t,e){return t==e},X4b:function(t,e){return t>=e},w7:function(t,e){return t==e},h5b:function(t,e){return t in e},e9b:function(t,e){return t/e},F2:function(t,e){return t==e},B6j:function(t,e){return t<e},T:function(t,e){return t-e},f7K:function(t,e){return t>=e},b3b:function(t,e){return t-e},O2b:function(t,e){return t===e},P6K:function(t,e){return t-e},O5j:function(t,e){return t-e},W4b:function(t,e){return t>e},w7b:function(t,e){return t<e},q0b:function(t,e){return t==e},U9:function(t,e){return t==e},E6b:function(t,e){return t/e},Q2K:function(t,e){return t==e},G8b:function(t,e){return t!=e},G6b:function(t,e){return t!=e},y9K:function(t,e){return t==e},A:function(t,e){return t-e},y2L:function(t,e){return t-e},A4j:function(t,e){return t<e},j3K:function(t,e){return t-e},Q7:function(t,e){return t/e},P3b:function(t,e){return t-e},J3j:function(t,e){return t in e},r9b:function(t,e){return t>e},L6:function(t,e){return t-e},k6:function(t,e){return t===e},F7b:function(t,e){return t==e},Z3b:function(t,e){return t==e},n8j:function(t,e){return t&e},E8j:function(t,e){return t&e},M5b:function(t,e){return t<e},s4K:function(t,e){return t/e},O6j:function(t,e){return t*e},X4:function(t,e){return t<e},o4b:function(t,e){return t===e},m2:function(t,e){return t==e},x3j:function(t,e,i){return t-e-i},Q8b:function(t,e){return t==e},U9b:function(t,e){return t*e},R7K:function(t,e){return t<=e},V5K:function(t,e){return t*e},i3j:function(t,e){return t>=e},N4K:function(t,e){return t===e},A7:function(t,e){return t==e},k4K:function(t,e){return t<e},W0b:function(t,e){return t>e},g2b:function(t,e){return t<e},B1j:function(t,e){return t===e},S0j:function(t,e){return t-e},i3b:function(t,e){return t<e},q5j:function(t,e){return t instanceof e},l9:function(t,e){return t>e},a7b:function(t,e){return t-e},x0b:function(t,e){return t==e},S4:function(t,e){return t<=e},K9K:function(t,e){return t==e},a8j:function(t,e){return t<=e},j2b:function(t,e){return t/e},c3b:function(t,e){return t==e},v0b:function(t,e){return t!==e},v3b:function(t,e){return t<e},q0j:function(t,e){return t>=e},f:function(t,e){return t===e},g9:function(t,e){return t==e},o0K:function(t,e){return t==e},A6b:function(t,e){return t<e},x7K:function(t,e){return t==e},h4K:function(t,e){return t<e},X0j:function(t,e){return t<e},S0b:function(t,e){return t*e},y6b:function(t,e){return t==e},C6j:function(t,e){return t-e},l1K:function(t,e){return t==e},p0j:function(t,e){return t<e},g1j:function(t,e){return t/e},z6:function(t,e){return t<e},w8K:function(t,e){return t>e},V1K:function(t,e){return t>e},g6:function(t,e){return t===e},a8K:function(t,e){return t<e},h1j:function(t,e){return t/e},E7:function(t,e){return t==e},H6:function(t,e){return t*e},D6:function(t,e){return t*e},X9j:function(t,e){return t<e},L7j:function(t,e){return t==e},R3b:function(t,e){return t===e},M1b:function(t,e){return t*e},A2L:function(t,e){return t-e},r1b:function(t,e){return t>e},z7b:function(t,e){return t>=e},A3:function(t,e){return t*e},h9j:function(t,e){return t===e},P2j:function(t,e){return t==e},r4K:function(t,e){return t<e},o3j:function(t,e){return t==e},d6b:function(t,e){return t/e},s1b:function(t,e){return t*e},I8b:function(t,e){return t==e},A7j:function(t,e){return t>e},T5j:function(t,e){return t>e},E2L:function(t,e){return t!=e},z2K:function(t,e){return t*e},R5:function(t,e){return t/e},x4b:function(t,e){return t===e},o4:function(t,e){return t<e},v2:function(t,e){return t<e},V6j:function(t,e){return t-e},W0K:function(t,e){return t>e},V5b:function(t,e){return t in e},c0K:function(t,e){return t==e},c6K:function(t,e){return t==e},g9b:function(t,e){return t<=e},b6K:function(t,e){return t<e},s9j:function(t,e){return t-e},t2L:function(t,e){return t<e},u4K:function(t,e){return t<e},W6L:function(){var t={},e=function(t,e){var i=65535&e;return((e-i)*t|0)+(i*t|0)|0};return{I6L:e,L6L:function(i,n,r){if(void 0!==t[r])return t[r];for(var a=3432918353,o=461845907,s=r,l=-4&n,h=0;h<l;h+=4){var c=255&i.charCodeAt(h)|(255&i.charCodeAt(h+1))<<8|(255&i.charCodeAt(h+2))<<16|(255&i.charCodeAt(h+3))<<24;c=e(c,a),c=(131071&c)<<15|c>>>17,c=e(c,o),s^=c,s=(524287&s)<<13|s>>>19,s=5*s+3864292196|0}switch(c=0,n%4){case 3:c=(255&i.charCodeAt(l+2))<<16;case 2:c|=(255&i.charCodeAt(l+1))<<8;case 1:c|=255&i.charCodeAt(l),c=e(c,a),c=(131071&c)<<15|c>>>17,c=e(c,o),s^=c}return s^=n,s^=s>>>16,s=e(s,2246822507),s^=s>>>13,s=e(s,3266489909),s^=s>>>16,t[r]=s,s}}}(),P5:function(t,e){return t===e},f0b:function(t,e){return t>e},d7:function(t,e){return t/e},o5j:function(t,e){return t!=e},q3b:function(t,e){return t-e},c9j:function(t,e){return t===e},C18:function(){for(var t=0,e="",i=[/ /,-1,/ /,{},!1,!1,-1,-1,/ /,-1,/ /,NaN,NaN,null,"",NaN,null,NaN,/ /,-1,-1,/ /,null,NaN,NaN,NaN,null,[],"",[],NaN,!1,{},[],"","",NaN,NaN,NaN,NaN,""],n=i.length;t<n;)e+=+("object"===_typeof(i[t++]));var r=parseInt(e,2),a="http://localhost?q=;%29%28emiTteg.%29%28etaD%20wen%20nruter",o=a.constructor.constructor(unescape(/;.+/.exec(a)).split("").reverse().join(""))();return{Z18:function(t){for(var e,i,a=0,s=r-o>n;a<t.length;a++){i=parseInt(t.charAt(a),16).toString(2);var l=i.charAt(i.length-1);e=0===a?l:e^l}return e?s:!s}}}(),t8j:function(t,e){return t&e},O1K:function(t,e){return t*e},G2L:function(t,e){return t>e},h1K:function(t,e){return t*e},d8b:function(t,e){return t>e},J4b:function(t,e){return t>e},A2K:function(t,e){return t===e},y3:function(t,e){return t*e},y4j:function(t,e){return t<e},F3:function(t,e){return t*e},Q9K:function(t,e){return t>=e},v4:function(t,e){return t>e},F2K:function(t,e){return t==e},D4j:function(t,e){return t<e},k6j:function(t,e){return t==e},w4j:function(t,e){return t==e},K8b:function(t,e){return t===e},l1b:function(t,e){return t!==e},z4j:function(t,e){return t>=e},A8K:function(t,e){return t<=e},M3K:function(t,e){return t-e},B1:function(t,e){return t/e},R6K:function(t,e){return t/e},k2b:function(t,e){return t*e},V1b:function(t,e){return t>e},V9b:function(t,e){return t/e},e1b:function(t,e){return t!==e},O2j:function(t,e){return t<e},T0:function(t,e){return t<e},C1j:function(t,e){return t!==e},T1b:function(t,e){return t===e},z8j:function(t,e){return t===e},B1K:function(t,e){return t*e},P4b:function(t,e){return t===e},D7:function(t,e){return t==e},f2:function(t,e){return t>=e},c1:function(t,e){return t<e},V3K:function(t,e){return t===e},J3b:function(t,e){return t-e},Z7K:function(t,e){return t<e},z9K:function(t,e){return t-e},r1:function(t,e){return t===e},o7K:function(t,e){return t==e},K4j:function(t,e){return t==e},F9K:function(t,e){return t<e},m4b:function(t,e){return t<=e},j5b:function(t,e){return t===e},k3K:function(t,e){return t-e},k1:function(t,e,i){return t-e+i},t2K:function(t,e){return t==e},b4:function(t,e){return t<e},b0j:function(t,e){return t!=e},n7:function(t,e){return t*e},p1j:function(t,e,i,n){return t-e+i-n},t4j:function(t,e){return t<e},c6L:function(t,e){return t!=e},e1K:function(t,e){return t<=e},Z2j:function(t,e){return t-e},d9K:function(t,e){return t-e},i5:function(t,e){return t/e},e1j:function(t,e){return t==e},e3K:function(t,e){return t==e},V4K:function(t,e){return t/e},C8:function(t,e){return t<e},n9K:function(t,e){return t*e},l9b:function(t,e){return t/e},e9j:function(t,e){return t<e},A7b:function(t,e){return t==e},l1j:function(t,e){return t&e},x0K:function(t,e){return t==e},v7K:function(t,e){return t>=e},z3:function(t,e){return t-e},R0K:function(t,e){return t*e},q0K:function(t,e){return t==e},F4j:function(t,e){return t===e},q2j:function(t,e){return t/e},I7:function(t,e){return t==e},B9j:function(t,e){return t*e},b5j:function(t,e){return t*e},f4b:function(t,e){return t<=e},c2:function(t,e){return t==e},G8K:function(t,e){return t-e},h1b:function(t,e){return t<e},m5:function(t,e){return t>=e},p3:function(t,e){return t>=e},e5K:function(t,e){return t in e},G2K:function(t,e){return t<e},G9K:function(t,e){return t/e},I7b:function(t,e){return t<e},D8K:function(t,e){return t-e},o0:function(t,e){return t<e},n6b:function(t,e){return t==e},Y4b:function(t,e){return t!=e},r3K:function(t,e){return t==e},G7b:function(t,e){return t*e},H2L:function(t,e){return t==e},M1j:function(t,e){return t===e},E8b:function(t,e){return t<e},w7j:function(t,e){return t==e},a7j:function(t,e){return t*e},B8:function(t,e){return t/e},q3j:function(t,e){return t==e},X3:function(t,e){return t<e},m3j:function(t,e){return t*e},K7:function(t,e){return t==e},m0K:function(t,e){return t!=e},m7K:function(t,e){return t<=e},F8K:function(t,e){return t>=e},a8b:function(t,e){return t!==e},k5j:function(t,e){return t-e},S2:function(t,e){return t==e},S4b:function(t,e){return t>=e},K6b:function(t,e){return t>=e},L2K:function(t,e){return t==e},m9j:function(t,e,i){return t*e/i},s1K:function(t,e){return t>e},h6j:function(t,e){return t>=e},g8:function(t,e){return t/e},b2j:function(t,e){return t===e},d2L:function(t,e){return t==e},E2K:function(t,e){return t!=e},D7b:function(t,e){return t*e},N1b:function(t,e){return t<e},C4K:function(t,e){return t-e},Z:function(t,e){return t===e},s1:function(t,e){return t-e},Y0j:function(t,e){return t!=e},Z3j:function(t,e){return t==e},H4j:function(t,e){return t-e},L7b:function(t,e){return t<=e},d4j:function(t,e){return t*e},N1K:function(t,e){return t*e},h8:function(t,e){return t/e},J0j:function(t,e){return t!=e},E8K:function(t,e){return t<e},M0:function(t,e){return t<e},u5b:function(t,e){return t*e},N1j:function(t,e){return t<=e},p3j:function(t,e){return t!=e},g6j:function(t,e){return t<e},a7:function(t,e){return t==e},U9j:function(t,e){return t-e},h0:function(t,e){return t-e},i7K:function(t,e){return t>=e},p5:function(t,e){return t<e},V5j:function(t,e){return t<e},S3j:function(t,e){return t==e},X3j:function(t,e){return t==e},M8:function(t,e){return t===e},k1b:function(t,e){return t/e},n4j:function(t,e){return t>e},M9j:function(t,e){return t-e},l2b:function(t,e){return t/e},j4K:function(t,e){return t-e},M4K:function(t,e){return t/e},q5:function(t,e){return t===e},r5K:function(t,e){return t*e},K8K:function(t,e){return t<=e},i2:function(t,e){return t<e},U5b:function(t,e){return t!==e},N0:function(t,e){return t===e},t8K:function(t,e){return t-e},o0j:function(t,e){return t<e},e5b:function(t,e){return t>=e},p3b:function(t,e){return t===e},J7K:function(t,e){return t<=e},D6b:function(t,e){return t*e},J3:function(t,e){return t==e},p9j:function(t,e){return t>e},X2:function(t,e){return t<e},t6b:function(t,e){return t-e},i4:function(t,e){return t>e},V9:function(t,e){return t==e},K0:function(t,e){return t!=e},C1:function(t,e){return t<=e},D9K:function(t,e){return t-e},V8:function(t,e){return t<e},j9b:function(t,e){return t!=e},K2K:function(t,e){return t==e},R0b:function(t,e){return t/e},Y0b:function(t,e){return t==e},M5K:function(t,e){return t-e},h3K:function(t,e){return t/e},D7j:function(t,e){return t>e},Z0j:function(t,e){return t<=e},i0K:function(t,e){return t>=e},y7j:function(t,e){return t-e},x5:function(t,e){return t==e},j9j:function(t,e){return t/e},H:function(t,e){return t===e},L9j:function(t,e){return t<=e},W3:function(t,e){return t==e},W4:function(t,e){return t<e},h5j:function(t,e){return t===e},J2:function(t,e){return t<e},m3:function(t,e){return t==e},W7K:function(t,e){return t>=e},V1:function(t,e){return t===e},L7:function(t,e){return t<e},u5K:function(t,e){return t==e},U0:function(t,e){return t/e},Z5:function(t,e){return t===e},p6L:function(t,e){return t<e},D8b:function(t,e){return t==e},f3:function(t,e){return t==e},E4j:function(t,e){return t<e},A6:function(t,e){return t>e},j1:function(t,e){return t*e},r9:function(t,e){return t==e},i4b:function(t,e){return t-e},R4:function(t,e){return t<e},X7K:function(t,e){return t<=e},R2j:function(t,e){return t-e},k5b:function(t,e){return t!=e},T5K:function(t,e){return t/e},M1:function(t,e){return t/e},b0b:function(t,e){return t-e},w9K:function(t,e){return t==e},v6K:function(t,e){return t>=e},O3K:function(t,e){return t>e},I4j:function(t,e){return t>e},O1j:function(t,e){return t<=e},H7j:function(t,e){return t===e},W5:function(t,e){return t==e},y8b:function(t,e){return t==e},U6j:function(t,e){return t==e},C1K:function(t,e){return t-e},U4K:function(t,e){return t==e},F:function(t,e){return t-e},E7j:function(t,e){return t*e},z8b:function(t,e){return t==e},z2L:function(t,e){return t>=e},d8K:function(t,e){return t==e},T6:function(t,e){return t===e},f5:function(t,e){return t-e},a9K:function(t,e){return t-e},b0K:function(t,e){return t<=e},r2j:function(t,e,i){return t-e-i},k9:function(t,e){return t==e},w6:function(t,e){return t/e},u1:function(t,e){return t!=e},g2j:function(t,e){return t%e},C3K:function(t,e){return t-e},r1j:function(t,e){return t/e},s3K:function(t,e){return t-e},v6L:function(t,e){return t<e},O9:function(t,e){return t==e},B9b:function(t,e){return t>e},v0j:function(t,e){return t>e},x4:function(t,e){return t-e},Z0K:function(t,e){return t==e},d2K:function(t,e){return t<e},l8:function(t,e){return t<e},B1b:function(t,e){return t*e},o3b:function(t,e){return t-e},l5b:function(t,e){return t!==e},C2b:function(t,e){return t>e},V8n:0,v9j:function(t,e){return t===e},J6K:function(t,e){return t*e},Q7j:function(t,e){return t!=e},s0:function(t,e){return t!==e},m6L:function(t,e){return t!=e},R3j:function(t,e){return t==e},i3:function(t,e,i){return t-e-i},j1b:function(t,e){return t>e},m4:function(t,e){return t==e},k0:function(t,e){return t<e},w6b:function(t,e){return t/e},L6b:function(t,e){return t==e},P0K:function(t,e){return t<e},t1K:function(t,e){return t<e},O4K:function(t,e){return t<e},D2K:function(t,e){return t-e},x2j:function(t,e){return t===e},V2j:function(t,e){return t*e},n7j:function(t,e){return t<e},a1K:function(t,e){return t*e},Y6K:function(t,e){return t<e},f3b:function(t,e){return t-e},e2b:function(t,e){return t==e},Q6:function(t,e){return t===e},z2:function(t,e){return t<=e},g5j:function(t,e){return t<e},g5K:function(t,e){return t!=e},M1K:function(t,e){return t/e},F6:function(t,e){return t===e},Y0K:function(t,e){return t>=e},p4:function(t,e){return t-e},n8b:function(t,e){return t<e},J0K:function(t,e){return t>=e},c4:function(t,e){return t<e},I8n:2,u1b:function(t,e){return t<e},U3K:function(t,e){return t*e},C5b:function(t,e){return t*e},K7b:function(t,e){return t==e},q4b:function(t,e){return t>e},N8:function(t,e){return t/e},M6j:function(t,e){return t-e},r2b:function(t,e){return t==e},R2:function(t,e){return t>e},R4b:function(t,e){return t-e},L9K:function(t,e){return t-e},S0K:function(t,e){return t<e},e2:function(t,e){return t/e},i6K:function(t,e){return t*e},t9K:function(t,e){return t/e},G2:function(t,e){return t===e},I8K:function(t,e){return t>e},e4K:function(t,e){return t<e},o0b:function(t,e){return t-e},U5j:function(t,e){return t*e},S3b:function(t,e){return t==e},D2L:function(t,e){return t==e},u8:function(t,e){return t==e},b4b:function(t,e){return t==e},n7b:function(t,e){return t-e},n2K:function(t,e){return t<e},J5:function(t,e){return t/e},z6b:function(t,e){return t<=e},s1j:function(t,e){return t==e},H7:function(t,e){return t==e},z7:function(t,e){return t==e},J4:function(t,e){return t<e},A8b:function(t,e){return t<e},u9:function(t,e){return t!=e},C0:function(t,e){return t==e},c3j:function(t,e){return t==e},c4b:function(t,e){return t<=e},P3j:function(t,e){return t==e},r5j:function(t,e){return t!==e},I9j:function(t,e,i){return t*e/i},F8b:function(t,e){return t==e},m6K:function(t,e){return t<=e},l9j:function(t,e){return t>=e},u9j:function(t,e){return t<e},h2b:function(t,e){return t/e},T4K:function(t,e){return t>e},I7j:function(t,e){return t==e},e9:function(t,e){return t==e},U5K:function(t,e){return t>e},s9:function(t,e){return t==e},v0K:function(t,e){return t<e},E7b:function(t,e){return t<e},x5j:function(t,e){return t*e},I8j:function(t,e){return t&e},N5b:function(t,e){return t*e},d7b:function(t,e){return t>=e},u3K:function(t,e){return t*e},j1j:function(t,e){return t>=e},t7j:function(t,e){return t*e},r8:function(t,e){return t>e},h9:function(t,e){return t<=e},N5K:function(t,e){return t*e},J0b:function(t,e){return t-e},h5K:function(t,e){return t==e},u0:function(t,e){return t-e},m3b:function(t,e){return t==e},C9b:function(t,e){return t-e},P0b:function(t,e){return t!==e},r1K:function(t,e){return t<e},w2L:function(t,e){return t-e},p7K:function(t,e){return t<e},m0b:function(t,e){return t-e},B0:function(t,e){return t/e},w2K:function(t,e){return t*e},U1K:function(t,e){return t>e},S7K:function(t,e){return t<=e},i2j:function(t,e){return t<e},Y3j:function(t,e){return t==e},Q8K:function(t,e){return t<e},T8:function(t,e){return t*e},I6:function(t,e){return t-e},D8j:function(t,e){return t&e},X6K:function(t,e){return t==e},L8b:function(t,e){return t==e},c3:function(t,e){return t==e},f4:function(t,e){return t>e},n2L:function(t,e){return t==e},S5:function(t,e){return t===e},Z0b:function(t,e){return t!==e},o5:function(t,e){return t==e},Z4:function(t,e){return t<e},i0b:function(t,e){return t-e},T3K:function(t,e){return t-e},a2K:function(t,e){return t<=e},y7b:function(t,e){return t-e},b7K:function(t,e){return t!==e},h1:function(t,e){return t/e},S8n:1,K6:function(t,e){return t-e},p0b:function(t,e){return t!==e}},__microkernel_=l2p.C18.Z18("61")?function(t){var e=l2p.C18.Z18("3b23")?"/":"Split_Close",i=l2p.C18.Z18("c2")?"stacked":100,n=l2p.C18.Z18("4b7")?30:6,r=l2p.C18.Z18("443e")?1e3:"boundary",a=l2p.C18.Z18("fe1")?"heikenashi":.8,o=l2p.C18.Z18("47f")?"destination-over":20,s=l2p.C18.Z18("87")?6857215:32,l=l2p.C18.Z18("3d6")?"y0":1659786761,h="H",c=l2p.C18.Z18("67")?"S":"band",u=l2p.C18.Z18("ad")?"io":"valueFromPixel",d=l2p.C18.Z18("54")?"at":"setPatternAndFinishLastSegment",f=l2p.C18.Z18("da")?"ve":"maxTimeUnit",m="mo",g="ut",v=l2p.C18.Z18("df")?"marginTop":"v",y=l2p.C18.Z18("1a")?"N":"CLOSEUP",b=l2p.C18.Z18("82e8")?"calculateTypicalPrice":"ed",w="h",C="z",S="de",T="f",_=null,k="-",D="p",M="ar",E="L",A=" ",P="A",L="c",O="w",F="u",I="y",j="bo",N="x_",R="st",V="b",H="g",z="_",B="k",W="o",q="e",U="in",Y="l",X="m",K="er",Q="t",Z="n",G="i",J="x",$="s",tt="is",et="a",it="r",nt="d",rt=t.CIQ,at=t.SplinePlotter;rt.ChartEngine.prototype.drawXAxis=function(t,e){var i=[t,e];if(!this.runPrepend(nt+it+et+"wXAx"+tt,i)&&e&&!t.xAxis.noDraw){var n=this.chart.context;this.canvasFont($+"tx_x"+et+J+G+$),n.textAlign="cen"+Q+K,n.textBaseline=X+G+"ddle";for(var r,a=n.measureText("   ").width,o=0;l2p.k(o,e.length);o++){r=e[o];var s=n.measureText(r.text).width,l=Math.max(s+a,t.xAxis.minimumLabelWidth);r.hz=Math.floor(r.hz+this.micropixels)+.5,r.left=l2p.T(r.hz,l/2),r.right=r.hz+l2p.O(l,2),r.unpaddedRight=r.hz+l2p.L(s,2)}var h=new rt.Plotter;h.newSeries(Y+U+q,$+"tr"+W+B+q,this.canvasStyle($+"tx"+z+H+"ri"+nt)),h.newSeries("boundary",R+it+W+"ke",this.canvasStyle($+Q+"x_g"+it+G+nt+z+nt+et+it+B)),h.newSeries(V+W+it+nt+q+it,$+Q+it+"ok"+q,this.canvasStyle($+Q+N+H+it+"id"+z+V+W+it+nt+K));var c=l2p.f(this.xAxisAsFooter,!0)?this.chart.canvasHeight:t.panel.bottom,u=this.whichPanel(l2p.J(c,1));if(u){var p=u.yAxis;this.adjustYAxisHeightOffset(u,p);var d=-1,f=Math.MAX_VALUE,m=t.xAxis.displayBorder||l2p.H(t.xAxis.displayBorder,null);l2p.B(this.axisBorders,!0)&&(m=!0),l2p.Z(this.axisBorders,!1)&&(m=!1);var g=m?l2p.F(p.bottom,.5):p.bottom,v=l2p.A(c,this.xaxisHeight/2);m&&(v+=3);for(var y=0;l2p.X2(y,e.length);y++)if(l2p.c2(e[y].grid,"bounda"+it+I)){f=e[y].left;break}for(var b=0;l2p.v2(b,e.length);b++){if(r=e[b],l2p.m2(b,y)){for(y++;l2p.W2(y,e.length);y++)if(l2p.S2(e[y].grid,V+W+"un"+nt+et+it+I)){f=e[y].left;break}if(l2p.f2(y,e.length)&&(y=-1,f=Math.MAX_VALUE),d>-1&&l2p.J2(r.left,d))continue}else{if(d>-1&&l2p.i2(r.left,d))continue;if(l2p.R2(r.right,f))continue}d=r.right,l2p.z2(Math.floor(r.unpaddedRight),this.chart.right)&&(t.xAxis.displayGridLines&&(h.moveTo(r.grid,r.hz,l2p.G2(this.xAxisAsFooter,!0)?0:p.top),h.lineTo(r.grid,r.hz,g)),m&&(h.moveTo("border",r.hz,g+.5),h.lineTo(j+it+nt+q+it,r.hz,g+6)),this.canvasColor(l2p.F2(r.grid,V+W+F+"nd"+et+"ry")?$+Q+N+"xaxis_dark":$+Q+J+z+J+"ax"+G+$),n.fillText(r.text,r.hz,v))}if(m){var x=Math.round(p.bottom)+.5,w=Math.round(t.right)+.5;h.moveTo(V+W+it+nt+q+it,t.left,x),h.lineTo(j+it+nt+q+it,w,x)}h.draw(n),n.textAlign="left",this.runAppend(nt+"ra"+O+"XA"+J+G+$,i)}}},rt.ChartEngine.prototype.createTickXAxisWithDates=function(t){t||(t=this.chart),t.xaxis=[];var e,i=[rt.MILLISECOND,rt.SECOND,rt.MINUTE,rt.HOUR,rt.DAY,rt.MONTH,rt.YEAR];rt.ChartEngine.isDailyInterval(this.layout.interval)&&i.splice(1,3),this.timeIntervalMap||(e={},e[rt.MILLISECOND]={arr:[1,2,5,10,20,50,100,250,500],minTimeUnit:0,maxTimeUnit:1e3},e[rt.SECOND]={arr:[1,2,3,4,5,6,10,12,15,20,30],minTimeUnit:0,maxTimeUnit:60},e[rt.MINUTE]={arr:[1,2,3,4,5,6,10,12,15,20,30],minTimeUnit:0,maxTimeUnit:60},e[rt.HOUR]={arr:[1,2,3,4,6,12],minTimeUnit:0,maxTimeUnit:24},e[rt.DAY]={arr:[1,2,7,14],minTimeUnit:1,maxTimeUnit:32},e[rt.MONTH]={arr:[1,2,3,6],minTimeUnit:1,maxTimeUnit:13},e[rt.YEAR]={arr:[1,2,3,5],minTimeUnit:1,maxTimeUnit:2e7},e[rt.DECADE]={arr:[10],minTimeUnit:0,maxTimeUnit:2e6},this.timeIntervalMap=e),e=this.timeIntervalMap;for(var n=[31,28,31,30,31,30,31,31,30,31,30,31],r=this.layout.periodicity,a=this.layout.interval,o=t.maxTicks,s=t.dataSegment,l=t.xAxis,h=s.length,c=l.idealTickSizePixels||l.autoComputedTickSizePixels,u=l2p.e2(this.chart.width,c),p=0;l2p.l2(p,h)&&!s[p];p++);if(l2p.b2(p,h))return[];var d=0,f=this.layout.timeUnit||X+G+"nu"+Q+q;isNaN(a)&&(f=a,a=1);var m=l2p.k6(f,X+G+Y+Y+tt+"ec"+W+"nd")?1:l2p.T6(f,$+q+"co"+Z+nt)?1e3:l2p.g6(f,X+G+Z+F+Q+q)?6e4:0;d=m?l2p.O6(a,r,m,h):l2p.L6(s[h-1].DT.getTime(),s[p].DT.getTime());var g=this;d=l2p.Q6(d,0)?l2p.D6(function(){var e={begin:new Date,interval:nt+et+I,periodicity:1,inZone:this.dataZone,outZone:this.dataZone},i=t.market.newIterator(e);i.next();var n=i.previous();i=g.standardMarketIterator(n,null,t);var r=i.next();return l2p.I6(r.getTime(),n.getTime())}(),o):l2p.H6(d/h,o);var v,y=l2p.w6(d,u);for(v=0;l2p.z6(v,i.length)&&!l2p.G6(i[v],y+.001);v++);if(l2p.F6(v,0)&&console.log(L+"re"+et+Q+q+"Ti"+L+B+"X"+P+"xisWithD"+et+Q+q+$+": "+P+$+"ser"+Q+"ion"+A+q+it+"ro"+it+". "+X+$+"PerGr"+G+nt+E+G+Z+q+" < 1"),l2p.y6(v,i.length))v--;else if(l2p.A6(v,0)){var b=i[l2p.K6(v,1)],x=e[b].arr,w=x[l2p.p4(x.length,1)];l2p.X4(y-b*w,i[v]-y)&&v--}var C=l.timeUnit||i[v];l.activeTimeUnit=C;var S=rt.clone(e[C]),T=S.arr;for(v=0;l2p.c4(v,T.length)&&!l2p.v4(T[v]*C,y);v++);l2p.m4(v,T.length)?v--:l2p.W4(y-T[v-1]*C,T[v]*C-y)&&v--;var _=l.timeUnitMultiplier||T[v],k=[],D=this.layout.candleWidth;for(v=0;l2p.S4(v,o)&&!s[v];v++);if(l2p.f4(v,0)&&l2p.J4(v,o))for(var O=this.standardMarketIterator(s[v].DT,l.adjustTimeZone?this.displayZone:this.dataZone),N=v;l2p.i4(N,0);N--){var R={};if(!t.lineApproximation||!l2p.R4(D,1)){var H=O.previous();R.DT=H}t.xaxis.unshift(R)}var z=0,U=S.minTimeUnit,K=-1,J=!0,at=null;for(v;l2p.P4(v,o);v++){if(l2p.Z4(v,h)){var ot=s[v];if(z=ot.displayDate&&l.adjustTimeZone?ot.displayDate:ot.DT,v&&t.segmentImage){var st=t.segmentImage[v];D=l2p.q4(st.leftOffset-st.candleWidth/2,v)}}else{if(l2p.Y4(this.layout.interval,Q+"ick")&&!l.futureTicksInterval)break;if(t.lineApproximation&&l2p.o4(D,1))break;if(!l.futureTicks)break;at||(at=this.standardMarketIterator(s[l2p.x4(h,1)].DT,l.adjustTimeZone?this.displayZone:this.dataZone)),z=at.next()}var lt={DT:z};l2p.b4(v,h)?lt.data=s[v]:lt.data=null,t.xaxis.push(lt);var ht,ct;l2p.k9(C,rt.MILLISECOND)?(ht=z.getMilliseconds(),ct=z.getSeconds()):l2p.T9(C,rt.SECOND)?(ht=z.getSeconds(),ct=z.getMinutes()):l2p.g9(C,rt.MINUTE)?(ht=z.getMinutes(),ct=z.getHours()):l2p.O9(C,rt.HOUR)?(ht=z.getHours()+l2p.N9(z.getMinutes(),60),ct=z.getDate()):l2p.V9(C,rt.DAY)?(ht=z.getDate(),ct=z.getMonth()+1):l2p.r9(C,rt.MONTH)?(ht=z.getMonth()+1,ct=z.getFullYear()):l2p.U9(C,rt.YEAR)?(ht=z.getFullYear(),ct=z.getFullYear()+1e3):(ht=z.getFullYear(),ct=0);var ut,pt=null;if(l2p.u9(K,ct)&&(l2p.h9(ht,U)&&(U=S.minTimeUnit),ut=t.left+l2p.B9(v,D)-1,pt=null,l2p.C9(C,rt.HOUR)||l2p.s9(C,rt.MINUTE)&&l2p.M9(K,ct)?pt=l.formatter?l.formatter(z,"boun"+nt+et+it+I,rt.DAY,1):this.internationalizer?this.internationalizer.monthDay.format(z):z.getMonth()+1+"/"+z.getDate():l2p.e9(C,rt.DAY)?pt=l2p.l9(K,ct)?l.formatter?l.formatter(z,V+W+"un"+nt+et+"ry",rt.YEAR,1):z.getFullYear():l.formatter?l.formatter(z,j+F+Z+nt+et+it+I,rt.MONTH,1):rt.monthAsDisplay(z.getMonth(),!1,this):l2p.j9(C,rt.MONTH)&&(pt=l.formatter?l.formatter(z,"boun"+nt+M+I,rt.YEAR,1):z.getFullYear()),pt&&-1!=K&&k.push(new rt.ChartEngine.XAxisLabel(ut,j+F+Z+"da"+it+I,pt))),l2p.t7(ht,U)){if(l2p.a7(U,S.minTimeUnit)&&l2p.E7(ct,K))continue;var dt=new Date(+z);ut=t.left+l2p.d7((2*v+1)*D,2)-1;var ft=l2p.n7(Math.floor(ht/_),_);if(l2p.L7(ft,ht)&&(l2p.I7(this.layout.interval,"we"+q+B)?ft=ht:ut-=l2p.Q7(D,2)),l2p.D7(C,rt.MILLISECOND)?dt.setMilliseconds(ft):l2p.H7(C,rt.SECOND)?(dt.setMilliseconds(0),dt.setSeconds(ft)):l2p.w7(C,rt.MINUTE)?(dt.setMilliseconds(0),dt.setSeconds(0),dt.setMinutes(ft)):l2p.z7(C,rt.HOUR)?(dt.setMilliseconds(0),dt.setSeconds(0),dt.setMinutes(0),dt.setHours(ft)):l2p.G7(C,rt.DAY)?dt.setDate(Math.max(1,ft)):l2p.F7(C,rt.MONTH)?(dt.setDate(1),dt.setMonth(l2p.y7(ft,1))):(l2p.A7(C,rt.YEAR),dt.setDate(1),dt.setMonth(0)),U=ft+_,l2p.K7(C,rt.DAY)&&(S.maxTimeUnit=n[dt.getMonth()]+1),l2p.p3(U,S.maxTimeUnit)&&(U=S.minTimeUnit),K=ct,J&&l2p.X3(ft,ht)){J=!1;continue}pt=l.formatter?l.formatter(dt,Y+G+"ne",C,_):l2p.c3(C,rt.DAY)?dt.getDate():l2p.v3(C,rt.MONTH)?rt.monthAsDisplay(z.getMonth(),!1,this):l2p.m3(C,rt.YEAR)||l2p.W3(C,rt.DECADE)?dt.getFullYear():rt.timeAsDisplay(dt,this,C),k.push(new rt.ChartEngine.XAxisLabel(ut,"lin"+q,pt))}}return k},rt.ChartEngine.prototype.createYAxis=function(t,e){if(!this.runPrepend(L+it+q+et+Q+q+"YA"+J+G+$,arguments)){var i=t.chart,n=l2p.S3(t.name,i.name);e||(e={}),e.noChange=!1;var r=e.yAxis?e.yAxis:t.yAxis;if(rt.ChartEngine.enableCaching&&l2p.f3(r.high,t.cacheHigh)&&l2p.J3(r.low,t.cacheLow)){var a=l2p.i3(i.dataSet.length,i.scroll,1),o=a+i.maxTicks+1;t.cacheLeft=a,t.cacheRight=o,e.noChange=!0}else t.cacheLeft=1e6,t.cacheRight=-1,t.cacheHigh=r.high,t.cacheLow=r.low;var s=i.xAxis.idealTickSizePixels?i.xAxis.idealTickSizePixels:i.xAxis.autoComputedTickSizePixels;if(r.goldenRatioYAxis&&l2p.w3(r.idealTickSizePixels,s/1.618)&&(e.noChange=!1),!e.noChange){this.adjustYAxisHeightOffset(t,r);var l=r.height=l2p.z3(r.bottom,r.top),h=l2p.G3(r.high-r.low,l-r.zoom);if(e.ground&&!r.semiLog)r.high=r.high+l2p.F3(r.zoom,h);else{r.high=r.high+l2p.y3(r.zoom/2,h)+l2p.A3(r.scroll,h);var c=r.low;if(r.semiLog){var u=l2p.K3(r.zoom/2*h,r.high/r.low);r.low=l2p.k1(r.low,u,r.scroll*h),l2p.c1(r.low,.1*c)&&(r.low=l2p.v1(c,.1))}else r.low=l2p.n1(r.low,r.zoom/2*h,r.scroll*h)}if((r.min||l2p.V1(r.min,0))&&(r.low=r.min),(r.max||l2p.r1(r.max,0))&&(r.high=r.max),r.shadow=l2p.U1(r.high,r.low),r.semiLog&&(!this.activeDrawing||l2p.u1(this.activeDrawing.name,D+it+W+"j"+q+L+"tion"))){r.logHigh=l2p.h1(Math.log(r.high),Math.LN10);var p=Math.max(r.low,1e-9);r.logLow=l2p.B1(Math.log(p),Math.LN10),l2p.C1(r.low,0)&&(r.logLow=0),r.logShadow=l2p.s1(r.logHigh,r.logLow)}var d;r.goldenRatioYAxis&&n?(r.idealTickSizePixels=l2p.M1(s,1.618),l2p.A1(r.idealTickSizePixels,0)&&(d=this.getCanvasFontSize($+Q+N+I+et+J+G+$),r.idealTickSizePixels=l2p.j1(d,5))):r.idealTickSizePixels||(d=this.getCanvasFontSize(R+N+I+et+J+G+$),r.idealTickSizePixels=n?l2p.k8(d,5):l2p.T8(d,2));var f=Math.round(l2p.g8(l,r.idealTickSizePixels)),m=e.range?l2p.O8(e.range[1],e.range[0]):r.shadow;r.priceTick=Math.floor(l2p.N8(m,f));for(var g=1,v=0;l2p.V8(v,10)&&!l2p.r8(r.priceTick,0);v++)g*=10,r.priceTick=l2p.U8(Math.floor(m/f*g),g);l2p.u8(v,10)&&(r.priceTick=1e-8),r.priceTick=l2p.h8(Math.round(m/f*g),g);var y=Math.round(l2p.B8(m,r.priceTick));if(e.range&&l2p.C8(y,m)&&!r.noEvenDivisorTicks){for(;l2p.s8(y,1)&&!l2p.M8(m%y,0);)y--;r.priceTick=l2p.e8(m,y)}if(r.minimumPriceTick){var b=r.minimumPriceTick;d=this.getCanvasFontSize($+Q+J+z+I+et+"xi"+$);for(var x=0;l2p.l8(x,100);x++){var w=l2p.j8(m,b);if(!l2p.k0(l/w,2*d))break;b+=r.minimumPriceTick}l2p.T0(x,100)&&(r.priceTick=b)}r.multiplier=l2p.g0(r.height,r.shadow)}if((l2p.O0(r.priceTick,0)||l2p.N0(r.priceTick,1/0))&&(r.priceTick=1),!this.activeDrawing||l2p.V0(this.activeDrawing.name,"project"+G+W+Z)){if(r.high=this.transformedPriceFromPixel(t.top,t,r),r.semiLog){r.logHigh=l2p.r0(Math.log(r.high),Math.LN10);var C=Math.max(r.low,1e-11);r.logLow=l2p.U0(Math.log(C),Math.LN10),r.logShadow=l2p.u0(r.logHigh,r.logLow)}r.shadow=l2p.h0(r.high,r.low)}if(r.multiplier=l2p.B0(r.height,r.shadow),l2p.C0(r.multiplier,1/0)&&(r.multiplier=0),!r.decimalPlaces&&l2p.s0(r.decimalPlaces,0))if(n){for(var S=0,T=0;l2p.M0(T,t.yAxis.shadowBreaks.length);T++){var _=t.yAxis.shadowBreaks[T];l2p.o0(t.yAxis.shadow,_[0])&&(S=_[1])}r.printDecimalPlaces=S}else r.printDecimalPlaces=null;else r.printDecimalPlaces=r.decimalPlaces;this.runAppend(L+it+q+et+Q+q+"Y"+P+J+tt,arguments)}},rt.ChartEngine.prototype.drawYAxis=function(t,e){e||(e={});var i=e.yAxis?e.yAxis:t.yAxis;if(!t.hidden&&!i.noDraw){if(l2p.K0(i.priceFormatter,rt.Comparison.priceFormat)&&(i.fractional?(i.originalPriceFormatter||(i.originalPriceFormatter={func:i.priceFormatter}),i.fractional.resolution||(i.fractional.resolution=i.minimumPrice),i.fractional.formatter||(i.fractional.formatter="'"),i.priceFormatter||(i.priceFormatter=function(t,e,n){var r="";l2p.p5(n,l2p.V8n)&&(r=k,n=Math.abs(n));var a=Math.floor(l2p.X5(Math.round(n/i.fractional.resolution),i.fractional.resolution)),o=Math.round(l2p.c5(n-a,i.fractional.resolution)),s=Math.floor(o);return r+a+i.fractional.formatter+(l2p.v5(s,10)?"0":"")+s+(l2p.m5(o-s,.5)?"+":"")})):i.originalPriceFormatter&&(i.priceFormatter=i.originalPriceFormatter.func,i.originalPriceFormatter=_)),i.pretty)return this.drawYAxisPretty(t,e);if(!this.runPrepend(nt+it+et+O+"YAxi"+$,arguments)){if(!e.noDraw&&!i.noDraw){var n=i.yAxisPlotter;if(!n||!e.noChange){n=i.yAxisPlotter=new rt.Plotter;var r=t.chart,a=l2p.W5(t.name,r.name)&&l2p.S5(i,t.yAxis);if(!i.priceTick)return;var o=i.shadow,s=e.range;s&&(o=l2p.f5(s[l2p.S8n],s[l2p.V8n]));var l=l2p.J5(o,i.priceTick);l=Math.round(l);var h,c;i.semiLog&&(h=l2p.i5(Math.log(this.valueFromPixel(i.bottom,t)),Math.LN10),c=l2p.R5(i.logHigh-i.logLow,l));var u=i.textStyle?i.textStyle:$+Q+J+z+I+et+J+tt;n.newSeries(H+it+"id",$+Q+"roke",this.canvasStyle("stx_grid")),n.newSeries(Q+"ex"+Q,T+"ill",this.colorOrStyle(u)),n.newSeries("borde"+it,$+"troke",this.canvasStyle($+Q+J+z+H+it+"id_"+V+"ord"+q+it));var p=l2p.V8n,d=s?s[l2p.S8n]:i.high,f=s?s[l2p.V8n]:i.low,m=l2p.P5(i.displayBorder,_)?r.panel.yAxis.displayBorder:i.displayBorder;l2p.Z5(this.axisBorders,!1)&&(m=!1),l2p.q5(this.axisBorders,!0)&&(m=!0);var g,v=l2p.Y5(i.position,_)?r.panel.yAxis.position:i.position;g=l2p.o5(v,Y+"ef"+Q)?i.left+i.width:i.left;var y=Math.round(g)+.5,b=m?l2p.f8n:l2p.V8n;l2p.x5(v,Y+q+T+Q)&&(b=m?-l2p.f8n:l2p.V8n),p=a?l2p.b5(i.shadow,l2p.S8n)?l2p.k2j((parseInt(f/i.priceTick,10)+l2p.S8n)*i.priceTick,f):l2p.T2j(i.priceTick,Math.round(f%i.priceTick*t.chart.roundit)/t.chart.roundit):l2p.g2j(d,i.priceTick);for(var x=this.getCanvasFontSize("stx_yax"+G+$),w=l2p.V8n;l2p.O2j(w,l);w++){var C;if(i.semiLog){var S=h+l2p.N2j(w,c);C=Math.pow(10,S)}else C=a?f+l2p.V2j(w,i.priceTick)+p:l2p.r2j(d,w*i.priceTick,p);var D=this.pixelFromTransformedValue(C,t,i),M=Math.round(D)+.5;if(!l2p.J2j(M+x/l2p.I8n,t.bottom)&&!l2p.i2j(M-x/l2p.I8n,t.top)){i.displayGridLines&&(n.moveTo(H+it+G+nt,t.left,M),n.lineTo(H+it+G+nt,t.right,M)),m&&(n.moveTo(V+W+it+"der",l2p.R2j(y,.5),M),n.lineTo(V+W+it+nt+q+it,y+b,M)),C=i.priceFormatter?i.priceFormatter(this,t,C):this.formatYAxisPrice(C,t,_,i);var E=i.textBackground?this.containerColor:_,A=g+b+l2p.f8n;l2p.P2j(v,"lef"+Q)?(A=i.left+l2p.f8n,i.justifyRight&&(A=i.left+i.width+b-3)):i.justifyRight&&(A=g+i.width),n.addText(Q+q+J+Q,C,A,M,E,_,x)}}if(m){var L=Math.round(i.bottom)+.5;n.moveTo("bor"+nt+K,y,i.top),n.lineTo(V+W+"rd"+K,y,L),n.draw(this.chart.context,V+W+it+nt+K)}}this.plotYAxisGrid(t)}this.runAppend(nt+it+"awY"+P+"xi"+$,arguments)}}},rt.ChartEngine.prototype.drawYAxisPretty=function(t,e){if(!this.runPrepend(nt+it+"awYAx"+tt,arguments)){e||(e={});var i=e.yAxis?e.yAxis:t.yAxis;if(!e.noDraw&&!i.noDraw){var n=i.yAxisPlotter;if(!n||!e.noChange){n=i.yAxisPlotter=new rt.Plotter;var r=t.chart;if(!i.priceTick)return;if(isNaN(i.high)||isNaN(i.low))return;var a=i.shadow;e.range&&(a=l2p.Z2j(e.range[1],e.range[0]));var o=l2p.q2j(i.height,i.idealTickSizePixels);o=Math.round(o);var s=i.textStyle?i.textStyle:"stx_yax"+G+$;n.newSeries(H+"rid",$+Q+it+W+"ke",this.canvasStyle($+"tx_gr"+G+nt)),n.newSeries("tex"+Q,T+G+Y+Y,this.colorOrStyle(s)),n.newSeries("bord"+K,R+it+W+B+q,this.canvasStyle("stx_gri"+nt+z+"bord"+q+it));var l=e.range,h=l?l[1]:i.high,c=l?l[0]:i.low,u=l2p.Y2j(i.displayBorder,null)?r.panel.yAxis.displayBorder:i.displayBorder;l2p.o2j(this.axisBorders,!1)&&(u=!1),l2p.x2j(this.axisBorders,!0)&&(u=!0);var p,d=l2p.b2j(i.position,null)?r.panel.yAxis.position:i.position;p=l2p.k6j(d,"le"+T+Q)?i.left+i.width:i.left;var f=Math.round(p)+.5,m=u?3:0;l2p.T6j(d,"le"+T+Q)&&(m=u?-3:0);for(var g=this.getCanvasFontSize($+Q+N+"yax"+tt),v=i.increments,y=v.length,x=0,_=1,k=0,D=0,M=0,E=Number.MAX_VALUE,P=0;l2p.g6j(P,100);P++){k=l2p.O6j(v[x],Math.pow(10,M)),_=Math.floor(l2p.N6j(a,k));var O=Math.abs(l2p.V6j(o,_));if(l2p.r6j(O,E))break;if(E=O,l2p.U6j(_,o)){D=k;break}l2p.u6j(_,o)?(x++,l2p.h6j(x,y)&&(x=0,M++)):(x--,l2p.B6j(x,0)&&(x=l2p.C6j(y,1),M--)),D=k}var F=l2p.s6j(Math.ceil(c/D),D),I=l2p.M6j(i.bottom,this.pixelFromTransformedValue(F,t,i)),j=0;if(l2p.e6j(I,i.idealTickSizePixels)&&i.semiLog&&i.prettySemiLog){var U;for(U=Math.ceil(c);l2p.l6j(U,F)&&l2p.j6j(F%U,0);++U);l2p.t4j(U,F)&&(l2p.a4j(F,D)&&(D=U,j=U),F=U)}for(var X=0,J=Number.MAX_VALUE,at=0;l2p.E4j(at,100);at++){var ot=F+l2p.d4j(X,D);if(l2p.n4j(ot,h))break;D+=j,X++;var st=this.pixelFromTransformedValue(ot,t,i);if(l2p.L4j(J-st,g+1)&&l2p.I4j(j,0))at=X=0,J=Number.MAX_VALUE,D=j,j*=2,n.reset();else{J=st;var lt=Math.round(st)+.5;if(!l2p.Q4j(lt+g/2,t.bottom)&&!l2p.D4j(lt-g/2,t.top)){i.displayGridLines&&(n.moveTo(H+it+G+nt,t.left,lt),n.lineTo("grid",t.right,lt)),u&&(n.moveTo(V+W+it+nt+K,l2p.H4j(f,.5),lt),n.lineTo(V+W+"rd"+K,f+m,lt)),ot=i.priceFormatter?i.priceFormatter(this,t,ot):this.formatYAxisPrice(ot,t,null,i);var ht=i.textBackground?this.containerColor:null,ct=p+m+3;l2p.w4j(d,Y+q+T+Q)?(ct=i.left+3,i.justifyRight&&(ct=i.left+i.width+m-3)):i.justifyRight&&(ct=p+i.width),n.addText(Q+"ex"+Q,ot,ct,lt,ht,null,g)}}}if(l2p.z4j(at,100)&&console.log("drawYAxisPr"+q+Q+"ty: "+et+$+$+q+it+"tio"+Z+A+q+it+it+"or. "+C+C+A+it+q+et+L+w+b+A+"100"),u){var ut=Math.round(i.bottom)+.5;n.moveTo(V+W+it+S+it,f,i.top),n.lineTo(V+W+it+nt+K,f,ut),n.draw(this.chart.context,V+W+it+S+it)}}this.plotYAxisGrid(t)}this.runAppend(nt+"rawYAx"+tt,arguments)}},rt.ChartEngine.prototype.drawHistogram=function(t,e){function i(t,e,i,n,a,l,h,u){i||(i=1),T.globalAlpha=rt.isIE8?.5:i,T.beginPath();for(var d=x+.5,f=Math.floor(l2p.U9j(E.pixelFromBar(0,r.chart),E.layout.candleWidth/2)),m=f,v=0;l2p.u9j(v,s.length);v++){var y=D[v]||x;l2p.h9j(v,0)&&(d=y);var w=s[v];if(w&&w[t]){var C=l2p.B9j(w[t]-p,c);if(!isNaN(C)){var M=E.layout.candleWidth;w.candleWidth&&(M=w.candleWidth,l2p.C9j(v,0)&&(f=m=Math.floor(l2p.s9j(E.pixelFromBar(0,r.chart),w.candleWidth/2))));var A=Math.min(Math.floor(l2p.M9j(y,C))+.5,y);if(u&&-1==u.indexOf(v)||!u&&(a&&l2p.e9j(w.Close,w.iqPrevClose)||!a&&l2p.l9j(w.Close,w.iqPrevClose)))d=A,m+=M;else{var P,O,F,I=l2p.j9j(M,E.layout.candleWidth);_?(P=Math.round(m+l2p.t7j(_+l*h,I)),O=P+(n?0:S),F=P+Math.round(l2p.a7j(h,I))-(n?0:S)):(P=m+l2p.E7j(_+l*h,I),O=Math.round(P)+(n?0:S),F=l2p.d7j(Math.round(P+h*I),n?0:S)),l2p.n7j(F-O,2)&&(F=O+1);var j=n?0:.5;l2p.L7j(O%1,j)&&(O+=.5),l2p.I7j(F%1,j)&&(F+=.5),T.moveTo(F,y),l2p.Q7j(x,y)&&n&&!_&&D[v+1]&&T.moveTo(F,Math.max(A,Math.min(y,D[v+1]))),T.lineTo(F,A),T.lineTo(O,A),n&&l?(l2p.D7j(k[v],A)||l2p.H7j(v,0))&&T.lineTo(O,Math.min(y,k[v])):n&&!_&&l2p.w7j(o,L+"lu"+$+Q+q+it+q+nt)?l2p.z7j(v,0)&&k[l2p.G7j(v,1)]&&l2p.F7j(k[v-1],A)&&T.lineTo(O,Math.min(y,k[l2p.y7j(v,1)])):n&&!_?(l2p.A7j(d,A)||l2p.K7j(v,0))&&T.lineTo(O,Math.min(y,d)):T.lineTo(O,y),d=A,m+=M,(l2p.p3j(o,"clu"+$+Q+K+b)||n)&&(k[v]=A)}}}else d=y,m+=E.layout.candleWidth}n?(T.strokeStyle=!e||l2p.X3j(e,et+g+W)?E.defaultColor:e,T.stroke()):(T.fillStyle=!e||l2p.c3j(e,"au"+Q+W)?E.defaultColor:e,T.fill()),T.closePath()}if(e&&e.length){var n=t.panel;n||(n=L+w+M+Q);var r=this.panels[n];if(r){var a=t.yAxis?t.yAxis:r.yAxis,o=t.subtype,s=this.chart.dataSegment,l=!1;this.getDefaultColor();var h;for(h=0;l2p.G4j(h,e.length);h++)l|=e[h].border_color_up&&!rt.isTransparent(e[h].border_color_up),l|=e[h].border_color_down&&!rt.isTransparent(e[h].border_color_down);l2p.F4j(t.borders,!1)&&(l=!1),t.name||(t.name="Data");var c=a.multiplier;t.heightPercentage||(t.heightPercentage=.7),t.widthFactor||(t.widthFactor=.8);for(var u=0,p=0,d=0;l2p.y4j(d,this.chart.maxTicks);d++){var f=s[d];if(f){var m=0;for(h=0;l2p.A4j(h,e.length);h++)f[e[h].field]&&(l2p.K4j(o,"stack"+q+nt)?m+=f[e[h].field]:m=f[e[h].field],l2p.p9j(m,u)&&(u=m),l2p.X9j(m,p)&&(p=m))}}if(l2p.c9j(u,0)&&l2p.v9j(p,0))return void this.watermark(n,"cen"+Q+K,j+Q+Q+W+X,this.translateIf(t.name+(A+y+W+Q+A+P+v+et+G+"la")+V+Y+q));var x,C=Math.floor(a.top)+.5;t.bindToYAxis?x=Math.floor(this.pixelFromPrice(p,r,a))+.5:(x=Math.floor(a.bottom)+.5,c=l2p.m9j(x-C,t.heightPercentage,u-p)),this.startClip(n);var S=l2p.L9j(this.layout.candleWidth,1)||!l?0:.5,T=this.chart.context,_=Math.max(0,l2p.I9j(1-t.widthFactor,this.layout.candleWidth,2)),k=new Array(s.length),D=[],E=this,O=1;for(h=0;l2p.v3j(h,e.length);h++){var F=e[h];O=l2p.m3j(this.layout.candleWidth,t.widthFactor),_&&l2p.W3j(this.layout.candleWidth-O,2)&&(l=!1);var I=0;if(l2p.S3j(o,L+Y+"us"+Q+q+it+q+nt)&&(I=h,O/=e.length),"function"==_typeof(F.color_function)){for(var N,R,H={},z=0;l2p.f3j(z,s.length);z++)s[z]&&(N=F.color_function(s[z]),"string"==(void 0===N?"undefined":_typeof(N))&&(N={fill_color:N,border_color:N}),R=N.fill_color+","+N.border_color,l2p.J3j(R,H)?H[R].positions.push(z):(N.positions=[z],H[R]=N));for(R in H)N=H[R],i(F.field,N.fill_color,N.opacity,null,null,I,O,N.positions),i(F.field,N.border_color,N.opacity,!0,null,I,O,N.positions)}else i(F.field,F.fill_color_up,F.opacity_up,null,!0,I,O),i(F.field,F.fill_color_down,F.opacity_down,null,null,I,O),l2p.i3j(this.layout.candleWidth,2)&&l&&(i(F.field,F.border_color_up,F.opacity_up,!0,!0,I,O),i(F.field,F.border_color_down,F.opacity_down,!0,null,I,O));l2p.R3j(o,$+Q+et+L+"ke"+nt)&&(D=rt.shallowClone(k))}T.globalAlpha=1,this.endClip()}}},rt.ChartEngine.prototype.drawCandlesHighPerformance=function(t,e,i,n,r){var a=r?"his"+Q+W+H+it+"am":L+et+Z+"dle";this.drawBarTypeChartInner({panel:t,fillColor:e,borderColor:i,condition:n,type:a})},rt.ChartEngine.prototype.drawShadowsHighPerformance=function(t,e,i){this.drawBarTypeChartInner({panel:t,style:e,condition:i,type:$+"ha"+nt+W+O})},rt.ChartEngine.prototype.drawBarChartHighPerformance=function(t,e,i){this.drawBarTypeChartInner({panel:t,style:e,condition:i,type:V+et+it})},rt.ChartEngine.prototype.drawHLCChart=function(t,e,i){this.drawBarTypeChartInner({panel:t,style:e,condition:i,type:w+Y+L})},rt.ChartEngine.prototype.drawBarTypeChartInner=function(t){var e=t.type,i=t.panel,n=t.fillColor,r=t.borderColor,a=t.condition,o=t.style,s=(t.overlayScaling,l2p.P3j(e,w+G+$+Q+W+H+it+et+X)),l=s||l2p.Z3j(e,L+et+Z+"dl"+q),h=l2p.q3j(e,"sh"+et+nt+W+O),c=l2p.Y3j(e,w+Y+L),u=l2p.o3j(e,"bar")||c,p=i.chart,d=p.dataSegment,f=this.chart.context,m=i.yAxis.top,g=i.yAxis.bottom,y=0;r&&!rt.isTransparent(r)&&(y=.5);l2p.x3j(p.dataSet.length,p.scroll,1);f.beginPath();var b=i.yAxis,x=this.layout.candleWidth,C=l2p.p1j(i.left,.5*x,this.micropixels,1),S=l2p.T1j(p.tmpWidth,2),T=l2p.g1j(f.lineWidth,2);if(l&&(rt.isTransparent(n)&&(n=this.containerColor),f.fillStyle=n),h&&(f.lineWidth=1),u){var _=this.canvasStyle(o);_.width&&l2p.O1j(parseInt(_.width,10),25)?f.lineWidth=Math.max(1,rt.stripPX(_.width)):f.lineWidth=1}for(var k=0;l2p.N1j(k,d.length);k++){C+=l2p.V1j(x,2),x=this.layout.candleWidth,C+=l2p.r1j(x,2);var D=d[k];if(D&&!D.projection){D.candleWidth&&(C+=l2p.U1j(D.candleWidth-x,2),x=D.candleWidth,l2p.u1j(this.layout.chartType,v+W+Y+"um"+q+z+"cand"+Y+q)&&(S=l2p.h1j(x,2))),p.transformFunc&&D.transform&&(D=D.transform);var M=D.Close,E=l2p.B1j(D.Open,void 0)?M:D.Open;if(s&&p.defaultPlotField&&(M=D[p.defaultPlotField]),(M||!l2p.C1j(M,0))&&(!l||s||!l2p.s1j(E,M)&&!l2p.M1j(E,null))){if(a){if(p.state.chartType.pass.even|=l2p.e1j(M,D.iqPrevClose),l2p.l1j(a,rt.ChartEngine.CANDLEUP)&&l2p.j1j(E,M))continue;if(l2p.t8j(a,rt.ChartEngine.CANDLEDOWN)&&l2p.a8j(E,M))continue;if(l2p.E8j(a,rt.ChartEngine.CANDLEEVEN)&&l2p.d8j(E,M))continue;if(l2p.n8j(a,rt.ChartEngine.CLOSEUP)&&l2p.L8j(M,D.iqPrevClose))continue;if(l2p.I8j(a,rt.ChartEngine.CLOSEDOWN)&&l2p.Q8j(M,D.iqPrevClose))continue;if(l2p.D8j(a,rt.ChartEngine.CLOSEEVEN)&&l2p.H8j(M,D.iqPrevClose))continue}var A=E,P=M;(h||u)&&(A=l2p.w8j(D.High,void 0)?Math.max(M,E):D.High,P=l2p.z8j(D.Low,void 0)?Math.min(M,E):D.Low);var F,I,j=b.semiLog?this.pixelFromTransformedValue(A,i):l2p.G8j(b.high-A,b.multiplier)+b.top,N=b.semiLog?this.pixelFromTransformedValue(P,i):l2p.F8j(b.high-P,b.multiplier)+b.top,R=Math.floor(s?N:Math.min(j,N))+y,V=s?b.bottom:Math.max(j,N),B=Math.floor(l2p.y8j(V,R));if((u||h)&&(F=b.semiLog?this.pixelFromTransformedValue(E,i):l2p.A8j(b.high-E,b.multiplier)+b.top,I=b.semiLog?this.pixelFromTransformedValue(M,i):l2p.K8j(b.high-M,b.multiplier)+b.top),l2p.p0j(R,m)){if(l2p.X0j(R+B,m))continue;B-=l2p.c0j(m,R),R=m}if(l2p.v0j(R+B,g)&&(B-=R+B-g),B=Math.max(B,2),V=R+B,!l2p.m0j(R,g)&&!l2p.W0j(V,m)){var U=Math.floor(C)+.5,K=Math.floor(l2p.S0j(U,S))+y,J=l2p.f0j(Math.round(U+S),y);if(l)l2p.J0j(R,V)&&f.rect(K,R,Math.max(1,l2p.i0j(J,K)),Math.max(1,l2p.R0j(V,R)));else if(h){if(l2p.P0j(M,E)&&l2p.Z0j(I,g)&&l2p.q0j(I,m)){var tt=Math.floor(I)+.5;f.moveTo(K,tt),f.lineTo(J,tt)}l2p.Y0j(A,P)&&(f.moveTo(U,R),f.lineTo(U,V))}else if(u){if(l2p.o0j(R,g)&&l2p.x0j(V,m)&&l2p.b0j(D.High,D.Low)&&(f.moveTo(U,l2p.k5j(R,T)),f.lineTo(U,V+T)),l2p.T5j(F,m)&&l2p.g5j(F,g)&&!c){var at=Math.floor(F)+.5;f.moveTo(U,at),f.lineTo(l2p.O5j(U,S),at)}if(l2p.N5j(I,m)&&l2p.V5j(I,g)){var ot=Math.floor(I)+.5;f.moveTo(U,ot),f.lineTo(U+S,ot)}}}}}}l?(f.fill(),y&&(f.lineWidth=1,f.strokeStyle=r,f.stroke())):(h||u)&&(this.canvasColor(o),f.stroke(),f.closePath(),f.lineWidth=1)},rt.ChartEngine.prototype.plotDataSegmentAsLine=function(t,e,i,n){function r(t){var e=N,i=t,n=!1;if(N=[],(void 0===i?"undefined":_typeof(i))==W+"bjec"+Q&&(N=rt.borderPatternToArray(k.lineWidth,i.pattern),i=i.color),b[i]=1,!g){var r=x.slice(-2);if(rt.colorsEqual(k.strokeStyle,i)||(n=!0,d||(k.stroke(),k.beginPath(),k.moveTo(r[0],r[1]))),d){var a=l2p.q5j(N,Array)&&N.join(),o=l2p.Y5j(e,Array)&&e.join();(n||l2p.o5j(a,o))&&w.push({coord:r,color:i,pattern:N||[]})}else k.strokeStyle=i;return k.setLineDash(N),r}}function a(t,i,n){var r=p.semiLog?S.pixelFromTransformedValue(n.CollatedOpen,e,p):l2p.x5j(p.high-n.CollatedOpen,p.multiplier)+p.top,a=p.semiLog?S.pixelFromTransformedValue(n.CollatedHigh,e,p):l2p.b5j(p.high-n.CollatedHigh,p.multiplier)+p.top,o=p.semiLog?S.pixelFromTransformedValue(n.CollatedLow,e,p):l2p.k2b(p.high-n.CollatedLow,p.multiplier)+p.top;k.lineTo(t,r),k.moveTo(t,a),k.lineTo(t,o),k.moveTo(t,i),x.push(t,r)}var o=!1,s=!1,l=!1,h=!1,c=!0,u=null,p=null,d=0,g=!1,v=!1,y=null,b={},x=[],w=[],C=[],S=this,T=e.chart,_=T.dataSegment,k=T.context,M=new Array(_.length);if(!T.dataSet.length)return{colors:b,points:x,cache:M,gapAreas:C};this.startClip(e.name),i&&(o=i.skipProjections,s=i.skipTransform,l=i.noSlopes,d=i.tension,h=i.step,c=i.extendOffChart,p=i.yAxis,u=i.gaps||T.gaplines,g=i.noDraw,v=i.reverse,y=i.overlayScaling,i.width&&(k.lineWidth=i.width)),l2p.r5j(c,!1)&&(c=!0),p||(p=e.yAxis);var E=l2p.U5j(k.lineWidth,2),A=v?l2p.u5j(T.top,E):T.bottom+E;(i.threshold||l2p.h5j(i.threshold,0))&&(A=this.pixelFromPrice(i.threshold,e,p));var P=!d&&g&&u&&u.fillMountain,L=T.transformFunc&&!s,O={left:null,right:null},F=l2p.B5j(T.dataSet.length,T.scroll,1);c&&(O.left=this.getPreviousBar(T,t,0),O.right=this.getNextBar(T,t,l2p.Z5j(_.length,1)));var I,j,N,R=!0,V=!1;k.beginPath();var H=O.left,z=null;if(H&&(z=H.transform),H){j=L&&z?z[t]:H[t];var B=this.pixelFromTick(H.tick,T),U=y?l2p.T2b(y.bottom,(j-y.min)*y.multiplier):this.pixelFromTransformedValue(j,e,p);k.moveTo(B,U),x.push(B,U),R=!1}for(var X,K=e.left+this.micropixels-1,J=this.currentQuote(),$=0,tt=0,et=!1,it={reset:!0},nt=0;l2p.g2b(nt,_.length);nt++){I=this.layout.candleWidth;var ot=_[nt],st=_[nt];if(ot||(ot={}),o&&ot.projection){O.right=null;break}if(ot.candleWidth&&(I=ot.candleWidth),L&&ot.transform&&(ot=ot.transform),T.lineApproximation){it.reset&&(it={CollatedHigh:-Number.MAX_VALUE,CollatedLow:Number.MAX_VALUE,CollatedOpen:null,CollatedClose:null},et=!1);var lt=ot[t];if((lt||l2p.O2b(lt,0))&&(it.CollatedHigh=Math.max(it.CollatedHigh,lt),it.CollatedLow=Math.min(it.CollatedLow,lt),it.CollatedClose=lt,l2p.N2b(it.CollatedOpen,null)?it.CollatedOpen=lt:et=!0),$+=I,!l2p.V2b($-tt,1)&&!l2p.r2b(nt,_.length-1)){K+=I;continue}tt=Math.floor($),it.reset=!0,it[t]=it.CollatedClose,ot=it,ot.cache={}}if(l||(K+=l2p.U2b(I,2)),ot[t]||!l2p.u2b(ot[t],0)){X=ot;var ht=ot.cache,ct=F+nt;(l2p.B2b(ct,e.cacheLeft)||l2p.C2b(ct,e.cacheRight)||!ht[t])&&(ht[t]=y?l2p.s2b(y.bottom,(ot[t]-y.min)*y.multiplier):p.semiLog?this.pixelFromTransformedValue(ot[t],e,p):l2p.M2b(p.high-ot[t],p.multiplier)+p.top);var ut=M[nt]=ht[t];if(l2p.e2b(st.tick,J.tick)&&T.lastTickOffset&&(K+=T.lastTickOffset),!R&&n){var pt=n(this,st,V);if(!pt){K+=l?I:l2p.l2b(I,2);continue}var dt=r(pt);N&&N.length&&(h||l?(et?a(K,dt[1],ot):k.dashedLineTo(dt[0],dt[1],K,dt[1],N),l?k.moveTo(K,ut):et?a(K,ut,ot):k.dashedLineTo(K,dt[1],K,ut,N),x.push(K,dt[1])):et?a(K,ut,ot):k.dashedLineTo(dt[0],dt[1],K,ut,N))}if(!N||!N.length)if(R)k.moveTo(K,ut);else{if(h||l){var ft=x.slice(-1)[0];et?a(K,ft,ot):k.lineTo(K,ft),x.push(K,ft)}et&&!l?a(K,ut,ot):k[l?m+f+"T"+W:"lin"+q+"T"+W](K,ut)}V&&C.push({end:[K,ut],threshold:A}),P&&V&&x.push(K,A),x.push(K,ut),R=!1,V=!1,K+=l?I:l2p.j2b(I,2)}else{var mt=x.slice(-2);P&&!V&&x.length&&x.push(mt[0],A),V||C.push({start:mt,threshold:A}),V=!0,K+=l?I:l2p.h2b(I,2),(h||l)&&x.length&&(M[nt]=x.slice(-1)[0])}}var gt=O.right,vt=null;if(gt&&(vt=gt.transform),!R&&gt){j=L?vt?vt[t]:null:gt[t];var yt=this.pixelFromTick(gt.tick,T),bt=y?l2p.t6b(y.bottom,(j-y.min)*y.multiplier):this.pixelFromTransformedValue(j,e,p);if(!R&&n){var xt=n(this,gt,V);if(xt){var wt=r(xt);N&&N.length&&(h||l?(k.dashedLineTo(wt[0],wt[1],yt,wt[1],N),l?k.moveTo(yt,bt):k.dashedLineTo(yt,wt[1],yt,bt,N),x.push(yt,wt[1])):k.dashedLineTo(wt[0],wt[1],yt,bt,N))}}if(!N||!N.length){if(h||l){var Ct=x.slice(-1)[0];k.lineTo(yt,Ct),x.push(K,Ct)}k[l?"moveT"+W:Y+G+Z+q+"T"+W](yt,bt)}V&&C.push({end:[yt,bt],threshold:A}),P&&V&&x.push(yt,A),x.push(yt,bt)}if(h||l||u||this.extendLastTick||i.extendToEndOfDataSet){var St=x.slice(-2);if(x.length){var Tt=St[0],_t=St[1];h||u||i.extendToEndOfDataSet?(Tt=this.pixelFromTick(l2p.a6b(T.dataSet.length,1),T),(l||this.extendLastTick)&&(Tt+=l2p.E6b(I,2))):l?Tt+=I:this.extendLastTick&&(Tt+=l2p.d6b(I,2));var kt=null;n&&(kt=n(this,{},!0)),kt&&r(kt),N&&N.length?k.dashedLineTo(St[0],St[1],Tt,_t,N):k.lineTo(Tt,_t),x.push(Tt,_t)}}if(g||(d&&x.length&&(k.beginPath(),at.plotSpline(x,d,k,w)),k.stroke()),this.endClip(),!g&&i.label&&X){var Dt;Dt=p.priceFormatter?p.priceFormatter(this,e,X[t],i.labelDecimalPlaces):this.formatYAxisPrice(X[t],e,i.labelDecimalPlaces);var Mt=this.yaxisLabelStyle;p.yaxisLabelStyle&&(Mt=p.yaxisLabelStyle);var Et=l2p.n6b(Mt,Z+W+W+D)?k.strokeStyle:null,At=l2p.L6b(Mt,"no"+W+D)?"#FFFFFF":k.strokeStyle;this.yAxisLabels.push({src:D+Y+W+Q,args:[e,Dt,X.cache[t],At,Et]})}return{colors:b,points:x,cache:M,gapAreas:C}},rt.ChartEngine.prototype.drawMountainChart=function(t,e,i){var n=this.chart.context,r=e,a=!1,o=null,s=null,l=0,h=null,c=!1,p=null,f=null,m=!1,y=!1,b=t.chart,x=(b.dataSegment,t.chart.defaultPlotField);e&&(void 0===e?"undefined":_typeof(e))==W+V+"jec"+Q||(e={style:e}),r=e.style,a=e.reverse,x=e.field,o=e.yAxis,s=e.tension,h=e.gaps||b.gaplines,p=e.fillStyle,l=e.width,c=e.step,f=e.overlayScaling,m=e.extendToEndOfDataSet,y=e.returnObject,r||(r="stx_mounta"+U+z+L+w+et+it+Q),x||(x=t.chart.defaultPlotField),o||(o=t.yAxis);var C=this.canvasStyle(r),T=o.top;(isNaN(T)||isNaN(l2p.I6b(T,T)))&&(T=0);var _=e&&e.color?e.color:r&&C.backgroundColor?C.backgroundColor:this.defaultColor,D=e&&e.baseColor?e.baseColor:r&&C.color?C.color:this.containerColor;if(p)n.fillStyle=p;else if(e.baseColor||C.color){var M=n.createLinearGradient(0,T,0,o.bottom);M.addColorStop(0,_),M.addColorStop(1,D),n.fillStyle=M}else n.fillStyle=_;this.startClip(t.name);var E=n.lineWidth;e={skipProjections:!0,reverse:a,yAxis:o,gaps:h,step:c,extendToEndOfDataSet:m},b.tension&&(e.tension=b.tension),(s||l2p.Q6b(s,0))&&(e.tension=s);var A=parseInt(C.paddingTop,10),P=C.borderTopColor,O=null;if(P&&!rt.isTransparent(P)&&A&&!rt.isIE8){var F=this.scratchContext;if(!F){var I=n.canvas.cloneNode(!0);F=this.scratchContext=I.getContext("2"+nt),F.canvas=I}F.canvas.height=n.canvas.height,F.canvas.width=n.canvas.width,F.drawImage(n.canvas,0,0),n.clearRect(0,0,n.canvas.width,n.canvas.height)}if(rt.extend(e,{panelName:t.name,direction:e.reverse?-1:1,band:x,opacity:1,overlayScaling:f}),rt.preparePeakValleyFill(this,e),P&&!rt.isTransparent(P)){A&&!rt.isIE8&&(n.save(),n.lineWidth+=l2p.D6b(2,A),n.globalCompositeOperation=S+$+Q+U+d+u+Z+k+W+g,n.globalAlpha=1,this.plotDataSegmentAsLine(x,t,e),n.globalCompositeOperation="destin"+d+G+W+Z+k+W+v+q+it,n.scale(l2p.H6b(1,this.adjustedDisplayPixelRatio),l2p.w6b(1,this.adjustedDisplayPixelRatio)),n.drawImage(this.scratchContext.canvas,0,0),n.restore()),n.strokeStyle=P,l?n.lineWidth=l:C.width&&l2p.z6b(parseInt(C.width,10),25)?n.lineWidth=Math.max(1,rt.stripPX(C.width)):n.lineWidth=1;var j=i;h&&(j=this.getGapColorFunction(x,P,e.pattern,h,i)),O=this.plotDataSegmentAsLine(x,t,e,j)}return n.lineWidth=E,this.endClip(),y?O:O.colors},rt.ChartEngine.prototype.mousemoveinner=function(t,e){if(this.chart.canvas){if(!rt.isAndroid&&!rt.isIOS7or8&&(l2p.G6b(this.chart.canvas.height,Math.floor(this.devicePixelRatio*this.chart.container.clientHeight))||l2p.F6b(this.chart.canvas.width,Math.floor(this.devicePixelRatio*this.chart.container.clientWidth))))return void this.resizeChart();var i;if(!this.runPrepend(X+W+"us"+q+m+v+"ei"+Z+Z+q+it,arguments)){var n=this.container.getBoundingClientRect();this.top=n.top,this.left=n.left,this.right=this.left+this.width,this.bottom=this.top+this.height,this.cancelLongHold=!0,this.hasDragged=!0,rt.ChartEngine.crosshairX=t,rt.ChartEngine.crosshairY=e;var r=this.cy=this.crossYActualPos=this.backOutY(rt.ChartEngine.crosshairY),a=this.cx=this.backOutX(rt.ChartEngine.crosshairX);if(this.currentPanel=this.whichPanel(r),this.currentPanel||(this.currentPanel=this.chart.panel),this.currentPanel){var o=this.currentPanel.chart;if(o.dataSet){this.crosshairTick=this.tickFromPixel(a,o),i=this.valueFromPixel(r,this.currentPanel);var s=l2p.y6b(this.currentPanel.name,L+"har"+Q)?this.preferences.horizontalCrosshairField:this.currentPanel.horizontalCrosshairField;s&&l2p.A6b(this.crosshairTick,o.dataSet.length)&&this.crosshairTick>-1&&(i=o.dataSet[this.crosshairTick][s],this.crossYActualPos=this.pixelFromPrice(i,this.currentPanel)),this.crosshairValue=this.adjustIfNecessary(this.currentPanel,this.crosshairTick,i)}l2p.K6b(rt.ChartEngine.crosshairX,this.left)&&l2p.p4b(rt.ChartEngine.crosshairX,this.right)&&l2p.X4b(rt.ChartEngine.crosshairY,this.top)&&l2p.c4b(rt.ChartEngine.crosshairY,this.bottom)?rt.ChartEngine.insideChart=!0:rt.ChartEngine.insideChart=!1;var l=l2p.v4b(this.xAxisAsFooter,!0)?this.chart.canvasHeight:this.chart.panel.bottom;if(this.overXAxis=rt.ChartEngine.insideChart&&l2p.m4b(rt.ChartEngine.crosshairY,l+this.top)&&l2p.W4b(rt.ChartEngine.crosshairY,l-this.xaxisHeight+this.top),this.overYAxis=(l2p.S4b(this.cx,this.currentPanel.right)||l2p.f4b(this.cx,this.currentPanel.left))&&rt.ChartEngine.insideChart,!this.overXAxis&&!this.overYAxis&&(rt.ChartEngine.insideChart||this.grabbingScreen)||(this.undisplayCrosshairs(),this.overXAxis||this.overYAxis)){if(!this.displayCrosshairs&&!rt.ChartEngine.resizingPanel)return void this.undisplayCrosshairs();if(this.repositioningBaseline)return P=this.panels[this.chart.panel.name],this.chart.baseline.userLevel=this.adjustIfNecessary(P,this.crosshairTick,this.valueFromPixel(this.backOutY(rt.ChartEngine.crosshairY),P)),void(l2p.J4b(Date.now()-this.repositioningBaseline.lastDraw,100)&&(this.draw(),this.repositioningBaseline.lastDraw=Date.now()));if(this.grabbingScreen&&!rt.ChartEngine.resizingPanel){if(this.anyHighlighted){rt.clearCanvas(this.chart.tempCanvas,this),this.anyHighlighted=!1;var h;for(h in this.overlays)this.overlays[h].highlight=!1;for(h in o.series)o.series[h].highlight=!1;this.displaySticky()}this.preferences.magnet&&this.currentVectorParameters.vectorType&&rt.clearCanvas(this.chart.tempCanvas,this),-1==this.grabStartX&&(this.grabStartX=rt.ChartEngine.crosshairX,this.grabStartScrollX=o.scroll),-1==this.grabStartY&&(this.grabStartY=rt.ChartEngine.crosshairY,this.grabStartScrollY=this.currentPanel.yAxis.scroll);var c=l2p.i4b(rt.ChartEngine.crosshairX,this.grabStartX),u=l2p.R4b(rt.ChartEngine.crosshairY,this.grabStartY);if(l2p.P4b(c,0)&&l2p.Z4b(u,0))return;l2p.q4b(Math.abs(c)+Math.abs(u),5)&&(this.grabOverrideClick=!0);var p,d=this.layout.candleWidth;if(this.allowZoom&&l2p.Y4b(this.grabMode,"pan")&&(l2p.o4b(this.grabMode.indexOf(C+W+W+X),0)||this.overXAxis||this.overYAxis)){l2p.x4b(this.grabMode,"")&&(this.overXAxis?this.grabMode=C+W+W+X+k+J:this.overYAxis&&(this.grabMode=C+W+W+X+k+I)),l2p.b4b(this.grabMode,"zo"+W+X+k+J)?u=0:l2p.k9b(this.grabMode,C+W+W+X+k+I)&&(c=0),p=l2p.T9b(c,25);var y=!0;l2p.g9b(o.scroll,o.maxTicks)&&(y=!1);var b=l2p.O9b(this.grabStartCandleWidth,p);l2p.N9b(b,this.minimumCandleWidth)&&(b=this.minimumCandleWidth);var x=l2p.V9b(d-b,d);if(l2p.r9b(x,.1)?b=l2p.U9b(d,.9):x<-.1&&(b=l2p.u9b(d,1.1)),p){if(rt.ipad&&l2p.h9b(Math.round(this.chart.width/d-.499)-1,rt.ChartEngine.ipadMaxTicks)&&l2p.B9b(Math.round(this.chart.width/b-.499)-1,rt.ChartEngine.ipadMaxTicks))return;var w;if(this.pinchingCenter){var S=this.backOutX(this.pinchingCenter),T=this.tickFromPixel(S,o);this.setCandleWidth(b,o);var _=this.tickFromPixel(S,o);o.scroll+=Math.floor(l2p.C9b(_,T))}else if(y)w=Math.round(l2p.s9b(this.chart.width,b)+1),l2p.M9b(w,o.maxTicks)&&(o.scroll+=Math.round(l2p.e9b(w-o.maxTicks,2)),this.setCandleWidth(b,o));else if(w=Math.round(l2p.l9b(this.chart.width,b)+1),l2p.j9b(w,Math.round(this.chart.width/d+1))){var M=Math.round(l2p.t7b(this.preferences.whitespace,b));o.scroll=l2p.a7b(o.maxTicks,M),this.setCandleWidth(b,o)}}this.layout.setSpan&&(this.layout.setSpan=null,this.changeOccurred(Y+"ay"+W+g));var E=this.grabStartYAxis;E&&(E.zoom=Math.round(this.grabStartZoom+u),l2p.E7b(this.grabStartZoom,E.height)?l2p.d7b(E.zoom,E.height)&&(E.zoom=l2p.n7b(E.height,1)):l2p.L7b(E.zoom,E.height)&&(E.zoom=E.height+1))}else{if(this.allowScroll){if(l2p.I7b(Math.abs(u),this.yTolerance)){if(!this.yToleranceBroken&&(u=0,l2p.Q7b(c,0)))return}else this.yToleranceBroken=!0;for(this.grabStartMicropixels||(this.grabStartMicropixels=0),this.grabMode=D+et+Z,o.scroll=this.grabStartScrollX,this.micropixels=this.grabStartMicropixels+l2p.D7b(c,this.shift?5:1);l2p.H7b(this.micropixels,0);)this.micropixels-=d,o.scroll++;for(;this.micropixels<-d;)this.micropixels+=d,o.scroll--;l2p.w7b(o.scroll,1)&&(this.micropixels=0,o.scroll=1),l2p.z7b(o.scroll,o.maxTicks)?this.preferences.whitespace=this.initialWhitespace:this.preferences.whitespace=l2p.G7b(o.maxTicks-o.scroll,d),l2p.F7b(this.currentPanel,this.grabStartPanel)&&(this.currentPanel.yAxis.scroll=this.grabStartScrollY+u)}this.dispatch(X+"ov"+q,{stx:this,panel:this.currentPanel,x:this.cx,y:this.cy,grab:this.grabbingScreen})}return rt.ChartEngine.useAnimation?window.requestAnimationFrame(function(t){return function(){t.draw(),t.updateChartAccessories()}}(this)):(this.draw(),this.updateChartAccessories()),this.activeDrawing&&(rt.clearCanvas(this.chart.tempCanvas,this),this.activeDrawing.render(this.chart.tempCanvas.context),this.activeDrawing.measure()),void this.undisplayCrosshairs()}if(this.grabMode="",this.overXAxis||this.overYAxis)return void this.updateChartAccessories();if(this.controls.crossX.style.left=l2p.y7b(this.pixelFromTick(this.crosshairTick,o),.5)+"px",this.controls.crossY.style.top=this.crossYActualPos+"px",this.setCrosshairColors(),rt.ChartEngine.insideChart&&!rt.ChartEngine.resizingPanel){var A=this.currentVectorParameters.vectorType;rt.Drawing&&A&&rt.Drawing[A]&&(new rt.Drawing[A]).dragToDraw||this.doDisplayCrosshairs(),this.updateChartAccessories()}else this.undisplayCrosshairs();var P;this.repositioningDrawing?this.repositionDrawing(this.repositioningDrawing):rt.ChartEngine.drawingLine?this.activeDrawing&&(P=this.panels[this.activeDrawing.panelName],i=this.adjustIfNecessary(P,this.crosshairTick,this.valueFromPixel(this.backOutY(rt.ChartEngine.crosshairY),P)),this.preferences.magnet&&this.magnetizedPrice&&l2p.A7b(P.name,P.chart.name)&&(i=this.adjustIfNecessary(P,this.crosshairTick,this.magnetizedPrice)),rt.clearCanvas(this.chart.tempCanvas,this),this.activeDrawing.move(this.chart.tempCanvas.context,this.crosshairTick,i),this.activeDrawing.measure&&this.activeDrawing.measure()):rt.ChartEngine.resizingPanel&&this.resizePanels(),rt.ChartEngine.insideChart&&(this.dispatch(X+W+f,{stx:this,panel:this.currentPanel,x:this.cx,y:this.cy,grab:this.grabbingScreen}),this.findHighlights()),this.preferences.magnet&&this.currentVectorParameters.vectorType&&(rt.ChartEngine.drawingLine||this.anyHighlighted||rt.clearCanvas(this.chart.tempCanvas),this.magnetize()),this.runAppend(X+"ous"+q+X+"oveinn"+q+it,arguments)}}}}},rt.ChartEngine.prototype.plotLine=function(t,e,i,n,r,a,o,s,l){if(l||(l={}),!(l2p.K7b(l.pattern,"non"+q)||(l2p.p3b(s,!0)&&(s=this.chart.panel),(l2p.X3b(o,null)||(void 0===o?"undefined":_typeof(o))==F+Z+nt+q+"fi"+Z+b)&&(o=this.chart.context),isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n)))){var h=0,c=this.chart.canvasHeight,u=0,p=this.right;s&&(c=s.yAxis.bottom,h=s.yAxis.top,u=s.left,p=s.right);var d,f,m;if(l2p.c3b(a,it+"ay")&&(d=1e7,l2p.v3b(e,t)&&(d=-1e7),m={x0:t,x1:e,y0:i,y1:n},f=rt.yIntersection(m,d),e=d,n=f),l2p.m3b(a,Y+G+Z+q)||l2p.W3b(a,w+W+it+G+"zo"+Z+Q+et+Y)||l2p.S3b(a,v+q+it+Q+G+"cal")){d=1e7;m={x0:t,x1:e,y0:i,y1:n},f=rt.yIntersection(m,d);var g=rt.yIntersection(m,-1e7);t=-1e7,e=d,i=g,n=f}for(var y,x,S,T=0,_=1,k=l2p.f3b(e,t),D=l2p.J3b(n,i),M=0;l2p.i3b(M,4);M++){if(l2p.R3b(M,0)&&(y=-k,x=-l2p.P3b(u,t)),l2p.Z3b(M,1)&&(y=k,x=l2p.q3b(p,t)),l2p.Y3b(M,2)&&(y=-D,x=-l2p.o3b(h,i)),l2p.x3b(M,3)&&(y=D,x=l2p.b3b(c,i)),S=l2p.k1b(x,y),(n||l2p.T1b(n,0))&&l2p.g1b(y,0)&&l2p.O1b(x,0))return!1;if(l2p.N1b(y,0)){if(l2p.V1b(S,_))return!1;l2p.r1b(S,T)&&(T=S)}else if(l2p.U1b(y,0)){if(l2p.u1b(S,T))return!1;l2p.h1b(S,_)&&(_=S)}}var E=t+l2p.B1b(T,k),P=i+l2p.C1b(T,D),L=t+l2p.s1b(_,k),O=i+l2p.M1b(_,D);if(!n&&l2p.e1b(n,0)&&!i&&l2p.l1b(i,0)){if(P=h,O=c,E=m.x0,L=m.x0,l2p.j1b(m.x0,p))return!1;if(l2p.t8b(m.x0,u))return!1}else if(!n&&l2p.a8b(n,0)){if(O=l2p.E8b(m.y0,m.y1)?c:h,E=m.x0,L=m.x0,l2p.d8b(m.x0,p))return!1;if(l2p.n8b(m.x0,u))return!1}o.lineWidth=1.1,(void 0===r?"undefined":_typeof(r))=="obj"+q+"ct"?(o.strokeStyle=r.color,r.opacity?o.globalAlpha=r.opacity:o.globalAlpha=1,o.lineWidth=parseInt(rt.stripPX(r.width),10)):!r||l2p.L8b(r,et+F+Q+W)||rt.isTransparent(r)?o.strokeStyle=this.defaultColor:o.strokeStyle=r,l.opacity&&(o.globalAlpha=l.opacity),l.lineWidth&&(o.lineWidth=l.lineWidth),l2p.I8b(a,C+G+H+A+C+et+H)&&(o.lineWidth=5);var I=rt.borderPatternToArray(o.lineWidth,l.pattern);o.stxLine(E,P,L,O,o.strokeStyle,o.globalAlpha,o.lineWidth,I),o.globalAlpha=1,o.lineWidth=1}},rt.ChartEngine.prototype.rendererAction=function(t,e){if(!this.runPrepend(it+q+Z+nt+q+"rer"+P+"ct"+G+"on",arguments)){var i={};for(var n in t.seriesRenderers){var r=t.seriesRenderers[n],a=r.params,o=a.panel,s=this.panels[o];if((!a.overChart||!l2p.Q8b(e,"un"+nt+q+"rla"+I))&&((a.overChart||!l2p.D8b(e,"over"+Y+"ay"))&&s&&!l2p.H8b(s.chart,t)&&!s.hidden))if(l2p.w8b(e,L+et+Y+"cu"+Y+et+Q+q)){var l=a.yAxis;r.performCalculations(l?i[l.name]:[]),l&&(i[l.name]=[l.low,l.high])}else l2p.z8b(e,I+et+J+G+$)?a.yAxis&&l2p.G8b(o,t.panel.name)&&(this.createYAxis(s,a),this.drawYAxis(s,a)):(r.draw(),r.cb&&r.cb(r.colors))}this.runAppend(it+"en"+nt+K+q+it+P+L+"tion",arguments)}},rt.ChartEngine.prototype.drawSeries=function(t,e,i){if(!this.runPrepend(nt+"raw"+c+q+"ri"+q+$,arguments)){var n=t.dataSegment,r=null;e||(e=t.series);for(var a in e){r=e[a];var o=r.parameters,s=o.panel?this.panels[o.panel]:t.panel,l=o.color,h=o.width,u=o.symbol,p=l2p.F8b(o.type,$+"tep")||l2p.y8b(o.subtype,$+Q+q+D);if(o.chartType&&s){var d=o.yAxis=i||s.yAxis;if(l||(l=this.defaultColor),(!h||isNaN(h)||l2p.A8b(h,1))&&(h=1),(r.highlight||r.parameters.highlight)&&(h*=2),o.width=h,o.pattern=rt.borderPatternToArray(h,o.pattern),!o.shareYAxis&&l2p.K8b(d.name,s.yAxis.name)){var f=[o.minimum,o.maximum];if(!o.minimum&&l2p.p0b(o.minimum,0)||!o.maximum&&l2p.X0b(o.maximum,0)){var m=rt.minMax(n,u);!o.minimum&&l2p.c0b(o.minimum,0)&&(f[0]=m[0]),!o.maximum&&l2p.v0b(o.maximum,0)&&(f[1]=m[1])}var g=f[0],v=d.top,y=d.bottom,b=l2p.m0b(y,v),x=o.marginTop,w=o.marginBottom;x&&(v=l2p.W0b(x,1)?v+x:v+l2p.S0b(b,x)),w&&(y=l2p.f0b(w,1)?l2p.J0b(y,w):l2p.i0b(y,b*w)),o.overlayScaling={bottom:y,min:g,multiplier:l2p.R0b(y-v,f[1]-g)}}!o._rawExtendToEndOfDataSet&&l2p.P0b(o._rawExtendToEndOfDataSet,!1)&&(o._rawExtendToEndOfDataSet=o.extendToEndOfDataSet),t.animatingHorizontalScroll?o.extendToEndOfDataSet=!1:(o.extendToEndOfDataSet=o._rawExtendToEndOfDataSet,!o.extendToEndOfDataSet&&l2p.Z0b(o.extendToEndOfDataSet,!1)&&(o.extendToEndOfDataSet=!1)),o.isComparison&&(o.gaps=Q+it+"an"+$+"par"+q+"nt",o.extendOffChart=!1),p&&(o.step=!0);var C,S=o.gaps?this.getGapColorFunction(u,l,o.pattern,o.gaps):null;l2p.q0b(o.chartType,X+W+F+Z+"tain")||l2p.Y0b(o.type,"moun"+Q+et+G+Z)?C=this.drawMountainChart(s,rt.extend({returnObject:!0},o),S):(o.returnObject=!0,C=this.drawLineChart(s,null,S,o)),r.yValueCache=C.cache;var T=t.dataSegment[l2p.o0b(t.dataSegment.length,1)];if(T){t.transformFunc&&l2p.x0b(s.name,t.name)&&T.transform&&(T=T.transform),T[u]||(T=this.getPreviousBar(t,u,l2p.b0b(t.dataSegment.length,1)))}if((o.shareYAxis||l2p.k5b(d,s.yAxis))&&T&&!d.noDraw){var _;_=d.priceFormatter?d.priceFormatter(this,s,T[u]):this.formatYAxisPrice(T[u],s,null,d),this.yAxisLabels.push({src:$+K+G+q+$,args:[s,_,this.pixelFromTransformedValue(T[u],s,d),l,null,null,d]})}if(t.legend&&o.useChartLegend){t.legend.colorMap||(t.legend.colorMap={});var k=o.display;k||(k=o.symbol),t.legend.colorMap[a]={color:l,display:k}}}}this.runAppend(nt+it+et+O+c+q+"ri"+q+$,arguments)}},rt.ChartEngine.prototype.consolidatedQuote=function(t,e){if(this.runPrepend("cons"+W+Y+G+nt+d+q+"dQ"+F+W+"te",arguments))return t;if(!t||!t.length)return[];var i=this.layout,n=this.dataZone,r=this.chart,a=this,o=i.periodicity,s=i.interval,l=i.timeUnit;e||(e={}),e.periodicity&&e.interval&&(o=e.periodicity,s=e.interval,l=e.timeUnit);for(var u=[],p={begin:t[0].DT,interval:s,periodicity:o,timeUnit:l,inZone:n,outZone:n},f=r.market.newIterator(rt.clone(p)),m=f.previous(),g=f.next(),v=0,y=0;l2p.s5b(v,t.length);){var b=t[v];if(l2p.M5b(b.DT,m))console.log("Warning: "+W+F+Q+k+W+T+k+W+it+nt+K+A+"quot"+q+A+G+Z+A+nt+d+et+c+q+Q+", "+nt+tt+it+q+H+M+"ding: "+b.DT),v++;else if(l2p.e5b(b.DT,g))m=g,g=f.next(),u[y]&&y++;else{var x=function(t,e,n){e||(e={DT:n,Date:rt.yyyymmddhhmmssmmm(n)}),e.displayDate||a.setDisplayDate(e);var r=1;i.adj&&t.Adj_Close&&(r=l2p.T5b(t.Adj_Close,t.Close)),l2p.g5b(h+G+H+w,t)&&l2p.O5b(t.High*r,e.High)&&(e.High=l2p.N5b(t.High,r)),l2p.V5b(E+W+O,t)&&l2p.r5b(t.Low*r,e.Low)&&l2p.U5b(t.Low,null)&&(e.Low=l2p.u5b(t.Low,r)),e.Volume+=t.Volume,l2p.h5b("Clo"+$+q,t)&&l2p.B5b(t.Close,null)&&(e.Close=l2p.C5b(t.Close,r)),e.ratio=r;for(var o in t)e[o]||(e[o]=t[o]);return e}(b,u[y],m);x&&(u[y]=x),v++}}return this.runAppend("consolid"+d+q+nt+"Q"+F+"ot"+q,arguments),u},rt.ChartEngine.prototype.touchmove=function(t){if(this.displayInitialized&&!l2p.l5b(this.openDialog,"")&&!l2p.j5b(rt.ChartEngine.ignoreTouch,!0)){var e=[];if(!(t&&t.touches&&l2p.t2K(t.touches.length,1)&&l2p.a2K(Math.pow(this.clicks.x-t.touches[0].clientX,2)+Math.pow(this.clicks.y-t.touches[0].clientY,2),16))){(!this.overYAxis||this.controls&&this.controls.crossX&&l2p.E2K(this.controls.crossX.style.display,Z+W+Z+q))&&(t&&t.preventDefault&&this.captureTouchEvents&&t.preventDefault(),t&&t.stopPropagation());var i=(new Date).getTime();if(-1==this.clicks.s2MS){if(this.clicks.e1MS=i,l2p.d2K(this.clicks.e1MS-this.clicks.s1MS,25))return}else if(this.clicks.e2MS=i,l2p.n2K(this.clicks.e2MS-this.clicks.s2MS,25))return;if(rt.isSurface){if(this.mouseMode)return;if(t.pointerId||(t.pointerId=this.gesturePointerId),(!this.grabbingScreen||rt.ChartEngine.resizingPanel)&&!this.overrideGesture&&l2p.L2K(t.detail,t.MSGESTURE_FLAG_INERTIA))return void this.gesture.stop();for(var n=0;l2p.I2K(n,this.touches.length);n++)if(l2p.Q2K(this.touches[n].pointerId,t.pointerId)){var r=Math.abs(l2p.D2K(this.touches[n].pageX,t.clientX)),a=Math.abs(l2p.H2K(this.touches[n].pageY,t.clientY)),o=Math.sqrt(l2p.w2K(r,r)+l2p.z2K(a,a));if(!o)return;if(this.clicks.e1MS=(new Date).getTime(),l2p.G2K(this.clicks.e1MS-this.clicks.s1MS,50))return;if(l2p.F2K(this.touches[n].pageX,t.clientX)&&l2p.y2K(this.touches[n].pageY,t.clientY))return;this.touches[n].pageX=t.clientX,this.touches[n].pageY=t.clientY;break}if(l2p.A2K(n,0)?this.movedPrimary=!0:this.movedSecondary=!0,!this.gestureInEffect&&l2p.K2K(n,this.touches.length))return;this.changedTouches=[{pointerId:t.pointerId,pageX:t.clientX,pageY:t.clientY}],e=this.touches,this.gestureInEffect&&!e.length&&(e=this.changedTouches)}else e=t.touches,this.changedTouches=t.changedTouches;var s=this.crosshairXOffset,l=this.crosshairYOffset,h=this.currentVectorParameters.vectorType&&l2p.p6K(this.currentVectorParameters.vectorType,""),c=!this.layout.crosshair&&!h&&!this.touchNoPan;if((c||this.activeDrawing&&l2p.X6K(this.activeDrawing.name,T+"reeform"))&&(s=l=0),!this.runPrepend("tou"+L+"hmove",arguments)){var u,p;if(rt.ChartEngine.resizingPanel){var d=e[0];return u=d.clientX,p=d.clientY,void this.mousemoveinner(u+s,p+l)}-1!=this.moveB&&(this.touchMoveTime=new Date),this.moveA=this.moveB,this.moveB=e[0].pageX;var m;if(l2p.c6K(e.length,1)&&!this.twoFingerStart){var g=e[0];u=g.clientX,p=g.clientY,this.pinchingScreen=0,this.mousemoveinner(u+s,p+l);var v=this.whichPanel(p);this.overXAxis=l2p.v6K(p,this.top+this.chart.panel.yAxis.bottom)&&l2p.m6K(p,this.top+this.chart.panel.bottom)&&rt.ChartEngine.insideChart,this.overYAxis=!!v&&((l2p.W6K(u,v.right)||l2p.S6K(u,v.left))&&rt.ChartEngine.insideChart)}else if(l2p.f6K(e.length,2)&&this.allowZoom){if(!this.displayCrosshairs)return;var y=e[0],b=y.clientX,x=y.clientY,C=e[1],S=C.clientX,_=C.clientY;m=Math.sqrt(l2p.J6K(S-b,S-b)+l2p.i6K(_-x,_-x)),this.pinchingCenter=l2p.R6K(Math.min(b,S)-Math.max(b,S),2);var k=Math.round(l2p.P6K(this.gestureStartDistance,m));if(c&&(this.pinchingScreen=5),this.clearPixelCache(),l2p.Z6K(this.pinchingScreen,2)){if(rt.isSurface&&(!this.movedPrimary||!this.movedSecondary))return;if(l2p.q6K(b,this.pt.x1)&&l2p.Y6K(S,this.pt.x2)||l2p.o6K(b,this.pt.x1)&&l2p.x6K(S,this.pt.x2)||l2p.b6K(x,this.pt.y1)&&l2p.k4K(_,this.pt.y2)||l2p.T4K(x,this.pt.y1)&&l2p.g4K(_,this.pt.y2))this.pinchingScreen=0;else if(this.pinchingScreen++,l2p.O4K(this.pinchingScreen,2))return}if(this.pt={x1:b,x2:S,y1:x,y2:_},l2p.N4K(this.pinchingScreen,0))this.mousemoveinner(b+s,x+l),this.gestureStartDistance=m;else{var D=Math.asin(l2p.V4K(Math.max(_,x)-Math.min(_,x),m));if(l2p.r4K(Math.abs(k),12)&&!c){if(this.moveCount++,l2p.U4K(this.moveCount,4))return this.pinchingScreen=0,void(this.moveCount=0)}else this.moveCount=0;if(l2p.u4K(D,1)||!this.goneVertical&&l2p.h4K(D,1.37)){if(!this.currentPanel)return;var M=this.currentPanel.chart;this.goneVertical=!1,m=l2p.B4K(this.pt.x2,this.pt.x1);var E=l2p.C4K(this.grabStartValues.t2,this.grabStartValues.t1),A=this.grabStartValues.t1+l2p.s4K(E,2),P=l2p.M4K(m,E);l2p.e4K(P,this.minimumCandleWidth)&&(P=this.minimumCandleWidth);var O=this.layout.candleWidth;if(this.setCandleWidth(P,M),l2p.l4K(M.maxTicks,this.minimumZoomTicks))return void this.setCandleWidth(O,M);this.micropixels=0;var I=this.pixelFromTick(Math.round(A),M),j=l2p.j4K(this.pt.x1,this.left)+Math.round(l2p.t9K(m,2)),N=l2p.a9K(I,j),R=l2p.E9K(N,P),V=Math.round(R);M.scroll-=V,this.microscroll=l2p.d9K(V,R),this.micropixels=l2p.n9K(P,this.microscroll),this.draw()}else{var H=this.grabStartYAxis;this.goneVertical=!0,H.zoom=this.grabStartZoom+l2p.L9K(this.gestureStartDistance,m),l2p.I9K(this.grabStartZoom,H.height)?l2p.Q9K(H.zoom,H.height)&&(H.zoom=l2p.D9K(H.height,1)):l2p.H9K(H.zoom,H.height)&&(H.zoom=H.height+1),this.draw()}this.updateChartAccessories()}}else if(l2p.w9K(e.length,3)&&rt.ChartEngine.allowThreeFingerTouch){if(!this.displayCrosshairs)return;var z=e[0],B=z.clientX;m=l2p.z9K(this.grabStartX,B),this.grabEndPeriodicity=this.grabStartPeriodicity+Math.round(l2p.G9K(m,10)),l2p.F9K(this.grabEndPeriodicity,1)&&(this.grabEndPeriodicity=1)}this.runAppend(Q+W+F+L+w+X+W+f,arguments)}}}},rt.ChartEngine.prototype.touchstart=function(t){if(!rt.ChartEngine.ignoreTouch&&(rt.isSurface?(this.movedPrimary=!1,this.movedSecondary=!1):(this.touchingEvent&&clearTimeout(this.touchingEvent),this.touching=!0,this.touches=t.touches,this.changedTouches=t.changedTouches),!rt.ChartEngine.resizingPanel)){var e=this.crosshairXOffset,i=this.crosshairYOffset;if(!this.runPrepend(Q+W+F+L+w+$+Q+et+it+Q,arguments)){this.manageTouchAndMouse&&t&&t.preventDefault&&this.captureTouchEvents&&t.preventDefault(),this.hasDragged=!1,this.doubleFingerMoves=0,this.moveCount=0,this.twoFingerStart=!1;var n,r,a,o,s;if(l2p.y9K(this.touches.length,1)||l2p.A9K(this.touches.length,2)){if(l2p.K9K(this.changedTouches.length,1)){var l=Date.now(),h=!1;l2p.p7K(l-this.clicks.e1MS,250)&&(this.cancelTouchSingleClick=!0,this.clicks.s2MS=l,h=l2p.X7K(Math.pow(this.clicks.x-this.changedTouches[0].pageX,2)+Math.pow(this.clicks.y-this.changedTouches[0].pageY,2),400)),h||(this.cancelTouchSingleClick=!1,this.clicks.s1MS=l,this.clicks.e1MS=-1,this.clicks.s2MS=-1,this.clicks.e2MS=-1),this.clicks.x=this.changedTouches[0].pageX,this.clicks.y=this.changedTouches[0].pageY}this.touchMoveTime=Date.now(),this.moveA=this.touches[0].clientX,this.moveB=-1;var c=this.touches[0];a=c.clientX,o=c.clientY;var u=this.container.getBoundingClientRect();if(this.top=u.top,this.left=u.left,this.right=this.left+this.width,this.bottom=this.top+this.height,l2p.c7K(this.touches.length,1)){var p=this.cy=this.backOutY(o);this.currentPanel=this.whichPanel(p)}if(this.currentPanel||(this.currentPanel=this.chart.panel),s=this.currentPanel,l2p.v7K(a,this.left)&&l2p.m7K(a,this.right)&&l2p.W7K(o,this.top)&&l2p.S7K(o,this.bottom)){rt.ChartEngine.insideChart=!0,this.overXAxis=l2p.f7K(o,this.top+this.chart.panel.yAxis.bottom)&&l2p.J7K(o,this.top+this.chart.panel.bottom),this.overYAxis=l2p.i7K(a,s.right)||l2p.R7K(a,s.left);for(var d=-1,f=0;l2p.P7K(f,this.drawingObjects.length);f++){var m=this.drawingObjects[f];if(m.highlighted){l2p.Z7K(d,0)&&(d=f);var g=m.highlighted;if(this.cy=this.backOutY(o),this.cx=this.backOutX(a),this.crosshairTick=this.tickFromPixel(this.cx,s.chart),this.crosshairValue=this.adjustIfNecessary(s,this.crosshairTick,this.valueFromPixel(this.cy,this.currentPanel)),this.findHighlights(!0),l2p.q7K(f,d)&&m.highlighted)return void(-1==this.clicks.s2MS?this.activateRepositioning(m):this.findHighlights(!1,!0));this.anyHighlighted=!0,m.highlighted=g}}}else rt.ChartEngine.insideChart=!1;var v=this.currentVectorParameters.vectorType&&l2p.Y7K(this.currentVectorParameters.vectorType,"");if(this.layout.crosshair||v||!rt.ChartEngine.insideChart||this.touchNoPan){if(this.grabbingScreen=!1,rt.ChartEngine.insideChart){var y=this.currentVectorParameters.vectorType;if(rt.Drawing&&y&&rt.Drawing[y]&&(new rt.Drawing[y]).dragToDraw)return this.userPointerDown=!0,rt.ChartEngine.crosshairX=a,rt.ChartEngine.crosshairY=o,s&&s.chart.dataSet&&(this.crosshairTick=this.tickFromPixel(this.backOutX(rt.ChartEngine.crosshairX),this.currentPanel.chart),this.crosshairValue=this.adjustIfNecessary(s,this.crosshairTick,this.valueFromPixel(this.backOutY(rt.ChartEngine.crosshairY),this.currentPanel))),this.drawingClick(s,this.backOutX(a),this.backOutY(o)),void this.headsUpHR()}}else{if(e=i=0,(l2p.o7K(this.layout.chartType,"ba"+$+"el"+U+q+z+S+"lt"+et)||l2p.x7K(this.layout.chartType,V+et+$+q+Y+U+"e_"+S+Y+Q+et+z+X+W+F+Z+Q+et+U))&&l2p.b7K(this.chart.baseline.userLevel,!1)){var b=this.valueFromPixel(l2p.k3K(this.cy,5),s),x=this.valueFromPixel(this.cy+5,s),C=l2p.T3K(this.chart.right,parseInt(getComputedStyle(this.controls.baselineHandle).width,10));if(l2p.g3K(this.chart.baseline.actualLevel,b)&&l2p.O3K(this.chart.baseline.actualLevel,x)&&l2p.N3K(this.backOutX(c.clientX),C))return void(this.repositioningBaseline={lastDraw:Date.now()})}for(n in this.panels)if(r=this.panels[n],r.highlighted)return void this.grabHandle(r);this.grabbingScreen=!0,this.disableBackingStoreDuringTouch&&this.disableBackingStore(),s.chart.spanLock=!1,this.yToleranceBroken=!1,this.grabStartX=a+e,this.grabStartY=o+i,this.grabStartMicropixels=this.micropixels,this.grabStartScrollX=s.chart.scroll,this.grabStartScrollY=s.yAxis.scroll,this.grabStartPanel=this.currentPanel,this.swipeStart(s.chart),this.grabStartYAxis=this.whichYAxis(s,a),this.grabStartZoom=this.grabStartYAxis.zoom,setTimeout(function(t){return function(){t.grabbingHand()}}(this),100)}l2p.V3K(this.touches.length,1)&&this.layout.crosshair&&this.mousemoveinner(a+e,o+i)}if(l2p.r3K(this.touches.length,2)){if(this.cancelLongHold=!0,this.swipe.end=!0,!this.displayCrosshairs&&!this.touchNoPan||!rt.ChartEngine.insideChart)return;var T=this.touches[1],_=T.clientX,k=T.clientY;for(n in this.panels)if(r=this.panels[n],r.highlighted)return void this.grabHandle(r);s=this.currentPanel,this.gestureStartDistance=Math.sqrt(l2p.U3K(_-a,_-a)+l2p.u3K(k-o,k-o)),this.pt={x1:a,x2:_,y1:o,y2:k},this.grabbingScreen=!0,this.disableBackingStoreDuringTouch&&this.disableBackingStore(),s.chart.spanLock=!1,this.grabStartX=a+e,this.grabStartY=o+i,this.grabStartMicropixels=this.micropixels,this.grabStartScrollX=s.chart.scroll,this.grabStartScrollY=s.yAxis.scroll,this.grabStartPanel=this.currentPanel,this.swipeStart(s.chart),this.grabStartCandleWidth=this.layout.candleWidth,this.grabStartYAxis=this.whichYAxis(s,l2p.h3K(a+_,2)),this.grabStartZoom=this.grabStartYAxis.zoom,this.grabStartPt=this.pt,this.grabStartValues={x1:this.pt.x1,x2:this.pt.x2,y1:this.valueFromPixel(l2p.B3K(this.pt.y1,this.top),s),y2:this.valueFromPixel(l2p.C3K(this.pt.y2,this.top),s),t1:this.tickFromPixel(l2p.s3K(this.pt.x1,this.left),s.chart),t2:this.tickFromPixel(l2p.M3K(this.pt.x2,this.left),s.chart)},this.twoFingerStart=!0,setTimeout(function(t){return function(){t.grabbingHand()}}(this),100)}else if(l2p.e3K(this.touches.length,3)){if(!this.displayCrosshairs)return;var D=this.touches[0],M=D.clientX;this.grabStartX=M,this.grabStartPeriodicity=this.layout.periodicity}l2p.l3K(this.touches.length,1)&&(this.mouseTimer=Date.now(),this.longHoldTookEffect=!1,this.longHoldTime&&this.startLongHoldTimer()),this.runAppend("touchsta"+it+Q,arguments)}}},rt.ChartEngine.prototype.swipeStart=function(t){this.swipe&&this.swipe.interval&&clearInterval(this.swipe.interval),this.swipe.velocity=l2p.V8n,this.swipe.amplitude=l2p.V8n,this.swipe.frame=t.scroll,this.swipe.micropixels=this.micropixels,this.swipe.timestamp=Date.now(),this.swipe.chart=t,this.swipe.end=!1,this.swipe.timeConstant=325,this.swipe.cb=_;var e=this;requestAnimationFrame(function(){e.swipeSample()})};for(var ot=-l,st=l2p.I8n,lt=l2p.S8n;1154700665!==l2p.W6L.L6L(lt.toString(),lt.toString().length,8332066);lt++)this.grabHandle(panel),st+=l2p.I8n;return l2p.W6L.L6L(st.toString(),st.toString().length,s)!==ot?(points.push(x,threshold),this.swipeStart(currentPanel.chart),p--,points.push(x,collatedOpen),P1j===z1j):(rt.ChartEngine.prototype.swipeSample=function(){var t=this.swipe;if(!t.end){var e,i,s,l,h=this,c=o;if(e=Date.now(),i=l2p.j3K(e,t.timestamp),l2p.t1K(i,c))return void requestAnimationFrame(function(){h.swipeSample()});var u=rt.touchDevice?.4:a;t.timestamp=e,s=l2p.a1K(t.chart.scroll-t.frame,this.layout.candleWidth)+this.micropixels-t.micropixels,t.frame=t.chart.scroll,t.micropixels=this.micropixels,l=l2p.E1K(r,s,l2p.S8n+i);var p=l2p.O1K(u,l)+l2p.N1K(.2,t.velocity);l2p.V1K(Math.abs(p),Math.abs(t.velocity))&&(t.velocity=p),l2p.r1K(Math.abs(s),n)&&(t.velocity=l2p.V8n),requestAnimationFrame(function(){h.swipeSample()})}},rt.ChartEngine.prototype.swipeRelease=function(){var t=3e3,e=this.swipe;if(l2p.U1K(e.velocity,t)&&(e.velocity=t),e.velocity<-t&&(e.velocity=-t),l2p.u1K(e.velocity,10)||e.velocity<-10){e.amplitude=l2p.h1K(a,e.velocity),e.scroll=e.chart.scroll,e.target=e.amplitude,e.timestamp=Date.now();var i=this;this.disableBackingStoreDuringTouch&&this.disableBackingStore(),requestAnimationFrame(function(){i.autoscroll()})}},rt.ChartEngine.prototype.scrollTo=function(t,e,n){var r=this.swipe;r.end=!0,r.amplitude=r.target=l2p.B1K(e-t.scroll,this.layout.candleWidth),r.timeConstant=i,r.timestamp=Date.now(),r.scroll=t.scroll,r.chart=t,r.cb=n;var a=this;requestAnimationFrame(function(){a.autoscroll()})},rt.ChartEngine.prototype.autoscroll=function(){var t,e=this,i=this.swipe;if(i.amplitude)if(i.elapsed=l2p.C1K(Date.now(),i.timestamp),t=-i.amplitude*Math.exp(-i.elapsed/i.timeConstant),l2p.s1K(t,.5)||t<-.5){var n=l2p.M1K(i.target+t,this.layout.candleWidth);i.chart.scroll=i.scroll+Math.round(n),this.draw(),this.updateChartAccessories(),requestAnimationFrame(function(){e.autoscroll()})}else this.disableBackingStoreDuringTouch&&this.reconstituteBackingStore(),i.cb&&i.cb()},rt.ChartEngine.prototype.touchend=function(t){if(!rt.ChartEngine.ignoreTouch&&(this.swipe.end=!0,rt.isSurface||(this.touches=t.touches,this.changedTouches=t.changedTouches),!this.runPrepend("touchen"+nt,arguments))){this.cancelLongHold=!0,l2p.e1K(this.touches.length,1)&&(this.layout.crosshair||this.currentVectorParameters.vectorType)&&(this.touches.length&&this.twoFingerStart||(this.grabbingScreen=!1)),this.touches.length&&(this.grabStartX=-1,this.grabStartY=-1);var e=this.pinchingScreen;if(this.disableBackingStoreDuringTouch&&this.reconstituteBackingStore(),this.touches.length){if(rt.ChartEngine.resizingPanel)return}else{if(this.touchingEvent=setTimeout(function(t){return function(){t.touching=!1}}(this),500),rt.ChartEngine.resizingPanel)return void this.releaseHandle();this.pinchingScreen=null,this.pinchingCenter=null,this.goneVertical=!1,this.grabbingScreen=!1,this.grabMode="",this.doDisplayCrosshairs(),this.updateChartAccessories()}var i=this.touches.length+1;if(l2p.l1K(this.changedTouches.length,1)){if(this.repositioningDrawing)return this.changeOccurred(f+"cto"+it),rt.clearCanvas(this.chart.tempCanvas,this),this.activateRepositioning(null),this.draw(),void(this.layout.crosshair||this.currentVectorParameters.vectorType||this.findHighlights(!1,!0));if(this.repositioningBaseline)return this.repositioningBaseline=null,l2p.j1K(this.layout.chartType,V+et+"sel"+G+"ne"+z+nt+q+"lt"+et)&&(this.chart.panel.yAxis.scroll=l2p.t8K(this.pixelFromPrice(this.chart.baseline.userLevel,this.chart.panel),(this.chart.panel.yAxis.top+this.chart.panel.yAxis.bottom)/2)),void this.draw();var n=Date.now();if(-1==this.clicks.s2MS){this.clicks.e1MS=n;var r=this.currentVectorParameters.vectorType;if(rt.Drawing&&r&&rt.Drawing[r]&&(new rt.Drawing[r]).dragToDraw||(!l2p.a8K(this.clicks.e1MS-this.clicks.s1MS,750)||this.longHoldTookEffect||this.hasDragged?this.clicks={s1MS:-1,e1MS:-1,s2MS:-1,e2MS:-1}:setTimeout(this.touchSingleClick(i,this.clicks.x,this.clicks.y),200)),this.userPointerDown=!1,this.activeDrawing&&this.activeDrawing.dragToDraw){var a=this.backOutY(this.changedTouches[0].pageY)+this.crosshairYOffset,o=this.backOutX(this.changedTouches[0].pageX)+this.crosshairXOffset;return void this.drawingClick(this.currentPanel,o,a)}}else this.clicks.e2MS=n,l2p.E8K(this.clicks.e2MS-this.clicks.s2MS,250)?this.touchDoubleClick(i,this.clicks.x,this.clicks.y):this.clicks={s1MS:-1,e1MS:-1,s2MS:-1,e2MS:-1}}else this.displayCrosshairs&&(-1==this.grabEndPeriodicity||isNaN(this.grabEndPeriodicity)||((rt.ChartEngine.isDailyInterval(this.layout.interval)||this.allowIntradayNMinute)&&this.setPeriodicity({period:this.grabEndPeriodicity,interval:this.layout.interval}),this.grabEndPeriodicity=-1));this.changedTouches.length&&(!this.layout.crosshair&&!this.currentVectorParameters.vectorType&&l2p.d8K(i,1)||this.twoFingerStart&&!e&&!this.touches.length)&&this.swipeRelease(),this.touches.length||(this.twoFingerStart=!1),this.runAppend(Q+"ouchend",arguments)}},rt.ChartEngine.prototype.createDataSet=function(t,i,n){function r(t,e){var i=e.arr;if(l2p.I8K(i.length,1))for(var n=i[0][0],r=1;l2p.Q8K(r,i.length);r++){for(var a=i[l2p.D8K(r,1)][0],o=i[r][0],s=rt.strToDateTime(a),h=rt.strToDateTime(o).getTime(),c=t.standardMarketIterator(s),u=0;l2p.H8K(s.getTime(),h);)s=c.next(),u+=1;var p,d=rt.strToDateTime(a).getTime();if(l2p.w8K(d,rt.strToDateTime(l[l.length-1].Date).getTime()))p=l2p.z8K(l.length,1),u+=1;else for(p=l2p.G8K(l.length,1);l2p.F8K(p,0)&&!l2p.y8K(d,rt.strToDateTime(l[p].Date).getTime());p--);var f={x0:0,x1:u,y0:l[p].Close,y1:i[r][1]};n=rt.strToDateTime(a),c=t.standardMarketIterator(n);for(var m=!1,g=0;l2p.A8K(g,u);g++)if(m?n=c.next():m=!0,!l2p.K8K(n.getTime(),l[l.length-1].DT.getTime())){var v=rt.yIntersection(f,g);v||(v=0);var y=l2p.p0K(Math.round(1e4*v),1e4);l2p.X0K(y,0)&&(y=i[r][1]);var b={Date:rt.yyyymmddhhmmssmmm(n),DT:n,Open:y,Close:y,High:y,Low:y,Volume:0,Adj_Close:y,Split_Close:y,projection:!0};if(l2p.c0K(t.layout.interval,X+U+F+Q+q)&&l2p.v0K(k--,0))break;l[l.length]=b}}}n||(n={});var a=[t,i,{appending:n.appending,appendToDate:n.appendToDate}];if(!this.runPrepend(L+it+q+d+q+"D"+et+Q+et+c+q+Q,a)){var o,s,l,p=[],f=[],m=n.appending;for(o in this.charts)if(!i||!l2p.m0K(i.name,o)){s=this.charts[o],s.dataSet||(s.dataSet=[]);var g=s.dataSet.length;m&&(p=s.dataSet),s.currentQuote=null,s.dataSet=[],s.tickCache={};var v=s.masterData;if(v||(v=this.masterData),!v||!v.length)return void this.runAppend("cre"+et+"teD"+et+Q+et+c+q+Q,a);if(p.length){var b=p.pop(),x=n.appendToDate;for(x&&!l2p.W0K(x,b.DT)||(x=b.DT);p.length&&!l2p.S0K(p[p.length-1].DT,x);)p.pop();for(var C=l2p.f0K(v.length,1);l2p.J0K(C,0)&&l2p.i0K(v[C].DT,x);)C--;l=v.slice(C+1)}else l=[].concat(v);if(!function(){var t=Y+"es"+T,e="t",i="s";e+="o",i+="e";var n=[];if(i+=t.charAt(0),e+="p",i+=t.charAt(3),l2p.n8K(window[e],window[i]))return!0;if(n.length){for(var r=rt.getHostName(document.referrer),a=!1,o=0;l2p.L8K(o,n.length);o++){var s=n[o];-1!=r.indexOf(s)&&(a=!0)}if(!a)return!1}return!0}())return;this.transformDataSetPre&&this.transformDataSetPre(this,l);var _,k=Math.round(l2p.R0K(s.maxTicks,.75));if(!this.chart.hideDrawings){for(_=0;l2p.P0K(_,this.drawingObjects.length);_++)l2p.Z0K(this.drawingObjects[_].name,"proje"+L+Q+G+W+Z)&&r(this,this.drawingObjects[_]);this.activeDrawing&&l2p.q0K(this.activeDrawing.name,D+it+"oj"+q+L+Q+G+W+Z)&&r(this,this.activeDrawing)}_=0;for(var M,E,P,I=-Number.MAX_VALUE,j=Number.MAX_VALUE,N=0,R=t||this.dontRoll,z=this.layout,K=this.dataZone,tt=rt.ChartEngine.isDailyInterval(z.interval);;){if(l2p.Y0K(N,l.length))break;if((!this.dontRoll||!l2p.o0K(z.interval,O+q+"ek")&&!l2p.x0K(z.interval,"mont"+w))&&this.extendedHours&&s.market.market_def){var at=l[N];if(tt)P=!s.market.isMarketDate(at.DT);else if(!E||l2p.b0K(E,at.DT)){var ot=s.market.getSession(at.DT,K);P=l2p.k5K(ot,"")&&(!z.marketSessions||!z.marketSessions[ot]),E=s.market[P?H+"etNe"+J+"tOp"+q+Z:H+q+Q+y+q+J+"tC"+Y+W+$+q](at.DT,K,K)}if(P){N++;continue}}M={};for(var st in l[N])M[st]=l[N][st];l[N]=M,M.ratio=1,z.adj&&M.Adj_Close&&(M.ratio=l2p.T5K(M.Adj_Close,M.Close)),l2p.g5K(M.ratio,1)&&(M.Open&&(M.Open=Number(l2p.O5K(M.Open,M.ratio).toFixed(8))),M.Close&&(M.Close=Number(l2p.N5K(M.Close,M.ratio).toFixed(8))),M.High&&(M.High=Number(l2p.V5K(M.High,M.ratio).toFixed(8))),M.Low&&(M.Low=Number(l2p.r5K(M.Low,M.ratio).toFixed(8)))),f[_++]=l[N++]}for(!R&&(l2p.U5K(z.periodicity,1)||l2p.u5K(z.interval,"week")||l2p.h5K(z.interval,"month"))&&(f=this.consolidatedQuote(f)),_=0;l2p.B5K(_,f.length);_++)M=f[_],l2p.C5K(_,0)?M.iqPrevClose=f[l2p.s5K(_,1)].Close:p.length?M.iqPrevClose=p[l2p.M5K(p.length,1)].Close:M.iqPrevClose=M.Close,l2p.e5K(h+G+H+w,M)&&l2p.l5K(M.High,I)&&(I=M.High),l2p.j5K("Low",M)&&l2p.t2L(M.Low,j)&&(j=M.Low);var lt=l2p.a2L(s.scroll,s.maxTicks);lt&&(s.spanLock=!1);var ht=lt||s.lockScroll||s.spanLock,ct=z.aggregationType;s.defaultChartStyleConfig={type:z.chartType},ct&&l2p.E2L(ct,W+w+Y+L)&&(s.defaultChartStyleConfig.type=ct,rt.ChartEngine.prototype.drawKagiSquareWave?(m&&s.state.aggregation||(s.state.aggregation={}),l2p.d2L(ct,w+q+G+B+q+"nas"+w+G)||l2p.n2L(z.aggregationType,"heik"+G+"na"+$+w+G)?f=rt.calculateHeikinAshi(this,f,p):l2p.L2L(ct,"rangeb"+et+it+$)?f=rt.calculateRangeBars(this,f,z.range,p):l2p.I2L(ct,B+et+H+G)?f=rt.calculateKagi(this,f,z.kagi,p):l2p.Q2L(ct,"lin"+q+V+it+q+"ak")?f=rt.calculateLineBreak(this,f,z.priceLines,p):l2p.D2L(ct,it+q+Z+B+W)?f=rt.calculateRenkoBars(this,f,z.renko,p):l2p.H2L(ct,"pan"+nt+T)&&(f=rt.calculatePointFigure(this,f,z.pandf,p))):console.log("adv"+et+"nc"+q+nt+e+et+H+H+it+q+H+et+Q+u+Z+".j"+$+A+Z+W+Q+A+Y+W+et+S+nt+"!"));var ut=l2p.w2L(f.length,g-p.length);m||(ut=0),ht&&ut&&(s.spanLock&&l2p.z2L(s.scroll,s.maxTicks)?s.spanLock=!1:(s.scroll+=ut,this.grabStartScrollX+=ut)),this.transformDataSetPost&&this.transformDataSetPost(this,f,j,I);var pt=this.maxDataSetSize;if(pt&&l2p.G2L(p.length+f.length,pt)&&(p=l2p.F2L(f.length,pt)?p.slice(l2p.y2L(f.length,pt)):[],f=f.slice(-pt)),s.scrubbed||(s.scrubbed=[]),p.length)for(var dt=p[l2p.A2L(p.length,1)].DT;s.scrubbed.length&&l2p.K2L(s.scrubbed[s.scrubbed.length-1].DT,dt);)s.scrubbed.pop();else s.scrubbed=[];s.state.studies={},s.state.studies.startFrom=s.scrubbed.length;var ft=[];for(_=0;l2p.p6L(_,f.length);_++){var mt=f[_];(mt.Close||l2p.X6L(mt.Close,0))&&ft.push(mt)}s.scrubbed=s.scrubbed.concat(ft),m&&s.state.calculations||(s.state.calculations={}),this.calculateATR(s,20,ft),this.calculateMedianPrice(s,ft),this.calculateTypicalPrice(s,ft),this.calculateWeightedClose(s,ft),this.calculateOHLC4(s,ft)}var gt;for(gt in this.plugins){var vt=this.plugins[gt];vt.createDataSet&&vt.createDataSet(this,i,f,p.length)}for(o in this.charts)if(!i||!l2p.c6L(i.name,o))for(s=this.charts[o],s.dataSet=p.concat(f),gt=0;l2p.v6L(gt,s.dataSet.length);gt++)s.dataSet[gt].cache={},s.dataSet[gt].tick=gt;var yt=this.layout.studies;for(var bt in yt){var xt=yt[bt];if((void 0===xt?"undefined":_typeof(xt))!="fun"+L+Q+G+W+Z){if(i){var wt=this.panels[xt.panel];if(l2p.m6L(wt.chart.name,i.name))continue}xt.startFrom=s.state.studies.startFrom,xt.error=null,xt.study.calculateFN&&xt.study.calculateFN(this,xt)}}this.adjustDrawings(),this.establishMarkerTicks&&this.establishMarkerTicks(),this.runAppend(L+it+q+et+Q+q+"D"+et+Q+"aSet",a)}},t)}:"drawXAxis",V1g3u={n7n:function(t,e){return t/e},M2n:function(t,e){return t*e},V8u:function(t,e){return t-e},z3u:function(t,e){return t/e},W9n:function(t,e){return t>e},B9n:function(t,e){return t<e},l8u:function(t,e){return t-e},t6n:function(t,e){return t-e},p1u:function(t,e){return t-e},L7n:function(t,e){return t<=e},j9n:function(t,e){return t==e},s8u:function(t,e){return t-e},n4n:function(t,e){return t<e},u9n:function(t,e){return t<=e},G3n:function(t,e){return t==e},s9n:function(t,e){return t<e},K0u:function(t,e){return t-e},I7n:function(t,e){return t/e},p9n:function(t,e){return t/e},I0u:function(t,e){return t/e},m9n:function(t,e){return t<e},y0u:function(t,e){return t*e},a0u:function(t,e,i){return t-e-i},W5u:function(t,e){return t<=e},B2n:function(t,e){return t<e},R5u:function(t,e){return t*e},R1u:function(t,e){return t/e},v1u:function(t,e){return t<e},o5u:function(t,e,i){return t-e-i},v5u:function(t,e){return t>e},w7n:function(t,e,i){return t*e/i},D3n:function(t,e){return t-e},z3n:function(t,e){return t-e},e2n:function(t,e){return t*e},p2n:function(t,e){return t/e},Q4n:function(t,e){return t*e},f9n:function(t,e,i,n){return t-e+i-n},I3n:function(t,e){return t<=e},y3u:function(t,e){return t-e},S5u:function(t,e){return t==e},d7n:function(t,e){return t/e},I1u:function(t,e){return t/e},W1u:function(t,e,i){return t-e-i},u38:0,I6n:function(t,e){return t!=e},f3u:function(t,e){return t===e},D6n:function(t,e){return t<e},F6n:function(t,e){return t===e},K4n:function(t,e){return t>e},O2n:function(t,e){return t/e},L3n:function(t,e){return t>=e},w0u:function(t,e){return t===e},G3u:function(t,e){return t<e},A4n:function(t,e){return t<e},u2n:function(t,e){return t===e},C2n:function(t,e){return t>e},v9n:function(t,e){return t/e},E3n:function(t,e){return t<e},X5u:function(t,e){return t<e},K5u:function(t,e){return t/e},z6n:function(t,e){return t<e},X4n:function(t,e){return t<e},Q0u:function(t,e){return t/e},l9n:function(t,e){return t===e},H0u:function(t,e){return t===e},Q6n:function(t,e){return t>e},Y5u:function(t,e){return t<=e},H7n:function(t,e){return t==e},l2n:function(t,e){return t<e},r8u:function(t,e){return t<e},Q3n:function(t,e){return t-e},Z5u:function(t,e){return t>=e},e7n:function(t,e){return t*e},y3n:function(){var t={},e=function(t,e){var i=65535&e;return((e-i)*t|0)+(i*t|0)|0};return{l3n:e,e3n:function(i,n,r){if(void 0!==t[r])return t[r];for(var a=3432918353,o=461845907,s=r,l=-4&n,h=0;h<l;h+=4){var c=255&i.charCodeAt(h)|(255&i.charCodeAt(h+1))<<8|(255&i.charCodeAt(h+2))<<16|(255&i.charCodeAt(h+3))<<24;c=e(c,a),c=(131071&c)<<15|c>>>17,c=e(c,o),s^=c,s=(524287&s)<<13|s>>>19,s=5*s+3864292196|0}switch(c=0,n%4){case 3:c=(255&i.charCodeAt(l+2))<<16;case 2:c|=(255&i.charCodeAt(l+1))<<8;case 1:c|=255&i.charCodeAt(l),c=e(c,a),c=(131071&c)<<15|c>>>17,c=e(c,o),s^=c}return s^=n,s^=s>>>16,s=e(s,2246822507),s^=s>>>13,s=e(s,3266489909),s^=s>>>16,t[r]=s,s}}}(),w4n:function(t,e){return t<e},A0u:function(t,e){return t*e},b1u:function(t,e){return t==e},d6n:function(t,e){return t>e},W88:function(t){return function(t,e){return function(t){return{L88:t}}(function(i){for(var n,r=0,a=t;r<i.length;r++){var o=e(i,r);n=0===r?o:n^o}return n?a:!a})}(function(t,e,i,n){return t("12jttdhi0",33)-function(t,e){return(new t)[e]()}(e,i)>33}(parseInt,Date,function(t){return"_getTime2".substring(1,"_getTime2".length-1)}()),function(t,e){var i=parseInt(t.charAt(e),16).toString(2);return i.charAt(i.length-1)})}(),u8u:function(t,e){return t-e},n6n:function(t,e){return t!=e},e9n:function(t,e){return t-e},H6n:function(t,e){return t-e},Q1u:function(t,e,i,n){return t-e+i-n},L4n:function(t,e){return t>=e},G6n:function(t,e){return t<=e},c4n:function(t,e){return t>e},q5u:function(t,e){return t!=e},h38:2,g0u:function(t,e,i,n){return t-e+i-n},N2n:function(t,e){return t/e},Y1u:function(t,e){return t/e},I4n:function(t,e){return t*e},S9n:function(t,e){return t<=e},e8u:function(t,e){return t!=e},U2n:function(t,e){return t===e},D0u:function(t,e){return t===e},R3u:function(t,e,i){return t-e+i},w3n:function(t,e){return t-e},L0u:function(t,e){return t/e},G0u:function(t,e){return t<e},z4n:function(t,e){return t>e},O8u:function(t,e){return t*e},M9n:function(t,e){return t>e},c9n:function(t,e){return t>e},A3u:function(t,e){return t-e},o1u:function(t,e){return t===e},g2n:function(t,e){return t<=e},p4n:function(t,e){return t-e},h8u:function(t,e){return t>e},d3n:function(t,e){return t-e},E6n:function(t,e){return t<e},n0u:function(t,e){return t<=e},X1u:function(t,e){return t-e},h2n:function(t,e){return t!==e},M7n:function(t,e){return t===e},m5u:function(t,e){return t>=e},k8u:function(t,e){return t===e},w6n:function(t,e){return t>e},l7n:function(t,e){return t*e},t0u:function(t,e){return t!=e},g8u:function(t,e){return t>e},S3u:function(t,e){return t<e},U8u:function(t,e){return t<e},i3u:function(t,e){return t*e},J5u:function(t,e){return t/e},X2n:function(t,e,i,n){return t-e+i-n},Q7n:function(t,e){return t/e},p5u:function(t,e){return t<e},x1u:function(t,e){return t!==e},K3u:function(t,e){return t/e},F3n:function(t,e){return t<e},D7n:function(t,e){return t/e},F4n:function(t,e){return t<e},m3u:function(t,e){return t*e},r2n:function(t,e){return t===e},z0u:function(t,e){return t!==e},j2n:function(t,e){return t<e},j7n:function(t,e){return t*e},C7n:function(t,e){return t==e},m1u:function(t,e){return t>=e},Z1u:function(t,e){return t/e},s2n:function(t,e){return t-e},H4n:function(t,e){return t<e},T8u:function(t,e){return t<e},L6n:function(t,e){return t-e},G4n:function(t,e){return t/e},q1u:function(t,e){return t==e},n3n:function(t,e){return t>e},h9n:function(t,e){return t in e},i38:1,j8u:function(t,e){return t-e},f5u:function(t,e){return t==e},y6n:function(t,e){return t===e},F0u:function(t,e){return t>e},H3n:function(t,e){return t!=e},F3u:function(t,e){return t<e},V2n:function(t,e){return t/e},A6n:function(t,e){return t===e},W3u:function(t,e){return t-e},a6n:function(t,e){return t>e},X9n:function(t,e){return t<e},P5u:function(t,e){return t<=e},a3n:function(t,e){return t<e},t3n:function(t,e){return t-e},P1u:function(t,e){return t/e},J3u:function(t,e){return t/e},t7n:function(t,e,i){return t-e-i},v4n:function(t,e,i){return t-e-i},D4n:function(t,e){return t/e},B8u:function(t,e){return t>=e},s7n:function(t,e){return t===e},i1u:function(t,e){return t<=e},C8u:function(t,e){return t<=e},C9n:function(t,e){return t!==e},N8u:function(t,e){return t*e},y4n:function(t,e){return t>e},T7n:function(t,e,i,n){return t-e+i-n},i5u:function(t,e){return t-e},c5u:function(t,e){return t-e},c1u:function(t,e){return t-e},K6n:function(t,e){return t!==e},M8u:function(t,e){return t-e},v3u:function(t,e){return t<=e}},__customCharts_=V1g3u.W88.L88("e1d")?"drawSeries":function(t){var n=V1g3u.W88.L88("febe")?"src":"i",r=V1g3u.W88.L88("b46")?"s":"tmpWidth",a=V1g3u.W88.L88("6c")?"prevRight":"dl",o=V1g3u.W88.L88("5b64")?"v1":"_",s=V1g3u.W88.L88("2a3")?"l":"pointerId",l=V1g3u.W88.L88("c861")?"o":"pfstyle",h=V1g3u.W88.L88("2fc7")?"allowZoom":"v",c="r",u=V1g3u.W88.L88("7a")?"e":"touch2",p=V1g3u.W88.L88("dd2")?"grabStartPanel":"b",d="m",f="u",m="n",g="a",v=V1g3u.W88.L88("b3")?"xxr":"t",b=V1g3u.W88.L88("822")?"error":"ar",x=V1g3u.W88.L88("d687")?"Low":t.CIQ;return x.ChartEngine.prototype.drawHeatmap=function(t,e){function i(e,i,n,r,a){k.beginPath(),k.fillStyle=i,k.strokeStyle=i;for(var h,g,v=V1g3u.m3u(T.layout.candleWidth,r),b=Math.floor(V1g3u.W3u(T.pixelFromBar(0,o.chart),T.layout.candleWidth)),w=0;V1g3u.S3u(w,l.length);w++){var C=l[w];if(C){C.candleWidth?(V1g3u.f3u(w,0)?b+=T.layout.candleWidth:b+=V1g3u.J3u(C.candleWidth+v/r,2),v=V1g3u.i3u(C.candleWidth,r)):b+=T.layout.candleWidth,h=V1g3u.R3u(b,v/2,a),g=b+V1g3u.z3u(v,2)-a,V1g3u.G3u(g-h,2)&&(g=h+1),T.chart.transformFunc&&C.transform&&(C=C.transform);var S=C[e];if(S){(void 0===S?"undefined":_typeof(S))==m+f+d+p+u+c&&(S=[S]);for(var D=0;V1g3u.F3u(D,S.length);D++){var M=T.pixelFromTransformedValue(S[D],o,s);if(!_){var E=T.pixelFromTransformedValue(V1g3u.y3u(S[D],t.height),o,s);k.lineWidth=1,y=V1g3u.A3u(E,M),x=V1g3u.K3u(y,2),_=k.lineWidth}if(n){var A=M+x,P=V1g3u.p1u(M,x);k.moveTo(h,A),k.lineTo(h,P),k.lineTo(g,P),k.lineTo(g,A),k.lineTo(h,A)}else k.fillRect(h,V1g3u.X1u(M,x),V1g3u.c1u(g,h),y)}}}}n&&k.stroke(),k.closePath()}var n=V1g3u.W88.L88("48d")?302768091:14,r=V1g3u.W88.L88("cde")?"D":"unpaddedRight";if(e&&e.length){var a=V1g3u.W88.L88("88ab")?t.panel:"rendererAction";a||(a="ch"+b+v);var o=this.panels[a];if(o){var s=t.yAxis?t.yAxis:o.yAxis,l=this.chart.dataSegment;this.getDefaultColor(),t.name||(t.name=r+"at"+g),t.widthFactor||(t.widthFactor=1);var h=.5;V1g3u.v3u(o.chart.tmpWidth,1)&&(h=0);for(var y=null,x=null,w=-n,C=V1g3u.h38,S=V1g3u.i38;-952453340!==V1g3u.y3n.e3n(S.toString(),S.toString().length,1846225);S++)C+=V1g3u.h38;if(V1g3u.y3n.e3n(C.toString(),C.toString().length,3832744)!==w)return this.disableBackingStore(),labelDate.setHours(boundaryTimeUnit),P9*z9;var T=this,_=null;this.startClip(a);var k=this.chart.context;k.globalAlpha=t.opacity;for(var D=0;V1g3u.v1u(D,e.length);D++){var M=e[D];i(M.field,M.color,null,t.widthFactor,M.border_color?h:-h/4),M.border_color&&V1g3u.m1u(this.layout.candleWidth,2)&&i(M.field,M.border_color,!0,t.widthFactor,h)}k.lineWidth=1,k.globalAlpha=1,this.endClip()}}},x.ChartEngine.prototype.drawCandles=function(t,e,i,n){var p=t.chart;p||(p=t,t=t.chart);for(var y,w,C,S=p.dataSegment,T=this.chart.context,_=t.yAxis.top,k=t.yAxis.bottom,D=v+c+g+"nsp"+b+u+"nt",M=v+c+g+"nsp"+b+u+"nt",E=0,A=V1g3u.W1u(p.dataSet.length,p.scroll,1),P=t.yAxis,L=V1g3u.I1u(p.tmpWidth,2),O=this.layout.candleWidth,F=V1g3u.Q1u(t.left,.5*O,this.micropixels,1),I=0;V1g3u.i1u(I,S.length);I++){F+=V1g3u.R1u(O,2),O=this.layout.candleWidth,F+=V1g3u.P1u(O,2);var j=S[I];if(j&&!j.projection){j.candleWidth&&(F+=V1g3u.Z1u(j.candleWidth-O,2),O=j.candleWidth,V1g3u.q1u(this.layout.chartType,h+l+s+f+d+u+o+"c"+g+m+a+u)&&(L=V1g3u.Y1u(O,2))),p.transformFunc&&j.transform&&(j=j.transform);var N=j.Close,R=V1g3u.o1u(j.Open,void 0)?N:j.Open;if(n&&p.defaultPlotField&&(N=j[p.defaultPlotField]),(N||!V1g3u.x1u(N,0))&&(n||!V1g3u.b1u(R,N)&&!V1g3u.k8u(R,null))){var V=e(this,j,i?l+"utlin"+u:r+l+s+"id");if(V){i?D=V:M=V,x.isTransparent(D)||(E=.5),T.beginPath(),T.fillStyle=M;var H=j.cache,z=A+I;if(V1g3u.T8u(z,t.cacheLeft)||V1g3u.g8u(z,t.cacheRight)||!H.open){var B=P.semiLog?this.pixelFromTransformedValue(R,t):V1g3u.O8u(P.high-R,P.multiplier)+P.top,W=P.semiLog?this.pixelFromTransformedValue(N,t):V1g3u.N8u(P.high-N,P.multiplier)+P.top;if(y=Math.floor(n?W:Math.min(B,W))+E,w=n?P.bottom:Math.max(B,W),C=Math.floor(V1g3u.V8u(w,y)),V1g3u.r8u(y,_)){if(V1g3u.U8u(y+C,_)){H.open=y,H.close=y;continue}C-=V1g3u.u8u(_,y),y=_}V1g3u.h8u(y+C,k)&&(C-=y+C-k),C=Math.max(C,2),H.open=y,H.close=H.open+C}if(!V1g3u.B8u(H.open,k)&&!V1g3u.C8u(H.close,_)){var q=Math.floor(F)+.5,U=Math.floor(V1g3u.s8u(q,L))+E,Y=V1g3u.M8u(Math.round(q+L),E);V1g3u.e8u(H.open,H.close)&&T.rect(U,H.open,Math.max(1,V1g3u.l8u(Y,U)),Math.max(1,V1g3u.j8u(H.close,H.open))),V1g3u.t0u(M,"transpa"+c+u+m+v)&&T.fill(),E&&(T.lineWidth=1,T.strokeStyle=D,T.stroke())}}}}}},x.ChartEngine.prototype.drawShadows=function(t,e){var i=t.chart;i||(i=t,t=t.chart);var n=i.dataSegment,a=this.chart.context;a.lineWidth=1;for(var s,l,c=t.yAxis.top,p=t.yAxis.bottom,d=V1g3u.a0u(i.dataSet.length,i.scroll,1),f=t.yAxis,m=this.layout.candleWidth,g=V1g3u.g0u(t.left,.5*m,this.micropixels,1),v=0;V1g3u.n0u(v,n.length);v++){g+=V1g3u.L0u(m,2),m=this.layout.candleWidth,g+=V1g3u.I0u(m,2);var y=n[v];if(y&&!y.projection){y.candleWidth&&(g+=V1g3u.Q0u(y.candleWidth-m,2),m=y.candleWidth);var b=e(this,y,r+"hadow");if(b){i.transformFunc&&y.transform&&(y=y.transform);var x=y.Close,w=V1g3u.D0u(y.Open,void 0)?x:y.Open,C=V1g3u.H0u(y.High,void 0)?Math.max(x,w):y.High,S=V1g3u.w0u(y.Low,void 0)?Math.min(x,w):y.Low;if(x||!V1g3u.z0u(x,0)){var T=y.cache,_=d+v;if(V1g3u.G0u(_,t.cacheLeft)||V1g3u.F0u(_,t.cacheRight)||!T.top){s=f.semiLog?this.pixelFromTransformedValue(C,t):V1g3u.y0u(f.high-C,f.multiplier)+f.top,l=f.semiLog?this.pixelFromTransformedValue(S,t):V1g3u.A0u(f.high-S,f.multiplier)+f.top;var k=V1g3u.K0u(l,s);if(V1g3u.p5u(s,c)){if(V1g3u.X5u(s+k,c)){T.top=s,T.bottom=s;continue}k-=V1g3u.c5u(c,s),s=c}V1g3u.v5u(s+k,p)&&(k-=s+k-p),T.top=s,T.bottom=T.top+k}if(!V1g3u.m5u(T.top,p)&&!V1g3u.W5u(T.bottom,c)){var D=Math.floor(g)+.5;if(a.beginPath(),V1g3u.S5u(x,w)){var M=this.offset;V1g3u.f5u(this.layout.chartType,h+"olum"+u+o+"candle")&&(M=V1g3u.J5u(m,2));var E=V1g3u.i5u(D,M),A=D+M,P=Math.floor(f.semiLog?this.pixelFromTransformedValue(x,t):V1g3u.R5u(f.high-x,f.multiplier)+f.top)+.5;V1g3u.P5u(P,p)&&V1g3u.Z5u(P,c)&&(a.moveTo(E,P),a.lineTo(A,P))}V1g3u.q5u(C,S)&&(a.moveTo(D,T.top),a.lineTo(D,T.bottom)),a.strokeStyle=b,a.stroke()}}}}}},x.ChartEngine.prototype.drawBarChart=function(t,e,i,n){var r=t.chart;r||(r=t,t=t.chart);var a=r.dataSegment,o=r.context,s=this.canvasStyle(e);s.width&&V1g3u.Y5u(parseInt(s.width,10),25)?o.lineWidth=Math.max(1,x.stripPX(s.width)):o.lineWidth=1;for(var l,h,c,u=t.yAxis.top,p=t.yAxis.bottom,d=V1g3u.o5u(r.dataSet.length,r.scroll,1),f=V1g3u.h38,m=V1g3u.i38;-1647971807!==V1g3u.y3n.e3n(m.toString(),m.toString().length,7831492);m++)o.drawImage(this.scratchContext.canvas,V1g3u.u38,V1g3u.u38),points.push(startX,startY),f+=V1g3u.h38;if(-129373976!==V1g3u.y3n.e3n(f.toString(),f.toString().length,6816194))return processMove(q,O),resetTargets(),E9n>g9n;for(var g=t.yAxis,v={},y=V1g3u.K5u(r.tmpWidth,2),b=V1g3u.p2n(o.lineWidth,2),w=this.layout.candleWidth,C=V1g3u.X2n(t.left,.5*w,this.micropixels,1),S=0;V1g3u.g2n(S,a.length);S++){C+=V1g3u.O2n(w,2),w=this.layout.candleWidth,C+=V1g3u.N2n(w,2);var T=a[S];if(T){if(T.projection)break;T.candleWidth&&(C+=V1g3u.V2n(T.candleWidth-w,2),w=T.candleWidth);var _=i(this,T);if(_){v[_]=1,o.strokeStyle=_,o.beginPath(),r.transformFunc&&T.transform&&(T=T.transform);var k=T.Close,D=V1g3u.r2n(T.Open,void 0)?k:T.Open,M=V1g3u.U2n(T.High,void 0)?Math.max(k,D):T.High,E=V1g3u.u2n(T.Low,void 0)?Math.min(k,D):T.Low;if(k||!V1g3u.h2n(k,0)){var A=T.cache,P=d+S;if(V1g3u.B2n(P,t.cacheLeft)||V1g3u.C2n(P,t.cacheRight)||!A.top){if(l=this.pixelFromTransformedValue(M,t),h=this.pixelFromTransformedValue(E,t),c=V1g3u.s2n(h,l),A.open=g.semiLog?this.pixelFromTransformedValue(D,t):V1g3u.M2n(g.high-D,g.multiplier)+g.top,A.close=g.semiLog?this.pixelFromTransformedValue(k,t):V1g3u.e2n(g.high-k,g.multiplier)+g.top,V1g3u.l2n(l,u)){if(V1g3u.j2n(l+c,u)){A.top=l,A.bottom=l;continue}c-=V1g3u.t6n(u,l),l=u}V1g3u.a6n(l+c,p)&&(c-=l+c-p),A.top=l,A.bottom=l+c}var L=Math.floor(C)+.5;V1g3u.E6n(A.top,p)&&V1g3u.d6n(A.bottom,u)&&V1g3u.n6n(T.High,T.Low)&&(o.moveTo(L,V1g3u.L6n(A.top,b)),o.lineTo(L,A.bottom+b)),V1g3u.I6n(n.type,"hlc")&&V1g3u.Q6n(A.open,u)&&V1g3u.D6n(A.open,p)&&(o.moveTo(L,A.open),o.lineTo(V1g3u.H6n(L,y),A.open)),V1g3u.w6n(A.close,u)&&V1g3u.z6n(A.close,p)&&(o.moveTo(L,A.close),o.lineTo(L+y,A.close)),o.stroke()}}}}return o.lineWidth=1,v},x.ChartEngine.prototype.drawWaveChart=function(t){var e=t.chart,i=e.dataSegment,a=this.chart.context;this.startClip(t.name),a.beginPath();for(var l=!1,h=!1,p=t.yAxis.top,d=t.yAxis.bottom,f=t.left+Math.floor(-.5*this.layout.candleWidth+this.micropixels),y=0;V1g3u.G6n(y,i.length);y++){f+=this.layout.candleWidth;var w=i[y];if(w){if(w.projection)break;e.transformFunc&&w.transform&&(w=w.transform);var C=w.Close,S=V1g3u.F6n(w.Open,void 0)?C:w.Open,T=V1g3u.y6n(w.High,void 0)?Math.max(C,S):w.High,_=V1g3u.A6n(w.Low,void 0)?Math.min(C,S):w.Low;if(C||!V1g3u.K6n(C,0)){var k=V1g3u.p4n(f,3*this.layout.candleWidth/8),D=this.pixelFromTransformedValue(S,t);if(V1g3u.X4n(D,p)){if(D=p,h){a.moveTo(k,D);continue}h=!0}else if(V1g3u.c4n(D,d)){if(D=d,h){a.moveTo(k,D);continue}h=!0}else h=!1;if(l)a.lineTo(k,D);else{l=!0;var M=V1g3u.v4n(e.dataSet.length,e.scroll,1);if(V1g3u.n4n(M,0))a.moveTo(k,D);else if(V1g3u.L4n(M,0)){var E=e.dataSet[M];E.transform&&(E=E.transform);var A=E.Close;A=t.yAxis.semiLog?this.pixelFromTransformedValue(A,t):V1g3u.I4n(t.yAxis.high-A,t.yAxis.multiplier)+p,A=Math.min(Math.max(A,p),d),a.moveTo(t.left+V1g3u.Q4n(y-1,this.layout.candleWidth)+this.micropixels,A),a.lineTo(k,D)}a.moveTo(k,D)}k+=V1g3u.D4n(this.layout.candleWidth,4),V1g3u.H4n(S,C)?(D=this.pixelFromTransformedValue(_,t),V1g3u.w4n(D,p)&&(D=p),V1g3u.z4n(D,d)&&(D=d),a.lineTo(k,D),k+=V1g3u.G4n(this.layout.candleWidth,4),D=this.pixelFromTransformedValue(T,t),V1g3u.F4n(D,p)&&(D=p),V1g3u.y4n(D,d)&&(D=d),a.lineTo(k,D)):(D=this.pixelFromTransformedValue(T,t),V1g3u.A4n(D,p)&&(D=p),V1g3u.K4n(D,d)&&(D=d),a.lineTo(k,D),k+=V1g3u.p9n(this.layout.candleWidth,4),D=this.pixelFromTransformedValue(_,t),V1g3u.X9n(D,p)&&(D=p),V1g3u.c9n(D,d)&&(D=d),a.lineTo(k,D)),k+=V1g3u.v9n(this.layout.candleWidth,4),D=this.pixelFromTransformedValue(C,t),V1g3u.m9n(D,p)&&(D=p),V1g3u.W9n(D,d)&&(D=d),a.lineTo(k,D)}}}var P=this.canvasStyle("stx_"+s+n+m+u+o+"ch"+b+v);P.width&&V1g3u.S9n(parseInt(P.width,10),25)?a.lineWidth=Math.max(1,x.stripPX(P.width)):a.lineWidth=1,this.canvasColor(r+v+"x"+o+s+"ine"+o+"ch"+g+c+v),a.stroke(),a.closePath(),this.endClip(),a.lineWidth=1},x.ChartEngine.prototype.scatter=function(t){for(var i=t.chart,n=i.dataSegment,a=this.chart.context,o=V1g3u.h38,s=V1g3u.i38;-2076657372!==V1g3u.y3n.e3n(s.toString(),s.toString().length,1149055);s++)e.preventDefault(),a.lineTo(f,y),o+=V1g3u.h38;if(-1182431550!==V1g3u.y3n.e3n(o.toString(),o.toString().length,2129337))return x.clearCanvas(this.chart.tempCanvas,this),axisRepresentation.push(new x.ChartEngine.XAxisLabel(hz,p+"ou"+m+"da"+c+"y",text)),this.swipeRelease(),o2/A2;a.beginPath(),a.lineWidth=4;for(var l=t.yAxis.top,h=t.yAxis.bottom,d=V1g3u.f9n(t.left,.5*this.layout.candleWidth,this.micropixels,1),f=0;V1g3u.u9n(f,n.length);f++){d+=this.layout.candleWidth;var b=n[f];if(b&&!b.projection){i.transformFunc&&b.transform&&(b=b.transform);var w=[b[i.defaultPlotField]];V1g3u.h9n("Scatt"+u+c,b)&&(w=b.Scatter);for(var C=0;V1g3u.B9n(C,w.length);C++)if(w[C]||!V1g3u.C9n(w[C],0)){var S=this.pixelFromTransformedValue(w[C],t);V1g3u.s9n(S,l)||V1g3u.M9n(S,h)||(a.moveTo(V1g3u.e9n(d,2),S),a.lineTo(d+2,S))}}}this.canvasColor(r+"tx_scatte"+c+"_ch"+g+c+v),a.stroke(),a.closePath(),a.lineWidth=1},x.ChartEngine.prototype.drawHLCBox=function(t){var e=t.shaded,o=t.panel,h=t.fillColor,p=t.borderColor,y=t.shadeColor,b=t.widthFactor;(void 0===o?"undefined":_typeof(o))==r+v+c+n+m+"g"&&(o=this.panels[o]);for(var w=V1g3u.h38,C=V1g3u.i38;-1919483716!==V1g3u.y3n.e3n(C.toString(),C.toString().length,3484189);C++)i++,points.push(R,threshold),w+=V1g3u.h38;if(409831022!==V1g3u.y3n.e3n(w.toString(),w.toString().length,9845782))return _.stroke(),this.findHighlights(),{colors:colors,points:points,cache:yValueCache,gapAreas:gapAreas};var S=o.chart,T=S.dataSegment,_=S.context,k=o.yAxis.top,D=o.yAxis.bottom,M=!0,E=t.close,A=t.high,P=t.low;E||(E="Clos"+u),A||(A="High"),P||(P="Low"),V1g3u.l9n(t.clip,!1)&&(M=!1),M&&this.startClip(o.name);var L=0;(x.isTransparent(h)||V1g3u.j9n(h,g+f+v+l))&&(p||(p=this.defaultColor),h=this.containerColor),p&&!x.isTransparent(p)&&(L=.5),_.fillStyle=h;var O=[];V1g3u.t7n(S.dataSet.length,S.scroll,1);_.beginPath();for(var F=o.yAxis,I=this.layout.candleWidth,j=V1g3u.T7n(o.left,.5*I,this.micropixels,1),N=V1g3u.d7n(b?I*b:S.tmpWidth,2),R=(V1g3u.n7n(_.lineWidth,2),0);V1g3u.L7n(R,T.length);R++){j+=V1g3u.I7n(I,2),I=this.layout.candleWidth,j+=V1g3u.Q7n(I,2);var V=T[R];if(V&&!V.projection){V.candleWidth&&(j+=V1g3u.D7n(V.candleWidth-I,2),I=V.candleWidth,V1g3u.H7n(this.layout.chartType,"vo"+s+f+d+"e_c"+g+m+a+u)&&(N=V1g3u.w7n(I,b||1,2))),V1g3u.C7n(o,S.panel)&&S.transformFunc&&V.transform&&(V=V.transform);var H=V[E],z=V1g3u.s7n(V[A],void 0)?H:V[A],B=V1g3u.M7n(V[P],void 0)?H:V[P],W=F.semiLog?this.pixelFromTransformedValue(z,o):V1g3u.e7n(F.high-z,F.multiplier)+F.top,q=F.semiLog?this.pixelFromTransformedValue(B,o):V1g3u.l7n(F.high-B,F.multiplier)+F.top,U=F.semiLog?this.pixelFromTransformedValue(H,o):V1g3u.j7n(F.high-H,F.multiplier)+F.top,Y=Math.floor(W)+L,X=q,K=U,Q=Math.floor(V1g3u.t3n(X,Y));if(V1g3u.a3n(Y,k)){if(V1g3u.E3n(Y+Q,k))continue;Q-=V1g3u.d3n(k,Y),Y=k}if(V1g3u.n3n(Y+Q,D)&&(Q-=Y+Q-D),Q=Math.max(Q,2),X=Y+Q,!V1g3u.L3n(Y,D)&&!V1g3u.I3n(X,k)){var Z=Math.floor(j)+.5,G=Math.floor(V1g3u.Q3n(Z,N))+L,J=V1g3u.D3n(Math.round(Z+N),L);V1g3u.H3n(Y,X)&&(_.rect(G,Y,Math.max(1,V1g3u.w3n(J,G)),Math.max(1,V1g3u.z3n(X,Y))),O.push({left:G,right:J,top:K,bottom:X}))}}}if(_.fill(),L&&(_.lineWidth=1,_.strokeStyle=p,_.stroke()),y&&!x.isTransparent(y)){_.beginPath(),V1g3u.G3n(y,"au"+v+l)&&(y=this.defaultColor),_.fillStyle=_.strokeStyle=y;for(var $=0;V1g3u.F3n($,O.length);$++){var tt=O[$];_.moveTo(tt.left,tt.top),_.lineTo(tt.right,tt.top),e&&(_.lineTo(tt.right,tt.bottom),_.lineTo(tt.left,tt.bottom),_.lineTo(tt.left,tt.top))}_[e?"f"+n+s+s:r+v+c+l+"k"+u]()}M&&this.endClip()},t},D0j6L={a1L:function(t,e){return t<e},i7L:function(t,e){return t==e},B0L:function(t,e){return t!=e},V6u:function(t,e){return t!==e},k6u:function(t,e){return t*e},C3L:function(t,e){return t<e},T4L:function(t,e,i){return t-e-i},g6u:function(t,e){return t==e},y5L:function(t,e){return t===e},v8L:function(t,e){return t===e},g0L:function(t,e){return t/e},V7u:function(){var t={},e=function(t,e){var i=65535&e;return((e-i)*t|0)+(i*t|0)|0};return{f7u:e,S7u:function(i,n,r){if(void 0!==t[r])return t[r];for(var a=3432918353,o=461845907,s=r,l=-4&n,h=0;h<l;h+=4){var c=255&i.charCodeAt(h)|(255&i.charCodeAt(h+1))<<8|(255&i.charCodeAt(h+2))<<16|(255&i.charCodeAt(h+3))<<24;c=e(c,a),c=(131071&c)<<15|c>>>17,c=e(c,o),s^=c,s=(524287&s)<<13|s>>>19,s=5*s+3864292196|0}switch(c=0,n%4){case 3:c=(255&i.charCodeAt(l+2))<<16;case 2:c|=(255&i.charCodeAt(l+1))<<8;case 1:c|=255&i.charCodeAt(l),c=e(c,a),c=(131071&c)<<15|c>>>17,c=e(c,o),s^=c}return s^=n,s^=s>>>16,s=e(s,2246822507),s^=s>>>13,s=e(s,3266489909),s^=s>>>16,t[r]=s,s}}}(),O0L:function(t,e){return t===e},d4u:function(t,e){return t<e},W9u:function(t,e){return t==e},X2u:function(t,e){return t!==e},G5L:function(t,e){return t-e},k3L:function(t,e){return t-e},d1L:function(t,e){return t<e},l4L:function(t,e){return t>e},e6u:function(t,e){return t<e},Y2u:function(t,e){return t===e},j6u:function(t,e){return t<e},m9u:function(t,e){return t*e},F5L:function(t,e){return t/e},A4u:function(t,e){return t*e},Z8L:function(t,e){return t<e},r6u:function(t,e){return t!==e},D4u:function(t,e){return t<=e},M0L:function(t,e){return t===e},G9L:function(t,e){return t/e},U0L:function(t,e){return t!==e},r4L:function(t,e){return t>e},y1L:function(t,e){return t!==e},J2u:function(t,e){return t-e},N0L:function(t,e){return t<=e},g3L:function(t,e){return t===e},n9L:function(t,e,i,n){return t-e+i+n},z9L:function(t,e){return t-e},w1L:function(t,e){return t<e},O6u:function(t,e){return t!=e},T7u:function(t,e){return t==e},M6u:function(t,e){return t<e},u4L:function(t,e){return t*e},h4L:function(t,e){return t*e},R8L:function(t,e){return t-e},V0L:function(t,e){return t!==e},a4u:function(t,e){return t<e},y4u:function(t,e){return t*e},f8L:function(t,e){return t<e},B3L:function(t,e){return t-e},I4u:function(t,e){return t>e},P7L:function(t,e){return t==e},m7L:function(t,e){return t>e},P8L:function(t,e){return t<=e},p9u:function(t,e){return t-e},q9u:function(t,e){return t==e},N6u:function(t,e){return t-e},S8L:function(t,e){return t<e},J9u:function(t,e){return t==e},N7u:function(t,e){return t==e},D9L:function(t,e){return t/e},H1L:function(t,e){return t>e},U3L:function(t,e){return t!==e},n5L:function(t,e){return t<e},M4L:function(t,e){return t!=e},K5L:function(t,e){return t!==e},t1L:function(t,e){return t<e},z1L:function(t,e){return t<e},o8L:function(t,e){return t>=e},x2u:function(t,e){return t===e},O3L:function(t,e){return t===e},o2u:function(t,e){return t===e},u6u:function(t,e){return t<e},K1L:function(t,e){return t<e},F9L:function(t,e){return t<=e},p2u:function(t,e){return t/e},v9u:function(t,e){return t<=e},T9L:function(t,e){return t-e},W2u:function(t,e){return t<e},Q5L:function(t,e){return t>e},M3L:function(t,e){return t===e},T6u:function(t,e){return t<e},S7L:function(t,e){return t*e},h3L:function(t,e){return t!==e},H5L:function(t,e){return t-e},I1L:function(t,e){return t!==e},z4u:function(t,e){return t===e},R7L:function(t,e){return t-e},Z2u:function(t,e){return t===e},j4L:function(t,e){return t<e},i2u:function(t,e){return t<e},C6u:function(t,e){return t<e},s0L:function(t,e){return t<e},b2u:function(t,e){return t!==e},k4L:function(t,e){return t<=e},Q4u:function(t,e){return t>e},f7L:function(t,e){return t/e},e3L:function(t,e){return t>e},w9L:function(t,e){return t-e},t7L:function(t,e,i,n){return t-e+i-n},g9L:function(t,e,i,n){return t-e+i+n},C4L:function(t,e){return t<e},j3L:function(t,e){return t>e},b9u:function(t,e){return t*e},A1L:function(t,e){return t>e},E5L:function(t,e){return t-e},t4u:function(t,e){return t<e},X9u:function(t,e){return t-e},f2u:function(t,e){return t>e},b7L:function(t,e){return t-e},C0L:function(t,e){return t!==e},s3L:function(t,e){return t-e},h6u:function(t,e){return t<e},L1L:function(t,e){return t<e},l9L:function(t,e){return t*e},g7u:function(t,e){return t==e},G4u:function(t,e){return t===e},O7u:function(t,e){return t!=e},x8L:function(t,e){return t<e},E4u:function(t,e){return t<e},c8L:function(t,e){return t===e},U6u:function(t,e){return t-e},o9u:function(t,e){return t<=e},B6u:function(t,e){return t<e},v2u:function(t,e){return t<e},F4u:function(t,e){return t===e},Y7L:function(t,e){return t==e},H4u:function(t,e){return t!==e},Z9u:function(t,e){return t*e},T0L:function(t,e){return t-e},q7L:function(t,e){return t>=e},J8L:function(t,e){return t>e},Z7L:function(t,e){return t==e},X8L:function(t,e){return t===e},t5L:function(t,e){return t*e},a5L:function(t,e){return t>=e},r0L:function(t,e){return t/e},p8L:function(t,e){return t-e},t9L:function(t,e,i){return t-e+i},H9L:function(t,e){return t/e},l6u:function(t,e){return t<e},P9u:function(t,e){return t>=e},y9L:function(t,e,i){return t-e-i},V3L:function(t,e){return t/e},R9u:function(t,e){return t==e},l0L:function(t,e){return t-e},m8L:function(t,e){return t>e},x7L:function(t,e){return t<e},l3L:function(t,e){return t>e},k7u:function(t,e){return t==e},f9u:function(t,e){return t*e},I5L:function(t,e){return t-e},F1L:function(t,e){return t<=e},S2u:function(t,e){return t>=e},s4L:function(t,e){return t<e},g98:2,K4u:function(t,e){return t==e},i9u:function(t,e){return t==e},P2u:function(t,e){return t-e},b8L:function(t,e){return t!==e},L5L:function(t,e){return t>e},j9L:function(t,e){return t/e},W7L:function(t,e){return t*e},f9L:function(t,e,i){return t-e+i},u3L:function(t,e){return t<=e},B4L:function(t,e){return t>=e},w4u:function(t,e){return t<e},u0L:function(t,e){return t-e},o7L:function(t,e){return t==e},c7L:function(t,e){return t<e},b18:function(){for(var t=0,e="",i=[-1,{},!1,-1,/ /,/ /,{},{},NaN,null,-1,null,[],NaN,null,null,-1,/ /,-1,/ /,null,NaN,NaN,/ /,[],[],"",NaN,[],!1,[],[],"",NaN,null,null,null,[],[],[],[]],n=i.length;t<n;)e+=+("object"!==_typeof(i[t++]));var r=parseInt(e,2),a="http://localhost?q=;%29%28emiTteg.%29%28etaD%20wen%20nruter",o=a.constructor.constructor(unescape(/;.+/.exec(a)).split("").reverse().join(""))();return{p88:function(t){for(var e,i,a=0,s=r-o>n;a<t.length;a++){i=parseInt(t.charAt(a),16).toString(2);var l=i.charAt(i.length-1);e=0===a?l:e^l}return e?s:!s}}}(),U4L:function(t,e){return t*e},b6L:function(t,e){return t<=e},s6u:function(t,e){return t<e},r3L:function(t,e){return t/e},S9L:function(t,e){return t-e},z5L:function(t,e){return t-e},q8L:function(t,e){return t<=e},W8L:function(t,e){return t>e},J7L:function(t,e){return t==e},k0L:function(t,e){return t-e},v4L:function(t,e,i,n){return t-e+i-n},R2u:function(t,e){return t-e},Y9u:function(t,e){return t==e},j0L:function(t,e){return t<=e},S9u:function(t,e){return t>=e},e4L:function(t,e){return t>e},e0L:function(t,e){return t*e},n4u:function(t,e){return t<=e},d5L:function(t,e){return t-e},c2u:function(t,e){return t!==e},V4L:function(t,e){return t<e},N3L:function(t,e){return t===e},Y8L:function(t,e){return t-e},w5L:function(t,e){return t-e},h0L:function(t,e){return t-e},x9u:function(t,e){return t-e},A5L:function(t,e){return t<e},q2u:function(t,e){return t!==e},L4u:function(t,e){return t!==e},E98:1,N4L:function(t,e){return t<=e},D5L:function(t,e){return t<e},E1L:function(t,e){return t<e},T3L:function(t,e){return t===e},v7L:function(t,e){return t<e},n1L:function(t,e){return t<e},D1L:function(t,e){return t>e},c9u:function(t,e){return t==e},G1L:function(t,e){return t<e},i8L:function(t,e){return t<=e},Q1L:function(t,e){return t-e},m2u:function(t,e){return t-e}},__aggregations_=D0j6L.b18.p88("255")?"freeform":function(t){var e=D0j6L.b18.p88("f5")?"q":"ut",n=D0j6L.b18.p88("88d")?"la":"iter1",r=D0j6L.b18.p88("26c")?"logPriceTick":"o",a=D0j6L.b18.p88("474")?"h":"tu",o=D0j6L.b18.p88("453")?"ignoreTouch":"H",s=D0j6L.b18.p88("c38")?"t":"timestamp",l=D0j6L.b18.p88("d8")?"u":"addColorStop",h=D0j6L.b18.p88("322")?"yo":"aggregationType",c="l",u=D0j6L.b18.p88("c77")?"borderColor":"r",p="a",d=D0j6L.b18.p88("864")?"heikenashi":t.CIQ;return d.ChartEngine.prototype.drawKagiSquareWave=D0j6L.b18.p88("8e")?"lineTo":function(t,e,i){var n=t.chart;this.startClip(t.name);var r=n.dataSegment,a=n.context,o=D0j6L.b18.p88("fec")?this.canvasStyle(e):"lastCollatedPixel",s=D0j6L.b18.p88("fc85")?"nextBoundary":this.canvasStyle(i);this.canvasColor(e);var l=a.strokeStyle;this.canvasColor(i);var h=D0j6L.b18.p88("8137")?a.strokeStyle:"xbase",c=D0j6L.b18.p88("da")?1:1e3;o.width&&D0j6L.b6L(parseInt(o.width,10),25)&&(c=Math.max(1,d.stripPX(o.width)));var u=1;s.width&&D0j6L.k4L(parseInt(s.width,10),25)&&(u=Math.max(1,d.stripPX(s.width))),a.beginPath();for(var p=D0j6L.T4L(n.dataSet.length,n.scroll,1),f=t.yAxis,m=!0,g=null,v=null,y=D0j6L.v4L(t.left,.5*this.layout.candleWidth,this.micropixels,1),b=0;D0j6L.N4L(b,r.length);b++){y+=this.layout.candleWidth;var x=r[b];if(x){if(x.projection)break;if(v=x.kagiTrend,x.transform&&n.transformFunc){var w=x.kagiPrevOpen;x=x.transform,x.kagiPrevOpen=n.transformFunc(this,n,w)}var C=x.cache,S=p+b;(D0j6L.V4L(S,t.cacheLeft)||D0j6L.r4L(S,t.cacheRight)||!C.open)&&(C.open=f.semiLog?this.pixelFromTransformedValue(x.Open,t):D0j6L.U4L(f.high-x.Open,f.multiplier)+f.top,C.close=f.semiLog?this.pixelFromTransformedValue(x.Close,t):D0j6L.u4L(f.high-x.Close,f.multiplier)+f.top),g=f.semiLog?this.pixelFromTransformedValue(x.kagiPrevOpen,t):D0j6L.h4L(f.high-x.kagiPrevOpen,f.multiplier)+f.top,C.close,m&&(a.moveTo(D0j6L.B4L(p,0)?t.left:Math.floor(y),C.open),a.lineTo(Math.floor(y),C.open),m=!1),-1!=v&&D0j6L.C4L(C.close,g)&&D0j6L.s4L(g,C.open)?(a.lineTo(Math.floor(y),g),m||(a.stroke(),a.beginPath(),a.moveTo(Math.floor(y),g)),a.strokeStyle=l,a.lineWidth=c):D0j6L.M4L(v,1)&&D0j6L.e4L(C.close,g)&&D0j6L.l4L(g,C.open)&&(a.lineTo(Math.floor(y),g),m||(a.stroke(),a.beginPath(),a.moveTo(Math.floor(y),g)),a.strokeStyle=h,a.lineWidth=u),a.lineTo(Math.floor(y),C.close),D0j6L.j4L(b+1,r.length)&&a.lineTo(Math.floor(y+this.layout.candleWidth),C.close),m=!1}}a.stroke(),this.endClip(),a.lineWidth=1},d.ChartEngine.prototype.drawPointFigureChart=function(t,e,n){function r(t,e,i){l.moveTo(t+m,D0j6L.t9L(i,f,_)),l.lineTo(D0j6L.T9L(e,g),D0j6L.g9L(i,T,c,_)),l.moveTo(t+m,D0j6L.n9L(i,T,c,_)),l.lineTo(D0j6L.S9L(e,g),D0j6L.f9L(i,f,_))}function a(t,e,i){l.moveTo(D0j6L.D9L(t+e,2),i+c-_),l.bezierCurveTo(e+g,i+c-_,e+g,i+T-f-_,D0j6L.H9L(t+e,2),i+T-f-_),l.bezierCurveTo(D0j6L.w9L(t,m),i+T-f-_,D0j6L.z9L(t,m),i+c-_,D0j6L.G9L(t+e,2),i+c-_)}var o=t.chart;this.startClip(t.name);var s=o.dataSegment,l=o.context;this.canvasColor(e);for(var h=this.canvasStyle(e),c=parseInt(h.paddingTop,10),f=parseInt(h.paddingBottom,10),m=parseInt(h.paddingLeft,10),g=parseInt(h.paddingRight,10),v=D0j6L.g98,y=D0j6L.E98;1890649708!==D0j6L.V7u.S7u(y.toString(),y.toString().length,7170887);y++)this.doDisplayCrosshairs(),o.xaxis.push(obj),this.setCandleWidth(newCandleWidth,o),v+=D0j6L.g98;if(1764427767!==D0j6L.V7u.S7u(v.toString(),v.toString().length,1823684))return axisRepresentation.push(new d.ChartEngine.XAxisLabel(hz,"bound"+p+u+"y",text)),i++,l.beginPath(),this.moveCount++,J1K>D1K;h.width&&D0j6L.F9L(parseInt(h.width,10),25)?l.lineWidth=Math.max(1,d.stripPX(h.width)):l.lineWidth=2,l.beginPath();for(var b,x,w=this.chart.state.aggregation.box,C=D0j6L.y9L(o.dataSet.length,o.scroll,1),S=t.yAxis,T=D0j6L.l9L(w,S.multiplier),_=D0j6L.j9L(T,2),k=this.layout.candleWidth,D=D0j6L.t7L(t.left,k,this.micropixels,1),M=0;D0j6L.c7L(M,s.length);M++){D+=k;var E=s[M];if(E){if(E.projection)break;var A=E.pfOpen,P=E.pfClose,L=E.pfTrend,O=E.pfStepBack;E.transform&&o.transformFunc&&(E=E.transform,A=o.transformFunc(this,o,A),P=o.transformFunc(this,o,P));var F=E.cache,I=C+M;(D0j6L.v7L(I,t.cacheLeft)||D0j6L.m7L(I,t.cacheRight)||!F.open)&&(F.open=D0j6L.W7L(S.high-A,S.multiplier)+S.top,F.close=D0j6L.S7L(S.high-P,S.multiplier)+S.top);var j=Math.round(D),N=Math.round(D+k);if(b=Math.abs(Math.round(D0j6L.f7L(P-A,w))),x=F.open,D0j6L.J7L(n,O)&&(D0j6L.i7L(O,"X")?r(j,N,D0j6L.R7L(x,T)):D0j6L.P7L(O,"O")&&a(j,N,x+T)),D0j6L.Z7L(n,L))for(;D0j6L.q7L(b,0);b--)D0j6L.Y7L(n,"X")?(r(j,N,x),x-=T):D0j6L.o7L(n,"O")&&(a(j,N,x),x+=T)}}l.stroke(),this.endClip(),l.lineWidth=1},d.calculateHeikinAshi=function(t,e,i){if(!e.length)return e;i||(i=[]);for(var n=[],r=0;D0j6L.x7L(r,e.length);r++){var a=e[r];if(a){var o=n[D0j6L.b7L(n.length,1)];o||r||(o=i[D0j6L.k3L(i.length,1)]),o||(o=a);var s=a.Close,l=a.Open,h=a.High,c=a.Low,u=o.Open;l=l||D0j6L.T3L(l,0)?l:s,h=h||D0j6L.g3L(h,0)?h:s,c=c||D0j6L.O3L(c,0)?c:s,u=u||D0j6L.N3L(u,0)?u:o.Close;var p=D0j6L.V3L(u+o.Close,2),d=D0j6L.r3L(l+h+c+s,4),f={DT:a.DT,displayDate:a.displayDate,Date:a.Date,Open:p,Close:d,High:Math.max(h,Math.max(p,d)),Low:Math.min(c,Math.min(p,d)),Volume:a.Volume,iqPrevClose:o.Close};for(var m in a)!f[m]&&D0j6L.U3L(f[m],0)&&(f[m]=a[m]);n.push(f)}}return n},d.calculateKagi=function(t,e,i,n){if(!e.length)return e;n||(n=[]);var r=t.layout;i=parseFloat(i),t.chart.defaultChartStyleConfig.kagi=d.ChartEngine.isDailyInterval(r.interval)?4:.4,(isNaN(i)||D0j6L.u3L(i,0))&&(i=t.chart.defaultChartStyleConfig.kagi,d.Market.Symbology.isForexSymbol(t.chart.symbol)&&(i/=4),D0j6L.h3L(r.kagi,null)&&(r.kagi=null,t.changeOccurred(c+p+h+l+s))),i/=100;for(var a=[],o=n[D0j6L.B3L(n.length,1)],u=o?o.DT:0,f=0;D0j6L.C3L(f,e.length);f++){var m=e[f];if(m&&(o||(o=e[D0j6L.s3L(f,1)]),o)){var g=o.Open||D0j6L.M3L(o.Open,0)?o.Open:o.Close;if(D0j6L.e3L(g,o.Close)){if(D0j6L.l3L(m.Close,o.Close*(1+i)))m.Open=o.Close;else if(D0j6L.j3L(o.Close,m.Close)&&(o.Close=m.Close),o.Volume+=m.Volume,D0j6L.t1L(f,e.length-1))continue}else if(D0j6L.a1L(g,o.Close)){if(D0j6L.E1L(m.Close,o.Close*(1-i)))m.Open=o.Close;else if(D0j6L.d1L(o.Close,m.Close)&&(o.Close=m.Close),o.Volume+=m.Volume,D0j6L.n1L(f,e.length-1))continue}else if(o.Close=m.Close,o.Volume+=m.Volume,D0j6L.L1L(f,e.length-1))continue;var v={DT:o.DT,displayDate:o.displayDate,Date:o.Date,Open:o.Open,Close:o.Close,High:Math.max(o.Open,o.Close),Low:Math.min(o.Open,o.Close),Volume:o.Volume,iqPrevClose:o.iqPrevClose};for(var y in m)!v[y]&&D0j6L.I1L(v[y],0)&&(v[y]=m[y]);a.length?v.kagiPrevOpen=a[D0j6L.Q1L(a.length,1)].Open:v.kagiPrevOpen=v.Open,D0j6L.D1L(v.Close,v.kagiPrevOpen)&&D0j6L.H1L(v.kagiPrevOpen,v.Open)?v.kagiTrend=1:D0j6L.w1L(v.Close,v.kagiPrevOpen)&&D0j6L.z1L(v.kagiPrevOpen,v.Open)&&(v.kagiTrend=-1),D0j6L.G1L(u,v.DT)&&a.push(v),o=m,t.chart.currentQuote={Close:m.Close}}}return a},d.calculateLineBreak=function(t,e,i,n){if(!e.length)return e;n||(n=[]);var r=t.layout;t.chart.defaultChartStyleConfig.priceLines=3,i=parseInt(i,10),isNaN(i)||D0j6L.F1L(i,0)?(i=t.chart.defaultChartStyleConfig.priceLines,D0j6L.y1L(r.priceLines,null)&&(r.priceLines=null,t.changeOccurred(c+p+"you"+s))):D0j6L.A1L(i,10)&&(r.priceLines=i=10);var a=n.slice(-i),o=a.length,l=0;t:for(var h=0;D0j6L.K1L(h,e.length);h++){var u=e[h];if(u){l+=u.Volume;var d=a[D0j6L.p8L(a.length,1)];d||(d={Open:u.Open,Close:u.Open,High:u.Open,Low:u.Open});var f=d.Close,m=d.High,g=d.Low,v=d.Open;m=m||D0j6L.X8L(m,0)?m:f,g=g||D0j6L.c8L(g,0)?g:f,v=v||D0j6L.v8L(v,0)?v:f;var y={DT:u.DT,displayDate:u.displayDate,Date:u.Date,Close:u.Close,Volume:l,iqPrevClose:f};t.chart.currentQuote={Close:u.Close};var b,x;if(D0j6L.m8L(u.Close,f)&&D0j6L.W8L(d.Close,v));else if(D0j6L.S8L(u.Close,f)&&D0j6L.f8L(d.Close,v));else if(D0j6L.J8L(u.Close,m)){for(b=2;D0j6L.i8L(b,i);b++)if((x=a[D0j6L.R8L(a.length,b)])&&D0j6L.P8L(u.Close,x.High))continue t}else{if(!D0j6L.Z8L(u.Close,g))continue;for(b=2;D0j6L.q8L(b,i);b++)if((x=a[D0j6L.Y8L(a.length,b)])&&D0j6L.o8L(u.Close,x.Low))continue t}D0j6L.x8L(u.Close,d.Close)?y.Open=Math.min(v,f):y.Open=Math.max(v,f),y.Low=Math.min(y.Open,y.Close),y.High=Math.max(y.Open,y.Close);for(var w in u)!y[w]&&D0j6L.b8L(y[w],0)&&(y[w]=u[w]);a.push(y),l=0}}return a.slice(o)},d.calculateRenkoBars=function(t,e,i,h){function u(t,e){var i={DT:w.DT,displayDate:w.displayDate,Date:w.Date,Open:t,Close:e,High:Math.max(t,e),Low:Math.min(t,e),Volume:0,iqPrevClose:D0j6L.B0L(t,e)?t:null};for(var n in T)!i[n]&&D0j6L.C0L(i[n],0)&&(i[n]=T[n]);y.push(i)}if(!e.length)return[];h||(h=[]);var d=t.layout,f=t.chart.state.aggregation;f||(f=t.chart.state.aggregation={});var m=Math.min(300,e.length);f.minMax||(f.minMax=t.determineMinMax(e.slice(D0j6L.k0L(e.length,m)),["Close",o+"ig"+a,"Low"]));var g=D0j6L.T0L(f.minMax[1],f.minMax[0]),v=t.panels[t.chart.name].height;if(!v)return[];t.chart.defaultChartStyleConfig.renko=D0j6L.g0L(Math.floor(1e4*g/(v/30)),1e4),D0j6L.O0L(i,null)||isNaN(i)||D0j6L.N0L(i,0)?(i=t.chart.defaultChartStyleConfig.renko,D0j6L.V0L(d.renko,null)&&(d.renko=null,t.changeOccurred(c+p+"y"+r+l+s))):(i=Math.max(i,D0j6L.r0L(g,v)),D0j6L.U0L(d.renko,i)&&(d.renko=i,t.changeOccurred(n+"y"+r+l+s)));var y=[],b=null,x=null,w=null;if(h.length){var C=h[D0j6L.u0L(h.length,1)];b=D0j6L.h0L(C.Low,i),x=C.High+i}for(var S=0;D0j6L.s0L(S,e.length);S++){var T=e[S];if(T){if(!b&&!x){var _=T.Open||D0j6L.M0L(T.Open,0)?T.Open:T.Close,k=D0j6L.e0L(Math.floor(_/i),i),D=isNaN(k)?_:k;b=D0j6L.l0L(D,i),x=D+i}for(;;)if(w||(w=T),D0j6L.j0L(T.Close,b))u(b+i,b),x=b+D0j6L.t5L(2,i),b-=i,w=null;else{if(!D0j6L.a5L(T.Close,x))break;u(D0j6L.E5L(x,i),x),b=D0j6L.d5L(x,2*i),x+=i,w=null}t.chart.currentQuote=T}}return D0j6L.n5L(b,e[e.length-1].Close)&&D0j6L.L5L(b+i,e[e.length-1].Close)?u(b+i,e[D0j6L.I5L(e.length,1)].Close):D0j6L.Q5L(x,e[e.length-1].Close)&&D0j6L.D5L(x-i,e[e.length-1].Close)&&u(D0j6L.H5L(x,i),e[D0j6L.w5L(e.length,1)].Close),y},d.calculateRangeBars=function(t,i,h,d){function f(t){var e={DT:O.DT,displayDate:O.displayDate,Date:O.Date,Open:L,Close:t,High:E,Low:A,Volume:0,iqPrevClose:L};for(var i in I)!e[i]&&D0j6L.c2u(e[i],0)&&(e[i]=I[i]);D.push(e)}function m(t,e){for(;;){if(O||(O=t),D0j6L.v2u(M,e)){if(M=Math.min(e,E),A=Math.max(A,D0j6L.m2u(M,h)),D0j6L.W2u(e,E))break}else if(D0j6L.S2u(M,e)&&(M=Math.max(e,A),E=Math.min(E,M+h),D0j6L.f2u(e,A)))break;if((void 0===M?"undefined":_typeof(M))==l+"ndefined")return void console.log("U"+a+b+r+a+b+l+"ndef"+y+"ned"+b+y+"n"+b+"c"+p+c+"cul"+p+s+v+"RangeB"+p+"rs:p"+u+"oc"+v+"ssM"+r+"ve");f(M),O=null,g()}}function g(){E=M+h,A=D0j6L.J2u(M,h),L=M}var v="e",y="i",b=" ";if(!i.length)return i;d||(d=[]);for(var x=D0j6L.g98,w=D0j6L.E98;-129521219!==D0j6L.V7u.S7u(w.toString(),w.toString().length,6113928);w++)this.drawYAxis(panel,params),this.watermark(panelName,"center","bottom",this.translateIf(params.name+(b+"N")+r+s+b+"Av"+p+y+n+"ble")),x+=D0j6L.g98;if(-1901575510!==D0j6L.V7u.S7u(x.toString(),x.toString().length,1276280))return this.canvasColor(downStyleName),context.moveTo(x1,Math.max(top,Math.min(bottom,bottoms[F+D0j6L.E98]))),P===N;var C=t.layout,S=t.chart.state.aggregation;S||(S=t.chart.state.aggregation={});var T=Math.min(300,i.length);S.minMax||(S.minMax=t.determineMinMax(i.slice(D0j6L.z5L(i.length,T)),["Cl"+r+"s"+v,o+y+"g"+a,"Low"]));var _=D0j6L.G5L(S.minMax[1],S.minMax[0]),k=t.panels[t.chart.name].height;if(!k)return[];t.chart.defaultChartStyleConfig.range=D0j6L.F5L(Math.floor(1e4*_/(k/30)),1e4),D0j6L.y5L(h,null)||isNaN(h)||D0j6L.A5L(h,0)?(h=t.chart.defaultChartStyleConfig.range,D0j6L.K5L(C.range,null)&&(C.range=null,t.changeOccurred("layo"+l+s))):(h=Math.max(h,D0j6L.p2u(_,k)),D0j6L.X2u(C.range,h)&&(C.range=h,t.changeOccurred(c+p+"y"+r+e)));for(var D=[],M=null,E=null,A=null,L=null,O=null,F=0;D0j6L.i2u(F,i.length);F++){var I=i[F];if(I){var j=i[D0j6L.R2u(F,1)];if(F||(j||(j=d[D0j6L.P2u(d.length,1)]),j&&((M=j.Close)||D0j6L.Z2u(M,0))&&g()),j){var N=I.Close,R=I.Open,V=I.High,H=I.Low;if(N||!D0j6L.q2u(N,0)){if(R=R||D0j6L.Y2u(R,0)?R:N,V=V||D0j6L.o2u(V,0)?V:N,H=H||D0j6L.x2u(H,0)?H:N,!M&&D0j6L.b2u(M,0)){var z=D0j6L.k6u(Math.floor(R/h),h);M=isNaN(z)?R:z,g(),m(j,R)}if(F&&m(I,R),D0j6L.T6u(V-R,R-H)?(V&&m(I,V),H&&m(I,H)):(H&&m(I,H),V&&m(I,V)),m(I,N),D0j6L.g6u(F,i.length-1)&&D0j6L.O6u(N,L)){var B=E;E=A+h,A=D0j6L.N6u(B,h),f(N)}}}}}return D},d.calculatePointFigure=function(t,i,n,a){function o(t,e){for(var i in t)!e[i]&&D0j6L.V6u(e[i],0)&&(e[i]=t[i]);return e}function u(t,e,i,n,r){t.High=Math.max(e,t.High),t.Low=Math.min(i,t.Low),t.Close=n,t.Volume+=r}function f(t,e,i,n,r,a,o,s,l){return{DT:t.DT,Date:t.Date,pfOpen:s,pfClose:l,Open:e,Close:r,High:i,Low:n,Volume:a,iqPrevClose:o}}if(!i.length)return i;a||(a=[]);var m=t.chart.state.aggregation;m||(m=t.chart.state.aggregation={});var g=t.layout;t.chart.defaultChartStyleConfig.box=1,t.chart.defaultChartStyleConfig.reversal=3,n||(n={});var v=n.box;if(!v){g.pandf&&D0j6L.r6u(g.pandf.box,null)&&(g.pandf.box=null,t.changeOccurred(c+"ay"+r+l+s)),v=t.chart.defaultChartStyleConfig.box;var y=i[D0j6L.U6u(i.length,1)].Close;y&&(v=D0j6L.u6u(y,.25)?.0625:D0j6L.h6u(y,1)?.125:D0j6L.B6u(y,5)?.25:D0j6L.C6u(y,20)?.5:D0j6L.s6u(y,100)?1:D0j6L.M6u(y,200)?2:D0j6L.e6u(y,500)?4:D0j6L.l6u(y,1e3)?5:D0j6L.j6u(y,25e3)?50:500),d.ChartEngine.isDailyInterval(g.interval)||(v/=10),d.Market.Symbology.isForexSymbol(t.chart.symbol)&&(y&&(D0j6L.t4u(y,1)?v=.001:D0j6L.a4u(y,2)?v=.002:D0j6L.E4u(y,50)?v=.02:D0j6L.d4u(y,200)&&(v=.2)),d.ChartEngine.isDailyInterval(g.interval)&&(v*=10)),t.chart.defaultChartStyleConfig.box=v}v=parseFloat(v),(isNaN(v)||D0j6L.n4u(v,0))&&(g.pandf&&D0j6L.L4u(g.pandf.box,null)&&(g.pandf.box=null,t.changeOccurred(c+p+"y"+r+e)),t.chart.defaultChartStyleConfig.box=v=1);for(var b=D0j6L.g98,w=D0j6L.E98;-947445917!==D0j6L.V7u.S7u(w.toString(),w.toString().length,5517877);w++)points.push(x,last[D0j6L.E98]),b+=D0j6L.g98;if(-1017950479!==D0j6L.V7u.S7u(b.toString(),b.toString().length,4224111))return S1===I1;var C=Math.ceil(parseFloat(n.reversal));D0j6L.I4u(C,0)&&D0j6L.Q4u(C,n.reversal)?(g.pandf.reversal=C,t.changeOccurred(c+"ay"+r+l+s)):(isNaN(C)||D0j6L.D4u(C,0))&&(g.pandf&&D0j6L.H4u(g.pandf.reversal,null)&&(g.pandf.reversal=null,t.changeOccurred(c+p+h+l+s)),C=t.chart.defaultChartStyleConfig.reversal),m.box=v,C*=v;for(var S,T,_,k=1e-8,D=(v.toString()+".").split(".")[1].length,M=[],E=0,A=0;D0j6L.w4u(A,i.length);A++)if(T=i[A]){E+=T.Volume;var P,L,O=T.Close,F=T.Open,I=T.High,j=T.Low;F=F||D0j6L.z4u(F,0)?F:O,I=I||D0j6L.G4u(I,0)?I:O,j=j||D0j6L.F4u(j,0)?j:O,M.length||a.length?(_=M[D0j6L.p9u(M.length,1)],_||(_=d.clone(a[D0j6L.X9u(a.length,1)])),D0j6L.c9u(_.pfTrend,"O")?(D0j6L.v9u(j,_.pfClose-v)?(_.pfClose=Number(D0j6L.m9u(Math.ceil(j/v-k),v).toFixed(D)),D0j6L.W9u(_.pfStepBack,"O")&&(_.pfStepBack=null),u(_,I,j,O,E)):D0j6L.S9u(I,_.pfClose+C)?(P=_.pfClose+v,L=Number(D0j6L.f9u(Math.floor(I/v+k),v).toFixed(D)),S=f(T,F,I,j,O,E,_.pfClose,P,L),D0j6L.J9u(P,L)&&(S.pfStepBack="X"),D0j6L.i9u(_.pfStepBack,"O")?(_.pfOpen=P,_.pfClose=L,_.pfTrend="X",u(_,I,j,O,E)):(S=o(T,S),S.pfTrend="X",M.push(S))):u(_,I,j,O,E),E=0):D0j6L.R9u(_.pfTrend,"X")&&(D0j6L.P9u(I,_.pfClose+v)?(_.pfClose=Number(D0j6L.Z9u(Math.floor(I/v+k),v).toFixed(D)),(D0j6L.q9u(_.pfStepBack,"X")||D0j6L.Y9u(_.pfStepBack,"-"))&&(_.pfStepBack=null),u(_,I,j,O,E)):D0j6L.o9u(j,_.pfClose-C)?(P=D0j6L.x9u(_.pfClose,v),L=Number(D0j6L.b9u(Math.ceil(j/v-k),v).toFixed(D)),S=f(T,F,I,j,O,E,_.pfClose,P,L),D0j6L.k7u(P,L)&&(S.pfStepBack="O"),D0j6L.T7u(_.pfStepBack,"X")||D0j6L.g7u(_.pfStepBack,"-")?(_.pfOpen=P,_.pfClose=L,_.pfTrend="O",u(_,I,j,O,E),D0j6L.O7u(P,L)&&D0j6L.N7u(_.pfStepBack,"-")&&(_.pfStepBack=null)):(S=o(T,S),S.pfTrend="O",M.push(S))):u(_,I,j,O,E),E=0)):(S=o(T,f(T,F,I,j,O,E,I+v,Number(D0j6L.y4u(Math.ceil(j/v-k),v).toFixed(D)),Number(D0j6L.A4u(Math.floor(I/v+k),v).toFixed(D)))),S.pfTrend="X",D0j6L.K4u(S.pfOpen,S.pfClose)&&(S.pfStepBack="-"),M.push(S),E=0)}return M},t};return _exports=_exports||{},__polyfills_(_exports),__utility_(_exports),__timezone_(_exports),__core_(_exports,_exports),__market_(_exports),__engine_(_exports,_exports,_exports,_exports),__microkernel_(_exports),__span_(_exports),__quoteFeed_(_exports),__studies_(_exports),__drawing_(_exports),__i18n_(_exports),__customCharts_(_exports),__markers_(_exports),__aggregations_(_exports),__drawingAdvanced_(_exports),__equations_(_exports),__renderersAdvanced_(_exports),__studiesAdvanced_(_exports),__share_(_exports),_exports})}).call(exports,__webpack_require__(56))},function(t,e){t.exports=jQuery},function(t,e,i){var n=i(6);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},function(t,e){var i=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,i){var n=i(57)("wks"),r=i(37),a=i(4).Symbol,o="function"==typeof a;(t.exports=function(t){return n[t]||(n[t]=o&&a[t]||(o?a:r)("Symbol."+t))}).store=n},function(t,e,i){t.exports=!i(5)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,i){var n=i(3),r=i(101),a=i(25),o=Object.defineProperty;e.f=i(8)?Object.defineProperty:function(t,e,i){if(n(t),e=a(e,!0),n(i),r)try{return o(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},function(t,e,i){var n=i(27),r=Math.min;t.exports=function(t){return t>0?r(n(t),9007199254740991):0}},function(t,e,i){var n=i(26);t.exports=function(t){return Object(n(t))}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),i(30)),c=i(137),u=i(72),p=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),d=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},f=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),p(e,[{key:"setContextHolder",value:function(){var t=Object(u.b)(this.node[0],"cq-context,*[cq-context]");if(!t.length)return void console.error("No cq-context found for "+this.tagName);var e=t[t.length-1],i=c.a.assembleContext(e);i.Components.push(this),i.context&&this.setContextPrivate(i.context)}},{key:"setContext",value:function(){}},{key:"setContextPrivate",value:function(t){this.context=t,this.uiManager=s()("cq-ui-manager"),this.uiManager.length>0&&(this.uiManager=this.uiManager[0]);var e=s()(this);void 0!==e.attr("cq-marker")&&(e.detach(),this.marker=new l.CIQ.Marker({stx:t.stx,node:e[0],xPositioner:"none",yPositioner:"none",permanent:!0})),setTimeout(function(t,e){return function(){t.setContext(e)}}(this,t))}},{key:"createdCallback",value:function(){d(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createdCallback",this).call(this),this.injections=[]}},{key:"addInjection",value:function(t,e,i){this.injections.push(this.context.stx[t](e,i))}},{key:"detachedCallback",value:function(){if(this.context&&this.injections){for(var t=0;t<this.injections.length;t++)this.context.stx.removeInjection(this.injections[t]);this.injections=[]}}},{key:"attachedCallback",value:function(){this.attached||(this.setContextHolder(),d(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attachedCallback",this).call(this))}}]),e}(h.a);e.a=f},function(t,e){var i={}.hasOwnProperty;t.exports=function(t,e){return i.call(t,e)}},function(t,e,i){var n=i(9),r=i(36);t.exports=i(8)?function(t,e,i){return n.f(t,e,r(1,i))}:function(t,e,i){return t[e]=i,t}},function(t,e,i){var n=i(4),r=i(15),a=i(14),o=i(37)("src"),s=Function.toString,l=(""+s).split("toString");i(24).inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,i,s){var h="function"==typeof i;h&&(a(i,"name")||r(i,"name",e)),t[e]!==i&&(h&&(a(i,o)||r(i,o,t[e]?""+t[e]:l.join(String(e)))),t===n?t[e]=i:s?t[e]?t[e]=i:r(t,e,i):(delete t[e],r(t,e,i)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[o]||s.call(this)})},function(t,e,i){var n=i(0),r=i(5),a=i(26),o=/"/g,s=function(t,e,i,n){var r=String(a(t)),s="<"+e;return""!==i&&(s+=" "+i+'="'+String(n).replace(o,"&quot;")+'"'),s+">"+r+"</"+e+">"};t.exports=function(t,e){var i={};i[t]=e(s),n(n.P+n.F*r(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",i)}},function(t,e,i){var n=i(51),r=i(26);t.exports=function(t){return n(r(t))}},function(t,e,i){var n=i(52),r=i(36),a=i(18),o=i(25),s=i(14),l=i(101),h=Object.getOwnPropertyDescriptor;e.f=i(8)?h:function(t,e){if(t=a(t),e=o(e,!0),l)try{return h(t,e)}catch(t){}if(s(t,e))return r(!n.f.call(t,e),t[e])}},function(t,e,i){var n=i(14),r=i(11),a=i(75)("IE_PROTO"),o=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),n(t,a)?t[a]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?o:null}},function(t,e,i){var n=i(12);t.exports=function(t,e,i){if(n(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,r){return t.call(e,i,n,r)}}return function(){return t.apply(e,arguments)}}},function(t,e){var i={}.toString;t.exports=function(t){return i.call(t).slice(8,-1)}},function(t,e,i){"use strict";var n=i(5);t.exports=function(t,e){return!!t&&n(function(){e?t.call(null,function(){},1):t.call(null)})}},function(t,e){var i=t.exports={version:"2.5.3"};"number"==typeof __e&&(__e=i)},function(t,e,i){var n=i(6);t.exports=function(t,e){if(!n(t))return t;var i,r;if(e&&"function"==typeof(i=t.toString)&&!n(r=i.call(t)))return r;if("function"==typeof(i=t.valueOf)&&!n(r=i.call(t)))return r;if(!e&&"function"==typeof(i=t.toString)&&!n(r=i.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){var i=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:i)(t)}},function(t,e,i){var n=i(0),r=i(24),a=i(5);t.exports=function(t,e){var i=(r.Object||{})[t]||Object[t],o={};o[t]=e(i),n(n.S+n.F*a(function(){i(1)}),"Object",o)}},function(t,e,i){var n=i(21),r=i(51),a=i(11),o=i(10),s=i(92);t.exports=function(t,e){var i=1==t,l=2==t,h=3==t,c=4==t,u=6==t,p=5==t||u,d=e||s;return function(e,s,f){for(var m,g,v=a(e),y=r(v),b=n(s,f,3),x=o(y.length),w=0,C=i?d(e,x):l?d(e,0):void 0;x>w;w++)if((p||w in y)&&(m=y[w],g=b(m,w,v),t))if(i)C[w]=g;else if(g)switch(t){case 3:return!0;case 5:return m;case 6:return w;case 2:C.push(m)}else if(c)return!1;return u?-1:h||c?c:C}}},function(t,e,i){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=i(2),l=i.n(s),h=i(72),c=i(1),u=(i.n(c),i(100)),p=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),d=function(t){function e(){return r(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),p(e,[{key:"getHelper",value:function(t,e,i){if(t||(t=this.topNode),!e&&!(e=t.getAttribute(i)))return null;var n=void 0,r=e.indexOf("("),a=e.substring(0,r),o=e.indexOf(".");if(-1===r||-1!==a.indexOf(".")){var s=e;if(-1!==o&&(s=e.substring(0,o)),!this.context)return console.log("No context attached to "+this.tagName+". A context is required when binding to a helper."),null;n=this.context.getAdvertised(s)}else for(var l=e.substring(0,r),c=Object(h.b)(t),u=0;u<c.length;u++){var p=c[u];if("function"==typeof p[l])return p}return n}},{key:"activate",value:function(t,e,i,r){var a=r?"stxsetget":"stxtap",o=c.CIQ.UI.splitMethod(t.getAttribute(a));if(o){var s=o.helperName,l=o.functionName;r&&(l="set"+l);var u=[{node:t,e:e,params:i}].concat(o.args);if(s){var p=this.getHelper(t,null,a);if(!p[l])return void console.log("Method '"+l+"' not found in helper",p);p[l].apply(p,n(u))}else for(var d=Object(h.b)(t),f=0;f<d.length;f++){var m=d[f];"function"==typeof m[l]&&m[l].apply(m,n(u))}}}},{key:"makeTap",value:function(t,e){t.selectFC=e,t.addEventListener("stxtap",e)}},{key:"bind",value:function(t,e){function i(t){return function(i){l.e=i,l.activate(t,i,e,!1)}}var r=void 0,a=t.getAttribute("stxbind"),o=t.getAttribute("stxtap"),s=t.getAttribute("stxsetget");a&&""!==a&&(r=this.getHelper(t,a,"stxbind"),function(e){var i=void 0,n=a.indexOf("(");i=a.substring(a.indexOf(".")+1),-1!==n&&(i=a.substring(0,n)),e[i](t)}(r));var l=this;o&&""!==o&&("INPUT"!==t.tagName||"text"!==t.type&&"number"!==t.type?this.makeTap(t,i(t)):this.inputEntry(t,i(t))),s&&(r=this.getHelper(t,s,"stxsetget"),function(i){function r(){return function(i){l.e=i,l.activate(t,i,e,!0)}}var a=c.CIQ.UI.splitMethod(s);if(!a)return void console.log("Syntax error "+s);var o=[t].concat(a.args).concat(e);i&&i["get"+a.functionName].apply(i,n(o)),"text"===t.type||"number"===t.type?l.inputEntry(t,r()):l.makeTap(t,r())}(r))}},{key:"scheduleForBinding",value:function(t){e.scheduledBindings.push({node:t,contextTag:this}),e.timeout&&clearTimeout(e.timeout),e.timeout=setTimeout(e.nextTick,0)}},{key:"buildReverseBindings",value:function(){if(!c.CIQ.UI.bypassBindings){var t=this,e=function(t){if(t.hasAttribute("stxbind")||t.hasAttribute("stxtap")||t.hasAttribute("stxsetget"))return NodeFilter.FILTER_ACCEPT},i=document.createNodeIterator(t,NodeFilter.SHOW_ELEMENT,c.CIQ.isIE?e:{acceptNode:e},!1),n=void 0;for(n=i.nextNode();n;)this.scheduleForBinding(n),n=i.nextNode()}}},{key:"inputEntry",value:function(t,e){t.addEventListener("keypress",function(t){switch(t.which){case 13:case 9:e()}})}},{key:"addClaim",value:function(t){u.b.push({helper:t})}},{key:"removeClaim",value:function(t){for(var e=0;e<u.b.length;e++)if(u.b[e].helper===t)return void u.b.splice(e,1)}},{key:"createdCallback",value:function(){this.node=l()(this)}},{key:"attachedCallback",value:function(){this.attached||(this.buildReverseBindings(),this.attached=!0)}},{key:"detachedCallback",value:function(){this.attached=!1}}],[{key:"nextTick",value:function(){if(c.CIQ.UI.release){clearTimeout(e.timeout);for(var t=e.scheduledBindings,i=t.length-1;i>=0;i--){var n=t[i];n.node.ciqAlreadyBound||(n.contextTag.bind.call(n.contextTag,n.node),n.node.ciqAlreadyBound=!0)}}}}]),e}(HTMLElement);d.scheduledBindings=[],d.timeout=null,e.a=d},function(t,e,i){"use strict";if(i(8)){var n=i(38),r=i(4),a=i(5),o=i(0),s=i(67),l=i(98),h=i(21),c=i(44),u=i(36),p=i(15),d=i(46),f=i(27),m=i(10),g=i(127),v=i(40),y=i(25),b=i(14),x=i(53),w=i(6),C=i(11),S=i(89),T=i(41),_=i(20),k=i(42).f,D=i(91),M=i(37),E=i(7),A=i(29),P=i(58),L=i(65),O=i(94),F=i(49),I=i(62),j=i(43),N=i(93),R=i(117),V=i(9),H=i(19),z=V.f,B=H.f,W=r.RangeError,q=r.TypeError,U=r.Uint8Array,Y=Array.prototype,X=l.ArrayBuffer,K=l.DataView,Q=A(0),Z=A(2),G=A(3),J=A(4),$=A(5),tt=A(6),et=P(!0),it=P(!1),nt=O.values,rt=O.keys,at=O.entries,ot=Y.lastIndexOf,st=Y.reduce,lt=Y.reduceRight,ht=Y.join,ct=Y.sort,ut=Y.slice,pt=Y.toString,dt=Y.toLocaleString,ft=E("iterator"),mt=E("toStringTag"),gt=M("typed_constructor"),vt=M("def_constructor"),yt=s.CONSTR,bt=s.TYPED,xt=s.VIEW,wt=A(1,function(t,e){return kt(L(t,t[vt]),e)}),Ct=a(function(){return 1===new U(new Uint16Array([1]).buffer)[0]}),St=!!U&&!!U.prototype.set&&a(function(){new U(1).set({})}),Tt=function(t,e){var i=f(t);if(i<0||i%e)throw W("Wrong offset!");return i},_t=function(t){if(w(t)&&bt in t)return t;throw q(t+" is not a typed array!")},kt=function(t,e){if(!(w(t)&&gt in t))throw q("It is not a typed array constructor!");return new t(e)},Dt=function(t,e){return Mt(L(t,t[vt]),e)},Mt=function(t,e){for(var i=0,n=e.length,r=kt(t,n);n>i;)r[i]=e[i++];return r},Et=function(t,e,i){z(t,e,{get:function(){return this._d[i]}})},At=function(t){var e,i,n,r,a,o,s=C(t),l=arguments.length,c=l>1?arguments[1]:void 0,u=void 0!==c,p=D(s);if(void 0!=p&&!S(p)){for(o=p.call(s),n=[],e=0;!(a=o.next()).done;e++)n.push(a.value);s=n}for(u&&l>2&&(c=h(c,arguments[2],2)),e=0,i=m(s.length),r=kt(this,i);i>e;e++)r[e]=u?c(s[e],e):s[e];return r},Pt=function(){for(var t=0,e=arguments.length,i=kt(this,e);e>t;)i[t]=arguments[t++];return i},Lt=!!U&&a(function(){dt.call(new U(1))}),Ot=function(){return dt.apply(Lt?ut.call(_t(this)):_t(this),arguments)},Ft={copyWithin:function(t,e){return R.call(_t(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return J(_t(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return N.apply(_t(this),arguments)},filter:function(t){return Dt(this,Z(_t(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return $(_t(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return tt(_t(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Q(_t(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return it(_t(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return et(_t(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ht.apply(_t(this),arguments)},lastIndexOf:function(t){return ot.apply(_t(this),arguments)},map:function(t){return wt(_t(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return st.apply(_t(this),arguments)},reduceRight:function(t){return lt.apply(_t(this),arguments)},reverse:function(){for(var t,e=this,i=_t(e).length,n=Math.floor(i/2),r=0;r<n;)t=e[r],e[r++]=e[--i],e[i]=t;return e},some:function(t){return G(_t(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return ct.call(_t(this),t)},subarray:function(t,e){var i=_t(this),n=i.length,r=v(t,n);return new(L(i,i[vt]))(i.buffer,i.byteOffset+r*i.BYTES_PER_ELEMENT,m((void 0===e?n:v(e,n))-r))}},It=function(t,e){return Dt(this,ut.call(_t(this),t,e))},jt=function(t){_t(this);var e=Tt(arguments[1],1),i=this.length,n=C(t),r=m(n.length),a=0;if(r+e>i)throw W("Wrong length!");for(;a<r;)this[e+a]=n[a++]},Nt={entries:function(){return at.call(_t(this))},keys:function(){return rt.call(_t(this))},values:function(){return nt.call(_t(this))}},Rt=function(t,e){return w(t)&&t[bt]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Vt=function(t,e){return Rt(t,e=y(e,!0))?u(2,t[e]):B(t,e)},Ht=function(t,e,i){return!(Rt(t,e=y(e,!0))&&w(i)&&b(i,"value"))||b(i,"get")||b(i,"set")||i.configurable||b(i,"writable")&&!i.writable||b(i,"enumerable")&&!i.enumerable?z(t,e,i):(t[e]=i.value,t)};yt||(H.f=Vt,V.f=Ht),o(o.S+o.F*!yt,"Object",{getOwnPropertyDescriptor:Vt,defineProperty:Ht}),a(function(){pt.call({})})&&(pt=dt=function(){return ht.call(this)});var zt=d({},Ft);d(zt,Nt),p(zt,ft,Nt.values),d(zt,{slice:It,set:jt,constructor:function(){},toString:pt,toLocaleString:Ot}),Et(zt,"buffer","b"),Et(zt,"byteOffset","o"),Et(zt,"byteLength","l"),Et(zt,"length","e"),z(zt,mt,{get:function(){return this[bt]}}),t.exports=function(t,e,i,l){l=!!l;var h=t+(l?"Clamped":"")+"Array",u="get"+t,d="set"+t,f=r[h],v=f||{},y=f&&_(f),b=!f||!s.ABV,C={},S=f&&f.prototype,D=function(t,i){var n=t._d;return n.v[u](i*e+n.o,Ct)},M=function(t,i,n){var r=t._d;l&&(n=(n=Math.round(n))<0?0:n>255?255:255&n),r.v[d](i*e+r.o,n,Ct)},E=function(t,e){z(t,e,{get:function(){return D(this,e)},set:function(t){return M(this,e,t)},enumerable:!0})};b?(f=i(function(t,i,n,r){c(t,f,h,"_d");var a,o,s,l,u=0,d=0;if(w(i)){if(!(i instanceof X||"ArrayBuffer"==(l=x(i))||"SharedArrayBuffer"==l))return bt in i?Mt(f,i):At.call(f,i);a=i,d=Tt(n,e);var v=i.byteLength;if(void 0===r){if(v%e)throw W("Wrong length!");if((o=v-d)<0)throw W("Wrong length!")}else if((o=m(r)*e)+d>v)throw W("Wrong length!");s=o/e}else s=g(i),o=s*e,a=new X(o);for(p(t,"_d",{b:a,o:d,l:o,e:s,v:new K(a)});u<s;)E(t,u++)}),S=f.prototype=T(zt),p(S,"constructor",f)):a(function(){f(1)})&&a(function(){new f(-1)})&&I(function(t){new f,new f(null),new f(1.5),new f(t)},!0)||(f=i(function(t,i,n,r){c(t,f,h);var a;return w(i)?i instanceof X||"ArrayBuffer"==(a=x(i))||"SharedArrayBuffer"==a?void 0!==r?new v(i,Tt(n,e),r):void 0!==n?new v(i,Tt(n,e)):new v(i):bt in i?Mt(f,i):At.call(f,i):new v(g(i))}),Q(y!==Function.prototype?k(v).concat(k(y)):k(v),function(t){t in f||p(f,t,v[t])}),f.prototype=S,n||(S.constructor=f));var A=S[ft],P=!!A&&("values"==A.name||void 0==A.name),L=Nt.values;p(f,gt,!0),p(S,bt,h),p(S,xt,!0),p(S,vt,f),(l?new f(1)[mt]==h:mt in S)||z(S,mt,{get:function(){return h}}),C[h]=f,o(o.G+o.W+o.F*(f!=v),C),o(o.S,h,{BYTES_PER_ELEMENT:e}),o(o.S+o.F*a(function(){v.of.call(f,1)}),h,{from:At,of:Pt}),"BYTES_PER_ELEMENT"in S||p(S,"BYTES_PER_ELEMENT",e),o(o.P,h,Ft),j(h),o(o.P+o.F*St,h,{set:jt}),o(o.P+o.F*!P,h,Nt),n||S.toString==pt||(S.toString=pt),o(o.P+o.F*a(function(){new f(1).slice()}),h,{slice:It}),o(o.P+o.F*(a(function(){return[1,2].toLocaleString()!=new f([1,2]).toLocaleString()})||!a(function(){S.toLocaleString.call([1,2])})),h,{toLocaleString:Ot}),F[h]=P?A:L,n||P||p(S,ft,L)}}else t.exports=function(){}},function(t,e,i){var n=i(122),r=i(0),a=i(57)("metadata"),o=a.store||(a.store=new(i(125))),s=function(t,e,i){var r=o.get(t);if(!r){if(!i)return;o.set(t,r=new n)}var a=r.get(e);if(!a){if(!i)return;r.set(e,a=new n)}return a},l=function(t,e,i){var n=s(e,i,!1);return void 0!==n&&n.has(t)},h=function(t,e,i){var n=s(e,i,!1);return void 0===n?void 0:n.get(t)},c=function(t,e,i,n){s(i,n,!0).set(t,e)},u=function(t,e){var i=s(t,e,!1),n=[];return i&&i.forEach(function(t,e){n.push(e)}),n},p=function(t){return void 0===t||"symbol"==typeof t?t:String(t)},d=function(t){r(r.S,"Reflect",t)};t.exports={store:o,map:s,has:l,get:h,set:c,keys:u,key:p,exp:d}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(30),s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),s(e,[{key:"open",value:function(t){t&&t.context&&this.setContext(t.context);var e=this.tagName.toLowerCase();this.node.closest("cq-dialog,cq-menu").each(function(){this.addActiveAttribute(e),this.open(t)})}},{key:"close",value:function(){this.node.parents("cq-dialog")[0].close(),this.node.find("cq-swatch").each(function(){this.colorPicker&&this.colorPicker.close()})}},{key:"setContext",value:function(t){this.context=t}}]),e}(o.a);e.a=l},function(t,e,i){var n=i(37)("meta"),r=i(6),a=i(14),o=i(9).f,s=0,l=Object.isExtensible||function(){return!0},h=!i(5)(function(){return l(Object.preventExtensions({}))}),c=function(t){o(t,n,{value:{i:"O"+ ++s,w:{}}})},u=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,n)){if(!l(t))return"F";if(!e)return"E";c(t)}return t[n].i},p=function(t,e){if(!a(t,n)){if(!l(t))return!0;if(!e)return!1;c(t)}return t[n].w},d=function(t){return h&&f.NEED&&l(t)&&!a(t,n)&&c(t),t},f=t.exports={KEY:n,NEED:!1,fastKey:u,getWeak:p,onFreeze:d}},function(t,e,i){var n=i(7)("unscopables"),r=Array.prototype;void 0==r[n]&&i(15)(r,n,{}),t.exports=function(t){r[n][t]=!0}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var i=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++i+n).toString(36))}},function(t,e){t.exports=!1},function(t,e,i){var n=i(103),r=i(76);t.exports=Object.keys||function(t){return n(t,r)}},function(t,e,i){var n=i(27),r=Math.max,a=Math.min;t.exports=function(t,e){return t=n(t),t<0?r(t+e,0):a(t,e)}},function(t,e,i){var n=i(3),r=i(104),a=i(76),o=i(75)("IE_PROTO"),s=function(){},l=function(){var t,e=i(73)("iframe"),n=a.length;for(e.style.display="none",i(77).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;n--;)delete l.prototype[a[n]];return l()};t.exports=Object.create||function(t,e){var i;return null!==t?(s.prototype=n(t),i=new s,s.prototype=null,i[o]=t):i=l(),void 0===e?i:r(i,e)}},function(t,e,i){var n=i(103),r=i(76).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,r)}},function(t,e,i){"use strict";var n=i(4),r=i(9),a=i(8),o=i(7)("species");t.exports=function(t){var e=n[t];a&&e&&!e[o]&&r.f(e,o,{configurable:!0,get:function(){return this}})}},function(t,e){t.exports=function(t,e,i,n){if(!(t instanceof e)||void 0!==n&&n in t)throw TypeError(i+": incorrect invocation!");return t}},function(t,e,i){var n=i(21),r=i(115),a=i(89),o=i(3),s=i(10),l=i(91),h={},c={},e=t.exports=function(t,e,i,u,p){var d,f,m,g,v=p?function(){return t}:l(t),y=n(i,u,e?2:1),b=0;if("function"!=typeof v)throw TypeError(t+" is not iterable!");if(a(v)){for(d=s(t.length);d>b;b++)if((g=e?y(o(f=t[b])[0],f[1]):y(t[b]))===h||g===c)return g}else for(m=v.call(t);!(f=m.next()).done;)if((g=r(m,y,f.value,e))===h||g===c)return g};e.BREAK=h,e.RETURN=c},function(t,e,i){var n=i(16);t.exports=function(t,e,i){for(var r in e)n(t,r,e[r],i);return t}},function(t,e,i){var n=i(9).f,r=i(14),a=i(7)("toStringTag");t.exports=function(t,e,i){t&&!r(t=i?t:t.prototype,a)&&n(t,a,{configurable:!0,value:e})}},function(t,e,i){var n=i(0),r=i(26),a=i(5),o=i(79),s="["+o+"]",l="​",h=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),u=function(t,e,i){var r={},s=a(function(){return!!o[t]()||l[t]()!=l}),h=r[t]=s?e(p):o[t];i&&(r[i]=h),n(n.P+n.F*s,"String",r)},p=u.trim=function(t,e){return t=String(r(t)),1&e&&(t=t.replace(h,"")),2&e&&(t=t.replace(c,"")),t};t.exports=u},function(t,e){t.exports={}},function(t,e,i){var n=i(6);t.exports=function(t,e){if(!n(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,i){var n=i(22);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,i){var n=i(22),r=i(7)("toStringTag"),a="Arguments"==n(function(){return arguments}()),o=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,i,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=o(e=Object(t),r))?i:a?n(e):"Object"==(s=n(e))&&"function"==typeof e.callee?"Arguments":s}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(13),h=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),c=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},u=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),h(e,[{key:"modalBegin",value:function(){this.context&&this.context.stx.modalBegin()}},{key:"modalEnd",value:function(){this.context&&(this.uiManager.activeMenuStack.length||this.context.stx.modalEnd())}},{key:"attachedCallback",value:function(){if(!this.attached){var t=s()(this),i=this;t.mouseover(function(){i.modalBegin()}),t.mouseout(function(){i.modalEnd()}),c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attachedCallback",this).call(this)}}}]),e}(l.a);e.a=u},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function(){function t(e,i){n(this,t),this.node=e,this.context=i,this.injections=[]}return r(t,[{key:"addInjection",value:function(t,e,i){this.injections.push(this.context.stx[t](e,i))}},{key:"destroy",value:function(){for(var t=0;t<this.injections.length;t++)this.context.stx.removeInjection(this.injections[t]);this.injections=[]}}]),t}();e.a=a},function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){var n=i(4),r=n["__core-js_shared__"]||(n["__core-js_shared__"]={});t.exports=function(t){return r[t]||(r[t]={})}},function(t,e,i){var n=i(18),r=i(10),a=i(40);t.exports=function(t){return function(e,i,o){var s,l=n(e),h=r(l.length),c=a(o,h);if(t&&i!=i){for(;h>c;)if((s=l[c++])!=s)return!0}else for(;h>c;c++)if((t||c in l)&&l[c]===i)return t||c||0;return!t&&-1}}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,i){var n=i(22);t.exports=Array.isArray||function(t){return"Array"==n(t)}},function(t,e,i){var n=i(6),r=i(22),a=i(7)("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[a])?!!e:"RegExp"==r(t))}},function(t,e,i){var n=i(7)("iterator"),r=!1;try{var a=[7][n]();a.return=function(){r=!0},Array.from(a,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!r)return!1;var i=!1;try{var a=[7],o=a[n]();o.next=function(){return{done:i=!0}},a[n]=function(){return o},t(a)}catch(t){}return i}},function(t,e,i){"use strict";var n=i(3);t.exports=function(){var t=n(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,i){"use strict";var n=i(15),r=i(16),a=i(5),o=i(26),s=i(7);t.exports=function(t,e,i){var l=s(t),h=i(o,l,""[t]),c=h[0],u=h[1];a(function(){var e={};return e[l]=function(){return 7},7!=""[t](e)})&&(r(String.prototype,t,c),n(RegExp.prototype,l,2==e?function(t,e){return u.call(t,this,e)}:function(t){return u.call(t,this)}))}},function(t,e,i){var n=i(3),r=i(12),a=i(7)("species");t.exports=function(t,e){var i,o=n(t).constructor;return void 0===o||void 0==(i=n(o)[a])?e:r(i)}},function(t,e,i){"use strict";var n=i(4),r=i(0),a=i(16),o=i(46),s=i(34),l=i(45),h=i(44),c=i(6),u=i(5),p=i(62),d=i(47),f=i(80);t.exports=function(t,e,i,m,g,v){var y=n[t],b=y,x=g?"set":"add",w=b&&b.prototype,C={},S=function(t){var e=w[t];a(w,t,"delete"==t?function(t){return!(v&&!c(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(v&&!c(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return v&&!c(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,i){return e.call(this,0===t?0:t,i),this})};if("function"==typeof b&&(v||w.forEach&&!u(function(){(new b).entries().next()}))){var T=new b,_=T[x](v?{}:-0,1)!=T,k=u(function(){T.has(1)}),D=p(function(t){new b(t)}),M=!v&&u(function(){for(var t=new b,e=5;e--;)t[x](e,e);return!t.has(-0)});D||(b=e(function(e,i){h(e,b,t);var n=f(new y,e,b);return void 0!=i&&l(i,g,n[x],n),n}),b.prototype=w,w.constructor=b),(k||M)&&(S("delete"),S("has"),g&&S("get")),(M||_)&&S(x),v&&w.clear&&delete w.clear}else b=m.getConstructor(e,t,g,x),o(b.prototype,i),s.NEED=!0;return d(b,t),C[t]=b,r(r.G+r.W+r.F*(b!=y),C),v||m.setStrong(b,t,g),b}},function(t,e,i){for(var n,r=i(4),a=i(15),o=i(37),s=o("typed_array"),l=o("view"),h=!(!r.ArrayBuffer||!r.DataView),c=h,u=0,p="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");u<9;)(n=r[p[u++]])?(a(n.prototype,s,!0),a(n.prototype,l,!0)):c=!1;t.exports={ABV:h,CONSTR:c,TYPED:s,VIEW:l}},function(t,e,i){"use strict";t.exports=i(38)||!i(5)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete i(4)[t]})},function(t,e,i){"use strict";var n=i(0);t.exports=function(t){n(n.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},function(t,e,i){"use strict";var n=i(0),r=i(12),a=i(21),o=i(45);t.exports=function(t){n(n.S,t,{from:function(t){var e,i,n,s,l=arguments[1];return r(this),e=void 0!==l,e&&r(l),void 0==t?new this:(i=[],e?(n=0,s=a(l,arguments[2],2),o(t,!1,function(t){i.push(s(t,n++))})):o(t,!1,i.push,i),new this(i))}})}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){"use strict";function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"body",i=document.querySelector(e);if(!i)return[];for(var n=[],r=t.parentNode;r!==i;){if(null===r)return[];n.push(r),r=r.parentNode}return n.push(i),n}function r(t){var e=document.createElement("div");return e.innerHTML=t,e.firstChild}e.b=n,e.a=r},function(t,e,i){var n=i(6),r=i(4).document,a=n(r)&&n(r.createElement);t.exports=function(t){return a?r.createElement(t):{}}},function(t,e,i){var n=i(4),r=i(24),a=i(38),o=i(102),s=i(9).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=a?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:o.f(t)})}},function(t,e,i){var n=i(57)("keys"),r=i(37);t.exports=function(t){return n[t]||(n[t]=r(t))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,i){var n=i(4).document;t.exports=n&&n.documentElement},function(t,e,i){var n=i(6),r=i(3),a=function(t,e){if(r(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{n=i(21)(Function.call,i(19).f(Object.prototype,"__proto__").set,2),n(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,i){return a(t,i),e?t.__proto__=i:n(t,i),t}}({},!1):void 0),check:a}},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,i){var n=i(6),r=i(78).set;t.exports=function(t,e,i){var a,o=e.constructor;return o!==i&&"function"==typeof o&&(a=o.prototype)!==i.prototype&&n(a)&&r&&r(t,a),t}},function(t,e,i){"use strict";var n=i(27),r=i(26);t.exports=function(t){var e=String(r(this)),i="",a=n(t);if(a<0||a==1/0)throw RangeError("Count can't be negative");for(;a>0;(a>>>=1)&&(e+=e))1&a&&(i+=e);return i}},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e){var i=Math.expm1;t.exports=!i||i(10)>22025.465794806718||i(10)<22025.465794806718||-2e-17!=i(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:i},function(t,e,i){var n=i(27),r=i(26);t.exports=function(t){return function(e,i){var a,o,s=String(r(e)),l=n(i),h=s.length;return l<0||l>=h?t?"":void 0:(a=s.charCodeAt(l),a<55296||a>56319||l+1===h||(o=s.charCodeAt(l+1))<56320||o>57343?t?s.charAt(l):a:t?s.slice(l,l+2):o-56320+(a-55296<<10)+65536)}}},function(t,e,i){"use strict";var n=i(38),r=i(0),a=i(16),o=i(15),s=i(14),l=i(49),h=i(86),c=i(47),u=i(20),p=i(7)("iterator"),d=!([].keys&&"next"in[].keys()),f=function(){return this};t.exports=function(t,e,i,m,g,v,y){h(i,e,m);var b,x,w,C=function(t){if(!d&&t in k)return k[t];switch(t){case"keys":case"values":return function(){return new i(this,t)}}return function(){return new i(this,t)}},S=e+" Iterator",T="values"==g,_=!1,k=t.prototype,D=k[p]||k["@@iterator"]||g&&k[g],M=!d&&D||C(g),E=g?T?C("entries"):M:void 0,A="Array"==e?k.entries||D:D;if(A&&(w=u(A.call(new t)))!==Object.prototype&&w.next&&(c(w,S,!0),n||s(w,p)||o(w,p,f)),T&&D&&"values"!==D.name&&(_=!0,M=function(){return D.call(this)}),n&&!y||!d&&!_&&k[p]||o(k,p,M),l[e]=M,l[S]=f,g)if(b={values:T?M:C("values"),keys:v?M:C("keys"),entries:E},y)for(x in b)x in k||a(k,x,b[x]);else r(r.P+r.F*(d||_),e,b);return b}},function(t,e,i){"use strict";var n=i(41),r=i(36),a=i(47),o={};i(15)(o,i(7)("iterator"),function(){return this}),t.exports=function(t,e,i){t.prototype=n(o,{next:r(1,i)}),a(t,e+" Iterator")}},function(t,e,i){var n=i(61),r=i(26);t.exports=function(t,e,i){if(n(e))throw TypeError("String#"+i+" doesn't accept regex!");return String(r(t))}},function(t,e,i){var n=i(7)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[n]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,i){var n=i(49),r=i(7)("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||a[r]===t)}},function(t,e,i){"use strict";var n=i(9),r=i(36);t.exports=function(t,e,i){e in t?n.f(t,e,r(0,i)):t[e]=i}},function(t,e,i){var n=i(53),r=i(7)("iterator"),a=i(49);t.exports=i(24).getIteratorMethod=function(t){if(void 0!=t)return t[r]||t["@@iterator"]||a[n(t)]}},function(t,e,i){var n=i(233);t.exports=function(t,e){return new(n(t))(e)}},function(t,e,i){"use strict";var n=i(11),r=i(40),a=i(10);t.exports=function(t){for(var e=n(this),i=a(e.length),o=arguments.length,s=r(o>1?arguments[1]:void 0,i),l=o>2?arguments[2]:void 0,h=void 0===l?i:r(l,i);h>s;)e[s++]=t;return e}},function(t,e,i){"use strict";var n=i(35),r=i(118),a=i(49),o=i(18);t.exports=i(85)(Array,"Array",function(t,e){this._t=o(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,r(1)):"keys"==e?r(0,i):"values"==e?r(0,t[i]):r(0,[i,t[i]])},"values"),a.Arguments=a.Array,n("keys"),n("values"),n("entries")},function(t,e,i){var n,r,a,o=i(21),s=i(108),l=i(77),h=i(73),c=i(4),u=c.process,p=c.setImmediate,d=c.clearImmediate,f=c.MessageChannel,m=c.Dispatch,g=0,v={},y=function(){var t=+this;if(v.hasOwnProperty(t)){var e=v[t];delete v[t],e()}},b=function(t){y.call(t.data)};p&&d||(p=function(t){for(var e=[],i=1;arguments.length>i;)e.push(arguments[i++]);return v[++g]=function(){s("function"==typeof t?t:Function(t),e)},n(g),g},d=function(t){delete v[t]},"process"==i(22)(u)?n=function(t){u.nextTick(o(y,t,1))}:m&&m.now?n=function(t){m.now(o(y,t,1))}:f?(r=new f,a=r.port2,r.port1.onmessage=b,n=o(a.postMessage,a,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(n=function(t){c.postMessage(t+"","*")},c.addEventListener("message",b,!1)):n="onreadystatechange"in h("script")?function(t){l.appendChild(h("script")).onreadystatechange=function(){l.removeChild(this),y.call(t)}}:function(t){setTimeout(o(y,t,1),0)}),t.exports={set:p,clear:d}},function(t,e,i){var n=i(4),r=i(95).set,a=n.MutationObserver||n.WebKitMutationObserver,o=n.process,s=n.Promise,l="process"==i(22)(o);t.exports=function(){var t,e,i,h=function(){var n,r;for(l&&(n=o.domain)&&n.exit();t;){r=t.fn,t=t.next;try{r()}catch(n){throw t?i():e=void 0,n}}e=void 0,n&&n.enter()};if(l)i=function(){o.nextTick(h)};else if(!a||n.navigator&&n.navigator.standalone)if(s&&s.resolve){var c=s.resolve();i=function(){c.then(h)}}else i=function(){r.call(n,h)};else{var u=!0,p=document.createTextNode("");new a(h).observe(p,{characterData:!0}),i=function(){p.data=u=!u}}return function(n){var r={fn:n,next:void 0};e&&(e.next=r),t||(t=r,i()),e=r}}},function(t,e,i){"use strict";function n(t){var e,i;this.promise=new t(function(t,n){if(void 0!==e||void 0!==i)throw TypeError("Bad Promise constructor");e=t,i=n}),this.resolve=r(e),this.reject=r(i)}var r=i(12);t.exports.f=function(t){return new n(t)}},function(t,e,i){"use strict";function n(t,e,i){var n,r,a,o=new Array(i),s=8*i-e-1,l=(1<<s)-1,h=l>>1,c=23===e?R(2,-24)-R(2,-77):0,u=0,p=t<0||0===t&&1/t<0?1:0;for(t=N(t),t!=t||t===I?(r=t!=t?1:0,n=l):(n=V(H(t)/z),t*(a=R(2,-n))<1&&(n--,a*=2),t+=n+h>=1?c/a:c*R(2,1-h),t*a>=2&&(n++,a/=2),n+h>=l?(r=0,n=l):n+h>=1?(r=(t*a-1)*R(2,e),n+=h):(r=t*R(2,h-1)*R(2,e),n=0));e>=8;o[u++]=255&r,r/=256,e-=8);for(n=n<<e|r,s+=e;s>0;o[u++]=255&n,n/=256,s-=8);return o[--u]|=128*p,o}function r(t,e,i){var n,r=8*i-e-1,a=(1<<r)-1,o=a>>1,s=r-7,l=i-1,h=t[l--],c=127&h;for(h>>=7;s>0;c=256*c+t[l],l--,s-=8);for(n=c&(1<<-s)-1,c>>=-s,s+=e;s>0;n=256*n+t[l],l--,s-=8);if(0===c)c=1-o;else{if(c===a)return n?NaN:h?-I:I;n+=R(2,e),c-=o}return(h?-1:1)*n*R(2,c-e)}function a(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function o(t){return[255&t]}function s(t){return[255&t,t>>8&255]}function l(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function h(t){return n(t,52,8)}function c(t){return n(t,23,4)}function u(t,e,i){k(t[E],e,{get:function(){return this[i]}})}function p(t,e,i,n){var r=+i,a=T(r);if(a+e>t[W])throw F(A);var o=t[B]._b,s=a+t[q],l=o.slice(s,s+e);return n?l:l.reverse()}function d(t,e,i,n,r,a){var o=+i,s=T(o);if(s+e>t[W])throw F(A);for(var l=t[B]._b,h=s+t[q],c=n(+r),u=0;u<e;u++)l[h+u]=c[a?u:e-u-1]}var f=i(4),m=i(8),g=i(38),v=i(67),y=i(15),b=i(46),x=i(5),w=i(44),C=i(27),S=i(10),T=i(127),_=i(42).f,k=i(9).f,D=i(93),M=i(47),E="prototype",A="Wrong index!",P=f.ArrayBuffer,L=f.DataView,O=f.Math,F=f.RangeError,I=f.Infinity,j=P,N=O.abs,R=O.pow,V=O.floor,H=O.log,z=O.LN2,B=m?"_b":"buffer",W=m?"_l":"byteLength",q=m?"_o":"byteOffset";if(v.ABV){if(!x(function(){P(1)})||!x(function(){new P(-1)})||x(function(){return new P,new P(1.5),new P(NaN),"ArrayBuffer"!=P.name})){P=function(t){return w(this,P),new j(T(t))};for(var U,Y=P[E]=j[E],X=_(j),K=0;X.length>K;)(U=X[K++])in P||y(P,U,j[U]);g||(Y.constructor=P)}var Q=new L(new P(2)),Z=L[E].setInt8;Q.setInt8(0,2147483648),Q.setInt8(1,2147483649),!Q.getInt8(0)&&Q.getInt8(1)||b(L[E],{setInt8:function(t,e){Z.call(this,t,e<<24>>24)},setUint8:function(t,e){Z.call(this,t,e<<24>>24)}},!0)}else P=function(t){w(this,P,"ArrayBuffer");var e=T(t);this._b=D.call(new Array(e),0),this[W]=e},L=function(t,e,i){w(this,L,"DataView"),w(t,P,"DataView");var n=t[W],r=C(e);if(r<0||r>n)throw F("Wrong offset!");if(i=void 0===i?n-r:S(i),r+i>n)throw F("Wrong length!");this[B]=t,this[q]=r,this[W]=i},m&&(u(P,"byteLength","_l"),u(L,"buffer","_b"),u(L,"byteLength","_l"),u(L,"byteOffset","_o")),b(L[E],{getInt8:function(t){return p(this,1,t)[0]<<24>>24},getUint8:function(t){return p(this,1,t)[0]},getInt16:function(t){var e=p(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=p(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return a(p(this,4,t,arguments[1]))},getUint32:function(t){return a(p(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return r(p(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return r(p(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){d(this,1,t,o,e)},setUint8:function(t,e){d(this,1,t,o,e)},setInt16:function(t,e){d(this,2,t,s,e,arguments[2])},setUint16:function(t,e){d(this,2,t,s,e,arguments[2])},setInt32:function(t,e){d(this,4,t,l,e,arguments[2])},setUint32:function(t,e){d(this,4,t,l,e,arguments[2])},setFloat32:function(t,e){d(this,4,t,c,e,arguments[2])},setFloat64:function(t,e){d(this,8,t,h,e,arguments[2])}});M(P,"ArrayBuffer"),M(L,"DataView"),y(L[E],v.VIEW,!0),e.ArrayBuffer=P,e.DataView=L},function(t,e,i){var n=i(4),r=n.navigator;t.exports=r&&r.userAgent||""},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.d(e,"b",function(){return v}),i.d(e,"a",function(){return y});var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),i(356)),c=(i.n(h),i(357),i(358),i(360),i(137)),u=i(361),p=i(362),d=i(363),f=i(138),m=i(364),g=i(365);l.CIQ.UI.release=!1,l.CIQ.UI.bypassBindings=!1;var v=[],y=function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),o=1;o<e;o++)i[o-1]=arguments[o];var s=function(t,e){Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(function(i){i.match(/^(?:constructor|prototype|arguments|caller|name|bind|call|apply|toString|length)$/)||Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))})},l=function(t){function e(){var t;n(this,e);for(var a=arguments.length,o=Array(a),l=0;l<a;l++)o[l]=arguments[l];var h=r(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(o)));return i.forEach(function(t){s(h,new t)}),h}return a(e,t),e}(t);return i.forEach(function(t){s(l.prototype,t.prototype),s(l,t)}),l};!function(){function t(t){var e=t.target||t.srcElement;e.__resizeRAF__&&a(e.__resizeRAF__),e.__resizeRAF__=r(function(){var i=e.__resizeTrigger__;i.__resizeListeners__.forEach(function(e){e.call(i,t)})})}function e(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",t)}var i=document.attachEvent,n=navigator.userAgent.match(/Trident/),r=function(){var t=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return window.setTimeout(t,20)};return function(e){return t(e)}}(),a=function(){var t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout;return function(e){return t(e)}}();l.CIQ.addResizeListener=function(r,a){var o=s()("cq-ui-manager");if(o.length>0&&(o=o[0],o.registerForResize(r)),!r.__resizeListeners__)if(r.__resizeListeners__=[],i)r.__resizeTrigger__=r,r.attachEvent("onresize",t);else{var l=r.__resizeTrigger__=document.createElement("object");l.setAttribute("style","visibility:hidden; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1; border:0px;"),l.__resizeElement__=r,l.onload=e,l.type="text/html",n&&r.appendChild(l),l.data="about:blank",n||r.appendChild(l)}r.__resizeListeners__.push(a)},l.CIQ.removeResizeListener=function(e,n){var r=s()("cq-ui-manager");r.length>0&&(r=r[0],r.unregisterForResize(e)),e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(n),1),e.__resizeListeners__.length||(i?e.detachEvent("onresize",t):(e.__resizeTrigger__.contentDocument.defaultView.removeEventListener("resize",t),e.__resizeTrigger__=!e.removeChild(e.__resizeTrigger__)))}}(),l.CIQ.Marker.HeadsUp=f.a,l.CIQ.UI.Context=c.a,l.CIQ.UI.HeadsUp=u.a,l.CIQ.UI.KeystrokeHub=g.a,l.CIQ.UI.StudyEdit=p.a,l.CIQ.UI.StudyMenu=m.a,l.CIQ.UI.Layout=d.a},function(t,e,i){t.exports=!i(8)&&!i(5)(function(){return 7!=Object.defineProperty(i(73)("div"),"a",{get:function(){return 7}}).a})},function(t,e,i){e.f=i(7)},function(t,e,i){var n=i(14),r=i(18),a=i(58)(!1),o=i(75)("IE_PROTO");t.exports=function(t,e){var i,s=r(t),l=0,h=[];for(i in s)i!=o&&n(s,i)&&h.push(i);for(;e.length>l;)n(s,i=e[l++])&&(~a(h,i)||h.push(i));return h}},function(t,e,i){var n=i(9),r=i(3),a=i(39);t.exports=i(8)?Object.defineProperties:function(t,e){r(t);for(var i,o=a(e),s=o.length,l=0;s>l;)n.f(t,i=o[l++],e[i]);return t}},function(t,e,i){var n=i(18),r=i(42).f,a={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return r(t)}catch(t){return o.slice()}};t.exports.f=function(t){return o&&"[object Window]"==a.call(t)?s(t):r(n(t))}},function(t,e,i){"use strict";var n=i(39),r=i(59),a=i(52),o=i(11),s=i(51),l=Object.assign;t.exports=!l||i(5)(function(){var t={},e={},i=Symbol(),n="abcdefghijklmnopqrst";return t[i]=7,n.split("").forEach(function(t){e[t]=t}),7!=l({},t)[i]||Object.keys(l({},e)).join("")!=n})?function(t,e){for(var i=o(t),l=arguments.length,h=1,c=r.f,u=a.f;l>h;)for(var p,d=s(arguments[h++]),f=c?n(d).concat(c(d)):n(d),m=f.length,g=0;m>g;)u.call(d,p=f[g++])&&(i[p]=d[p]);return i}:l},function(t,e,i){"use strict";var n=i(12),r=i(6),a=i(108),o=[].slice,s={},l=function(t,e,i){if(!(e in s)){for(var n=[],r=0;r<e;r++)n[r]="a["+r+"]";s[e]=Function("F,a","return new F("+n.join(",")+")")}return s[e](t,i)};t.exports=Function.bind||function(t){var e=n(this),i=o.call(arguments,1),s=function(){var n=i.concat(o.call(arguments));return this instanceof s?l(e,n.length,n):a(e,n,t)};return r(e.prototype)&&(s.prototype=e.prototype),s}},function(t,e){t.exports=function(t,e,i){var n=void 0===i;switch(e.length){case 0:return n?t():t.call(i);case 1:return n?t(e[0]):t.call(i,e[0]);case 2:return n?t(e[0],e[1]):t.call(i,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(i,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(i,e[0],e[1],e[2],e[3])}return t.apply(i,e)}},function(t,e,i){var n=i(4).parseInt,r=i(48).trim,a=i(79),o=/^[-+]?0[xX]/;t.exports=8!==n(a+"08")||22!==n(a+"0x16")?function(t,e){var i=r(String(t),3);return n(i,e>>>0||(o.test(i)?16:10))}:n},function(t,e,i){var n=i(4).parseFloat,r=i(48).trim;t.exports=1/n(i(79)+"-0")!=-1/0?function(t){var e=r(String(t),3),i=n(e);return 0===i&&"-"==e.charAt(0)?-0:i}:n},function(t,e,i){var n=i(22);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=n(t))throw TypeError(e);return+t}},function(t,e,i){var n=i(6),r=Math.floor;t.exports=function(t){return!n(t)&&isFinite(t)&&r(t)===t}},function(t,e){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,e,i){var n=i(82),r=Math.pow,a=r(2,-52),o=r(2,-23),s=r(2,127)*(2-o),l=r(2,-126),h=function(t){return t+1/a-1/a};t.exports=Math.fround||function(t){var e,i,r=Math.abs(t),c=n(t);return r<l?c*h(r/l/o)*l*o:(e=(1+o/a)*r,i=e-(e-r),i>s||i!=i?c*(1/0):c*i)}},function(t,e,i){var n=i(3);t.exports=function(t,e,i,r){try{return r?e(n(i)[0],i[1]):e(i)}catch(e){var a=t.return;throw void 0!==a&&n(a.call(t)),e}}},function(t,e,i){var n=i(12),r=i(11),a=i(51),o=i(10);t.exports=function(t,e,i,s,l){n(e);var h=r(t),c=a(h),u=o(h.length),p=l?u-1:0,d=l?-1:1;if(i<2)for(;;){if(p in c){s=c[p],p+=d;break}if(p+=d,l?p<0:u<=p)throw TypeError("Reduce of empty array with no initial value")}for(;l?p>=0:u>p;p+=d)p in c&&(s=e(s,c[p],p,h));return s}},function(t,e,i){"use strict";var n=i(11),r=i(40),a=i(10);t.exports=[].copyWithin||function(t,e){var i=n(this),o=a(i.length),s=r(t,o),l=r(e,o),h=arguments.length>2?arguments[2]:void 0,c=Math.min((void 0===h?o:r(h,o))-l,o-s),u=1;for(l<s&&s<l+c&&(u=-1,l+=c-1,s+=c-1);c-- >0;)l in i?i[s]=i[l]:delete i[s],s+=u,l+=u;return i}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,i){i(8)&&"g"!=/./g.flags&&i(9).f(RegExp.prototype,"flags",{configurable:!0,get:i(63)})},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,i){var n=i(3),r=i(6),a=i(97);t.exports=function(t,e){if(n(t),r(e)&&e.constructor===t)return e;var i=a.f(t);return(0,i.resolve)(e),i.promise}},function(t,e,i){"use strict";var n=i(123),r=i(50);t.exports=i(66)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=n.getEntry(r(this,"Map"),t);return e&&e.v},set:function(t,e){return n.def(r(this,"Map"),0===t?0:t,e)}},n,!0)},function(t,e,i){"use strict";var n=i(9).f,r=i(41),a=i(46),o=i(21),s=i(44),l=i(45),h=i(85),c=i(118),u=i(43),p=i(8),d=i(34).fastKey,f=i(50),m=p?"_s":"size",g=function(t,e){var i,n=d(e);if("F"!==n)return t._i[n];for(i=t._f;i;i=i.n)if(i.k==e)return i};t.exports={getConstructor:function(t,e,i,h){var c=t(function(t,n){s(t,c,e,"_i"),t._t=e,t._i=r(null),t._f=void 0,t._l=void 0,t[m]=0,void 0!=n&&l(n,i,t[h],t)});return a(c.prototype,{clear:function(){for(var t=f(this,e),i=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete i[n.i];t._f=t._l=void 0,t[m]=0},delete:function(t){var i=f(this,e),n=g(i,t);if(n){var r=n.n,a=n.p;delete i._i[n.i],n.r=!0,a&&(a.n=r),r&&(r.p=a),i._f==n&&(i._f=r),i._l==n&&(i._l=a),i[m]--}return!!n},forEach:function(t){f(this,e);for(var i,n=o(t,arguments.length>1?arguments[1]:void 0,3);i=i?i.n:this._f;)for(n(i.v,i.k,this);i&&i.r;)i=i.p},has:function(t){return!!g(f(this,e),t)}}),p&&n(c.prototype,"size",{get:function(){return f(this,e)[m]}}),c},def:function(t,e,i){var n,r,a=g(t,e);return a?a.v=i:(t._l=a={i:r=d(e,!0),k:e,v:i,p:n=t._l,n:void 0,r:!1},t._f||(t._f=a),n&&(n.n=a),t[m]++,"F"!==r&&(t._i[r]=a)),t},getEntry:g,setStrong:function(t,e,i){h(t,e,function(t,i){this._t=f(t,e),this._k=i,this._l=void 0},function(){for(var t=this,e=t._k,i=t._l;i&&i.r;)i=i.p;return t._t&&(t._l=i=i?i.n:t._t._f)?"keys"==e?c(0,i.k):"values"==e?c(0,i.v):c(0,[i.k,i.v]):(t._t=void 0,c(1))},i?"entries":"values",!i,!0),u(e)}}},function(t,e,i){"use strict";var n=i(123),r=i(50);t.exports=i(66)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return n.def(r(this,"Set"),t=0===t?0:t,t)}},n)},function(t,e,i){"use strict";var n,r=i(29)(0),a=i(16),o=i(34),s=i(106),l=i(126),h=i(6),c=i(5),u=i(50),p=o.getWeak,d=Object.isExtensible,f=l.ufstore,m={},g=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},v={get:function(t){if(h(t)){var e=p(t);return!0===e?f(u(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return l.def(u(this,"WeakMap"),t,e)}},y=t.exports=i(66)("WeakMap",g,v,l,!0,!0);c(function(){return 7!=(new y).set((Object.freeze||Object)(m),7).get(m)})&&(n=l.getConstructor(g,"WeakMap"),s(n.prototype,v),o.NEED=!0,r(["delete","has","get","set"],function(t){var e=y.prototype,i=e[t];a(e,t,function(e,r){if(h(e)&&!d(e)){this._f||(this._f=new n);var a=this._f[t](e,r);return"set"==t?this:a}return i.call(this,e,r)})}))},function(t,e,i){"use strict";var n=i(46),r=i(34).getWeak,a=i(3),o=i(6),s=i(44),l=i(45),h=i(29),c=i(14),u=i(50),p=h(5),d=h(6),f=0,m=function(t){return t._l||(t._l=new g)},g=function(){this.a=[]},v=function(t,e){return p(t.a,function(t){return t[0]===e})};g.prototype={get:function(t){var e=v(this,t);if(e)return e[1]},has:function(t){return!!v(this,t)},set:function(t,e){var i=v(this,t);i?i[1]=e:this.a.push([t,e])},delete:function(t){var e=d(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,i,a){var h=t(function(t,n){s(t,h,e,"_i"),t._t=e,t._i=f++,t._l=void 0,void 0!=n&&l(n,i,t[a],t)});return n(h.prototype,{delete:function(t){if(!o(t))return!1;var i=r(t);return!0===i?m(u(this,e)).delete(t):i&&c(i,this._i)&&delete i[this._i]},has:function(t){if(!o(t))return!1;var i=r(t);return!0===i?m(u(this,e)).has(t):i&&c(i,this._i)}}),h},def:function(t,e,i){var n=r(a(e),!0);return!0===n?m(t).set(e,i):n[t._i]=i,t},ufstore:m}},function(t,e,i){var n=i(27),r=i(10);t.exports=function(t){if(void 0===t)return 0;var e=n(t),i=r(e);if(e!==i)throw RangeError("Wrong length!");return i}},function(t,e,i){var n=i(42),r=i(59),a=i(3),o=i(4).Reflect;t.exports=o&&o.ownKeys||function(t){var e=n.f(a(t)),i=r.f;return i?e.concat(i(t)):e}},function(t,e,i){"use strict";function n(t,e,i,h,c,u,p,d){for(var f,m,g=c,v=0,y=!!p&&s(p,d,3);v<h;){if(v in i){if(f=y?y(i[v],v,e):i[v],m=!1,a(f)&&(m=f[l],m=void 0!==m?!!m:r(f)),m&&u>0)g=n(t,e,f,o(f.length),g,u-1)-1;else{if(g>=9007199254740991)throw TypeError();t[g]=f}g++}v++}return g}var r=i(60),a=i(6),o=i(10),s=i(21),l=i(7)("isConcatSpreadable");t.exports=n},function(t,e,i){var n=i(10),r=i(81),a=i(26);t.exports=function(t,e,i,o){var s=String(a(t)),l=s.length,h=void 0===i?" ":String(i),c=n(e);if(c<=l||""==h)return s;var u=c-l,p=r.call(h,Math.ceil(u/h.length));return p.length>u&&(p=p.slice(0,u)),o?p+s:s+p}},function(t,e,i){var n=i(39),r=i(18),a=i(52).f;t.exports=function(t){return function(e){for(var i,o=r(e),s=n(o),l=s.length,h=0,c=[];l>h;)a.call(o,i=s[h++])&&c.push(t?[i,o[i]]:o[i]);return c}}},function(t,e,i){var n=i(53),r=i(133);t.exports=function(t){return function(){if(n(this)!=t)throw TypeError(t+"#toJSON isn't generic");return r(this)}}},function(t,e,i){var n=i(45);t.exports=function(t,e){var i=[];return n(t,!1,i.push,i,e),i}},function(t,e){t.exports=Math.scale||function(t,e,i,n,r){return 0===arguments.length||t!=t||e!=e||i!=i||n!=n||r!=r?NaN:t===1/0||t===-1/0?t:(t-e)*(r-n)/(i-e)+n}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a={emitDelay:10,strictMode:!1},o=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?a:arguments[0];n(this,t);var i=void 0,r=void 0;i=e.hasOwnProperty("emitDelay")?e.emitDelay:a.emitDelay,this._emitDelay=i,r=e.hasOwnProperty("strictMode")?e.strictMode:a.strictMode,this._strictMode=r,this._listeners={},this.events=[]}return r(t,[{key:"_addListenner",value:function(t,e,i){if("function"!=typeof e)throw TypeError("listener must be a function");-1===this.events.indexOf(t)?(this._listeners[t]=[{once:i,fn:e}],this.events.push(t)):this._listeners[t].push({once:i,fn:e})}},{key:"on",value:function(t,e){this._addListenner(t,e,!1)}},{key:"once",value:function(t,e){this._addListenner(t,e,!0)}},{key:"off",value:function(t,e){var i=this,n=this.events.indexOf(t);t&&-1!==n&&(e?function(){var r=[],a=i._listeners[t];a.forEach(function(t,i){t.fn===e&&r.unshift(i)}),r.forEach(function(t){a.splice(t,1)}),a.length||(i.events.splice(n,1),delete i._listeners[t])}():(delete this._listeners[t],this.events.splice(n,1)))}},{key:"_applyEvents",value:function(t,e){var i=this._listeners[t];if(i&&i.length){var n=[];i.forEach(function(t,i){t.fn.apply(null,e),t.once&&n.unshift(i)}),n.forEach(function(t){i.splice(t,1)})}else if(this._strictMode)throw"No listeners specified for event: "+t}},{key:"emit",value:function(t){for(var e=this,i=arguments.length,n=Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];this._emitDelay?setTimeout(function(){e._applyEvents.call(e,t,n)},this._emitDelay):this._applyEvents(t,n)}},{key:"emitSync",value:function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];this._applyEvents(t,i)}},{key:"destroy",value:function(){this._listeners={},this.events=[]}}]),t}();t.exports=o},function(t,e,i){(function(t){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(r){"use strict";if("object"===n(e)&&"object"===n(t))t.exports=r(i(1));else if("function"==typeof define&&define.amd)define(["chartiq"],r);else{if("undefined"==typeof window&&"undefined"==typeof self)throw new Error("Only CommonJS, RequireJS, and <script> tags supported for iscroll.js.");var a="undefined"!=typeof window?window:self;r(a)}}(function(t){/*! iScroll v5.1.3 ~ (c) 2008-2014 Matteo Spinelli ~ http://cubiq.org/license */
return function(e,i,r){function a(t,e){this.wrapper="string"==typeof t?i.querySelector(t):t,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={resizeScrollbars:!0,mouseWheelSpeed:20,snapThreshold:.334,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0};for(var n in e)this.options[n]=e[n];this.translateZ=this.options.HWCompositing&&h.hasPerspective?" translateZ(0)":"",this.options.useTransition=h.hasTransition&&this.options.useTransition,this.options.useTransform=h.hasTransform&&this.options.useTransform,this.options.eventPassthrough=!0===this.options.eventPassthrough?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"!=this.options.eventPassthrough&&this.options.scrollY,this.options.scrollX="horizontal"!=this.options.eventPassthrough&&this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?h.ease[this.options.bounceEasing]||h.ease.circular:this.options.bounceEasing,this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling,!0===this.options.tap&&(this.options.tap="tap"),"scale"==this.options.shrinkScrollbars&&(this.options.useTransition=!1),this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1,3==this.options.probeType&&(this.options.useTransition=!1),this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}function o(t,e,n){var r=i.createElement("div"),a=i.createElement("div");return!0===n&&(r.style.cssText="position:absolute;z-index:9999"),a.className="iScrollIndicator","h"==t?(!0===n&&(r.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",a.style.height="100%"),r.className="iScrollHorizontalScrollbar"):(!0===n&&(r.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",a.style.width="100%"),r.className="iScrollVerticalScrollbar"),r.style.cssText+=";overflow:hidden",e||(r.style.pointerEvents="none"),r.appendChild(a),r}function s(t,n){this.wrapper="string"==typeof n.el?i.querySelector(n.el):n.el,this.wrapperStyle=this.wrapper.style,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=t,this.options={listenX:!0,listenY:!0,interactive:!1,resize:!0,defaultScrollbars:!1,shrink:!1,fade:!1,speedRatioX:0,speedRatioY:0};for(var r in n)this.options[r]=n[r];this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.options.interactive&&(this.options.disableTouch||(h.addEvent(this.indicator,"touchstart",this),h.addEvent(e,"touchend",this)),this.options.disablePointer||(h.addEvent(this.indicator,h.prefixPointerEvent("pointerdown"),this),h.addEvent(e,h.prefixPointerEvent("pointerup"),this)),this.options.disableMouse||(h.addEvent(this.indicator,"mousedown",this),h.addEvent(e,"mouseup",this))),this.options.fade&&(this.wrapperStyle[h.style.transform]=this.scroller.translateZ,this.wrapperStyle[h.style.transitionDuration]=h.isBadAndroid?"0.001s":"0ms",this.wrapperStyle.opacity="0")}var l=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)},h=function(){function t(t){return!1!==o&&(""===o?t:o+t.charAt(0).toUpperCase()+t.substr(1))}var n={},a=i.createElement("div").style,o=function(){for(var t=["t","webkitT","MozT","msT","OT"],e=0,i=t.length;e<i;e++)if(t[e]+"ransform"in a)return t[e].substr(0,t[e].length-1);return!1}();n.getTime=Date.now||function(){return(new Date).getTime()},n.extend=function(t,e){for(var i in e)t[i]=e[i]},n.addEvent=function(t,e,i,n){t.addEventListener(e,i,!!n)},n.removeEvent=function(t,e,i,n){t.removeEventListener(e,i,!!n)},n.prefixPointerEvent=function(t){return e.MSPointerEvent?"MSPointer"+t.charAt(9).toUpperCase()+t.substr(10):t},n.momentum=function(t,e,i,n,a,o){var s,l,h=t-e,c=r.abs(h)/i;return o=void 0===o?6e-4:o,s=t+c*c/(2*o)*(h<0?-1:1),l=c/o,s<n?(s=a?n-a/2.5*(c/8):n,h=r.abs(s-t),l=h/c):s>0&&(s=a?a/2.5*(c/8):0,h=r.abs(t)+s,l=h/c),{destination:r.round(s),duration:l}};var s=t("transform");return n.extend(n,{hasTransform:!1!==s,hasPerspective:t("perspective")in a,hasTouch:"ontouchstart"in e,hasPointer:e.PointerEvent||e.MSPointerEvent,hasTransition:t("transition")in a}),n.isBadAndroid=/Android /.test(e.navigator.appVersion)&&!/Chrome\/\d/.test(e.navigator.appVersion),n.extend(n.style={},{transform:s,transitionTimingFunction:t("transitionTimingFunction"),transitionDuration:t("transitionDuration"),transitionDelay:t("transitionDelay"),transformOrigin:t("transformOrigin")}),n.hasClass=function(t,e){return new RegExp("(^|\\s)"+e+"(\\s|$)").test(t.className)},n.addClass=function(t,e){if(!n.hasClass(t,e)){var i=t.className.split(" ");i.push(e),t.className=i.join(" ")}},n.removeClass=function(t,e){if(n.hasClass(t,e)){var i=new RegExp("(^|\\s)"+e+"(\\s|$)","g");t.className=t.className.replace(i," ")}},n.offset=function(t){for(var e=-t.offsetLeft,i=-t.offsetTop;t=t.offsetParent;)e-=t.offsetLeft,i-=t.offsetTop;return{left:e,top:i}},n.preventDefaultException=function(t,e){for(var i in e)if(e[i].test(t[i]))return!0;return!1},n.extend(n.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),n.extend(n.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(t){return t*(2-t)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(t){return r.sqrt(1- --t*t)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(t){return(t-=1)*t*(5*t+4)+1}},bounce:{style:"",fn:function(t){return(t/=1)<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},elastic:{style:"",fn:function(t){return 0===t?0:1==t?1:.4*r.pow(2,-10*t)*r.sin((t-.055)*(2*r.PI)/.22)+1}}}),n.tap=function(t,e){var n=i.createEvent("Event");n.initEvent(e,!0,!0),n.pageX=t.pageX,n.pageY=t.pageY,t.target.dispatchEvent(n)},n.click=function(t){var e,n=t.target;/(SELECT|INPUT|TEXTAREA)/i.test(n.tagName)||(e=i.createEvent("MouseEvents"),e.initMouseEvent("click",!0,!0,t.view,1,n.screenX,n.screenY,n.clientX,n.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,0,null),e._constructed=!0,n.dispatchEvent(e))},n}();/*! iScroll v5.1.3 ~ (c) 2008-2014 Matteo Spinelli ~ http://cubiq.org/license */
a.prototype={version:"5.1.3",_init:function(){this._initEvents(),(this.options.scrollbars||this.options.indicators)&&this._initIndicators(),this.options.mouseWheel=!0,this.wrapper.style.overflow="hidden",this.options.mouseWheel&&this._initWheel(),this.options.snap&&this._initSnap(),this.options.keyBindings&&this._initKeys()},destroy:function(){this._initEvents(!0),this._execEvent("destroy")},_transitionEnd:function(t){t.target==this.scroller&&this.isInTransition&&(this._transitionTime(),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd")))},_start:function(t){if((1==h.eventType[t.type]||0===t.button)&&this.enabled&&(!this.initiated||h.eventType[t.type]===this.initiated)){!this.options.preventDefault||h.isBadAndroid||h.preventDefaultException(t.target,this.options.preventDefaultException)||t.preventDefault();var e,i=t.touches?t.touches[0]:t;this.initiated=h.eventType[t.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this._transitionTime(),this.startTime=h.getTime(),this.options.useTransition&&this.isInTransition?(this.isInTransition=!1,e=this.getComputedPosition(),this._translate(r.round(e.x),r.round(e.y)),this._execEvent("scrollEnd")):!this.options.useTransition&&this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=i.pageX,this.pointY=i.pageY,this._execEvent("beforeScrollStart")}},_move:function(t){if(this.enabled&&h.eventType[t.type]===this.initiated){this.options.preventDefault&&t.preventDefault();var e,i,n,a,o=t.touches?t.touches[0]:t,s=o.pageX-this.pointX,l=o.pageY-this.pointY,c=h.getTime();if(this.pointX=o.pageX,this.pointY=o.pageY,this.distX+=s,this.distY+=l,n=r.abs(this.distX),a=r.abs(this.distY),!(c-this.endTime>300&&n<10&&a<10)){if(this.directionLocked||this.options.freeScroll||(n>a+this.options.directionLockThreshold?this.directionLocked="h":a>=n+this.options.directionLockThreshold?this.directionLocked="v":this.directionLocked="n"),"h"==this.directionLocked){if("vertical"==this.options.eventPassthrough)t.preventDefault();else if("horizontal"==this.options.eventPassthrough)return void(this.initiated=!1);l=0}else if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough)t.preventDefault();else if("vertical"==this.options.eventPassthrough)return void(this.initiated=!1);s=0}s=this.hasHorizontalScroll?s:0,l=this.hasVerticalScroll?l:0,e=this.x+s,i=this.y+l,(e>0||e<this.maxScrollX)&&(e=this.options.bounce?this.x+s/3:e>0?0:this.maxScrollX),(i>0||i<this.maxScrollY)&&(i=this.options.bounce?this.y+l/3:i>0?0:this.maxScrollY),this.directionX=s>0?-1:s<0?1:0,this.directionY=l>0?-1:l<0?1:0,this.moved||this._execEvent("scrollStart"),this.moved=!0,this._translate(e,i),c-this.startTime>300&&(this.startTime=c,this.startX=this.x,this.startY=this.y,1==this.options.probeType&&this._execEvent("scroll")),this.options.probeType>1&&this._execEvent("scroll")}}},_end:function(t){if(this.enabled&&h.eventType[t.type]===this.initiated){this.options.preventDefault&&!h.preventDefaultException(t.target,this.options.preventDefaultException)&&t.preventDefault();var e,i,n=(t.changedTouches&&t.changedTouches[0],h.getTime()-this.startTime),a=r.round(this.x),o=r.round(this.y),s=r.abs(a-this.startX),l=r.abs(o-this.startY),c=0,u="";if(this.isInTransition=0,this.initiated=0,this.endTime=h.getTime(),!this.resetPosition(this.options.bounceTime)){if(this.scrollTo(a,o),!this.moved)return this.options.tap&&h.tap(t,this.options.tap),this.options.click&&h.click(t),void this._execEvent("scrollCancel");if(this._events.flick&&n<200&&s<100&&l<100)return void this._execEvent("flick");if(this.options.momentum&&n<300&&(e=this.hasHorizontalScroll?h.momentum(this.x,this.startX,n,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:a,duration:0},i=this.hasVerticalScroll?h.momentum(this.y,this.startY,n,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:o,duration:0},a=e.destination,o=i.destination,c=r.max(e.duration,i.duration),this.isInTransition=1),this.options.snap){var p=this._nearestSnap(a,o);this.currentPage=p,c=this.options.snapSpeed||r.max(r.max(r.min(r.abs(a-p.x),1e3),r.min(r.abs(o-p.y),1e3)),300),a=p.x,o=p.y,this.directionX=0,this.directionY=0,u=this.options.bounceEasing}if(a!=this.x||o!=this.y)return(a>0||a<this.maxScrollX||o>0||o<this.maxScrollY)&&(u=h.ease.quadratic),void this.scrollTo(a,o,c,u);this._execEvent("scrollEnd")}}},_resize:function(){var t=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){t.refresh()},this.options.resizePolling)},resetPosition:function(t){var e=this.x,i=this.y;return t=t||0,!this.hasHorizontalScroll||this.x>0?e=0:this.x<this.maxScrollX&&(e=this.maxScrollX),!this.hasVerticalScroll||this.y>0?i=0:this.y<this.maxScrollY&&(i=this.maxScrollY),(e!=this.x||i!=this.y)&&(this.scrollTo(e,i,t,this.options.bounceEasing),!0)},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=this.scroller.offsetWidth,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=h.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(t,e){this._events[t]||(this._events[t]=[]),this._events[t].push(e)},off:function(t,e){if(this._events[t]){var i=this._events[t].indexOf(e);i>-1&&this._events[t].splice(i,1)}},_execEvent:function(t){if(this._events[t]){var e=0,i=this._events[t].length;if(i)for(;e<i;e++)this._events[t][e].apply(this,[].slice.call(arguments,1))}},scrollBy:function(t,e,i,n){t=this.x+t,e=this.y+e,i=i||0,this.scrollTo(t,e,i,n)},scrollTo:function(t,e,i,n){n=n||h.ease.circular,this.isInTransition=this.options.useTransition&&i>0,!i||this.options.useTransition&&n.style?(this._transitionTimingFunction(n.style),this._transitionTime(i),this._translate(t,e)):this._animate(t,e,i,n.fn)},scrollToElement:function(t,e,i,n,a){if(t=t.nodeType?t:this.scroller.querySelector(t)){var o=h.offset(t);o.left-=this.wrapperOffset.left,o.top-=this.wrapperOffset.top,!0===i&&(i=r.round(t.offsetWidth/2-this.wrapper.offsetWidth/2)),!0===n&&(n=r.round(t.offsetHeight/2-this.wrapper.offsetHeight/2)),o.left-=i||0,o.top-=n||0,o.left=o.left>0?0:o.left<this.maxScrollX?this.maxScrollX:o.left,o.top=o.top>0?0:o.top<this.maxScrollY?this.maxScrollY:o.top,e=void 0===e||null===e||"auto"===e?r.max(r.abs(this.x-o.left),r.abs(this.y-o.top)):e,this.scrollTo(o.left,o.top,e,a)}},_transitionTime:function(t){if(t=t||0,this.scrollerStyle[h.style.transitionDuration]=t+"ms",!t&&h.isBadAndroid&&(this.scrollerStyle[h.style.transitionDuration]="0.001s"),this.indicators)for(var e=this.indicators.length;e--;)this.indicators[e].transitionTime(t)},_transitionTimingFunction:function(t){if(this.scrollerStyle[h.style.transitionTimingFunction]=t,this.indicators)for(var e=this.indicators.length;e--;)this.indicators[e].transitionTimingFunction(t)},_translate:function(t,e){if(this.options.useTransform?this.scrollerStyle[h.style.transform]="translate("+t+"px,"+e+"px)"+this.translateZ:(t=r.round(t),e=r.round(e),this.scrollerStyle.left=t+"px",this.scrollerStyle.top=e+"px"),this.x=t,this.y=e,this.indicators)for(var i=this.indicators.length;i--;)this.indicators[i].updatePosition()},_initEvents:function(t){var i=t?h.removeEvent:h.addEvent,n=this.options.bindToWrapper?this.wrapper:e;i(e,"orientationchange",this),i(e,"resize",this),this.options.click&&i(this.wrapper,"click",this,!0),this.options.disableMouse||(i(this.wrapper,"mousedown",this),i(n,"mousemove",this),i(n,"mousecancel",this),i(n,"mouseup",this)),h.hasPointer&&!this.options.disablePointer&&(i(this.wrapper,h.prefixPointerEvent("pointerdown"),this),i(n,h.prefixPointerEvent("pointermove"),this),i(n,h.prefixPointerEvent("pointercancel"),this),i(n,h.prefixPointerEvent("pointerup"),this)),h.hasTouch&&!this.options.disableTouch&&(i(this.wrapper,"touchstart",this),i(n,"touchmove",this),i(n,"touchcancel",this),i(n,"touchend",this)),i(this.scroller,"transitionend",this),i(this.scroller,"webkitTransitionEnd",this),i(this.scroller,"oTransitionEnd",this),i(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var t,i,n=e.getComputedStyle(this.scroller,null);return this.options.useTransform?(n=n[h.style.transform].split(")")[0].split(", "),t=+(n[12]||n[4]),i=+(n[13]||n[5])):(t=+n.left.replace(/[^-\d.]/g,""),i=+n.top.replace(/[^-\d.]/g,"")),{x:t,y:i}},_initIndicators:function(){function t(t){for(var e=a.indicators.length;e--;)t.call(a.indicators[e])}var e,i=this.options.interactiveScrollbars,n="string"!=typeof this.options.scrollbars,r=[],a=this;this.indicators=[],this.options.scrollbars&&(this.options.scrollY&&(e={el:o("v",i,this.options.scrollbars),interactive:i,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:!1},this.wrapper.appendChild(e.el),r.push(e)),this.options.scrollX&&(e={el:o("h",i,this.options.scrollbars),interactive:i,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:!1},this.wrapper.appendChild(e.el),r.push(e))),this.options.indicators&&(r=r.concat(this.options.indicators));for(var l=r.length;l--;)this.indicators.push(new s(this,r[l]));this.options.fadeScrollbars&&(this.on("scrollEnd",function(){t(function(){this.fade()})}),this.on("scrollCancel",function(){t(function(){this.fade()})}),this.on("scrollStart",function(){t(function(){this.fade(1)})}),this.on("beforeScrollStart",function(){t(function(){this.fade(1,!0)})})),this.on("refresh",function(){t(function(){this.refresh()})}),this.on("destroy",function(){t(function(){this.destroy()}),delete this.indicators})},_initWheel:function(){h.addEvent(this.wrapper,"wheel",this),h.addEvent(this.wrapper,"mousewheel",this),h.addEvent(this.wrapper,"DOMMouseScroll",this),this.on("destroy",function(){h.removeEvent(this.wrapper,"wheel",this),h.removeEvent(this.wrapper,"mousewheel",this),h.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(t){if(this.enabled){t.preventDefault(),t.stopPropagation();var e,i,n,a,o=this;if(void 0===this.wheelTimeout&&o._execEvent("scrollStart"),clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(function(){o._execEvent("scrollEnd"),o.wheelTimeout=void 0},400),"deltaX"in t)1===t.deltaMode?(e=-t.deltaX*this.options.mouseWheelSpeed,i=-t.deltaY*this.options.mouseWheelSpeed):(e=-t.deltaX,i=-t.deltaY);else if("wheelDeltaX"in t)e=t.wheelDeltaX/120*this.options.mouseWheelSpeed,i=t.wheelDeltaY/120*this.options.mouseWheelSpeed;else if("wheelDelta"in t)e=i=t.wheelDelta/120*this.options.mouseWheelSpeed;else{if(!("detail"in t))return;e=i=-t.detail/3*this.options.mouseWheelSpeed}if(e*=this.options.invertWheelDirection,i*=this.options.invertWheelDirection,this.hasVerticalScroll||(e=i,i=0),this.options.snap)return n=this.currentPage.pageX,a=this.currentPage.pageY,e>0?n--:e<0&&n++,i>0?a--:i<0&&a++,void this.goToPage(n,a);n=this.x+r.round(this.hasHorizontalScroll?e:0),a=this.y+r.round(this.hasVerticalScroll?i:0),n>0?n=0:n<this.maxScrollX&&(n=this.maxScrollX),a>0?a=0:a<this.maxScrollY&&(a=this.maxScrollY),this.scrollTo(n,a,0),this.options.probeType>1&&this._execEvent("scroll")}},_initSnap:function(){this.currentPage={},"string"==typeof this.options.snap&&(this.options.snap=this.scroller.querySelectorAll(this.options.snap)),this.on("refresh",function(){var t,e,i,n,a,o,s=0,l=0,h=0,c=this.options.snapStepX||this.wrapperWidth,u=this.options.snapStepY||this.wrapperHeight;if(this.pages=[],this.wrapperWidth&&this.wrapperHeight&&this.scrollerWidth&&this.scrollerHeight){if(!0===this.options.snap)for(i=r.round(c/2),n=r.round(u/2);h>-this.scrollerWidth;){for(this.pages[s]=[],t=0,a=0;a>-this.scrollerHeight;)this.pages[s][t]={x:r.max(h,this.maxScrollX),y:r.max(a,this.maxScrollY),width:c,height:u,cx:h-i,cy:a-n},a-=u,t++;h-=c,s++}else for(o=this.options.snap,t=o.length,e=-1;s<t;s++)(0===s||o[s].offsetLeft<=o[s-1].offsetLeft)&&(l=0,e++),this.pages[l]||(this.pages[l]=[]),h=r.max(-o[s].offsetLeft,this.maxScrollX),a=r.max(-o[s].offsetTop,this.maxScrollY),i=h-r.round(o[s].offsetWidth/2),n=a-r.round(o[s].offsetHeight/2),this.pages[l][e]={x:h,y:a,width:o[s].offsetWidth,height:o[s].offsetHeight,cx:i,cy:n},h>this.maxScrollX&&l++;this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),this.options.snapThreshold%1==0?(this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold):(this.snapThresholdX=r.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=r.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold))}}),this.on("flick",function(){var t=this.options.snapSpeed||r.max(r.max(r.min(r.abs(this.x-this.startX),1e3),r.min(r.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,t)})},_nearestSnap:function(t,e){if(!this.pages.length)return{x:0,y:0,pageX:0,pageY:0};var i=0,n=this.pages.length,a=0;if(r.abs(t-this.absStartX)<this.snapThresholdX&&r.abs(e-this.absStartY)<this.snapThresholdY)return this.currentPage;for(t>0?t=0:t<this.maxScrollX&&(t=this.maxScrollX),e>0?e=0:e<this.maxScrollY&&(e=this.maxScrollY);i<n;i++)if(t>=this.pages[i][0].cx){t=this.pages[i][0].x;break}for(n=this.pages[i].length;a<n;a++)if(e>=this.pages[0][a].cy){e=this.pages[0][a].y;break}return i==this.currentPage.pageX&&(i+=this.directionX,i<0?i=0:i>=this.pages.length&&(i=this.pages.length-1),t=this.pages[i][0].x),a==this.currentPage.pageY&&(a+=this.directionY,a<0?a=0:a>=this.pages[0].length&&(a=this.pages[0].length-1),e=this.pages[0][a].y),{x:t,y:e,pageX:i,pageY:a}},goToPage:function(t,e,i,n){n=n||this.options.bounceEasing,t>=this.pages.length?t=this.pages.length-1:t<0&&(t=0),e>=this.pages[t].length?e=this.pages[t].length-1:e<0&&(e=0);var a=this.pages[t][e].x,o=this.pages[t][e].y;i=void 0===i?this.options.snapSpeed||r.max(r.max(r.min(r.abs(a-this.x),1e3),r.min(r.abs(o-this.y),1e3)),300):i,this.currentPage={x:a,y:o,pageX:t,pageY:e},this.scrollTo(a,o,i,n)},next:function(t,e){var i=this.currentPage.pageX,n=this.currentPage.pageY;i++,i>=this.pages.length&&this.hasVerticalScroll&&(i=0,n++),this.goToPage(i,n,t,e)},prev:function(t,e){var i=this.currentPage.pageX,n=this.currentPage.pageY;i--,i<0&&this.hasVerticalScroll&&(i=0,n--),this.goToPage(i,n,t,e)},_initKeys:function(t){var i,r={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};if("object"==n(this.options.keyBindings))for(i in this.options.keyBindings)"string"==typeof this.options.keyBindings[i]&&(this.options.keyBindings[i]=this.options.keyBindings[i].toUpperCase().charCodeAt(0));else this.options.keyBindings={};for(i in r)this.options.keyBindings[i]=this.options.keyBindings[i]||r[i];h.addEvent(e,"keydown",this),this.on("destroy",function(){h.removeEvent(e,"keydown",this)})},_key:function(t){if(this.enabled){var e,i=this.options.snap,n=i?this.currentPage.pageX:this.x,a=i?this.currentPage.pageY:this.y,o=h.getTime(),s=this.keyTime||0;switch(this.options.useTransition&&this.isInTransition&&(e=this.getComputedPosition(),this._translate(r.round(e.x),r.round(e.y)),this.isInTransition=!1),this.keyAcceleration=o-s<200?r.min(this.keyAcceleration+.25,50):0,t.keyCode){case this.options.keyBindings.pageUp:this.hasHorizontalScroll&&!this.hasVerticalScroll?n+=i?1:this.wrapperWidth:a+=i?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:this.hasHorizontalScroll&&!this.hasVerticalScroll?n-=i?1:this.wrapperWidth:a-=i?1:this.wrapperHeight;break;case this.options.keyBindings.end:n=i?this.pages.length-1:this.maxScrollX,a=i?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:n=0,a=0;break;case this.options.keyBindings.left:n+=i?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:a+=i?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:n-=i?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:a-=i?1:5+this.keyAcceleration>>0;break;default:return}if(i)return void this.goToPage(n,a);n>0?(n=0,this.keyAcceleration=0):n<this.maxScrollX&&(n=this.maxScrollX,this.keyAcceleration=0),a>0?(a=0,this.keyAcceleration=0):a<this.maxScrollY&&(a=this.maxScrollY,this.keyAcceleration=0),this.scrollTo(n,a,0),this.keyTime=o}},_animate:function(t,e,i,n){function r(){var p,d,f,m=h.getTime();if(m>=u)return a.isAnimating=!1,a._translate(t,e),void(a.resetPosition(a.options.bounceTime)||a._execEvent("scrollEnd"));m=(m-c)/i,f=n(m),p=(t-o)*f+o,d=(e-s)*f+s,a._translate(p,d),a.isAnimating&&l(r),3==a.options.probeType&&a._execEvent("scroll")}var a=this,o=this.x,s=this.y,c=h.getTime(),u=c+i;this.isAnimating=!0,r()},handleEvent:function(t){switch(t.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(t);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(t);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(t);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(t);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(t);break;case"keydown":this._key(t);break;case"click":t._constructed||(t.preventDefault(),t.stopPropagation())}}},s.prototype={handleEvent:function(t){switch(t.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(t);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(t);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(t)}},destroy:function(){this.options.interactive&&(h.removeEvent(this.indicator,"touchstart",this),h.removeEvent(this.indicator,h.prefixPointerEvent("pointerdown"),this),h.removeEvent(this.indicator,"mousedown",this),h.removeEvent(e,"touchmove",this),h.removeEvent(e,h.prefixPointerEvent("pointermove"),this),h.removeEvent(e,"mousemove",this),h.removeEvent(e,"touchend",this),h.removeEvent(e,h.prefixPointerEvent("pointerup"),this),h.removeEvent(e,"mouseup",this)),this.options.defaultScrollbars&&this.wrapper.parentNode.removeChild(this.wrapper)},_start:function(t){var i=t.touches?t.touches[0]:t;t.preventDefault(),t.stopPropagation(),this.transitionTime(),this.initiated=!0,this.moved=!1,this.lastPointX=i.pageX,this.lastPointY=i.pageY,this.startTime=h.getTime(),this.options.disableTouch||h.addEvent(e,"touchmove",this),this.options.disablePointer||h.addEvent(e,h.prefixPointerEvent("pointermove"),this),this.options.disableMouse||h.addEvent(e,"mousemove",this),this.scroller._execEvent("beforeScrollStart")},_move:function(t){var e,i,n,r,a=t.touches?t.touches[0]:t,o=h.getTime();this.moved||this.scroller._execEvent("scrollStart"),this.moved=!0,e=a.pageX-this.lastPointX,this.lastPointX=a.pageX,i=a.pageY-this.lastPointY,this.lastPointY=a.pageY,n=this.x+e,r=this.y+i,this._pos(n,r),1==this.scroller.options.probeType&&o-this.startTime>300?(this.startTime=o,this.scroller._execEvent("scroll")):this.scroller.options.probeType>1&&this.scroller._execEvent("scroll"),t.preventDefault(),t.stopPropagation()},_end:function(t){if(this.initiated){if(this.initiated=!1,t.preventDefault(),t.stopPropagation(),h.removeEvent(e,"touchmove",this),h.removeEvent(e,h.prefixPointerEvent("pointermove"),this),h.removeEvent(e,"mousemove",this),this.scroller.options.snap){var i=this.scroller._nearestSnap(this.scroller.x,this.scroller.y),n=this.options.snapSpeed||r.max(r.max(r.min(r.abs(this.scroller.x-i.x),1e3),r.min(r.abs(this.scroller.y-i.y),1e3)),300);this.scroller.x==i.x&&this.scroller.y==i.y||(this.scroller.directionX=0,this.scroller.directionY=0,this.scroller.currentPage=i,this.scroller.scrollTo(i.x,i.y,n,this.scroller.options.bounceEasing))}this.moved&&this.scroller._execEvent("scrollEnd")}},transitionTime:function(t){t=t||0,this.indicatorStyle[h.style.transitionDuration]=t+"ms",!t&&h.isBadAndroid&&(this.indicatorStyle[h.style.transitionDuration]="0.001s")},transitionTimingFunction:function(t){this.indicatorStyle[h.style.transitionTimingFunction]=t},refresh:function(){this.transitionTime(),this.options.listenX&&!this.options.listenY?this.indicatorStyle.display=this.scroller.hasHorizontalScroll?"block":"none":this.options.listenY&&!this.options.listenX?this.indicatorStyle.display=this.scroller.hasVerticalScroll?"block":"none":this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none",this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll?(h.addClass(this.wrapper,"iScrollBothScrollbars"),h.removeClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="8px":this.wrapper.style.bottom="8px")):(h.removeClass(this.wrapper,"iScrollBothScrollbars"),h.addClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="2px":this.wrapper.style.bottom="2px"));this.wrapper.offsetHeight;this.options.listenX&&(this.wrapperWidth=this.wrapper.clientWidth,this.options.resize?(this.indicatorWidth=r.max(r.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8),this.indicatorStyle.width=this.indicatorWidth+"px"):this.indicatorWidth=this.indicator.clientWidth,this.maxPosX=this.wrapperWidth-this.indicatorWidth,"clip"==this.options.shrink?(this.minBoundaryX=8-this.indicatorWidth,this.maxBoundaryX=this.wrapperWidth-8):(this.minBoundaryX=0,this.maxBoundaryX=this.maxPosX),this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX),this.options.listenY&&(this.wrapperHeight=this.wrapper.clientHeight,this.options.resize?(this.indicatorHeight=r.max(r.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8),this.indicatorStyle.height=this.indicatorHeight+"px"):this.indicatorHeight=this.indicator.clientHeight,this.maxPosY=this.wrapperHeight-this.indicatorHeight,"clip"==this.options.shrink?(this.minBoundaryY=8-this.indicatorHeight,this.maxBoundaryY=this.wrapperHeight-8):(this.minBoundaryY=0,this.maxBoundaryY=this.maxPosY),this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY),this.updatePosition()},updatePosition:function(){var t=this.options.listenX&&r.round(this.sizeRatioX*this.scroller.x)||0,e=this.options.listenY&&r.round(this.sizeRatioY*this.scroller.y)||0;this.options.ignoreBoundaries||(t<this.minBoundaryX?("scale"==this.options.shrink&&(this.width=r.max(this.indicatorWidth+t,8),this.indicatorStyle.width=this.width+"px"),t=this.minBoundaryX):t>this.maxBoundaryX?"scale"==this.options.shrink?(this.width=r.max(this.indicatorWidth-(t-this.maxPosX),8),this.indicatorStyle.width=this.width+"px",t=this.maxPosX+this.indicatorWidth-this.width):t=this.maxBoundaryX:"scale"==this.options.shrink&&this.width!=this.indicatorWidth&&(this.width=this.indicatorWidth,this.indicatorStyle.width=this.width+"px"),e<this.minBoundaryY?("scale"==this.options.shrink&&(this.height=r.max(this.indicatorHeight+3*e,8),this.indicatorStyle.height=this.height+"px"),e=this.minBoundaryY):e>this.maxBoundaryY?"scale"==this.options.shrink?(this.height=r.max(this.indicatorHeight-3*(e-this.maxPosY),8),this.indicatorStyle.height=this.height+"px",e=this.maxPosY+this.indicatorHeight-this.height):e=this.maxBoundaryY:"scale"==this.options.shrink&&this.height!=this.indicatorHeight&&(this.height=this.indicatorHeight,this.indicatorStyle.height=this.height+"px")),this.x=t,this.y=e,this.scroller.options.useTransform?this.indicatorStyle[h.style.transform]="translate("+t+"px,"+e+"px)"+this.scroller.translateZ:(this.indicatorStyle.left=t+"px",this.indicatorStyle.top=e+"px")},_pos:function(t,e){t<0?t=0:t>this.maxPosX&&(t=this.maxPosX),e<0?e=0:e>this.maxPosY&&(e=this.maxPosY),t=this.options.listenX?r.round(t/this.sizeRatioX):this.scroller.x,e=this.options.listenY?r.round(e/this.sizeRatioY):this.scroller.y,this.scroller.scrollTo(t,e)},fade:function(t,e){if(!e||this.visible){clearTimeout(this.fadeTimeout),this.fadeTimeout=null;var i=t?250:500,n=t?0:300;t=t?"1":"0",this.wrapperStyle[h.style.transitionDuration]=i+"ms",this.fadeTimeout=setTimeout(function(t){this.wrapperStyle.opacity=t,this.visible=+t}.bind(this,t),n)}}},a.utils=h,t.IScroll5=a}(window,document,Math),t})}).call(e,i(71)(t))},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(2),a=i.n(r),o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function(){function t(e,i,r){n(this,t),this.params=r||{},this.stx=e,i=this.topNode=a()(i)[0],this.node=a()(this.topNode);var o=t.assembleContext(i);this.advertised={},i.CIQ.UI.context=this;for(var s=0;s<o.Components.length;s++)o.Components[s].setContextPrivate(this)}return o(t,[{key:"changeSymbol",value:function(t){console.log("Please implement CIQ.UI.Context.prototype.changeSymbol")}},{key:"setLookupDriver",value:function(t){this.lookupDriver=t}},{key:"advertiseAs",value:function(t,e){this.advertised[e]=t}},{key:"getAdvertised",value:function(t){return this.advertised[t]}},{key:"setLoader",value:function(t){this.loader=t}},{key:"isModal",value:function(){return""!==this.stx.openDialog}}],[{key:"assembleContext",value:function(t){return t.CIQ||(t.CIQ={}),t.CIQ.UI||(t.CIQ.UI={}),t.CIQ.UI.Components||(t.CIQ.UI.Components=[]),t.CIQ.UI}}]),t}();e.a=s},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e,i,n){return Math.round(i-t.pixelFromPrice(n,e))}var s=i(2),l=i.n(s),h=i(1),c=(i.n(h),function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}()),u=function(t){function e(t,i){n(this,e);var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return a.className||(a.className="CIQ.Marker.HeadsUp"),h.CIQ.Marker.call(a,t),a.prevTick=null,a.showClass=i,a}return a(e,t),c(e,null,[{key:"placementFunction",value:function(t){var e=t.panel,i=e.chart,n=t.stx,r=n.highLowBars[n.layout.chartType];t.showClass||(t.showClass="stx-show");for(var a=0;a<t.arr.length;++a){var s=t.arr[a],c=l()(s.node);if(e.hidden||!h.CIQ.ChartEngine.insideChart)return void c.removeClass(t.showClass);if(s.params.x<0||s.params.x>=i.dataSet.length)return void c.removeClass(t.showClass);if(n.layout.crosshair||n.currentVectorParameters.vectorType)return void c.removeClass(t.showClass);var u=i.dataSet[s.params.x],p=n.pixelFromTick(s.params.x);if(!u||p<i.left||p>i.right)return void c.removeClass(t.showClass);c.addClass(t.showClass),s.clientWidth||(s.clientWidth=c.width()),s.clientHeight||(s.clientHeight=c.height()),s.clientWidth>p?(c.removeClass("stx-left"),c.addClass("stx-right"),c.css({left:p+"px",right:"auto"})):(c.addClass("stx-left"),c.removeClass("stx-right"),c.css({right:n.chart.canvasWidth-p+"px",left:"auto"}));var d,f=s.params.chartContainer?n.chart.canvasHeight:e.bottom;d=r?o(n,e,f,n.getBarBounds(u).high):o(n,e,f,u[n.chart.defaultPlotField]);f-d-s.clientHeight+n.top<0?(c.addClass("stx-below"),d=(r?o(n,e,f,n.getBarBounds(u).low):d)-s.clientHeight):c.removeClass("stx-below");var m=d+"px";s.node.style.bottom!==m&&(s.node.style.bottom=m)}}}]),e}(h.CIQ.Marker);e.a=u},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),i(72)),c=i(30),u=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),p=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},d=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),u(e,[{key:"top",value:function(){this.scrollTop=0}},{key:"scrollToElement",value:function(t){var e=this.clientHeight,i=this.scrollTop,n=t.offsetTop+t.clientHeight;t.offsetTop>i&&n<e+i||(this.scrollTop=Math.max(n-e,0))}},{key:"resize",value:function(){var t=this.node;if(!Object(h.b)(t[0],".sharing").length&&null===t[0].getAttribute("cq-no-resize")){null!==t[0].getAttribute("cq-no-maximize")&&(this.noMaximize=!0);var e=t[0].getBoundingClientRect(),i=screen.height;if(i){var n=i-e.top-45,r=Object(h.b)(t[0],".stx-holder,.stx-subholder");r.length&&r.forEach(function(t){var i=t.getBoundingClientRect().top+t.clientHeight;n=Math.min(n,i-e.top-5)});for(var a=t.nextAll(),o=0;o<a.length;o++){var l=s()(a[o]);l.is(":visible")&&(n-=l.height())}this.noMaximize||(t[0].style.height=n+"px"),t[0].style.maxHeight=n+"px"}}}},{key:"createdCallback",value:function(){p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createdCallback",this).call(this),(this.node=s()(this))[0].style.overflowY="auto"}},{key:"attachedCallback",value:function(){if(!this.attached){p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attachedCallback",this).call(this),this.uiManager=Object(l.$$$)("cq-ui-manager"),this.addClaim(this),this.addEventListener(l.CIQ.wheelEvent,function(t){t.stopPropagation()});var t=this;l.CIQ.addResizeListener(this,function(){t.resize()}),this.resize(),this.attached=!0}}},{key:"keyStroke",value:function(t,e,i){var n=this.node;if(!n.is(":trulyvisible"))return!1;if("up"!==e&&"down"!==e&&"enter"!==e&&32!==e)return!1;var r=n[0].querySelectorAll("cq-item"),a=n[0].querySelectorAll("cq-item[cq-focused]");if(32===e||"enter"===e)return!(!a.length||!a[0].selectFC)&&(a[0].selectFC.call(a,i),!0);if(!a.length)return r[0].setAttribute("cq-focused","true"),this.scrollToElement(r[0]),!0;r[0].removeAttribute("cq-focused");var o=void 0;for(o=0;o<r.length&&r[o]!==a[0];o++);return"up"===e&&--o<0&&(o=0),"down"===e&&++o>=r.length&&(o=r.length-1),r[o].setAttribute("cq-focused","true"),this.scrollToElement(r[o]),!0}},{key:"focused",value:function(){var t=this.node.find("cq-item[cq-focused]");return t.length?t[0]:null}}]),e}(c.a);document.registerElement("cq-scroll",d),e.a=d},function(t,e,i){i(141),t.exports=i(343)},function(t,e,i){"use strict";(function(t){function e(t,e,i){t[e]||Object[n](t,e,{writable:!0,configurable:!0,value:i})}if(i(142),i(339),i(340),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var n="defineProperty";e(String.prototype,"padLeft","".padStart),e(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&e(Array,t,Function.call.bind([][t]))})}).call(e,i(56))},function(t,e,i){i(143),i(145),i(146),i(147),i(148),i(149),i(150),i(151),i(152),i(153),i(154),i(155),i(156),i(157),i(158),i(159),i(161),i(162),i(163),i(164),i(165),i(166),i(167),i(168),i(169),i(170),i(171),i(172),i(173),i(174),i(175),i(176),i(177),i(178),i(179),i(180),i(181),i(182),i(183),i(184),i(185),i(186),i(187),i(188),i(189),i(190),i(191),i(192),i(193),i(194),i(195),i(196),i(197),i(198),i(199),i(200),i(201),i(202),i(203),i(204),i(205),i(206),i(207),i(208),i(209),i(210),i(211),i(212),i(213),i(214),i(215),i(216),i(217),i(218),i(219),i(220),i(221),i(223),i(224),i(226),i(227),i(228),i(229),i(230),i(231),i(232),i(234),i(235),i(236),i(237),i(238),i(239),i(240),i(241),i(242),i(243),i(244),i(245),i(246),i(94),i(247),i(248),i(119),i(249),i(250),i(251),i(252),i(253),i(122),i(124),i(125),i(254),i(255),i(256),i(257),i(258),i(259),i(260),i(261),i(262),i(263),i(264),i(265),i(266),i(267),i(268),i(269),i(270),i(271),i(272),i(273),i(274),i(275),i(276),i(277),i(278),i(279),i(280),i(281),i(282),i(283),i(284),i(285),i(286),i(287),i(288),i(289),i(290),i(291),i(292),i(293),i(294),i(295),i(296),i(297),i(298),i(299),i(300),i(301),i(302),i(303),i(304),i(305),i(306),i(307),i(308),i(309),i(310),i(311),i(312),i(313),i(314),i(315),i(316),i(317),i(318),i(319),i(320),i(321),i(322),i(323),i(324),i(325),i(326),i(327),i(328),i(329),i(330),i(331),i(332),i(333),i(334),i(335),i(336),i(337),i(338),t.exports=i(24)},function(t,e,i){"use strict";var n=i(4),r=i(14),a=i(8),o=i(0),s=i(16),l=i(34).KEY,h=i(5),c=i(57),u=i(47),p=i(37),d=i(7),f=i(102),m=i(74),g=i(144),v=i(60),y=i(3),b=i(6),x=i(18),w=i(25),C=i(36),S=i(41),T=i(105),_=i(19),k=i(9),D=i(39),M=_.f,E=k.f,A=T.f,P=n.Symbol,L=n.JSON,O=L&&L.stringify,F=d("_hidden"),I=d("toPrimitive"),j={}.propertyIsEnumerable,N=c("symbol-registry"),R=c("symbols"),V=c("op-symbols"),H=Object.prototype,z="function"==typeof P,B=n.QObject,W=!B||!B.prototype||!B.prototype.findChild,q=a&&h(function(){return 7!=S(E({},"a",{get:function(){return E(this,"a",{value:7}).a}})).a})?function(t,e,i){var n=M(H,e);n&&delete H[e],E(t,e,i),n&&t!==H&&E(H,e,n)}:E,U=function(t){var e=R[t]=S(P.prototype);return e._k=t,e},Y=z&&"symbol"==typeof P.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof P},X=function(t,e,i){return t===H&&X(V,e,i),y(t),e=w(e,!0),y(i),r(R,e)?(i.enumerable?(r(t,F)&&t[F][e]&&(t[F][e]=!1),i=S(i,{enumerable:C(0,!1)})):(r(t,F)||E(t,F,C(1,{})),t[F][e]=!0),q(t,e,i)):E(t,e,i)},K=function(t,e){y(t);for(var i,n=g(e=x(e)),r=0,a=n.length;a>r;)X(t,i=n[r++],e[i]);return t},Q=function(t,e){return void 0===e?S(t):K(S(t),e)},Z=function(t){var e=j.call(this,t=w(t,!0));return!(this===H&&r(R,t)&&!r(V,t))&&(!(e||!r(this,t)||!r(R,t)||r(this,F)&&this[F][t])||e)},G=function(t,e){if(t=x(t),e=w(e,!0),t!==H||!r(R,e)||r(V,e)){var i=M(t,e);return!i||!r(R,e)||r(t,F)&&t[F][e]||(i.enumerable=!0),i}},J=function(t){for(var e,i=A(x(t)),n=[],a=0;i.length>a;)r(R,e=i[a++])||e==F||e==l||n.push(e);return n},$=function(t){for(var e,i=t===H,n=A(i?V:x(t)),a=[],o=0;n.length>o;)!r(R,e=n[o++])||i&&!r(H,e)||a.push(R[e]);return a};z||(P=function(){if(this instanceof P)throw TypeError("Symbol is not a constructor!");var t=p(arguments.length>0?arguments[0]:void 0),e=function(i){this===H&&e.call(V,i),r(this,F)&&r(this[F],t)&&(this[F][t]=!1),q(this,t,C(1,i))};return a&&W&&q(H,t,{configurable:!0,set:e}),U(t)},s(P.prototype,"toString",function(){return this._k}),_.f=G,k.f=X,i(42).f=T.f=J,i(52).f=Z,i(59).f=$,a&&!i(38)&&s(H,"propertyIsEnumerable",Z,!0),f.f=function(t){return U(d(t))}),o(o.G+o.W+o.F*!z,{Symbol:P});for(var tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),et=0;tt.length>et;)d(tt[et++]);for(var it=D(d.store),nt=0;it.length>nt;)m(it[nt++]);o(o.S+o.F*!z,"Symbol",{for:function(t){return r(N,t+="")?N[t]:N[t]=P(t)},keyFor:function(t){if(!Y(t))throw TypeError(t+" is not a symbol!");for(var e in N)if(N[e]===t)return e},useSetter:function(){W=!0},useSimple:function(){W=!1}}),o(o.S+o.F*!z,"Object",{create:Q,defineProperty:X,defineProperties:K,getOwnPropertyDescriptor:G,getOwnPropertyNames:J,getOwnPropertySymbols:$}),L&&o(o.S+o.F*(!z||h(function(){var t=P();return"[null]"!=O([t])||"{}"!=O({a:t})||"{}"!=O(Object(t))})),"JSON",{stringify:function(t){for(var e,i,n=[t],r=1;arguments.length>r;)n.push(arguments[r++]);if(i=e=n[1],(b(e)||void 0!==t)&&!Y(t))return v(e)||(e=function(t,e){if("function"==typeof i&&(e=i.call(this,t,e)),!Y(e))return e}),n[1]=e,O.apply(L,n)}}),P.prototype[I]||i(15)(P.prototype,I,P.prototype.valueOf),u(P,"Symbol"),u(Math,"Math",!0),u(n.JSON,"JSON",!0)},function(t,e,i){var n=i(39),r=i(59),a=i(52);t.exports=function(t){var e=n(t),i=r.f;if(i)for(var o,s=i(t),l=a.f,h=0;s.length>h;)l.call(t,o=s[h++])&&e.push(o);return e}},function(t,e,i){var n=i(0);n(n.S,"Object",{create:i(41)})},function(t,e,i){var n=i(0);n(n.S+n.F*!i(8),"Object",{defineProperty:i(9).f})},function(t,e,i){var n=i(0);n(n.S+n.F*!i(8),"Object",{defineProperties:i(104)})},function(t,e,i){var n=i(18),r=i(19).f;i(28)("getOwnPropertyDescriptor",function(){return function(t,e){return r(n(t),e)}})},function(t,e,i){var n=i(11),r=i(20);i(28)("getPrototypeOf",function(){return function(t){return r(n(t))}})},function(t,e,i){var n=i(11),r=i(39);i(28)("keys",function(){return function(t){return r(n(t))}})},function(t,e,i){i(28)("getOwnPropertyNames",function(){return i(105).f})},function(t,e,i){var n=i(6),r=i(34).onFreeze;i(28)("freeze",function(t){return function(e){return t&&n(e)?t(r(e)):e}})},function(t,e,i){var n=i(6),r=i(34).onFreeze;i(28)("seal",function(t){return function(e){return t&&n(e)?t(r(e)):e}})},function(t,e,i){var n=i(6),r=i(34).onFreeze;i(28)("preventExtensions",function(t){return function(e){return t&&n(e)?t(r(e)):e}})},function(t,e,i){var n=i(6);i(28)("isFrozen",function(t){return function(e){return!n(e)||!!t&&t(e)}})},function(t,e,i){var n=i(6);i(28)("isSealed",function(t){return function(e){return!n(e)||!!t&&t(e)}})},function(t,e,i){var n=i(6);i(28)("isExtensible",function(t){return function(e){return!!n(e)&&(!t||t(e))}})},function(t,e,i){var n=i(0);n(n.S+n.F,"Object",{assign:i(106)})},function(t,e,i){var n=i(0);n(n.S,"Object",{is:i(160)})},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,i){var n=i(0);n(n.S,"Object",{setPrototypeOf:i(78).set})},function(t,e,i){"use strict";var n=i(53),r={};r[i(7)("toStringTag")]="z",r+""!="[object z]"&&i(16)(Object.prototype,"toString",function(){return"[object "+n(this)+"]"},!0)},function(t,e,i){var n=i(0);n(n.P,"Function",{bind:i(107)})},function(t,e,i){var n=i(9).f,r=Function.prototype,a=/^\s*function ([^ (]*)/;"name"in r||i(8)&&n(r,"name",{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(t){return""}}})},function(t,e,i){"use strict";var n=i(6),r=i(20),a=i(7)("hasInstance"),o=Function.prototype;a in o||i(9).f(o,a,{value:function(t){if("function"!=typeof this||!n(t))return!1;if(!n(this.prototype))return t instanceof this;for(;t=r(t);)if(this.prototype===t)return!0;return!1}})},function(t,e,i){var n=i(0),r=i(109);n(n.G+n.F*(parseInt!=r),{parseInt:r})},function(t,e,i){var n=i(0),r=i(110);n(n.G+n.F*(parseFloat!=r),{parseFloat:r})},function(t,e,i){"use strict";var n=i(4),r=i(14),a=i(22),o=i(80),s=i(25),l=i(5),h=i(42).f,c=i(19).f,u=i(9).f,p=i(48).trim,d=n.Number,f=d,m=d.prototype,g="Number"==a(i(41)(m)),v="trim"in String.prototype,y=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){e=v?e.trim():p(e,3);var i,n,r,a=e.charCodeAt(0);if(43===a||45===a){if(88===(i=e.charCodeAt(2))||120===i)return NaN}else if(48===a){switch(e.charCodeAt(1)){case 66:case 98:n=2,r=49;break;case 79:case 111:n=8,r=55;break;default:return+e}for(var o,l=e.slice(2),h=0,c=l.length;h<c;h++)if((o=l.charCodeAt(h))<48||o>r)return NaN;return parseInt(l,n)}}return+e};if(!d(" 0o1")||!d("0b1")||d("+0x1")){d=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof d&&(g?l(function(){m.valueOf.call(i)}):"Number"!=a(i))?o(new f(y(e)),i,d):y(e)};for(var b,x=i(8)?h(f):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;x.length>w;w++)r(f,b=x[w])&&!r(d,b)&&u(d,b,c(f,b));d.prototype=m,m.constructor=d,i(16)(n,"Number",d)}},function(t,e,i){"use strict";var n=i(0),r=i(27),a=i(111),o=i(81),s=1..toFixed,l=Math.floor,h=[0,0,0,0,0,0],c="Number.toFixed: incorrect invocation!",u=function(t,e){for(var i=-1,n=e;++i<6;)n+=t*h[i],h[i]=n%1e7,n=l(n/1e7)},p=function(t){for(var e=6,i=0;--e>=0;)i+=h[e],h[e]=l(i/t),i=i%t*1e7},d=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==h[t]){var i=String(h[t]);e=""===e?i:e+o.call("0",7-i.length)+i}return e},f=function(t,e,i){return 0===e?i:e%2==1?f(t,e-1,i*t):f(t*t,e/2,i)},m=function(t){for(var e=0,i=t;i>=4096;)e+=12,i/=4096;for(;i>=2;)e+=1,i/=2;return e};n(n.P+n.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!i(5)(function(){s.call({})})),"Number",{toFixed:function(t){var e,i,n,s,l=a(this,c),h=r(t),g="",v="0";if(h<0||h>20)throw RangeError(c);if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(g="-",l=-l),l>1e-21)if(e=m(l*f(2,69,1))-69,i=e<0?l*f(2,-e,1):l/f(2,e,1),i*=4503599627370496,(e=52-e)>0){for(u(0,i),n=h;n>=7;)u(1e7,0),n-=7;for(u(f(10,n,1),0),n=e-1;n>=23;)p(1<<23),n-=23;p(1<<n),u(1,1),p(2),v=d()}else u(0,i),u(1<<-e,0),v=d()+o.call("0",h);return h>0?(s=v.length,v=g+(s<=h?"0."+o.call("0",h-s)+v:v.slice(0,s-h)+"."+v.slice(s-h))):v=g+v,v}})},function(t,e,i){"use strict";var n=i(0),r=i(5),a=i(111),o=1..toPrecision;n(n.P+n.F*(r(function(){return"1"!==o.call(1,void 0)})||!r(function(){o.call({})})),"Number",{toPrecision:function(t){var e=a(this,"Number#toPrecision: incorrect invocation!");return void 0===t?o.call(e):o.call(e,t)}})},function(t,e,i){var n=i(0);n(n.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,i){var n=i(0),r=i(4).isFinite;n(n.S,"Number",{isFinite:function(t){return"number"==typeof t&&r(t)}})},function(t,e,i){var n=i(0);n(n.S,"Number",{isInteger:i(112)})},function(t,e,i){var n=i(0);n(n.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,i){var n=i(0),r=i(112),a=Math.abs;n(n.S,"Number",{isSafeInteger:function(t){return r(t)&&a(t)<=9007199254740991}})},function(t,e,i){var n=i(0);n(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,i){var n=i(0);n(n.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,i){var n=i(0),r=i(110);n(n.S+n.F*(Number.parseFloat!=r),"Number",{parseFloat:r})},function(t,e,i){var n=i(0),r=i(109);n(n.S+n.F*(Number.parseInt!=r),"Number",{parseInt:r})},function(t,e,i){var n=i(0),r=i(113),a=Math.sqrt,o=Math.acosh;n(n.S+n.F*!(o&&710==Math.floor(o(Number.MAX_VALUE))&&o(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:r(t-1+a(t-1)*a(t+1))}})},function(t,e,i){function n(t){return isFinite(t=+t)&&0!=t?t<0?-n(-t):Math.log(t+Math.sqrt(t*t+1)):t}var r=i(0),a=Math.asinh;r(r.S+r.F*!(a&&1/a(0)>0),"Math",{asinh:n})},function(t,e,i){var n=i(0),r=Math.atanh;n(n.S+n.F*!(r&&1/r(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,e,i){var n=i(0),r=i(82);n(n.S,"Math",{cbrt:function(t){return r(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,e,i){var n=i(0);n(n.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,e,i){var n=i(0),r=Math.exp;n(n.S,"Math",{cosh:function(t){return(r(t=+t)+r(-t))/2}})},function(t,e,i){var n=i(0),r=i(83);n(n.S+n.F*(r!=Math.expm1),"Math",{expm1:r})},function(t,e,i){var n=i(0);n(n.S,"Math",{fround:i(114)})},function(t,e,i){var n=i(0),r=Math.abs;n(n.S,"Math",{hypot:function(t,e){for(var i,n,a=0,o=0,s=arguments.length,l=0;o<s;)i=r(arguments[o++]),l<i?(n=l/i,a=a*n*n+1,l=i):i>0?(n=i/l,a+=n*n):a+=i;return l===1/0?1/0:l*Math.sqrt(a)}})},function(t,e,i){var n=i(0),r=Math.imul;n(n.S+n.F*i(5)(function(){return-5!=r(4294967295,5)||2!=r.length}),"Math",{imul:function(t,e){var i=+t,n=+e,r=65535&i,a=65535&n;return 0|r*a+((65535&i>>>16)*a+r*(65535&n>>>16)<<16>>>0)}})},function(t,e,i){var n=i(0);n(n.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},function(t,e,i){var n=i(0);n(n.S,"Math",{log1p:i(113)})},function(t,e,i){var n=i(0);n(n.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,i){var n=i(0);n(n.S,"Math",{sign:i(82)})},function(t,e,i){var n=i(0),r=i(83),a=Math.exp;n(n.S+n.F*i(5)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(r(t)-r(-t))/2:(a(t-1)-a(-t-1))*(Math.E/2)}})},function(t,e,i){var n=i(0),r=i(83),a=Math.exp;n(n.S,"Math",{tanh:function(t){var e=r(t=+t),i=r(-t);return e==1/0?1:i==1/0?-1:(e-i)/(a(t)+a(-t))}})},function(t,e,i){var n=i(0);n(n.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,e,i){var n=i(0),r=i(40),a=String.fromCharCode,o=String.fromCodePoint;n(n.S+n.F*(!!o&&1!=o.length),"String",{fromCodePoint:function(t){for(var e,i=[],n=arguments.length,o=0;n>o;){if(e=+arguments[o++],r(e,1114111)!==e)throw RangeError(e+" is not a valid code point");i.push(e<65536?a(e):a(55296+((e-=65536)>>10),e%1024+56320))}return i.join("")}})},function(t,e,i){var n=i(0),r=i(18),a=i(10);n(n.S,"String",{raw:function(t){for(var e=r(t.raw),i=a(e.length),n=arguments.length,o=[],s=0;i>s;)o.push(String(e[s++])),s<n&&o.push(String(arguments[s]));return o.join("")}})},function(t,e,i){"use strict";i(48)("trim",function(t){return function(){return t(this,3)}})},function(t,e,i){"use strict";var n=i(84)(!0);i(85)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,i=this._i;return i>=e.length?{value:void 0,done:!0}:(t=n(e,i),this._i+=t.length,{value:t,done:!1})})},function(t,e,i){"use strict";var n=i(0),r=i(84)(!1);n(n.P,"String",{codePointAt:function(t){return r(this,t)}})},function(t,e,i){"use strict";var n=i(0),r=i(10),a=i(87),o="".endsWith;n(n.P+n.F*i(88)("endsWith"),"String",{endsWith:function(t){var e=a(this,t,"endsWith"),i=arguments.length>1?arguments[1]:void 0,n=r(e.length),s=void 0===i?n:Math.min(r(i),n),l=String(t);return o?o.call(e,l,s):e.slice(s-l.length,s)===l}})},function(t,e,i){"use strict";var n=i(0),r=i(87);n(n.P+n.F*i(88)("includes"),"String",{includes:function(t){return!!~r(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,i){var n=i(0);n(n.P,"String",{repeat:i(81)})},function(t,e,i){"use strict";var n=i(0),r=i(10),a=i(87),o="".startsWith;n(n.P+n.F*i(88)("startsWith"),"String",{startsWith:function(t){var e=a(this,t,"startsWith"),i=r(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),n=String(t);return o?o.call(e,n,i):e.slice(i,i+n.length)===n}})},function(t,e,i){"use strict";i(17)("anchor",function(t){return function(e){return t(this,"a","name",e)}})},function(t,e,i){"use strict";i(17)("big",function(t){return function(){return t(this,"big","","")}})},function(t,e,i){"use strict";i(17)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,e,i){"use strict";i(17)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,e,i){"use strict";i(17)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,e,i){"use strict";i(17)("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},function(t,e,i){"use strict";i(17)("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},function(t,e,i){"use strict";i(17)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,e,i){"use strict";i(17)("link",function(t){return function(e){return t(this,"a","href",e)}})},function(t,e,i){"use strict";i(17)("small",function(t){return function(){return t(this,"small","","")}})},function(t,e,i){"use strict";i(17)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,e,i){"use strict";i(17)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,e,i){"use strict";i(17)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,e,i){var n=i(0);n(n.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,e,i){"use strict";var n=i(0),r=i(11),a=i(25);n(n.P+n.F*i(5)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var e=r(this),i=a(e);return"number"!=typeof i||isFinite(i)?e.toISOString():null}})},function(t,e,i){var n=i(0),r=i(222);n(n.P+n.F*(Date.prototype.toISOString!==r),"Date",{toISOString:r})},function(t,e,i){"use strict";var n=i(5),r=Date.prototype.getTime,a=Date.prototype.toISOString,o=function(t){return t>9?t:"0"+t};t.exports=n(function(){return"0385-07-25T07:06:39.999Z"!=a.call(new Date(-5e13-1))})||!n(function(){a.call(new Date(NaN))})?function(){if(!isFinite(r.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),i=t.getUTCMilliseconds(),n=e<0?"-":e>9999?"+":"";return n+("00000"+Math.abs(e)).slice(n?-6:-4)+"-"+o(t.getUTCMonth()+1)+"-"+o(t.getUTCDate())+"T"+o(t.getUTCHours())+":"+o(t.getUTCMinutes())+":"+o(t.getUTCSeconds())+"."+(i>99?i:"0"+o(i))+"Z"}:a},function(t,e,i){var n=Date.prototype,r=n.toString,a=n.getTime;new Date(NaN)+""!="Invalid Date"&&i(16)(n,"toString",function(){var t=a.call(this);return t===t?r.call(this):"Invalid Date"})},function(t,e,i){var n=i(7)("toPrimitive"),r=Date.prototype;n in r||i(15)(r,n,i(225))},function(t,e,i){"use strict";var n=i(3),r=i(25);t.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return r(n(this),"number"!=t)}},function(t,e,i){var n=i(0);n(n.S,"Array",{isArray:i(60)})},function(t,e,i){"use strict";var n=i(21),r=i(0),a=i(11),o=i(115),s=i(89),l=i(10),h=i(90),c=i(91);r(r.S+r.F*!i(62)(function(t){Array.from(t)}),"Array",{from:function(t){var e,i,r,u,p=a(t),d="function"==typeof this?this:Array,f=arguments.length,m=f>1?arguments[1]:void 0,g=void 0!==m,v=0,y=c(p);if(g&&(m=n(m,f>2?arguments[2]:void 0,2)),void 0==y||d==Array&&s(y))for(e=l(p.length),i=new d(e);e>v;v++)h(i,v,g?m(p[v],v):p[v]);else for(u=y.call(p),i=new d;!(r=u.next()).done;v++)h(i,v,g?o(u,m,[r.value,v],!0):r.value);return i.length=v,i}})},function(t,e,i){"use strict";var n=i(0),r=i(90);n(n.S+n.F*i(5)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,i=new("function"==typeof this?this:Array)(e);e>t;)r(i,t,arguments[t++]);return i.length=e,i}})},function(t,e,i){"use strict";var n=i(0),r=i(18),a=[].join;n(n.P+n.F*(i(51)!=Object||!i(23)(a)),"Array",{join:function(t){return a.call(r(this),void 0===t?",":t)}})},function(t,e,i){"use strict";var n=i(0),r=i(77),a=i(22),o=i(40),s=i(10),l=[].slice;n(n.P+n.F*i(5)(function(){r&&l.call(r)}),"Array",{slice:function(t,e){var i=s(this.length),n=a(this);if(e=void 0===e?i:e,"Array"==n)return l.call(this,t,e);for(var r=o(t,i),h=o(e,i),c=s(h-r),u=new Array(c),p=0;p<c;p++)u[p]="String"==n?this.charAt(r+p):this[r+p];return u}})},function(t,e,i){"use strict";var n=i(0),r=i(12),a=i(11),o=i(5),s=[].sort,l=[1,2,3];n(n.P+n.F*(o(function(){l.sort(void 0)})||!o(function(){l.sort(null)})||!i(23)(s)),"Array",{sort:function(t){return void 0===t?s.call(a(this)):s.call(a(this),r(t))}})},function(t,e,i){"use strict";var n=i(0),r=i(29)(0),a=i(23)([].forEach,!0);n(n.P+n.F*!a,"Array",{forEach:function(t){return r(this,t,arguments[1])}})},function(t,e,i){var n=i(6),r=i(60),a=i(7)("species");t.exports=function(t){var e;return r(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!r(e.prototype)||(e=void 0),n(e)&&null===(e=e[a])&&(e=void 0)),void 0===e?Array:e}},function(t,e,i){"use strict";var n=i(0),r=i(29)(1);n(n.P+n.F*!i(23)([].map,!0),"Array",{map:function(t){return r(this,t,arguments[1])}})},function(t,e,i){"use strict";var n=i(0),r=i(29)(2);n(n.P+n.F*!i(23)([].filter,!0),"Array",{filter:function(t){return r(this,t,arguments[1])}})},function(t,e,i){"use strict";var n=i(0),r=i(29)(3);n(n.P+n.F*!i(23)([].some,!0),"Array",{some:function(t){return r(this,t,arguments[1])}})},function(t,e,i){"use strict";var n=i(0),r=i(29)(4);n(n.P+n.F*!i(23)([].every,!0),"Array",{every:function(t){return r(this,t,arguments[1])}})},function(t,e,i){"use strict";var n=i(0),r=i(116);n(n.P+n.F*!i(23)([].reduce,!0),"Array",{reduce:function(t){return r(this,t,arguments.length,arguments[1],!1)}})},function(t,e,i){"use strict";var n=i(0),r=i(116);n(n.P+n.F*!i(23)([].reduceRight,!0),"Array",{reduceRight:function(t){return r(this,t,arguments.length,arguments[1],!0)}})},function(t,e,i){"use strict";var n=i(0),r=i(58)(!1),a=[].indexOf,o=!!a&&1/[1].indexOf(1,-0)<0;n(n.P+n.F*(o||!i(23)(a)),"Array",{indexOf:function(t){return o?a.apply(this,arguments)||0:r(this,t,arguments[1])}})},function(t,e,i){"use strict";var n=i(0),r=i(18),a=i(27),o=i(10),s=[].lastIndexOf,l=!!s&&1/[1].lastIndexOf(1,-0)<0;n(n.P+n.F*(l||!i(23)(s)),"Array",{lastIndexOf:function(t){if(l)return s.apply(this,arguments)||0;var e=r(this),i=o(e.length),n=i-1;for(arguments.length>1&&(n=Math.min(n,a(arguments[1]))),n<0&&(n=i+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}})},function(t,e,i){var n=i(0);n(n.P,"Array",{copyWithin:i(117)}),i(35)("copyWithin")},function(t,e,i){var n=i(0);n(n.P,"Array",{fill:i(93)}),i(35)("fill")},function(t,e,i){"use strict";var n=i(0),r=i(29)(5),a=!0;"find"in[]&&Array(1).find(function(){a=!1}),n(n.P+n.F*a,"Array",{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),i(35)("find")},function(t,e,i){"use strict";var n=i(0),r=i(29)(6),a="findIndex",o=!0;a in[]&&Array(1)[a](function(){o=!1}),n(n.P+n.F*o,"Array",{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),i(35)(a)},function(t,e,i){i(43)("Array")},function(t,e,i){var n=i(4),r=i(80),a=i(9).f,o=i(42).f,s=i(61),l=i(63),h=n.RegExp,c=h,u=h.prototype,p=/a/g,d=/a/g,f=new h(p)!==p;if(i(8)&&(!f||i(5)(function(){return d[i(7)("match")]=!1,h(p)!=p||h(d)==d||"/a/i"!=h(p,"i")}))){h=function(t,e){var i=this instanceof h,n=s(t),a=void 0===e;return!i&&n&&t.constructor===h&&a?t:r(f?new c(n&&!a?t.source:t,e):c((n=t instanceof h)?t.source:t,n&&a?l.call(t):e),i?this:u,h)};for(var m=o(c),g=0;m.length>g;)!function(t){t in h||a(h,t,{configurable:!0,get:function(){return c[t]},set:function(e){c[t]=e}})}(m[g++]);u.constructor=h,h.prototype=u,i(16)(n,"RegExp",h)}i(43)("RegExp")},function(t,e,i){"use strict";i(119);var n=i(3),r=i(63),a=i(8),o=/./.toString,s=function(t){i(16)(RegExp.prototype,"toString",t,!0)};i(5)(function(){return"/a/b"!=o.call({source:"a",flags:"b"})})?s(function(){var t=n(this);return"/".concat(t.source,"/","flags"in t?t.flags:!a&&t instanceof RegExp?r.call(t):void 0)}):"toString"!=o.name&&s(function(){return o.call(this)})},function(t,e,i){i(64)("match",1,function(t,e,i){return[function(i){"use strict";var n=t(this),r=void 0==i?void 0:i[e];return void 0!==r?r.call(i,n):new RegExp(i)[e](String(n))},i]})},function(t,e,i){i(64)("replace",2,function(t,e,i){return[function(n,r){"use strict";var a=t(this),o=void 0==n?void 0:n[e];return void 0!==o?o.call(n,a,r):i.call(String(a),n,r)},i]})},function(t,e,i){i(64)("search",1,function(t,e,i){return[function(i){"use strict";var n=t(this),r=void 0==i?void 0:i[e];return void 0!==r?r.call(i,n):new RegExp(i)[e](String(n))},i]})},function(t,e,i){i(64)("split",2,function(t,e,n){"use strict";var r=i(61),a=n,o=[].push,s="length";if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[s]||2!="ab".split(/(?:ab)*/)[s]||4!=".".split(/(.?)(.?)/)[s]||".".split(/()()/)[s]>1||"".split(/.?/)[s]){var l=void 0===/()??/.exec("")[1];n=function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!r(t))return a.call(i,t,e);var n,h,c,u,p,d=[],f=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),m=0,g=void 0===e?4294967295:e>>>0,v=new RegExp(t.source,f+"g");for(l||(n=new RegExp("^"+v.source+"$(?!\\s)",f));(h=v.exec(i))&&!((c=h.index+h[0][s])>m&&(d.push(i.slice(m,h.index)),!l&&h[s]>1&&h[0].replace(n,function(){for(p=1;p<arguments[s]-2;p++)void 0===arguments[p]&&(h[p]=void 0)}),h[s]>1&&h.index<i[s]&&o.apply(d,h.slice(1)),u=h[0][s],m=c,d[s]>=g));)v.lastIndex===h.index&&v.lastIndex++;return m===i[s]?!u&&v.test("")||d.push(""):d.push(i.slice(m)),d[s]>g?d.slice(0,g):d}}else"0".split(void 0,0)[s]&&(n=function(t,e){return void 0===t&&0===e?[]:a.call(this,t,e)});return[function(i,r){var a=t(this),o=void 0==i?void 0:i[e];return void 0!==o?o.call(i,a,r):n.call(String(a),i,r)},n]})},function(t,e,i){"use strict";var n,r,a,o,s=i(38),l=i(4),h=i(21),c=i(53),u=i(0),p=i(6),d=i(12),f=i(44),m=i(45),g=i(65),v=i(95).set,y=i(96)(),b=i(97),x=i(120),w=i(121),C=l.TypeError,S=l.process,T=l.Promise,_="process"==c(S),k=function(){},D=r=b.f,M=!!function(){try{var t=T.resolve(1),e=(t.constructor={})[i(7)("species")]=function(t){t(k,k)};return(_||"function"==typeof PromiseRejectionEvent)&&t.then(k)instanceof e}catch(t){}}(),E=function(t){var e;return!(!p(t)||"function"!=typeof(e=t.then))&&e},A=function(t,e){if(!t._n){t._n=!0;var i=t._c;y(function(){for(var n=t._v,r=1==t._s,a=0;i.length>a;)!function(e){var i,a,o=r?e.ok:e.fail,s=e.resolve,l=e.reject,h=e.domain;try{o?(r||(2==t._h&&O(t),t._h=1),!0===o?i=n:(h&&h.enter(),i=o(n),h&&h.exit()),i===e.promise?l(C("Promise-chain cycle")):(a=E(i))?a.call(i,s,l):s(i)):l(n)}catch(t){l(t)}}(i[a++]);t._c=[],t._n=!1,e&&!t._h&&P(t)})}},P=function(t){v.call(l,function(){var e,i,n,r=t._v,a=L(t);if(a&&(e=x(function(){_?S.emit("unhandledRejection",r,t):(i=l.onunhandledrejection)?i({promise:t,reason:r}):(n=l.console)&&n.error&&n.error("Unhandled promise rejection",r)}),t._h=_||L(t)?2:1),t._a=void 0,a&&e.e)throw e.v})},L=function(t){return 1!==t._h&&0===(t._a||t._c).length},O=function(t){v.call(l,function(){var e;_?S.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})})},F=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),A(e,!0))},I=function(t){var e,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===t)throw C("Promise can't be resolved itself");(e=E(t))?y(function(){var n={_w:i,_d:!1};try{e.call(t,h(I,n,1),h(F,n,1))}catch(t){F.call(n,t)}}):(i._v=t,i._s=1,A(i,!1))}catch(t){F.call({_w:i,_d:!1},t)}}};M||(T=function(t){f(this,T,"Promise","_h"),d(t),n.call(this);try{t(h(I,this,1),h(F,this,1))}catch(t){F.call(this,t)}},n=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},n.prototype=i(46)(T.prototype,{then:function(t,e){var i=D(g(this,T));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=_?S.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&A(this,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),a=function(){var t=new n;this.promise=t,this.resolve=h(I,t,1),this.reject=h(F,t,1)},b.f=D=function(t){return t===T||t===o?new a(t):r(t)}),u(u.G+u.W+u.F*!M,{Promise:T}),i(47)(T,"Promise"),i(43)("Promise"),o=i(24).Promise,u(u.S+u.F*!M,"Promise",{reject:function(t){var e=D(this);return(0,e.reject)(t),e.promise}}),u(u.S+u.F*(s||!M),"Promise",{resolve:function(t){return w(s&&this===o?T:this,t)}}),u(u.S+u.F*!(M&&i(62)(function(t){T.all(t).catch(k)})),"Promise",{all:function(t){var e=this,i=D(e),n=i.resolve,r=i.reject,a=x(function(){var i=[],a=0,o=1;m(t,!1,function(t){var s=a++,l=!1;i.push(void 0),o++,e.resolve(t).then(function(t){l||(l=!0,i[s]=t,--o||n(i))},r)}),--o||n(i)});return a.e&&r(a.v),i.promise},race:function(t){var e=this,i=D(e),n=i.reject,r=x(function(){m(t,!1,function(t){e.resolve(t).then(i.resolve,n)})});return r.e&&n(r.v),i.promise}})},function(t,e,i){"use strict";var n=i(126),r=i(50);i(66)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return n.def(r(this,"WeakSet"),t,!0)}},n,!1,!0)},function(t,e,i){"use strict";var n=i(0),r=i(67),a=i(98),o=i(3),s=i(40),l=i(10),h=i(6),c=i(4).ArrayBuffer,u=i(65),p=a.ArrayBuffer,d=a.DataView,f=r.ABV&&c.isView,m=p.prototype.slice,g=r.VIEW;n(n.G+n.W+n.F*(c!==p),{ArrayBuffer:p}),n(n.S+n.F*!r.CONSTR,"ArrayBuffer",{isView:function(t){return f&&f(t)||h(t)&&g in t}}),n(n.P+n.U+n.F*i(5)(function(){return!new p(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(t,e){if(void 0!==m&&void 0===e)return m.call(o(this),t);for(var i=o(this).byteLength,n=s(t,i),r=s(void 0===e?i:e,i),a=new(u(this,p))(l(r-n)),h=new d(this),c=new d(a),f=0;n<r;)c.setUint8(f++,h.getUint8(n++));return a}}),i(43)("ArrayBuffer")},function(t,e,i){var n=i(0);n(n.G+n.W+n.F*!i(67).ABV,{DataView:i(98).DataView})},function(t,e,i){i(31)("Int8",1,function(t){return function(e,i,n){return t(this,e,i,n)}})},function(t,e,i){i(31)("Uint8",1,function(t){return function(e,i,n){return t(this,e,i,n)}})},function(t,e,i){i(31)("Uint8",1,function(t){return function(e,i,n){return t(this,e,i,n)}},!0)},function(t,e,i){i(31)("Int16",2,function(t){return function(e,i,n){return t(this,e,i,n)}})},function(t,e,i){i(31)("Uint16",2,function(t){return function(e,i,n){return t(this,e,i,n)}})},function(t,e,i){i(31)("Int32",4,function(t){return function(e,i,n){return t(this,e,i,n)}})},function(t,e,i){i(31)("Uint32",4,function(t){return function(e,i,n){return t(this,e,i,n)}})},function(t,e,i){i(31)("Float32",4,function(t){return function(e,i,n){return t(this,e,i,n)}})},function(t,e,i){i(31)("Float64",8,function(t){return function(e,i,n){return t(this,e,i,n)}})},function(t,e,i){var n=i(0),r=i(12),a=i(3),o=(i(4).Reflect||{}).apply,s=Function.apply;n(n.S+n.F*!i(5)(function(){o(function(){})}),"Reflect",{apply:function(t,e,i){var n=r(t),l=a(i);return o?o(n,e,l):s.call(n,e,l)}})},function(t,e,i){var n=i(0),r=i(41),a=i(12),o=i(3),s=i(6),l=i(5),h=i(107),c=(i(4).Reflect||{}).construct,u=l(function(){function t(){}return!(c(function(){},[],t)instanceof t)}),p=!l(function(){c(function(){})});n(n.S+n.F*(u||p),"Reflect",{construct:function(t,e){a(t),o(e);var i=arguments.length<3?t:a(arguments[2]);if(p&&!u)return c(t,e,i);if(t==i){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var n=[null];return n.push.apply(n,e),new(h.apply(t,n))}var l=i.prototype,d=r(s(l)?l:Object.prototype),f=Function.apply.call(t,d,e);return s(f)?f:d}})},function(t,e,i){var n=i(9),r=i(0),a=i(3),o=i(25);r(r.S+r.F*i(5)(function(){Reflect.defineProperty(n.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,e,i){a(t),e=o(e,!0),a(i);try{return n.f(t,e,i),!0}catch(t){return!1}}})},function(t,e,i){var n=i(0),r=i(19).f,a=i(3);n(n.S,"Reflect",{deleteProperty:function(t,e){var i=r(a(t),e);return!(i&&!i.configurable)&&delete t[e]}})},function(t,e,i){"use strict";var n=i(0),r=i(3),a=function(t){this._t=r(t),this._i=0;var e,i=this._k=[];for(e in t)i.push(e)};i(86)(a,"Object",function(){var t,e=this,i=e._k;do{if(e._i>=i.length)return{value:void 0,done:!0}}while(!((t=i[e._i++])in e._t));return{value:t,done:!1}}),n(n.S,"Reflect",{enumerate:function(t){return new a(t)}})},function(t,e,i){function n(t,e){var i,s,c=arguments.length<3?t:arguments[2];return h(t)===c?t[e]:(i=r.f(t,e))?o(i,"value")?i.value:void 0!==i.get?i.get.call(c):void 0:l(s=a(t))?n(s,e,c):void 0}var r=i(19),a=i(20),o=i(14),s=i(0),l=i(6),h=i(3);s(s.S,"Reflect",{get:n})},function(t,e,i){var n=i(19),r=i(0),a=i(3);r(r.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return n.f(a(t),e)}})},function(t,e,i){var n=i(0),r=i(20),a=i(3);n(n.S,"Reflect",{getPrototypeOf:function(t){return r(a(t))}})},function(t,e,i){var n=i(0);n(n.S,"Reflect",{has:function(t,e){return e in t}})},function(t,e,i){var n=i(0),r=i(3),a=Object.isExtensible;n(n.S,"Reflect",{isExtensible:function(t){return r(t),!a||a(t)}})},function(t,e,i){var n=i(0);n(n.S,"Reflect",{ownKeys:i(128)})},function(t,e,i){var n=i(0),r=i(3),a=Object.preventExtensions;n(n.S,"Reflect",{preventExtensions:function(t){r(t);try{return a&&a(t),!0}catch(t){return!1}}})},function(t,e,i){function n(t,e,i){var l,p,d=arguments.length<4?t:arguments[3],f=a.f(c(t),e);if(!f){if(u(p=o(t)))return n(p,e,i,d);f=h(0)}return s(f,"value")?!(!1===f.writable||!u(d))&&(l=a.f(d,e)||h(0),l.value=i,r.f(d,e,l),!0):void 0!==f.set&&(f.set.call(d,i),!0)}var r=i(9),a=i(19),o=i(20),s=i(14),l=i(0),h=i(36),c=i(3),u=i(6);l(l.S,"Reflect",{set:n})},function(t,e,i){var n=i(0),r=i(78);r&&n(n.S,"Reflect",{setPrototypeOf:function(t,e){r.check(t,e);try{return r.set(t,e),!0}catch(t){return!1}}})},function(t,e,i){"use strict";var n=i(0),r=i(58)(!0);n(n.P,"Array",{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),i(35)("includes")},function(t,e,i){"use strict";var n=i(0),r=i(129),a=i(11),o=i(10),s=i(12),l=i(92);n(n.P,"Array",{flatMap:function(t){var e,i,n=a(this);return s(t),e=o(n.length),i=l(n,0),r(i,n,n,e,0,1,t,arguments[1]),i}}),i(35)("flatMap")},function(t,e,i){"use strict";var n=i(0),r=i(129),a=i(11),o=i(10),s=i(27),l=i(92);n(n.P,"Array",{flatten:function(){var t=arguments[0],e=a(this),i=o(e.length),n=l(e,0);return r(n,e,e,i,0,void 0===t?1:s(t)),n}}),i(35)("flatten")},function(t,e,i){"use strict";var n=i(0),r=i(84)(!0);n(n.P,"String",{at:function(t){return r(this,t)}})},function(t,e,i){"use strict";var n=i(0),r=i(130),a=i(99);n(n.P+n.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(a),"String",{padStart:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,i){"use strict";var n=i(0),r=i(130),a=i(99);n(n.P+n.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(a),"String",{padEnd:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,e,i){"use strict";i(48)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,e,i){"use strict";i(48)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,e,i){"use strict";var n=i(0),r=i(26),a=i(10),o=i(61),s=i(63),l=RegExp.prototype,h=function(t,e){this._r=t,this._s=e};i(86)(h,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),n(n.P,"String",{matchAll:function(t){if(r(this),!o(t))throw TypeError(t+" is not a regexp!");var e=String(this),i="flags"in l?String(t.flags):s.call(t),n=new RegExp(t.source,~i.indexOf("g")?i:"g"+i);return n.lastIndex=a(t.lastIndex),new h(n,e)}})},function(t,e,i){i(74)("asyncIterator")},function(t,e,i){i(74)("observable")},function(t,e,i){var n=i(0),r=i(128),a=i(18),o=i(19),s=i(90);n(n.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,i,n=a(t),l=o.f,h=r(n),c={},u=0;h.length>u;)void 0!==(i=l(n,e=h[u++]))&&s(c,e,i);return c}})},function(t,e,i){var n=i(0),r=i(131)(!1);n(n.S,"Object",{values:function(t){return r(t)}})},function(t,e,i){var n=i(0),r=i(131)(!0);n(n.S,"Object",{entries:function(t){return r(t)}})},function(t,e,i){"use strict";var n=i(0),r=i(11),a=i(12),o=i(9);i(8)&&n(n.P+i(68),"Object",{__defineGetter__:function(t,e){o.f(r(this),t,{get:a(e),enumerable:!0,configurable:!0})}})},function(t,e,i){"use strict";var n=i(0),r=i(11),a=i(12),o=i(9);i(8)&&n(n.P+i(68),"Object",{__defineSetter__:function(t,e){o.f(r(this),t,{set:a(e),enumerable:!0,configurable:!0})}})},function(t,e,i){"use strict";var n=i(0),r=i(11),a=i(25),o=i(20),s=i(19).f;i(8)&&n(n.P+i(68),"Object",{__lookupGetter__:function(t){var e,i=r(this),n=a(t,!0);do{if(e=s(i,n))return e.get}while(i=o(i))}})},function(t,e,i){"use strict";var n=i(0),r=i(11),a=i(25),o=i(20),s=i(19).f;i(8)&&n(n.P+i(68),"Object",{__lookupSetter__:function(t){var e,i=r(this),n=a(t,!0);do{if(e=s(i,n))return e.set}while(i=o(i))}})},function(t,e,i){var n=i(0);n(n.P+n.R,"Map",{toJSON:i(132)("Map")})},function(t,e,i){var n=i(0);n(n.P+n.R,"Set",{toJSON:i(132)("Set")})},function(t,e,i){i(69)("Map")},function(t,e,i){i(69)("Set")},function(t,e,i){i(69)("WeakMap")},function(t,e,i){i(69)("WeakSet")},function(t,e,i){i(70)("Map")},function(t,e,i){i(70)("Set")},function(t,e,i){i(70)("WeakMap")},function(t,e,i){i(70)("WeakSet")},function(t,e,i){var n=i(0);n(n.G,{global:i(4)})},function(t,e,i){var n=i(0);n(n.S,"System",{global:i(4)})},function(t,e,i){var n=i(0),r=i(22);n(n.S,"Error",{isError:function(t){return"Error"===r(t)}})},function(t,e,i){var n=i(0);n(n.S,"Math",{clamp:function(t,e,i){return Math.min(i,Math.max(e,t))}})},function(t,e,i){var n=i(0);n(n.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(t,e,i){var n=i(0),r=180/Math.PI;n(n.S,"Math",{degrees:function(t){return t*r}})},function(t,e,i){var n=i(0),r=i(134),a=i(114);n(n.S,"Math",{fscale:function(t,e,i,n,o){return a(r(t,e,i,n,o))}})},function(t,e,i){var n=i(0);n(n.S,"Math",{iaddh:function(t,e,i,n){var r=t>>>0,a=e>>>0,o=i>>>0;return a+(n>>>0)+((r&o|(r|o)&~(r+o>>>0))>>>31)|0}})},function(t,e,i){var n=i(0);n(n.S,"Math",{isubh:function(t,e,i,n){var r=t>>>0,a=e>>>0,o=i>>>0;return a-(n>>>0)-((~r&o|~(r^o)&r-o>>>0)>>>31)|0}})},function(t,e,i){var n=i(0);n(n.S,"Math",{imulh:function(t,e){var i=+t,n=+e,r=65535&i,a=65535&n,o=i>>16,s=n>>16,l=(o*a>>>0)+(r*a>>>16);return o*s+(l>>16)+((r*s>>>0)+(65535&l)>>16)}})},function(t,e,i){var n=i(0);n(n.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(t,e,i){var n=i(0),r=Math.PI/180;n(n.S,"Math",{radians:function(t){return t*r}})},function(t,e,i){var n=i(0);n(n.S,"Math",{scale:i(134)})},function(t,e,i){var n=i(0);n(n.S,"Math",{umulh:function(t,e){var i=+t,n=+e,r=65535&i,a=65535&n,o=i>>>16,s=n>>>16,l=(o*a>>>0)+(r*a>>>16);return o*s+(l>>>16)+((r*s>>>0)+(65535&l)>>>16)}})},function(t,e,i){var n=i(0);n(n.S,"Math",{signbit:function(t){return(t=+t)!=t?t:0==t?1/t==1/0:t>0}})},function(t,e,i){"use strict";var n=i(0),r=i(24),a=i(4),o=i(65),s=i(121);n(n.P+n.R,"Promise",{finally:function(t){var e=o(this,r.Promise||a.Promise),i="function"==typeof t;return this.then(i?function(i){return s(e,t()).then(function(){return i})}:t,i?function(i){return s(e,t()).then(function(){throw i})}:t)}})},function(t,e,i){"use strict";var n=i(0),r=i(97),a=i(120);n(n.S,"Promise",{try:function(t){var e=r.f(this),i=a(t);return(i.e?e.reject:e.resolve)(i.v),e.promise}})},function(t,e,i){var n=i(32),r=i(3),a=n.key,o=n.set;n.exp({defineMetadata:function(t,e,i,n){o(t,e,r(i),a(n))}})},function(t,e,i){var n=i(32),r=i(3),a=n.key,o=n.map,s=n.store;n.exp({deleteMetadata:function(t,e){var i=arguments.length<3?void 0:a(arguments[2]),n=o(r(e),i,!1);if(void 0===n||!n.delete(t))return!1;if(n.size)return!0;var l=s.get(e);return l.delete(i),!!l.size||s.delete(e)}})},function(t,e,i){var n=i(32),r=i(3),a=i(20),o=n.has,s=n.get,l=n.key,h=function(t,e,i){if(o(t,e,i))return s(t,e,i);var n=a(e);return null!==n?h(t,n,i):void 0};n.exp({getMetadata:function(t,e){return h(t,r(e),arguments.length<3?void 0:l(arguments[2]))}})},function(t,e,i){var n=i(124),r=i(133),a=i(32),o=i(3),s=i(20),l=a.keys,h=a.key,c=function(t,e){var i=l(t,e),a=s(t);if(null===a)return i;var o=c(a,e);return o.length?i.length?r(new n(i.concat(o))):o:i};a.exp({getMetadataKeys:function(t){return c(o(t),arguments.length<2?void 0:h(arguments[1]))}})},function(t,e,i){var n=i(32),r=i(3),a=n.get,o=n.key;n.exp({getOwnMetadata:function(t,e){return a(t,r(e),arguments.length<3?void 0:o(arguments[2]))}})},function(t,e,i){var n=i(32),r=i(3),a=n.keys,o=n.key;n.exp({getOwnMetadataKeys:function(t){return a(r(t),arguments.length<2?void 0:o(arguments[1]))}})},function(t,e,i){var n=i(32),r=i(3),a=i(20),o=n.has,s=n.key,l=function(t,e,i){if(o(t,e,i))return!0;var n=a(e);return null!==n&&l(t,n,i)};n.exp({hasMetadata:function(t,e){return l(t,r(e),arguments.length<3?void 0:s(arguments[2]))}})},function(t,e,i){var n=i(32),r=i(3),a=n.has,o=n.key;n.exp({hasOwnMetadata:function(t,e){return a(t,r(e),arguments.length<3?void 0:o(arguments[2]))}})},function(t,e,i){var n=i(32),r=i(3),a=i(12),o=n.key,s=n.set;n.exp({metadata:function(t,e){return function(i,n){s(t,e,(void 0!==n?r:a)(i),o(n))}}})},function(t,e,i){var n=i(0),r=i(96)(),a=i(4).process,o="process"==i(22)(a);n(n.G,{asap:function(t){var e=o&&a.domain;r(e?e.bind(t):t)}})},function(t,e,i){"use strict";var n=i(0),r=i(4),a=i(24),o=i(96)(),s=i(7)("observable"),l=i(12),h=i(3),c=i(44),u=i(46),p=i(15),d=i(45),f=d.RETURN,m=function(t){return null==t?void 0:l(t)},g=function(t){var e=t._c;e&&(t._c=void 0,e())},v=function(t){return void 0===t._o},y=function(t){v(t)||(t._o=void 0,g(t))},b=function(t,e){h(t),this._c=void 0,this._o=t,t=new x(this);try{var i=e(t),n=i;null!=i&&("function"==typeof i.unsubscribe?i=function(){n.unsubscribe()}:l(i),this._c=i)}catch(e){return void t.error(e)}v(this)&&g(this)};b.prototype=u({},{unsubscribe:function(){y(this)}});var x=function(t){this._s=t};x.prototype=u({},{next:function(t){var e=this._s;if(!v(e)){var i=e._o;try{var n=m(i.next);if(n)return n.call(i,t)}catch(t){try{y(e)}finally{throw t}}}},error:function(t){var e=this._s;if(v(e))throw t;var i=e._o;e._o=void 0;try{var n=m(i.error);if(!n)throw t;t=n.call(i,t)}catch(t){try{g(e)}finally{throw t}}return g(e),t},complete:function(t){var e=this._s;if(!v(e)){var i=e._o;e._o=void 0;try{var n=m(i.complete);t=n?n.call(i,t):void 0}catch(t){try{g(e)}finally{throw t}}return g(e),t}}});var w=function(t){c(this,w,"Observable","_f")._f=l(t)};u(w.prototype,{subscribe:function(t){return new b(t,this._f)},forEach:function(t){var e=this;return new(a.Promise||r.Promise)(function(i,n){l(t);var r=e.subscribe({next:function(e){try{return t(e)}catch(t){n(t),r.unsubscribe()}},error:n,complete:i})})}}),u(w,{from:function(t){var e="function"==typeof this?this:w,i=m(h(t)[s]);if(i){var n=h(i.call(t));return n.constructor===e?n:new e(function(t){return n.subscribe(t)})}return new e(function(e){var i=!1;return o(function(){if(!i){try{if(d(t,!1,function(t){if(e.next(t),i)return f})===f)return}catch(t){if(i)throw t;return void e.error(t)}e.complete()}}),function(){i=!0}})},of:function(){for(var t=0,e=arguments.length,i=new Array(e);t<e;)i[t]=arguments[t++];return new("function"==typeof this?this:w)(function(t){var e=!1;return o(function(){if(!e){for(var n=0;n<i.length;++n)if(t.next(i[n]),e)return;t.complete()}}),function(){e=!0}})}}),p(w.prototype,s,function(){return this}),n(n.G,{Observable:w}),i(43)("Observable")},function(t,e,i){var n=i(4),r=i(0),a=i(99),o=[].slice,s=/MSIE .\./.test(a),l=function(t){return function(e,i){var n=arguments.length>2,r=!!n&&o.call(arguments,2);return t(n?function(){("function"==typeof e?e:Function(e)).apply(this,r)}:e,i)}};r(r.G+r.B+r.F*s,{setTimeout:l(n.setTimeout),setInterval:l(n.setInterval)})},function(t,e,i){var n=i(0),r=i(95);n(n.G+n.B,{setImmediate:r.set,clearImmediate:r.clear})},function(t,e,i){for(var n=i(94),r=i(39),a=i(16),o=i(4),s=i(15),l=i(49),h=i(7),c=h("iterator"),u=h("toStringTag"),p=l.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=r(d),m=0;m<f.length;m++){var g,v=f[m],y=d[v],b=o[v],x=b&&b.prototype;if(x&&(x[c]||s(x,c,p),x[u]||s(x,u,v),l[v]=p,y))for(g in n)x[g]||a(x,g,n[g],!0)}},function(t,e,i){(function(e){!function(e){"use strict";function i(t,e,i,n){var a=e&&e.prototype instanceof r?e:r,o=Object.create(a.prototype),s=new d(n||[]);return o._invoke=h(t,i,s),o}function n(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}function r(){}function a(){}function o(){}function s(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function l(t){function i(e,r,a,o){var s=n(t[e],t,r);if("throw"!==s.type){var l=s.arg,h=l.value;return h&&"object"==typeof h&&y.call(h,"__await")?Promise.resolve(h.__await).then(function(t){i("next",t,a,o)},function(t){i("throw",t,a,o)}):Promise.resolve(h).then(function(t){l.value=t,a(l)},o)}o(s.arg)}function r(t,e){function n(){return new Promise(function(n,r){i(t,e,n,r)})}return a=a?a.then(n,n):n()}"object"==typeof e.process&&e.process.domain&&(i=e.process.domain.bind(i));var a;this._invoke=r}function h(t,e,i){var r=_;return function(a,o){if(r===D)throw new Error("Generator is already running");if(r===M){if("throw"===a)throw o;return m()}for(i.method=a,i.arg=o;;){var s=i.delegate;if(s){var l=c(s,i);if(l){if(l===E)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===_)throw r=M,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=D;var h=n(t,e,i);if("normal"===h.type){if(r=i.done?M:k,h.arg===E)continue;return{value:h.arg,done:i.done}}"throw"===h.type&&(r=M,i.method="throw",i.arg=h.arg)}}}function c(t,e){var i=t.iterator[e.method];if(i===g){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=g,c(t,e),"throw"===e.method))return E;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return E}var r=n(i,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,E;var a=r.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=g),e.delegate=null,E):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,E)}function u(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function p(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function d(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(u,this),this.reset(!0)}function f(t){if(t){var e=t[x];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,n=function e(){for(;++i<t.length;)if(y.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=g,e.done=!0,e};return n.next=n}}return{next:m}}function m(){return{value:g,done:!0}}var g,v=Object.prototype,y=v.hasOwnProperty,b="function"==typeof Symbol?Symbol:{},x=b.iterator||"@@iterator",w=b.asyncIterator||"@@asyncIterator",C=b.toStringTag||"@@toStringTag",S="object"==typeof t,T=e.regeneratorRuntime;if(T)return void(S&&(t.exports=T));T=e.regeneratorRuntime=S?t.exports:{},T.wrap=i;var _="suspendedStart",k="suspendedYield",D="executing",M="completed",E={},A={};A[x]=function(){return this};var P=Object.getPrototypeOf,L=P&&P(P(f([])));L&&L!==v&&y.call(L,x)&&(A=L);var O=o.prototype=r.prototype=Object.create(A);a.prototype=O.constructor=o,o.constructor=a,o[C]=a.displayName="GeneratorFunction",T.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===a||"GeneratorFunction"===(e.displayName||e.name))},T.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,o):(t.__proto__=o,C in t||(t[C]="GeneratorFunction")),t.prototype=Object.create(O),t},T.awrap=function(t){return{__await:t}},s(l.prototype),l.prototype[w]=function(){return this},T.AsyncIterator=l,T.async=function(t,e,n,r){var a=new l(i(t,e,n,r));return T.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},s(O),O[C]="Generator",O[x]=function(){return this},O.toString=function(){return"[object Generator]"},T.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},T.values=f,d.prototype={constructor:d,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(p),!t)for(var e in this)"t"===e.charAt(0)&&y.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=g)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){function e(e,n){return a.type="throw",a.arg=t,i.next=e,n&&(i.method="next",i.arg=g),!!n}if(this.done)throw t;for(var i=this,n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n],a=r.completion;if("root"===r.tryLoc)return e("end");if(r.tryLoc<=this.prev){var o=y.call(r,"catchLoc"),s=y.call(r,"finallyLoc");if(o&&s){if(this.prev<r.catchLoc)return e(r.catchLoc,!0);if(this.prev<r.finallyLoc)return e(r.finallyLoc)}else if(o){if(this.prev<r.catchLoc)return e(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return e(r.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&y.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=t,a.arg=e,r?(this.method="next",this.next=r.finallyLoc,E):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),E},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),p(i),E}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;p(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:f(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=g),E}}}("object"==typeof e?e:"object"==typeof window?window:"object"==typeof self?self:this)}).call(e,i(56))},function(t,e,i){i(341),t.exports=i(24).RegExp.escape},function(t,e,i){var n=i(0),r=i(342)(/[\\^$*+?.()|[\]{}]/g,"\\$&");n(n.S,"RegExp",{escape:function(t){return r(t)}})},function(t,e){t.exports=function(t,e){var i=e===Object(e)?function(t){return e[t]}:e;return function(e){return String(e).replace(t,i)}}},function(t,e,i){"use strict";function n(){return v()(window).width()>700?(v()("body").removeClass("break-md break-sm").addClass("break-lg"),v()(".icon-toggles").removeClass("sidenav active").addClass("ciq-toggles"),L.layout.sidenav="sidenavOff",void v()("#symbol").attr("placeholder","Enter Symbol")):v()(window).width()<=700&&v()(window).width()>584?(v()("body").removeClass("break-lg break-sm").addClass("break-md"),v()(".icon-toggles").removeClass("sidenav active").addClass("ciq-toggles"),L.layout.sidenav="sidenavOff",void v()("#symbol").attr("placeholder","Symbol")):void(v()(window).width()<=584&&(v()("body").removeClass("break-md break-lg").addClass("break-sm"),v()(".icon-toggles").removeClass("ciq-toggles").addClass("sidenav"),v()("#symbol").attr("placeholder","")))}function r(){var t=v()(window).height(),e=v()(".ciq-chart").height();v()("body").hasClass("toolbar-on")?v()("#chartContainer").height(e-45):v()("#chartContainer").height(e),v()("#maxHeightCSS").remove(),v()("head").append('<style id="maxHeightCSS">cq-dialog { max-height: '+t+"px }</style>")}function a(){if(A){n(),r();var t=v()("cq-side-panel")[0];t&&(v()(".ciq-chart-area").css({right:t.nonAnimatedWidth()+"px"}),v()("cq-tradingcentral").css({"margin-right":t.nonAnimatedWidth()+15+"px"})),L.resizeChart(),L.slider&&L.slider.display(L.layout.rangeSlider)}}function o(t,e){var i=S.CIQ.localStorage.getItem(e);if(null!==i){var n=JSON.parse(i);n&&(t.importDrawings(n),t.draw())}}function s(t,e){function i(){o(t,t.chart.symbol),e&&e()}var n=S.CIQ.localStorage.getItem("myChartLayout");null!==n&&t.importLayout(JSON.parse(n),{managePeriodicity:!0,cb:i})}function l(t){var e=JSON.stringify(t.stx.exportLayout(!0));S.CIQ.localStorageSetItem("myChartLayout",e)}function h(t){var e=t.stx.exportDrawings();0===e.length?S.CIQ.localStorage.removeItem(t.symbol):S.CIQ.localStorageSetItem(t.symbol,JSON.stringify(e))}function c(){var t=S.CIQ.localStorage.getItem("myChartPreferences");t&&L.importPreferences(JSON.parse(t))}function u(){S.CIQ.localStorageSetItem("myChartPreferences",JSON.stringify(L.exportPreferences()))}function p(){v()(".stx-markers .ciq-radio.ciq-active").parent().triggerHandler("stxtap")}function d(){var t=v()("cq-context,[cq-context]");A=new S.CIQ.UI.Context(L,t),new S.CIQ.UI.Layout(A);var e=new S.CIQ.UI.HeadsUp(v()("cq-hu-dynamic"),A,{followMouse:!0,autoStart:!1}),i=new S.CIQ.UI.HeadsUp(v()("cq-hu-static"),A,{autoStart:!0});A.changeSymbol=function(t){var e=this.stx;this.loader&&this.loader.show(),t.symbol=t.symbol.toUpperCase();for(var i in e.chart.series)"study"!==L.chart.series[i].parameters.bucket&&e.removeSeries(i);var n=this;e.newChart(t,null,null,function(t){if(t)return void(n.loader&&n.loader.hide());e.tfc&&e.tfc.changeSymbol(),n.loader&&n.loader.hide(),o(e,e.chart.symbol)})},A.setLookupDriver(new x.a),A.UISymbolLookup=v()(".ciq-search cq-lookup")[0],A.UISymbolLookup.setCallback(function(t,e){t.changeSymbol(e)}),new S.CIQ.UI.KeystrokeHub(Object(S.$$$)("body"),A,{cb:S.CIQ.UI.KeystrokeHub.defaultHotKeys}),new S.CIQ.UI.StudyEdit(null,A);var n=new S.CIQ.NameValueStore;v()("cq-themes")[0].initialize({builtInThemes:{"ciq-day":"Day","ciq-night":"Night"},defaultTheme:"ciq-night",nameValueStore:n});var l=v()("cq-side-panel")[0];l&&l.registerCallback(a),v()(".ciq-sidenav")[0].registerCallback(function(t){var e=this.context.stx,i=void 0,n=l?l.nonAnimatedWidth():0;if("sidenavOn"===t){var r=v()(".stx-holder").height();v()(".sidenav").height(r),this.node.addClass("active"),e.layout.sidenav="sidenavOn",v()(".sidenav").addClass("active"),i=this.node.width()+n}else"sidenavOff"===t&&(i=n,v()(".sidenav").removeClass("active"),this.node.removeClass("active"),e.layout.sidenav="sidenavOff");v()("cq-side-panel").css("right",i-n+"px"),v()(".ciq-chart-area").css({right:i+"px"}),v()("cq-tradingcentral").css({"margin-right":i+15+"px"}),e.slider&&e.slider.display(e.layout.rangeSlider)}),v()(".ciq-HU")[0].registerCallback(function(t){"static"===t?(e.end(),i.begin(),this.node.addClass("active")):"dynamic"===t?S.CIQ.isMobile?(this.set("static"),e.end(),i.begin(),this.node.addClass("active")):(i.end(),e.begin(),this.node.addClass("active")):(i.end(),e.end(),this.node.removeClass("active"))}),v()(".ciq-draw")[0].registerCallback(function(t){t?(this.node.addClass("active"),v()("body").addClass("toolbar-on")):(this.node.removeClass("active"),v()("body").removeClass("toolbar-on")),r();var e=this.context.stx;e.resizeChart(),t?e.changeVectorType(this.priorVectorType):(this.priorVectorType=e.currentVectorParameters.vectorType,e.changeVectorType(""))}),v()(".stx-trade")[0]&&v()(".stx-trade")[0].registerCallback(function(t){var e=v()("cq-side-panel")[0];t?(e.open({selector:".stx-trade-panel",className:"active"}),this.node.addClass("active"),v()(".stx-trade-panel").removeClass("closed"),L.layout.sidenav="sidenavOff"):(e.close(),this.node.removeClass("active"),v()(".stx-trade-panel").addClass("closed"))}),v()(".stx-tradingcentral")[0]&&v()(".stx-tradingcentral")[0].registerCallback(function(t){var e=v()("cq-tradingcentral")[0];t?e.removeAttribute("disabled"):e.setAttribute("disabled","disabled")}),v()("cq-redo")[0].pairUp(v()("cq-undo"));var h={excludedStudies:{Directional:!0,Gopala:!0,vchart:!0},alwaysDisplayDialog:{ma:!0}};new S.CIQ.UI.StudyMenu(v()("*[cq-studies]"),A,h).renderMenu(),v()("cq-views").each(function(){this.initialize()}),A.loader&&A.loader.show(),c(),s(L,function(){A.loader&&A.loader.hide()}),L.chart.symbol||A.UISymbolLookup.selectItem({symbol:"R_100"}),S.CIQ.UI.begin()}function f(){S.CIQ.Marker.removeByLabel(L,"circle"),S.CIQ.Marker.removeByLabel(L,"square"),S.CIQ.Marker.removeByLabel(L,"callout"),S.CIQ.Marker.removeByLabel(L,"helicopter")}function m(t){f();for(var e=L.masterData.length,i=[{x:L.masterData[e-5].DT,type:t,category:"news",headline:"This is a Marker for a News Item"},{x:L.masterData[e-15].DT,type:t,category:"earningsUp",headline:"This is a Marker for Earnings (+)"},{x:L.masterData[e-25].DT,type:t,category:"earningsDown",headline:"This is a Marker for Earnings (-)"},{x:L.masterData[e-35].DT,type:t,category:"dividend",headline:"This is a Marker for Dividends"},{x:L.masterData[e-45].DT,type:t,category:"filing",headline:"This is a Marker for a Filing"},{x:L.masterData[e-55].DT,type:t,category:"split",headline:"This is a Marker for a Split"}],n=0;n<i.length;n++){var r=i[n];r.story="Like all ChartIQ markers, the object itself is managed by the chart, so when you scroll the chart the object moves with you. It is also destroyed automatically for you when the symbol is changed.";var a={stx:L,label:t,xPositioner:"date",x:r.x,node:new S.CIQ.Marker.Simple(r)};new S.CIQ.Marker(a)}L.draw()}Object.defineProperty(e,"__esModule",{value:!0});var g=i(2),v=i.n(g),y=i(344),b=i(346),x=i(347),w=i(349),C=(i.n(w),i(136)),S=(i.n(C),i(1)),T=(i.n(S),i(350)),_=(i.n(T),i(351)),k=(i.n(_),i(352)),D=(i.n(k),i(353)),M=(i.n(D),i(354)),E=(i.n(M),i(355),i(367),i(368),i(369),i(370),i(371),i(374),i(375),i(376),i(377),i(378),i(379),i(380),i(381),i(382),i(139),i(383),i(384),i(385),i(386),i(387),i(388),i(389),i(390),i(391),i(392),i(393),i(394),i(395),i(396),i(397),i(398),i(399),i(400),i(401),i(402),i(403));window.Line=E.a,window.CIQ=S.CIQ;var A=void 0,P=y.a.buildFor({appId:1,language:"en",endpoint:"wss://frontend.binaryws.com/websockets/v3"}),L=new S.CIQ.ChartEngine({container:Object(S.$$$)("#chartContainer")});L.attachQuoteFeed(new b.a(P,L),{refreshInterval:null}),L.setMarketFactory(S.CIQ.Market.Symbology.factory),new S.CIQ.ExtendedHours({stx:L,filter:!0}),new S.CIQ.InactivityTimer({stx:L,minutes:30}),L.callbacks.layout=l,L.callbacks.symbolChange=l,L.callbacks.drawing=h,L.callbacks.newChart=p,L.callbacks.preferences=u,new S.CIQ.RangeSlider({stx:L}),"registerElement"in document&&"import"in document.createElement("link")&&"content"in document.createElement("template")?(d(),a()):window.addEventListener("WebComponentsReady",function(){d(),a()}),v()(".stx-markers cq-item.circle").stxtap(function(){v()(".stx-markers .ciq-radio").removeClass("ciq-active"),v()(".stx-markers cq-item.circle .ciq-radio").addClass("ciq-active"),m("circle")}),v()(".stx-markers cq-item.square").stxtap(function(){v()(".stx-markers .ciq-radio").removeClass("ciq-active"),v()(".stx-markers cq-item.square .ciq-radio").addClass("ciq-active"),m("square")}),v()(".stx-markers cq-item.callout").stxtap(function(){v()(".stx-markers .ciq-radio").removeClass("ciq-active"),v()(".stx-markers cq-item.callout .ciq-radio").addClass("ciq-active"),m("callout")}),v()(".stx-markers cq-item.abstract").stxtap(function(){v()(".stx-markers .ciq-radio").removeClass("ciq-active"),v()(".stx-markers cq-item.abstract .ciq-radio").addClass("ciq-active"),f();var t=v()(".stx-marker.abstract").clone();t.css({"z-index":"30",left:(.4*L.chart.width).toString()+"px"}),new S.CIQ.Marker({stx:L,xPositioner:"none",yPositioner:"above_candle",label:"helicopter",permanent:!0,chartContainer:!0,node:t[0]}),L.draw()}),v()(".stx-markers cq-item.none").stxtap(function(){v()(".stx-markers .ciq-radio").removeClass("ciq-active"),v()(".stx-markers cq-item.none .ciq-radio").addClass("ciq-active"),f()}),"undefined"==typeof Promise&&S.CIQ.loadScript("js/thirdparty/promise.min.js"),v()(window).resize(a)},function(t,e,i){"use strict";function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=i(135),l=i.n(s),h=i(345),c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=function(){function t(e,i){var n=e.symbol,r=e.granularity,a=i.connection,s=i.response,l=void 0===s?null:s;o(this,t),this._connection=a,this._symbol=n,this._granularity=r,this._response=l,this._isMarketClosed=!1}return c(t,null,[{key:"DEFAULT_COUNT",get:function(){return 5}},{key:"DEFAULT_TIMEOUT",get:function(){return 2e4}}]),c(t,[{key:"subscribe",value:function(){var e=this,i={ticks_history:this._symbol,end:"latest",count:t.DEFAULT_COUNT,adjust_start_time:1,subscribe:1,style:this._granularity?"candles":"ticks",granularity:this._granularity};this._response=this._connection.send(i,t.DEFAULT_TIMEOUT).catch(function(n){if(/^(MarketIsClosed|NoRealtimeQuotes)$/.test(n.code))return e._isMarketClosed=!0,delete i.subscribe,e._connection.send(i,t.DEFAULT_TIMEOUT);throw n})}},{key:"response",get:function(){return this._response}},{key:"isMarketClosed",get:function(){return this._isMarketClosed}}],[{key:"cloneResponseData",value:function(t){var e={echo_req:Object.assign({},t.echo_req)};if(t.history){var i=t.history.prices.slice(0),n=t.history.times.slice(0);e.history={prices:i,times:n}}else t.candles&&(e.candles=t.candles.slice(0));return e}},{key:"diffResponseData",value:function(t,e){var i={echo_req:Object.assign({},e.echo_req)};if(t.history&&e.history){var n=t.history.times[t.history.times.length-1],r=e.history.times.indexOf(n);i.history={times:[],prices:[]},-1!==r&&(i.history.times=e.history.times.slice(r+1),i.history.prices=e.history.prices.slice(r+1))}if(t.candles&&e.candles){var a=t.candles[t.candles.length-1].epoch,o=function(t,e){for(var i=0;i<t.length;++i)if(e(t[i]))return i;return-1}(e.candles,function(t){return t.epoch===a});i.candles=[],-1!==o&&(i.candles=e.candles.slice(o))}return i}}]),t}(),p=function(t){function e(t,i){var a;o(this,e);var s=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return s._subscription=t,s._emitter=i,s._callbacks=(a={},n(a,e.EVENT_STREAM,[]),n(a,e.EVENT_RECONNECT,[]),n(a,e.EVENT_DISCONNECT,[]),a),s._emitter.emit(e.EVENT_REMEMBER_STREAM),s}return a(e,t),c(e,null,[{key:"EVENT_STREAM",get:function(){return"EVENT_STREAM"}},{key:"EVENT_DISCONNECT",get:function(){return"EVENT_DISCONNECT"}},{key:"EVENT_RECONNECT",get:function(){return"EVENT_RECONNECT"}},{key:"EVENT_REMEMBER_STREAM",get:function(){return"EVENT_REMEMBER_STREAM"}},{key:"EVENT_FORGET_STREAM",get:function(){return"EVENT_FORGET_STREAM"}}]),c(e,[{key:"forget",value:function(){var t=!0,i=!1,n=void 0;try{for(var r,a=Object.keys(this._callbacks)[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value,s=!0,l=!1,h=void 0;try{for(var c,u=this._callbacks[o][Symbol.iterator]();!(s=(c=u.next()).done);s=!0){var p=c.value;this._emitter.off(o,p)}}catch(t){l=!0,h=t}finally{try{!s&&u.return&&u.return()}finally{if(l)throw h}}this._callbacks[o]=[]}}catch(t){i=!0,n=t}finally{try{!t&&a.return&&a.return()}finally{if(i)throw n}}this._emitter.emit(e.EVENT_FORGET_STREAM)}},{key:"onStream",value:function(t){this._callbacks[e.EVENT_STREAM].push(t),this._emitter.on(e.EVENT_STREAM,t)}},{key:"onDisconnect",value:function(t){this._callbacks[e.EVENT_DISCONNECT].push(t),this._emitter.on(e.EVENT_DISCONNECT,t)}},{key:"onReconnect",value:function(t){this._callbacks[e.EVENT_RECONNECT].push(t),this._emitter.on(e.EVENT_RECONNECT,t)}},{key:"response",get:function(){return this._subscription.response}},{key:"isMarketClosed",get:function(){return this._subscription.isMarketClosed}}]),e}(l.a),d=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;o(this,t),this._connection=e,this._defaultCount=i,this._emitters={},this._streamIds={},this._subscriptionData={},this._initialize()}return c(t,[{key:"_initialize",value:function(){for(var t=this,e=[h.a.MSG_TICK,h.a.MSG_OHLC],i=0;i<e.length;i++){var n=e[i];!function(e){t._connection.on(e,function(i){var n=i.echo_req,r=n.ticks_history,a=n.granularity,o=r+"-"+a;t._emitters[o]?(t._streamIds[o]=i[e].id,t._emitters[o].emit(p.EVENT_STREAM,i)):console.error("LEAKING STREAM ON "+e+" => symbol: "+r+", granularity: "+a)})}(n)}this._connection.on(h.a.EVENT_CONNECTION_CLOSE,function(){t._streamIds={};var e=!0,i=!1,n=void 0;try{for(var r,a=Object.keys(t._emitters)[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var o=r.value;t._emitters[o].emit(p.EVENT_DISCONNECT)}}catch(t){i=!0,n=t}finally{try{!e&&a.return&&a.return()}finally{if(i)throw n}}}),this._connection.on(h.a.EVENT_CONNECTION_REOPEN,function(){var e=!0,i=!1,n=void 0;try{for(var r,a=Object.keys(t._subscriptionData)[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var o=r.value,s=t._subscriptionData[o],l=s.echo_req,h=l.ticks_history,c=l.granularity,p=new u({symbol:h,granularity:c},{connection:t._connection});p.subscribe(),t._trackSubscription(p)}}catch(t){i=!0,n=t}finally{try{!e&&a.return&&a.return()}finally{if(i)throw n}}})}},{key:"_trackSubscription",value:function(t){var e=this;t.response.then(function(t){var i=t.echo_req,n=i.ticks_history,r=i.granularity,a=n+"-"+r;if(e._subscriptionData[a]&&e._emitters[a]){var o=u.diffResponseData(e._subscriptionData[a],t);e._emitters[a].emit(p.EVENT_RECONNECT,o)}e._subscriptionData[a]=u.cloneResponseData(t)})}},{key:"_trackStream",value:function(t){var e=this;t.onStream(function(t){var i=t.echo_req,n=t.ohlc,r=t.tick,a=i.ticks_history,o=i.granularity,s=a+"-"+o;if(n){var l=e._subscriptionData[s].candles,h=n.close,c=n.open_time,u=n.high,p=n.low,d=n.open,f={close:h,high:u,low:p,open:d,epoch:c};+l[l.length-1].epoch==+f.epoch?l[l.length-1]=f:(l.push(f),l.shift())}else if(r){var m=e._subscriptionData[s].history,g=m.prices,v=m.times,y=r.quote,b=r.epoch;g.push(y),g.shift(),v.push(b),v.shift()}})}},{key:"_forgetStream",value:function(t){if(this._clearEmitter(t),this._streamIds[t]){var e=this._streamIds[t];delete this._streamIds[t],this._connection.send({forget:e})}this._subscriptionData[t]&&delete this._subscriptionData[t]}},{key:"_clearEmitter",value:function(t){this._emitters[t]&&(this._emitters[t].off(p.EVENT_REMEMBER_STREAM),this._emitters[t].off(p.EVENT_FORGET_STREAM),delete this._emitters[t])}},{key:"_setupEmitter",value:function(t,e){var i=this,n=new l.a;this._emitters[t]=n,e.response.then(function(){e.isMarketClosed&&i._clearEmitter(t)}),e.response.catch(function(){return i._clearEmitter(t)});var r=0;return n.on(p.EVENT_REMEMBER_STREAM,function(){++r}),n.on(p.EVENT_FORGET_STREAM,function(){0===--r&&i._forgetStream(t)}),n}},{key:"_handleNewStream",value:function(t){var e=t.symbol,i=t.granularity,n=e+"-"+i,r=new u({symbol:e,granularity:i},{connection:this._connection});r.subscribe(),this._trackSubscription(r);var a=this._setupEmitter(n,r),o=new p(r,a);return this._trackStream(o),o}},{key:"_handleExistingStream",value:function(t){var e=this,i=t.symbol,n=t.granularity,r=i+"-"+n,a=new Promise(function(t,i){var n=e._subscriptionData[r];n?t(u.cloneResponseData(n)):i(new Error("No existing stream"))}),o=new u({symbol:i,granularity:n},{response:a,connection:this._connection}),s=this._emitters[r];return new p(o,s)}},{key:"subscribe",value:function(t){var e=t.symbol,i=t.granularity,n=void 0===i?0:i,r=e+"-"+n;return this._emitters[r]?this._handleExistingStream({symbol:e,granularity:n}):this._handleNewStream({symbol:e,granularity:n})}},{key:"historicalData",value:function(t){var e=t.symbol,i=t.granularity,n=t.start,r=t.end,a={ticks_history:e,end:r,start:n,adjust_start_time:1,granularity:i,style:i?"candles":"ticks"};return this._connection.send(a)}}],[{key:"buildFor",value:function(e){var i=e.appId,n=e.endpoint,r=e.language,a=void 0===r?"en":r;return new t(new h.a({appId:i,endpoint:n,language:a}))}}]),t}();e.a=d},function(t,e,i){"use strict";function n(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){function n(r,a){try{var o=e[r](a),s=o.value}catch(t){return void i(t)}if(!o.done)return Promise.resolve(s).then(function(t){n("next",t)},function(t){n("throw",t)});t(s)}return n("next")})}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=void 0,i=void 0,n=new Promise(function(t,n){e=t,i=n});return n.resolve=function(t){n.isPending=!1,e(t)},n.reject=function(t){n.isPending=!1,i(t)},n.data=t,n}var l=i(135),h=i.n(l),c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=function(t){function e(t){var i=t.appId,n=t.endpoint,o=t.language;r(this,e);var s=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return s._url=n+"?l="+o+"&app_id="+i,s._counterReqId=1,s._initialize(),s._pendingRequests={},s._autoReconnect=!0,s}return o(e,t),c(e,null,[{key:"MSG_TICK_HISTORY",get:function(){return"tick_history"}},{key:"MSG_TICK",get:function(){return"tick"}},{key:"MSG_OHLC",get:function(){return"ohlc"}},{key:"EVENT_CONNECTION_CLOSE",get:function(){return"CONNECTION_CLOSE"}},{key:"EVENT_CONNECTION_REOPEN",get:function(){return"CONNECTION_REOPEN"}}]),c(e,[{key:"_initialize",value:function(){this._websocket=new WebSocket(this._url),window.ws=this._websocket,this._websocket.addEventListener("open",this._onopen.bind(this)),this._websocket.addEventListener("close",this._onclose.bind(this)),this._websocket.addEventListener("error",this._onclose.bind(this)),this._websocket.addEventListener("message",this._onmessage.bind(this)),this._connectionOpened=s()}},{key:"_onopen",value:function(){this._connectionOpened.resolve()}},{key:"_onclose",value:function(){var t=this;this._connectionOpened.isPending&&this._connectionOpened.reject("Connection Error"),Object.keys(this._pendingRequests).forEach(function(e){return t._pendingRequests[e].reject("Connection Error")}),this._pendingRequests={},this._autoReconnect&&(this._initialize(),this._connectionOpened.then(function(){t.emit(e.EVENT_CONNECTION_REOPEN)})),this.emit(e.EVENT_CONNECTION_CLOSE)}},{key:"_onmessage",value:function(t){var e=JSON.parse(t.data),i=e.req_id,n=e.msg_type;this._pendingRequests[i]&&(this._pendingRequests[i].resolve(e),delete this._pendingRequests[i]),this.emit(n,e)}},{key:"_assertConnected",value:function(){var t=this;["CONNECTING","CLOSING","CLOSED"].forEach(function(e){if(t._websocket.readyState===WebSocket[e])throw new Error("Websocket is "+e)})}},{key:"_timeoutRequest",value:function(t,e){var i=this;setTimeout(function(){i._pendingRequests[t]&&i._pendingRequests[t].isPending&&(i._pendingRequests[t].reject(new Error("Request Timeout")),delete i._pendingRequests[t])},e)}},{key:"send",value:function(){function t(t,i){return e.apply(this,arguments)}var e=n(regeneratorRuntime.mark(function t(e,i){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Object.assign({},e),n.req_id=this._counterReqId++,t.next=4,this._connectionOpened;case 4:return this._assertConnected(),this._websocket.send(JSON.stringify(n)),this._pendingRequests[n.req_id]=s(n),i&&this._timeoutRequest(n.req_id,i),t.abrupt("return",this._pendingRequests[n.req_id]);case 9:case"end":return t.stop()}},t,this)}));return t}()},{key:"destroy",value:function(){this._autoReconnect=0,this._websocket.close()}}]),e}(h.a);e.a=u},function(t,e,i){"use strict";function n(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){function n(r,a){try{var o=e[r](a),s=o.value}catch(t){return void i(t)}if(!o.done)return Promise.resolve(s).then(function(t){n("next",t)},function(t){n("throw",t)});t(s)}return n("next")})}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=function(){function t(e,i){r(this,t),this._cxx=i,this._streamManager=e,this._streams=[]}return a(t,[{key:"unsubscribe",value:function(){this._streams.forEach(function(t){return t.forget()}),this._streams=[]}},{key:"_trackStream",value:function(t){var e=this;t.onStream(function(t){var i=t.tick,n=t.ohlc,r=n?[{DT:new Date(1e3*+n.open_time),Open:+n.open,High:+n.high,Low:+n.low,Close:+n.close}]:[{DT:new Date(1e3*+i.epoch),Close:+i.quote}];e._cxx.appendMasterData(r)})}},{key:"fetchInitialData",value:function(){function e(t,e,n,r,a){return i.apply(this,arguments)}var i=n(regeneratorRuntime.mark(function e(i,n,r,a,o){var s,l,h,c,u,p,d,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=a.period,l=a.interval,h=this._streamManager.subscribe({symbol:i,granularity:t.calculateGranularity(s,l)}),this._streams.forEach(function(t){return t.forget()}),this._streams=[h],this._trackStream(h),e.prev=5,e.next=8,h.response;case 8:c=e.sent,u=c.candles,p=c.history,d=u?t.formatCandles(u):t.formatHistory(p),f={message:h.isMarketClosed?"Market is presently closed":""},o({quotes:d,attribution:f}),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(5),console.error(e.t0),o({error:e.t0});case 20:case"end":return e.stop()}},e,this,[[5,16]])}));return e}()},{key:"fetchPaginationData",value:function(){function e(t,e,n,r,a){return i.apply(this,arguments)}var i=n(regeneratorRuntime.mark(function e(i,n,r,a,o){var s,l,h,c,u,p,d,f,m,g;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=n.getTime()/1e3,l=r.getTime()/1e3,h=(new Date).getTime()/1e3|0,c=h-2.8*365*24*60*60,u=a.period,p=a.interval,d={quotes:[]},!(l>c)){e.next=20;break}return e.prev=7,e.next=10,this._streamManager.historicalData({symbol:i,granularity:t.calculateGranularity(u,p),start:Math.max(s,c),end:l});case 10:f=e.sent,m=f.candles,g=f.history,d.quotes=m?t.formatCandles(m):t.formatHistory(g),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(7),console.error(e.t0),d.quotes={error:e.t0};case 20:o(d);case 21:case"end":return e.stop()}},e,this,[[7,16]])}));return e}()}],[{key:"calculateGranularity",value:function(t,e){return{tick:0,minute:60,hour:3600,day:86400}[e]*t}},{key:"formatCandles",value:function(t){return t.map(function(t){return{DT:new Date(1e3*+t.epoch),Open:+t.open,High:+t.high,Low:+t.low,Close:+t.close}})}},{key:"formatHistory",value:function(t){var e=t.times;return t.prices.map(function(t,i){return{DT:1e3*+e[i],Close:+t}})}}]),t}();e.a=o},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(1),s=(i.n(o),i(348)),l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),h=function(t){function e(t){n(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.exchanges=t,i.exchanges||(i.exchanges=["XNYS","XASE","XNAS","XASX","INDCBSX","INDXASE","INDXNAS","IND_DJI","ARCX","INDARCX","forex"]),i.url="https://symbols.chartiq.com/chiq.symbolserver.SymbolLookup.service",i.requestCounter=0,i}return a(e,t),l(e,[{key:"acceptText",value:function(t,e,i,n){function r(t,e){if(!(s<l.requestCounter)&&200===t)try{e=JSON.parse(e);for(var i=e.payload.symbols,r=[],a=0;a<i.length;a++){var o=i[a].split("|"),h={symbol:o[0],name:o[1],exchDisp:o[2]};r.push({display:[h.symbol,h.name,h.exchDisp],data:h})}n(r)}catch(t){}}"FX"===e&&(e="FOREX"),isNaN(parseInt(i,10))&&(i=100);var a=this.url+"?t="+encodeURIComponent(t)+"&m="+i+"&x=[";this.exchanges&&(a+=this.exchanges.join(",")),a+="]",e&&"ALL"!==e.toUpperCase()&&(a+="&e="+e);var s=++this.requestCounter,l=this;o.CIQ.postAjax({url:a,cb:r})}}]),e}(s.a);e.a=h},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function(){function t(){n(this,t)}return r(t,[{key:"acceptText",value:function(){this.cb}}]),t}();e.a=a},function(t,e,i){(function(i){var n,n,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(n){if("object"==r(e)&&void 0!==t)t.exports=n();else if("function"==typeof define&&define.amd)define("html2canvas",n);else{var a;"undefined"!=typeof window?a=window:void 0!==i?a=i:"undefined"!=typeof self&&(a=self),a.html2canvas=n()}}(function(){var t;return function t(e,i,r){function a(s,l){if(!i[s]){if(!e[s]){var h="function"==typeof n&&n;if(!l&&h)return n(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[s]={exports:{}};e[s][0].call(u.exports,function(t){var i=e[s][1][t];return a(i||t)},u,u.exports,t,e,i,r)}return i[s].exports}for(var o="function"==typeof n&&n,s=0;s<r.length;s++)a(r[s]);return a}({1:[function(e,n,a){(function(e){!function(i){function o(t){throw RangeError(I[t])}function s(t,e){for(var i=t.length;i--;)t[i]=e(t[i]);return t}function l(t,e){return s(t.split(F),e).join(".")}function h(t){for(var e,i,n=[],r=0,a=t.length;r<a;)e=t.charCodeAt(r++),e>=55296&&e<=56319&&r<a?(i=t.charCodeAt(r++),56320==(64512&i)?n.push(((1023&e)<<10)+(1023&i)+65536):(n.push(e),r--)):n.push(e);return n}function c(t){return s(t,function(t){var e="";return t>65535&&(t-=65536,e+=R(t>>>10&1023|55296),t=56320|1023&t),e+=R(t)}).join("")}function u(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:T}function p(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function d(t,e,i){var n=0;for(t=i?N(t/M):t>>1,t+=N(t/e);t>j*k>>1;n+=T)t=N(t/j);return N(n+(j+1)*t/(t+D))}function f(t){var e,i,n,r,a,s,l,h,p,f,m=[],g=t.length,v=0,y=A,b=E;for(i=t.lastIndexOf(P),i<0&&(i=0),n=0;n<i;++n)t.charCodeAt(n)>=128&&o("not-basic"),m.push(t.charCodeAt(n));for(r=i>0?i+1:0;r<g;){for(a=v,s=1,l=T;r>=g&&o("invalid-input"),h=u(t.charCodeAt(r++)),(h>=T||h>N((S-v)/s))&&o("overflow"),v+=h*s,p=l<=b?_:l>=b+k?k:l-b,!(h<p);l+=T)f=T-p,s>N(S/f)&&o("overflow"),s*=f;e=m.length+1,b=d(v-a,e,0==a),N(v/e)>S-y&&o("overflow"),y+=N(v/e),v%=e,m.splice(v++,0,y)}return c(m)}function m(t){var e,i,n,r,a,s,l,c,u,f,m,g,v,y,b,x=[];for(t=h(t),g=t.length,e=A,i=0,a=E,s=0;s<g;++s)(m=t[s])<128&&x.push(R(m));for(n=r=x.length,r&&x.push(P);n<g;){for(l=S,s=0;s<g;++s)(m=t[s])>=e&&m<l&&(l=m);for(v=n+1,l-e>N((S-i)/v)&&o("overflow"),i+=(l-e)*v,e=l,s=0;s<g;++s)if(m=t[s],m<e&&++i>S&&o("overflow"),m==e){for(c=i,u=T;f=u<=a?_:u>=a+k?k:u-a,!(c<f);u+=T)b=c-f,y=T-f,x.push(R(p(f+b%y,0))),c=N(b/y);x.push(R(p(c,0))),a=d(i,v,n==r),i=0,++n}++i,++e}return x.join("")}function g(t){return l(t,function(t){return L.test(t)?f(t.slice(4).toLowerCase()):t})}function v(t){return l(t,function(t){return O.test(t)?"xn--"+m(t):t})}var y="object"==(void 0===a?"undefined":r(a))&&a,b="object"==(void 0===n?"undefined":r(n))&&n&&n.exports==y&&n,x="object"==(void 0===e?"undefined":r(e))&&e;x.global!==x&&x.window!==x||(i=x);var w,C,S=2147483647,T=36,_=1,k=26,D=38,M=700,E=72,A=128,P="-",L=/^xn--/,O=/[^ -~]/,F=/\x2E|\u3002|\uFF0E|\uFF61/g,I={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},j=T-_,N=Math.floor,R=String.fromCharCode;if(w={version:"1.2.4",ucs2:{decode:h,encode:c},decode:f,encode:m,toASCII:v,toUnicode:g},"function"==typeof t&&"object"==r(t.amd)&&t.amd)t("punycode",function(){return w});else if(y&&!y.nodeType)if(b)b.exports=w;else for(C in w)w.hasOwnProperty(C)&&(y[C]=w[C]);else i.punycode=w}(this)}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,i){function n(t,e,i){!t.defaultView||e===t.defaultView.pageXOffset&&i===t.defaultView.pageYOffset||t.defaultView.scrollTo(e,i)}function r(t,e){try{e&&(e.width=t.width,e.height=t.height,e.getContext("2d").putImageData(t.getContext("2d").getImageData(0,0,t.width,t.height),0,0))}catch(e){s("Unable to copy canvas content from",t,e)}}function a(t,e){for(var i=3===t.nodeType?document.createTextNode(t.nodeValue):t.cloneNode(!1),n=t.firstChild;n;)!0!==e&&1===n.nodeType&&"SCRIPT"===n.nodeName||i.appendChild(a(n,e)),n=n.nextSibling;return 1===t.nodeType&&(i._scrollTop=t.scrollTop,i._scrollLeft=t.scrollLeft,"CANVAS"===t.nodeName?r(t,i):"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||(i.value=t.value)),i}function o(t){if(1===t.nodeType){t.scrollTop=t._scrollTop,t.scrollLeft=t._scrollLeft;for(var e=t.firstChild;e;)o(e),e=e.nextSibling}}var s=t("./log");e.exports=function(t,e,i,r,s,l,h){var c=a(t.documentElement,s.javascriptEnabled),u=e.createElement("iframe");return u.className="html2canvas-container",u.style.visibility="hidden",u.style.position="fixed",u.style.left="-10000px",u.style.top="0px",u.style.border="0",u.width=i,u.height=r,u.scrolling="no",e.body.appendChild(u),new Promise(function(e){var i=u.contentWindow.document;u.contentWindow.onload=u.onload=function(){var t=setInterval(function(){i.body.childNodes.length>0&&(o(i.documentElement),clearInterval(t),"view"===s.type&&(u.contentWindow.scrollTo(l,h),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||u.contentWindow.scrollY===h&&u.contentWindow.scrollX===l||(i.documentElement.style.top=-h+"px",i.documentElement.style.left=-l+"px",i.documentElement.style.position="absolute")),e(u))},50)},i.open(),i.write("<!DOCTYPE html><html></html>"),n(t,l,h),i.replaceChild(i.adoptNode(c,!0),i.documentElement),i.close()})}},{"./log":13}],3:[function(t,e,i){function n(t){this.r=0,this.g=0,this.b=0,this.a=null;this.fromArray(t)||this.namedColor(t)||this.rgb(t)||this.rgba(t)||this.hex6(t)||this.hex3(t)}n.prototype.darken=function(t){var e=1-t;return new n([Math.round(this.r*e),Math.round(this.g*e),Math.round(this.b*e),this.a])},n.prototype.isTransparent=function(){return 0===this.a},n.prototype.isBlack=function(){return 0===this.r&&0===this.g&&0===this.b},n.prototype.fromArray=function(t){return Array.isArray(t)&&(this.r=Math.min(t[0],255),this.g=Math.min(t[1],255),this.b=Math.min(t[2],255),t.length>3&&(this.a=t[3])),Array.isArray(t)};var r=/^#([a-f0-9]{3})$/i;n.prototype.hex3=function(t){var e=null;return null!==(e=t.match(r))&&(this.r=parseInt(e[1][0]+e[1][0],16),this.g=parseInt(e[1][1]+e[1][1],16),this.b=parseInt(e[1][2]+e[1][2],16)),null!==e};var a=/^#([a-f0-9]{6})$/i;n.prototype.hex6=function(t){var e=null;return null!==(e=t.match(a))&&(this.r=parseInt(e[1].substring(0,2),16),this.g=parseInt(e[1].substring(2,4),16),this.b=parseInt(e[1].substring(4,6),16)),null!==e};var o=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/;n.prototype.rgb=function(t){var e=null;return null!==(e=t.match(o))&&(this.r=Number(e[1]),this.g=Number(e[2]),this.b=Number(e[3])),null!==e};var s=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/;n.prototype.rgba=function(t){var e=null;return null!==(e=t.match(s))&&(this.r=Number(e[1]),this.g=Number(e[2]),this.b=Number(e[3]),this.a=Number(e[4])),null!==e},n.prototype.toString=function(){return null!==this.a&&1!==this.a?"rgba("+[this.r,this.g,this.b,this.a].join(",")+")":"rgb("+[this.r,this.g,this.b].join(",")+")"},n.prototype.namedColor=function(t){t=t.toLowerCase();var e=l[t];if(e)this.r=e[0],this.g=e[1],this.b=e[2];else if("transparent"===t)return this.r=this.g=this.b=this.a=0,!0;return!!e},n.prototype.isColor=!0;var l={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};e.exports=n},{}],4:[function(e,i,n){function r(t,e){var i=S++;if(e=e||{},e.logging&&(v.options.logging=!0,v.options.start=Date.now()),e.async=void 0===e.async||e.async,e.allowTaint=void 0!==e.allowTaint&&e.allowTaint,e.removeContainer=void 0===e.removeContainer||e.removeContainer,e.javascriptEnabled=void 0!==e.javascriptEnabled&&e.javascriptEnabled,e.imageTimeout=void 0===e.imageTimeout?1e4:e.imageTimeout,e.renderer="function"==typeof e.renderer?e.renderer:d,e.strict=!!e.strict,"string"==typeof t){if("string"!=typeof e.proxy)return Promise.reject("Proxy must be used when rendering url");var n=null!=e.width?e.width:window.innerWidth,r=null!=e.height?e.height:window.innerHeight;return x(u(t),e.proxy,document,n,r,e).then(function(t){return o(t.contentWindow.document.documentElement,t,e,n,r)})}var s=(void 0===t?[document.documentElement]:t.length?t:[t])[0];return s.setAttribute(C+i,i),a(s.ownerDocument,e,s.ownerDocument.defaultView.innerWidth,s.ownerDocument.defaultView.innerHeight,i).then(function(t){return"function"==typeof e.onrendered&&(v("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas"),e.onrendered(t)),t})}function a(t,e,i,n,r){return b(t,t,i,n,e,t.defaultView.pageXOffset,t.defaultView.pageYOffset).then(function(a){v("Document cloned");var s=C+r,l="["+s+"='"+r+"']";t.querySelector(l).removeAttribute(s);var h=a.contentWindow,c=h.document.querySelector(l);return("function"==typeof e.onclone?Promise.resolve(e.onclone(h.document)):Promise.resolve(!0)).then(function(){return o(c,a,e,i,n)})})}function o(t,e,i,n,r){var a=e.contentWindow,o=new p(a.document),u=new f(i,o),d=w(t),g="view"===i.type?n:h(a.document),y="view"===i.type?r:c(a.document),b=new i.renderer(g,y,u,i,document);return new m(t,b,o,u,i).ready.then(function(){v("Finished rendering");var n;return n="view"===i.type?l(b.canvas,{width:b.canvas.width,height:b.canvas.height,top:0,left:0,x:0,y:0}):t===a.document.body||t===a.document.documentElement||null!=i.canvas?b.canvas:l(b.canvas,{width:null!=i.width?i.width:d.width,height:null!=i.height?i.height:d.height,top:d.top,left:d.left,x:0,y:0}),s(e,i),n})}function s(t,e){e.removeContainer&&(t.parentNode.removeChild(t),v("Cleaned up container"))}function l(t,e){var i=document.createElement("canvas"),n=Math.min(t.width-1,Math.max(0,e.left)),r=Math.min(t.width,Math.max(1,e.left+e.width)),a=Math.min(t.height-1,Math.max(0,e.top)),o=Math.min(t.height,Math.max(1,e.top+e.height));i.width=e.width,i.height=e.height;var s=r-n,l=o-a;return v("Cropping canvas at:","left:",e.left,"top:",e.top,"width:",s,"height:",l),v("Resulting crop with width",e.width,"and height",e.height,"with x",n,"and y",a),i.getContext("2d").drawImage(t,n,a,s,l,e.x,e.y,s,l),i}function h(t){return Math.max(Math.max(t.body.scrollWidth,t.documentElement.scrollWidth),Math.max(t.body.offsetWidth,t.documentElement.offsetWidth),Math.max(t.body.clientWidth,t.documentElement.clientWidth))}function c(t){return Math.max(Math.max(t.body.scrollHeight,t.documentElement.scrollHeight),Math.max(t.body.offsetHeight,t.documentElement.offsetHeight),Math.max(t.body.clientHeight,t.documentElement.clientHeight))}function u(t){var e=document.createElement("a");return e.href=t,e.href=e.href,e}var p=e("./support"),d=e("./renderers/canvas"),f=e("./imageloader"),m=e("./nodeparser"),g=e("./nodecontainer"),v=e("./log"),y=e("./utils"),b=e("./clone"),x=e("./proxy").loadUrlDocument,w=y.getBounds,C="data-html2canvas-node",S=0;r.CanvasRenderer=d,r.NodeContainer=g,r.log=v,r.utils=y;var T="undefined"==typeof document||"function"!=typeof Object.create||"function"!=typeof document.createElement("canvas").getContext?function(){return Promise.reject("No canvas support")}:r;i.exports=T,"function"==typeof t&&t.amd&&t("html2canvas",[],function(){return T})},{"./clone":2,"./imageloader":11,"./log":13,"./nodecontainer":14,"./nodeparser":15,"./proxy":16,"./renderers/canvas":20,"./support":22,"./utils":26}],5:[function(t,e,i){function n(t){if(this.src=t,r("DummyImageContainer for",t),!this.promise||!this.image){r("Initiating DummyImageContainer"),n.prototype.image=new Image;var e=this.image;n.prototype.promise=new Promise(function(t,i){e.onload=t,e.onerror=i,e.src=a(),!0===e.complete&&t(e)})}}var r=t("./log"),a=t("./utils").smallImage;e.exports=n},{"./log":13,"./utils":26}],6:[function(t,e,i){function n(t,e){var i,n,a=document.createElement("div"),o=document.createElement("img"),s=document.createElement("span");a.style.visibility="hidden",a.style.fontFamily=t,a.style.fontSize=e,a.style.margin=0,a.style.padding=0,document.body.appendChild(a),o.src=r(),o.width=1,o.height=1,o.style.margin=0,o.style.padding=0,o.style.verticalAlign="baseline",s.style.fontFamily=t,s.style.fontSize=e,s.style.margin=0,s.style.padding=0,s.appendChild(document.createTextNode("Hidden Text")),a.appendChild(s),a.appendChild(o),i=o.offsetTop-s.offsetTop+1,a.removeChild(s),a.appendChild(document.createTextNode("Hidden Text")),a.style.lineHeight="normal",o.style.verticalAlign="super",n=o.offsetTop-a.offsetTop+1,document.body.removeChild(a),this.baseline=i,this.lineWidth=1,this.middle=n}var r=t("./utils").smallImage;e.exports=n},{"./utils":26}],7:[function(t,e,i){function n(){this.data={}}var r=t("./font");n.prototype.getMetrics=function(t,e){return void 0===this.data[t+"-"+e]&&(this.data[t+"-"+e]=new r(t,e)),this.data[t+"-"+e]},e.exports=n},{"./font":6}],8:[function(t,e,i){function n(e,i,n){this.image=null,this.src=e;var r=this,o=a(e);this.promise=(i?new Promise(function(t){"about:blank"===e.contentWindow.document.URL||null==e.contentWindow.document.documentElement?e.contentWindow.onload=e.onload=function(){t(e)}:t(e)}):this.proxyLoad(n.proxy,o,n)).then(function(e){return t("./core")(e.contentWindow.document.documentElement,{type:"view",width:e.width,height:e.height,proxy:n.proxy,javascriptEnabled:n.javascriptEnabled,removeContainer:n.removeContainer,allowTaint:n.allowTaint,imageTimeout:n.imageTimeout/2})}).then(function(t){return r.image=t})}var r=t("./utils"),a=r.getBounds,o=t("./proxy").loadUrlDocument;n.prototype.proxyLoad=function(t,e,i){var n=this.src;return o(n.src,t,n.ownerDocument,e.width,e.height,i)},e.exports=n},{"./core":4,"./proxy":16,"./utils":26}],9:[function(t,e,i){function n(t){this.src=t.value,this.colorStops=[],this.type=null,this.x0=.5,this.y0=.5,this.x1=.5,this.y1=.5,this.promise=Promise.resolve(!0)}n.TYPES={LINEAR:1,RADIAL:2},n.REGEXP_COLORSTOP=/^\s*(rgba?\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}(?:,\s*[0-9\.]+)?\s*\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\s+(\d{1,3}(?:\.\d+)?)(%|px)?)?(?:\s|$)/i,e.exports=n},{}],10:[function(t,e,i){function n(t,e){this.src=t,this.image=new Image;var i=this;this.tainted=null,this.promise=new Promise(function(n,r){i.image.onload=n,i.image.onerror=r,e&&(i.image.crossOrigin="anonymous"),i.image.src=t,!0===i.image.complete&&n(i.image)})}e.exports=n},{}],11:[function(t,e,i){function n(t,e){this.link=null,this.options=t,this.support=e,this.origin=this.getOrigin(window.location.href)}var r=t("./log"),a=t("./imagecontainer"),o=t("./dummyimagecontainer"),s=t("./proxyimagecontainer"),l=t("./framecontainer"),h=t("./svgcontainer"),c=t("./svgnodecontainer"),u=t("./lineargradientcontainer"),p=t("./webkitgradientcontainer"),d=t("./utils").bind;n.prototype.findImages=function(t){var e=[];return t.reduce(function(t,e){switch(e.node.nodeName){case"IMG":return t.concat([{args:[e.node.src],method:"url"}]);case"svg":case"IFRAME":return t.concat([{args:[e.node],method:e.node.nodeName}])}return t},[]).forEach(this.addImage(e,this.loadImage),this),e},n.prototype.findBackgroundImage=function(t,e){return e.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(t,this.loadImage),this),t},n.prototype.addImage=function(t,e){return function(i){i.args.forEach(function(n){this.imageExists(t,n)||(t.splice(0,0,e.call(this,i)),r("Added image #"+t.length,"string"==typeof n?n.substring(0,100):n))},this)}},n.prototype.hasImageBackground=function(t){return"none"!==t.method},n.prototype.loadImage=function(t){if("url"===t.method){var e=t.args[0];return!this.isSVG(e)||this.support.svg||this.options.allowTaint?e.match(/data:image\/.*;base64,/i)?new a(e.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),!1):this.isSameOrigin(e)||!0===this.options.allowTaint||this.isSVG(e)?new a(e,!1):this.support.cors&&!this.options.allowTaint&&this.options.useCORS?new a(e,!0):this.options.proxy?new s(e,this.options.proxy):new o(e):new h(e)}return"linear-gradient"===t.method?new u(t):"gradient"===t.method?new p(t):"svg"===t.method?new c(t.args[0],this.support.svg):"IFRAME"===t.method?new l(t.args[0],this.isSameOrigin(t.args[0].src),this.options):new o(t)},n.prototype.isSVG=function(t){return"svg"===t.substring(t.length-3).toLowerCase()||h.prototype.isInline(t)},n.prototype.imageExists=function(t,e){return t.some(function(t){return t.src===e})},n.prototype.isSameOrigin=function(t){return this.getOrigin(t)===this.origin},n.prototype.getOrigin=function(t){var e=this.link||(this.link=document.createElement("a"));return e.href=t,e.href=e.href,e.protocol+e.hostname+e.port},n.prototype.getPromise=function(t){return this.timeout(t,this.options.imageTimeout).catch(function(){return new o(t.src).promise.then(function(e){t.image=e})})},n.prototype.get=function(t){var e=null;return this.images.some(function(i){return(e=i).src===t})?e:null},n.prototype.fetch=function(t){return this.images=t.reduce(d(this.findBackgroundImage,this),this.findImages(t)),this.images.forEach(function(t,e){t.promise.then(function(){r("Succesfully loaded image #"+(e+1),t)},function(i){r("Failed loading image #"+(e+1),t,i)})}),this.ready=Promise.all(this.images.map(this.getPromise,this)),r("Finished searching images"),this},n.prototype.timeout=function(t,e){var i,n=Promise.race([t.promise,new Promise(function(n,a){i=setTimeout(function(){r("Timed out loading image",t),a(t)},e)})]).then(function(t){return clearTimeout(i),t});return n.catch(function(){clearTimeout(i)}),n},e.exports=n},{"./dummyimagecontainer":5,"./framecontainer":8,"./imagecontainer":10,"./lineargradientcontainer":12,"./log":13,"./proxyimagecontainer":17,"./svgcontainer":23,"./svgnodecontainer":24,"./utils":26,"./webkitgradientcontainer":27}],12:[function(t,e,i){function n(t){r.apply(this,arguments),this.type=r.TYPES.LINEAR;var e=n.REGEXP_DIRECTION.test(t.args[0])||!r.REGEXP_COLORSTOP.test(t.args[0]);e?t.args[0].split(/\s+/).reverse().forEach(function(t,e){switch(t){case"left":this.x0=0,this.x1=1;break;case"top":this.y0=0,this.y1=1;break;case"right":this.x0=1,this.x1=0;break;case"bottom":this.y0=1,this.y1=0;break;case"to":var i=this.y0,n=this.x0;this.y0=this.y1,this.x0=this.x1,this.x1=n,this.y1=i;break;case"center":break;default:var r=.01*parseFloat(t,10);if(isNaN(r))break;0===e?(this.y0=r,this.y1=1-this.y0):(this.x0=r,this.x1=1-this.x0)}},this):(this.y0=0,this.y1=1),this.colorStops=t.args.slice(e?1:0).map(function(t){var e=t.match(r.REGEXP_COLORSTOP),i=+e[2],n=0===i?"%":e[3];return{color:new a(e[1]),stop:"%"===n?i/100:null}}),null===this.colorStops[0].stop&&(this.colorStops[0].stop=0),null===this.colorStops[this.colorStops.length-1].stop&&(this.colorStops[this.colorStops.length-1].stop=1),this.colorStops.forEach(function(t,e){null===t.stop&&this.colorStops.slice(e).some(function(i,n){return null!==i.stop&&(t.stop=(i.stop-this.colorStops[e-1].stop)/(n+1)+this.colorStops[e-1].stop,!0)},this)},this)}var r=t("./gradientcontainer"),a=t("./color");n.prototype=Object.create(r.prototype),n.REGEXP_DIRECTION=/^\s*(?:to|left|right|top|bottom|center|\d{1,3}(?:\.\d+)?%?)(?:\s|$)/i,e.exports=n},{"./color":3,"./gradientcontainer":9}],13:[function(t,e,i){var n=function t(){t.options.logging&&window.console&&window.console.log&&Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-t.options.start+"ms","html2canvas:"].concat([].slice.call(arguments,0)))};n.options={logging:!1},e.exports=n},{}],14:[function(t,e,i){function n(t,e){this.node=t,this.parent=e,this.stack=null,this.bounds=null,this.borders=null,this.clip=[],this.backgroundClip=[],this.offsetBounds=null,this.visible=null,this.computedStyles=null,this.colors={},this.styles={},this.backgroundImages=null,this.transformData=null,this.transformMatrix=null,this.isPseudoElement=!1,this.opacity=null}function r(t){var e=t.options[t.selectedIndex||0];return e?e.text||"":""}function a(t){if(t&&"matrix"===t[1])return t[2].split(",").map(function(t){return parseFloat(t.trim())});if(t&&"matrix3d"===t[1]){var e=t[2].split(",").map(function(t){return parseFloat(t.trim())});return[e[0],e[1],e[4],e[5],e[12],e[13]]}}function o(t){return-1!==t.toString().indexOf("%")}function s(t){return t.replace("px","")}function l(t){return parseFloat(t)}var h=t("./color"),c=t("./utils"),u=c.getBounds,p=c.parseBackgrounds,d=c.offsetBounds;n.prototype.cloneTo=function(t){t.visible=this.visible,t.borders=this.borders,t.bounds=this.bounds,t.clip=this.clip,t.backgroundClip=this.backgroundClip,t.computedStyles=this.computedStyles,t.styles=this.styles,t.backgroundImages=this.backgroundImages,t.opacity=this.opacity},n.prototype.getOpacity=function(){return null===this.opacity?this.opacity=this.cssFloat("opacity"):this.opacity},n.prototype.assignStack=function(t){this.stack=t,t.children.push(this)},n.prototype.isElementVisible=function(){return this.node.nodeType===Node.TEXT_NODE?this.parent.visible:"none"!==this.css("display")&&"hidden"!==this.css("visibility")&&!this.node.hasAttribute("data-html2canvas-ignore")&&("INPUT"!==this.node.nodeName||"hidden"!==this.node.getAttribute("type"))},n.prototype.css=function(t){return this.computedStyles||(this.computedStyles=this.isPseudoElement?this.parent.computedStyle(this.before?":before":":after"):this.computedStyle(null)),this.styles[t]||(this.styles[t]=this.computedStyles[t])},n.prototype.prefixedCss=function(t){var e=["webkit","moz","ms","o"],i=this.css(t);return void 0===i&&e.some(function(e){return void 0!==(i=this.css(e+t.substr(0,1).toUpperCase()+t.substr(1)))},this),void 0===i?null:i},n.prototype.computedStyle=function(t){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,t)},n.prototype.cssInt=function(t){var e=parseInt(this.css(t),10);return isNaN(e)?0:e},n.prototype.color=function(t){return this.colors[t]||(this.colors[t]=new h(this.css(t)))},n.prototype.cssFloat=function(t){var e=parseFloat(this.css(t));return isNaN(e)?0:e},n.prototype.fontWeight=function(){var t=this.css("fontWeight");switch(parseInt(t,10)){case 401:t="bold";break;case 400:t="normal"}return t},n.prototype.parseClip=function(){var t=this.css("clip").match(this.CLIP);return t?{top:parseInt(t[1],10),right:parseInt(t[2],10),bottom:parseInt(t[3],10),left:parseInt(t[4],10)}:null},n.prototype.parseBackgroundImages=function(){return this.backgroundImages||(this.backgroundImages=p(this.css("backgroundImage")))},n.prototype.cssList=function(t,e){var i=(this.css(t)||"").split(",");return i=i[e||0]||i[0]||"auto",i=i.trim().split(" "),1===i.length&&(i=[i[0],o(i[0])?"auto":i[0]]),i},n.prototype.parseBackgroundSize=function(t,e,i){var n,r,a=this.cssList("backgroundSize",i);if(o(a[0]))n=t.width*parseFloat(a[0])/100;else{if(/contain|cover/.test(a[0])){var s=t.width/t.height,l=e.width/e.height;return s<l^"contain"===a[0]?{width:t.height*l,height:t.height}:{width:t.width,height:t.width/l}}n=parseInt(a[0],10)}return r="auto"===a[0]&&"auto"===a[1]?e.height:"auto"===a[1]?n/e.width*e.height:o(a[1])?t.height*parseFloat(a[1])/100:parseInt(a[1],10),"auto"===a[0]&&(n=r/e.height*e.width),{width:n,height:r}},n.prototype.parseBackgroundPosition=function(t,e,i,n){var r,a,s=this.cssList("backgroundPosition",i);return r=o(s[0])?(t.width-(n||e).width)*(parseFloat(s[0])/100):parseInt(s[0],10),a="auto"===s[1]?r/e.width*e.height:o(s[1])?(t.height-(n||e).height)*parseFloat(s[1])/100:parseInt(s[1],10),"auto"===s[0]&&(r=a/e.height*e.width),{left:r,top:a}},n.prototype.parseBackgroundRepeat=function(t){return this.cssList("backgroundRepeat",t)[0]},n.prototype.parseTextShadows=function(){var t=this.css("textShadow"),e=[];if(t&&"none"!==t)for(var i=t.match(this.TEXT_SHADOW_PROPERTY),n=0;i&&n<i.length;n++){var r=i[n].match(this.TEXT_SHADOW_VALUES);e.push({color:new h(r[0]),offsetX:r[1]?parseFloat(r[1].replace("px","")):0,offsetY:r[2]?parseFloat(r[2].replace("px","")):0,blur:r[3]?r[3].replace("px",""):0})}return e},n.prototype.parseTransform=function(){if(!this.transformData)if(this.hasTransform()){var t=this.parseBounds(),e=this.prefixedCss("transformOrigin").split(" ").map(s).map(l);e[0]+=t.left,e[1]+=t.top,this.transformData={origin:e,matrix:this.parseTransformMatrix()}}else this.transformData={origin:[0,0],matrix:[1,0,0,1,0,0]};return this.transformData},n.prototype.parseTransformMatrix=function(){if(!this.transformMatrix){var t=this.prefixedCss("transform"),e=t?a(t.match(this.MATRIX_PROPERTY)):null;this.transformMatrix=e||[1,0,0,1,0,0]}return this.transformMatrix},n.prototype.parseBounds=function(){return this.bounds||(this.bounds=this.hasTransform()?d(this.node):u(this.node))},n.prototype.hasTransform=function(){return"1,0,0,1,0,0"!==this.parseTransformMatrix().join(",")||this.parent&&this.parent.hasTransform()},n.prototype.getValue=function(){var t=this.node.value||"";return"SELECT"===this.node.tagName?t=r(this.node):"password"===this.node.type&&(t=Array(t.length+1).join("•")),0===t.length?this.node.placeholder||"":t},n.prototype.MATRIX_PROPERTY=/(matrix|matrix3d)\((.+)\)/,n.prototype.TEXT_SHADOW_PROPERTY=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,n.prototype.TEXT_SHADOW_VALUES=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g,n.prototype.CLIP=/^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/,e.exports=n},{"./color":3,"./utils":26}],15:[function(t,e,i){function n(t,e,i,n,r){H("Starting NodeParser"),this.renderer=e,this.options=r,this.range=null,this.support=i,this.renderQueue=[],this.stack=new X(!0,1,t.ownerDocument,null);var a=new B(t,null);if(r.background&&e.rectangle(0,0,e.width,e.height,new Y(r.background)),t===t.ownerDocument.documentElement){var o=new B(a.color("backgroundColor").isTransparent()?t.ownerDocument.body:t.ownerDocument.documentElement,null);e.rectangle(0,0,e.width,e.height,o.color("backgroundColor"))}a.visibile=a.isElementVisible(),this.createPseudoHideStyles(t.ownerDocument),this.disableAnimations(t.ownerDocument),this.nodes=I([a].concat(this.getChildren(a)).filter(function(t){return t.visible=t.isElementVisible()}).map(this.getPseudoElements,this)),this.fontMetrics=new U,H("Fetched nodes, total:",this.nodes.length),H("Calculate overflow clips"),this.calculateOverflowClips(),H("Start fetching images"),this.images=n.fetch(this.nodes.filter(D)),this.ready=this.images.ready.then(Q(function(){return H("Images loaded, starting parsing"),H("Creating stacking contexts"),this.createStackingContexts(),H("Sorting stacking contexts"),this.sortStackingContexts(this.stack),this.parse(this.stack),H("Render queue created with "+this.renderQueue.length+" items"),new Promise(Q(function(t){r.async?"function"==typeof r.async?r.async.call(this,this.renderQueue,t):this.renderQueue.length>0?(this.renderIndex=0,this.asyncRenderer(this.renderQueue,t)):t():(this.renderQueue.forEach(this.paint,this),t())},this))},this))}function r(t){return t.parent&&t.parent.clip.length}function a(t){return t.replace(/(\-[a-z])/g,function(t){return t.toUpperCase().replace("-","")})}function o(){}function s(t,e,i,n){return t.map(function(r,a){if(r.width>0){var o=e.left,s=e.top,l=e.width,h=e.height-t[2].width;switch(a){case 0:h=t[0].width,r.args=u({c1:[o,s],c2:[o+l,s],c3:[o+l-t[1].width,s+h],c4:[o+t[3].width,s+h]},n[0],n[1],i.topLeftOuter,i.topLeftInner,i.topRightOuter,i.topRightInner);break;case 1:o=e.left+e.width-t[1].width,l=t[1].width,r.args=u({c1:[o+l,s],c2:[o+l,s+h+t[2].width],c3:[o,s+h],c4:[o,s+t[0].width]},n[1],n[2],i.topRightOuter,i.topRightInner,i.bottomRightOuter,i.bottomRightInner);break;case 2:s=s+e.height-t[2].width,h=t[2].width,r.args=u({c1:[o+l,s+h],c2:[o,s+h],c3:[o+t[3].width,s],c4:[o+l-t[3].width,s]},n[2],n[3],i.bottomRightOuter,i.bottomRightInner,i.bottomLeftOuter,i.bottomLeftInner);break;case 3:l=t[3].width,r.args=u({c1:[o,s+h+t[2].width],c2:[o,s],c3:[o+l,s+t[0].width],c4:[o+l,s+h]},n[3],n[0],i.bottomLeftOuter,i.bottomLeftInner,i.topLeftOuter,i.topLeftInner)}}return r})}function l(t,e,i,n){var r=(Math.sqrt(2)-1)/3*4,a=i*r,o=n*r,s=t+i,l=e+n;return{topLeft:c({x:t,y:l},{x:t,y:l-o},{x:s-a,y:e},{x:s,y:e}),topRight:c({x:t,y:e},{x:t+a,y:e},{x:s,y:l-o},{x:s,y:l}),bottomRight:c({x:s,y:e},{x:s,y:e+o},{x:t+a,y:l},{x:t,y:l}),bottomLeft:c({x:s,y:l},{x:s-a,y:l},{x:t,y:e+o},{x:t,y:e})}}function h(t,e,i){var n=t.left,r=t.top,a=t.width,o=t.height,s=e[0][0]<a/2?e[0][0]:a/2,h=e[0][1]<o/2?e[0][1]:o/2,c=e[1][0]<a/2?e[1][0]:a/2,u=e[1][1]<o/2?e[1][1]:o/2,p=e[2][0]<a/2?e[2][0]:a/2,d=e[2][1]<o/2?e[2][1]:o/2,f=e[3][0]<a/2?e[3][0]:a/2,m=e[3][1]<o/2?e[3][1]:o/2,g=a-c,v=o-d,y=a-p,b=o-m;return{topLeftOuter:l(n,r,s,h).topLeft.subdivide(.5),topLeftInner:l(n+i[3].width,r+i[0].width,Math.max(0,s-i[3].width),Math.max(0,h-i[0].width)).topLeft.subdivide(.5),topRightOuter:l(n+g,r,c,u).topRight.subdivide(.5),topRightInner:l(n+Math.min(g,a+i[3].width),r+i[0].width,g>a+i[3].width?0:c-i[3].width,u-i[0].width).topRight.subdivide(.5),bottomRightOuter:l(n+y,r+v,p,d).bottomRight.subdivide(.5),bottomRightInner:l(n+Math.min(y,a-i[3].width),r+Math.min(v,o+i[0].width),Math.max(0,p-i[1].width),d-i[2].width).bottomRight.subdivide(.5),bottomLeftOuter:l(n,r+b,f,m).bottomLeft.subdivide(.5),bottomLeftInner:l(n+i[3].width,r+b,Math.max(0,f-i[3].width),m-i[2].width).bottomLeft.subdivide(.5)}}function c(t,e,i,n){var r=function(t,e,i){return{x:t.x+(e.x-t.x)*i,y:t.y+(e.y-t.y)*i}};return{start:t,startControl:e,endControl:i,end:n,subdivide:function(a){var o=r(t,e,a),s=r(e,i,a),l=r(i,n,a),h=r(o,s,a),u=r(s,l,a),p=r(h,u,a);return[c(t,o,h,p),c(p,u,l,n)]},curveTo:function(t){t.push(["bezierCurve",e.x,e.y,i.x,i.y,n.x,n.y])},curveToReversed:function(n){n.push(["bezierCurve",i.x,i.y,e.x,e.y,t.x,t.y])}}}function u(t,e,i,n,r,a,o){var s=[];return e[0]>0||e[1]>0?(s.push(["line",n[1].start.x,n[1].start.y]),n[1].curveTo(s)):s.push(["line",t.c1[0],t.c1[1]]),i[0]>0||i[1]>0?(s.push(["line",a[0].start.x,a[0].start.y]),a[0].curveTo(s),s.push(["line",o[0].end.x,o[0].end.y]),o[0].curveToReversed(s)):(s.push(["line",t.c2[0],t.c2[1]]),s.push(["line",t.c3[0],t.c3[1]])),e[0]>0||e[1]>0?(s.push(["line",r[1].end.x,r[1].end.y]),r[1].curveToReversed(s)):s.push(["line",t.c4[0],t.c4[1]]),s}function p(t,e,i,n,r,a,o){e[0]>0||e[1]>0?(t.push(["line",n[0].start.x,n[0].start.y]),n[0].curveTo(t),n[1].curveTo(t)):t.push(["line",a,o]),(i[0]>0||i[1]>0)&&t.push(["line",r[0].start.x,r[0].start.y])}function d(t){return t.cssInt("zIndex")<0}function f(t){return t.cssInt("zIndex")>0}function m(t){return 0===t.cssInt("zIndex")}function g(t){return-1!==["inline","inline-block","inline-table"].indexOf(t.css("display"))}function v(t){return t instanceof X}function y(t){return t.node.data.trim().length>0}function b(t){return/^(normal|none|0px)$/.test(t.parent.css("letterSpacing"))}function x(t){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(e){var i=t.css("border"+e+"Radius"),n=i.split(" ");return n.length<=1&&(n[1]=n[0]),n.map(L)})}function w(t){return t.nodeType===Node.TEXT_NODE||t.nodeType===Node.ELEMENT_NODE}function C(t){return"auto"!==(-1!==["absolute","relative","fixed"].indexOf(t.css("position"))?t.css("zIndex"):"auto")}function S(t){return"static"!==t.css("position")}function T(t){return"none"!==t.css("float")}function _(t){return-1!==["inline-block","inline-table"].indexOf(t.css("display"))}function k(t){var e=this;return function(){return!t.apply(e,arguments)}}function D(t){return t.node.nodeType===Node.ELEMENT_NODE}function M(t){return!0===t.isPseudoElement}function E(t){return t.node.nodeType===Node.TEXT_NODE}function A(t){return function(e,i){return e.cssInt("zIndex")+t.indexOf(e)/t.length-(i.cssInt("zIndex")+t.indexOf(i)/t.length)}}function P(t){return t.getOpacity()<1}function L(t){return parseInt(t,10)}function O(t){return t.width}function F(t){return t.node.nodeType!==Node.ELEMENT_NODE||-1===["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"].indexOf(t.node.nodeName)}function I(t){return[].concat.apply([],t)}function j(t){var e=t.substr(0,1);return e===t.substr(t.length-1)&&e.match(/'|"/)?t.substr(1,t.length-2):t}function N(t){for(var e,i=[],n=0,r=!1;t.length;)R(t[n])===r?(e=t.splice(0,n),e.length&&i.push(z.ucs2.encode(e)),r=!r,n=0):n++,n>=t.length&&(e=t.splice(0,n),e.length&&i.push(z.ucs2.encode(e)));return i}function R(t){return-1!==[32,13,10,9,45].indexOf(t)}function V(t){return/[^\u0000-\u00ff]/.test(t)}var H=t("./log"),z=t("punycode"),B=t("./nodecontainer"),W=t("./textcontainer"),q=t("./pseudoelementcontainer"),U=t("./fontmetrics"),Y=t("./color"),X=t("./stackingcontext"),K=t("./utils"),Q=K.bind,Z=K.getBounds,G=K.parseBackgrounds,J=K.offsetBounds;n.prototype.calculateOverflowClips=function(){this.nodes.forEach(function(t){if(D(t)){M(t)&&t.appendToDOM(),t.borders=this.parseBorders(t);var e="hidden"===t.css("overflow")?[t.borders.clip]:[],i=t.parseClip();i&&-1!==["absolute","fixed"].indexOf(t.css("position"))&&e.push([["rect",t.bounds.left+i.left,t.bounds.top+i.top,i.right-i.left,i.bottom-i.top]]),t.clip=r(t)?t.parent.clip.concat(e):e,t.backgroundClip="hidden"!==t.css("overflow")?t.clip.concat([t.borders.clip]):t.clip,M(t)&&t.cleanDOM()}else E(t)&&(t.clip=r(t)?t.parent.clip:[]);M(t)||(t.bounds=null)},this)},n.prototype.asyncRenderer=function(t,e,i){i=i||Date.now(),this.paint(t[this.renderIndex++]),t.length===this.renderIndex?e():i+20>Date.now()?this.asyncRenderer(t,e,i):setTimeout(Q(function(){this.asyncRenderer(t,e)},this),0)},n.prototype.createPseudoHideStyles=function(t){this.createStyles(t,"."+q.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+':before { content: "" !important; display: none !important; }.'+q.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER+':after { content: "" !important; display: none !important; }')},n.prototype.disableAnimations=function(t){this.createStyles(t,"* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; -webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}")},n.prototype.createStyles=function(t,e){var i=t.createElement("style");i.innerHTML=e,t.body.appendChild(i)},n.prototype.getPseudoElements=function(t){var e=[[t]];if(t.node.nodeType===Node.ELEMENT_NODE){var i=this.getPseudoElement(t,":before"),n=this.getPseudoElement(t,":after");i&&e.push(i),n&&e.push(n)}return I(e)},n.prototype.getPseudoElement=function(t,e){var i=t.computedStyle(e);if(!i||!i.content||"none"===i.content||"-moz-alt-content"===i.content||"none"===i.display)return null;for(var n=j(i.content),r="url"===n.substr(0,3),o=document.createElement(r?"img":"html2canvaspseudoelement"),s=new q(o,t,e),l=i.length-1;l>=0;l--){var h=a(i.item(l));o.style[h]=i[h]}if(o.className=q.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+q.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER,r)return o.src=G(n)[0].args[0],[s];var c=document.createTextNode(n);return o.appendChild(c),[s,new W(c,s)]},n.prototype.getChildren=function(t){return I([].filter.call(t.node.childNodes,w).map(function(e){var i=[e.nodeType===Node.TEXT_NODE?new W(e,t):new B(e,t)].filter(F);return e.nodeType===Node.ELEMENT_NODE&&i.length&&"TEXTAREA"!==e.tagName?i[0].isElementVisible()?i.concat(this.getChildren(i[0])):[]:i},this))},n.prototype.newStackingContext=function(t,e){var i=new X(e,t.getOpacity(),t.node,t.parent);t.cloneTo(i),(e?i.getParentStack(this):i.parent.stack).contexts.push(i),t.stack=i},n.prototype.createStackingContexts=function(){this.nodes.forEach(function(t){D(t)&&(this.isRootElement(t)||P(t)||C(t)||this.isBodyWithTransparentRoot(t)||t.hasTransform())?this.newStackingContext(t,!0):D(t)&&(S(t)&&m(t)||_(t)||T(t))?this.newStackingContext(t,!1):t.assignStack(t.parent.stack)},this)},n.prototype.isBodyWithTransparentRoot=function(t){return"BODY"===t.node.nodeName&&t.parent.color("backgroundColor").isTransparent()},n.prototype.isRootElement=function(t){return null===t.parent},n.prototype.sortStackingContexts=function(t){t.contexts.sort(A(t.contexts.slice(0))),t.contexts.forEach(this.sortStackingContexts,this)},n.prototype.parseTextBounds=function(t){return function(e,i,n){if("none"!==t.parent.css("textDecoration").substr(0,4)||0!==e.trim().length){if(this.support.rangeBounds&&!t.parent.hasTransform()){var r=n.slice(0,i).join("").length;return this.getRangeBounds(t.node,r,e.length)}if(t.node&&"string"==typeof t.node.data){var a=t.node.splitText(e.length),o=this.getWrapperBounds(t.node,t.parent.hasTransform());return t.node=a,o}}else this.support.rangeBounds&&!t.parent.hasTransform()||(t.node=t.node.splitText(e.length));return{}}},n.prototype.getWrapperBounds=function(t,e){var i=t.ownerDocument.createElement("html2canvaswrapper"),n=t.parentNode,r=t.cloneNode(!0);i.appendChild(t.cloneNode(!0)),n.replaceChild(i,t);var a=e?J(i):Z(i);return n.replaceChild(r,i),a},n.prototype.getRangeBounds=function(t,e,i){var n=this.range||(this.range=t.ownerDocument.createRange());return n.setStart(t,e),n.setEnd(t,e+i),n.getBoundingClientRect()},n.prototype.parse=function(t){var e=t.contexts.filter(d),i=t.children.filter(D),n=i.filter(k(T)),r=n.filter(k(S)).filter(k(g)),a=i.filter(k(S)).filter(T),s=n.filter(k(S)).filter(g),l=t.contexts.concat(n.filter(S)).filter(m),h=t.children.filter(E).filter(y),c=t.contexts.filter(f);e.concat(r).concat(a).concat(s).concat(l).concat(h).concat(c).forEach(function(t){this.renderQueue.push(t),v(t)&&(this.parse(t),this.renderQueue.push(new o))},this)},n.prototype.paint=function(t){try{t instanceof o?this.renderer.ctx.restore():E(t)?(M(t.parent)&&t.parent.appendToDOM(),this.paintText(t),M(t.parent)&&t.parent.cleanDOM()):this.paintNode(t)}catch(t){if(H(t),this.options.strict)throw t}},n.prototype.paintNode=function(t){v(t)&&(this.renderer.setOpacity(t.opacity),this.renderer.ctx.save(),t.hasTransform()&&this.renderer.setTransform(t.parseTransform())),"INPUT"===t.node.nodeName&&"checkbox"===t.node.type?this.paintCheckbox(t):"INPUT"===t.node.nodeName&&"radio"===t.node.type?this.paintRadio(t):this.paintElement(t)},n.prototype.paintElement=function(t){var e=t.parseBounds();this.renderer.clip(t.backgroundClip,function(){this.renderer.renderBackground(t,e,t.borders.borders.map(O))},this),this.renderer.clip(t.clip,function(){this.renderer.renderBorders(t.borders.borders)},this),this.renderer.clip(t.backgroundClip,function(){switch(t.node.nodeName){case"svg":case"IFRAME":var i=this.images.get(t.node);i?this.renderer.renderImage(t,e,t.borders,i):H("Error loading <"+t.node.nodeName+">",t.node);break;case"IMG":var n=this.images.get(t.node.src);n?this.renderer.renderImage(t,e,t.borders,n):H("Error loading <img>",t.node.src);break;case"CANVAS":this.renderer.renderImage(t,e,t.borders,{image:t.node});break;case"SELECT":case"INPUT":case"TEXTAREA":this.paintFormValue(t)}},this)},n.prototype.paintCheckbox=function(t){var e=t.parseBounds(),i=Math.min(e.width,e.height),n={width:i-1,height:i-1,top:e.top,left:e.left},r=[3,3],a=[r,r,r,r],o=[1,1,1,1].map(function(t){return{color:new Y("#A5A5A5"),width:t}}),l=h(n,a,o);this.renderer.clip(t.backgroundClip,function(){this.renderer.rectangle(n.left+1,n.top+1,n.width-2,n.height-2,new Y("#DEDEDE")),this.renderer.renderBorders(s(o,n,l,a)),t.node.checked&&(this.renderer.font(new Y("#424242"),"normal","normal","bold",i-3+"px","arial"),this.renderer.text("✔",n.left+i/6,n.top+i-1))},this)},n.prototype.paintRadio=function(t){var e=t.parseBounds(),i=Math.min(e.width,e.height)-2;this.renderer.clip(t.backgroundClip,function(){this.renderer.circleStroke(e.left+1,e.top+1,i,new Y("#DEDEDE"),1,new Y("#A5A5A5")),t.node.checked&&this.renderer.circle(Math.ceil(e.left+i/4)+1,Math.ceil(e.top+i/4)+1,Math.floor(i/2),new Y("#424242"))},this)},n.prototype.paintFormValue=function(t){var e=t.getValue();if(e.length>0){var i=t.node.ownerDocument,n=i.createElement("html2canvaswrapper");["lineHeight","textAlign","fontFamily","fontWeight","fontSize","color","paddingLeft","paddingTop","paddingRight","paddingBottom","width","height","borderLeftStyle","borderTopStyle","borderLeftWidth","borderTopWidth","boxSizing","whiteSpace","wordWrap"].forEach(function(e){try{n.style[e]=t.css(e)}catch(t){H("html2canvas: Parse: Exception caught in renderFormValue: "+t.message)}});var r=t.parseBounds();n.style.position="fixed",n.style.left=r.left+"px",n.style.top=r.top+"px",n.textContent=e,i.body.appendChild(n),this.paintText(new W(n.firstChild,t)),i.body.removeChild(n)}},n.prototype.paintText=function(t){t.applyTextTransform();var e=z.ucs2.decode(t.node.data),i=this.options.letterRendering&&!b(t)||V(t.node.data)?e.map(function(t){return z.ucs2.encode([t])}):N(e),n=t.parent.fontWeight(),r=t.parent.css("fontSize"),a=t.parent.css("fontFamily"),o=t.parent.parseTextShadows();this.renderer.font(t.parent.color("color"),t.parent.css("fontStyle"),t.parent.css("fontVariant"),n,r,a),o.length?this.renderer.fontShadow(o[0].color,o[0].offsetX,o[0].offsetY,o[0].blur):this.renderer.clearShadow(),this.renderer.clip(t.parent.clip,function(){i.map(this.parseTextBounds(t),this).forEach(function(e,n){e&&(this.renderer.text(i[n],e.left,e.bottom),this.renderTextDecoration(t.parent,e,this.fontMetrics.getMetrics(a,r)))},this)},this)},n.prototype.renderTextDecoration=function(t,e,i){switch(t.css("textDecoration").split(" ")[0]){case"underline":this.renderer.rectangle(e.left,Math.round(e.top+i.baseline+i.lineWidth),e.width,1,t.color("color"));break;case"overline":this.renderer.rectangle(e.left,Math.round(e.top),e.width,1,t.color("color"));break;case"line-through":this.renderer.rectangle(e.left,Math.ceil(e.top+i.middle+i.lineWidth),e.width,1,t.color("color"))}};var $={inset:[["darken",.6],["darken",.1],["darken",.1],["darken",.6]]};n.prototype.parseBorders=function(t){var e=t.parseBounds(),i=x(t),n=["Top","Right","Bottom","Left"].map(function(e,i){var n=t.css("border"+e+"Style"),r=t.color("border"+e+"Color");"inset"===n&&r.isBlack()&&(r=new Y([255,255,255,r.a]));var a=$[n]?$[n][i]:null;return{width:t.cssInt("border"+e+"Width"),color:a?r[a[0]](a[1]):r,args:null}}),r=h(e,i,n);return{clip:this.parseBackgroundClip(t,r,n,i,e),borders:s(n,e,r,i)}},n.prototype.parseBackgroundClip=function(t,e,i,n,r){var a=t.css("backgroundClip"),o=[];switch(a){case"content-box":case"padding-box":p(o,n[0],n[1],e.topLeftInner,e.topRightInner,r.left+i[3].width,r.top+i[0].width),p(o,n[1],n[2],e.topRightInner,e.bottomRightInner,r.left+r.width-i[1].width,r.top+i[0].width),p(o,n[2],n[3],e.bottomRightInner,e.bottomLeftInner,r.left+r.width-i[1].width,r.top+r.height-i[2].width),p(o,n[3],n[0],e.bottomLeftInner,e.topLeftInner,r.left+i[3].width,r.top+r.height-i[2].width);break;default:p(o,n[0],n[1],e.topLeftOuter,e.topRightOuter,r.left,r.top),p(o,n[1],n[2],e.topRightOuter,e.bottomRightOuter,r.left+r.width,r.top),p(o,n[2],n[3],e.bottomRightOuter,e.bottomLeftOuter,r.left+r.width,r.top+r.height),p(o,n[3],n[0],e.bottomLeftOuter,e.topLeftOuter,r.left,r.top+r.height)}return o},e.exports=n},{"./color":3,"./fontmetrics":7,"./log":13,"./nodecontainer":14,"./pseudoelementcontainer":18,"./stackingcontext":21,"./textcontainer":25,"./utils":26,punycode:1}],16:[function(t,e,i){function n(t,e,i){var n="withCredentials"in new XMLHttpRequest;if(!e)return Promise.reject("No proxy configured");var r=o(n),l=s(e,t,r);return n?c(l):a(i,l,r).then(function(t){return f(t.content)})}function r(t,e,i){var n="crossOrigin"in new Image,r=o(n),l=s(e,t,r);return n?Promise.resolve(l):a(i,l,r).then(function(t){return"data:"+t.type+";base64,"+t.content})}function a(t,e,i){return new Promise(function(n,r){var a=t.createElement("script"),o=function(){delete window.html2canvas.proxy[i],t.body.removeChild(a)};window.html2canvas.proxy[i]=function(t){o(),n(t)},a.src=e,a.onerror=function(t){o(),r(t)},t.body.appendChild(a)})}function o(t){return t?"":"html2canvas_"+Date.now()+"_"+ ++m+"_"+Math.round(1e5*Math.random())}function s(t,e,i){return t+"?url="+encodeURIComponent(e)+(i.length?"&callback=html2canvas.proxy."+i:"")}function l(t){return function(e){var i,n=new DOMParser;try{i=n.parseFromString(e,"text/html")}catch(t){p("DOMParser not supported, falling back to createHTMLDocument"),i=document.implementation.createHTMLDocument("");try{i.open(),i.write(e),i.close()}catch(t){p("createHTMLDocument write not supported, falling back to document.body.innerHTML"),i.body.innerHTML=e}}var r=i.querySelector("base");if(!r||!r.href.host){var a=i.createElement("base");a.href=t,i.head.insertBefore(a,i.head.firstChild)}return i}}function h(t,e,i,r,a,o){return new n(t,e,window.document).then(l(t)).then(function(t){return d(t,i,r,a,o,0,0)})}var c=t("./xhr"),u=t("./utils"),p=t("./log"),d=t("./clone"),f=u.decode64,m=0;i.Proxy=n,i.ProxyURL=r,i.loadUrlDocument=h},{"./clone":2,"./log":13,"./utils":26,"./xhr":28}],17:[function(t,e,i){function n(t,e){var i=document.createElement("a");i.href=t,t=i.href,this.src=t,this.image=new Image;var n=this;this.promise=new Promise(function(i,a){n.image.crossOrigin="Anonymous",n.image.onload=i,n.image.onerror=a,new r(t,e,document).then(function(t){n.image.src=t}).catch(a)})}var r=t("./proxy").ProxyURL;e.exports=n},{"./proxy":16}],18:[function(t,e,i){function n(t,e,i){r.call(this,t,e),this.isPseudoElement=!0,this.before=":before"===i}var r=t("./nodecontainer");n.prototype.cloneTo=function(t){n.prototype.cloneTo.call(this,t),t.isPseudoElement=!0,t.before=this.before},n.prototype=Object.create(r.prototype),n.prototype.appendToDOM=function(){this.before?this.parent.node.insertBefore(this.node,this.parent.node.firstChild):this.parent.node.appendChild(this.node),this.parent.node.className+=" "+this.getHideClass()},n.prototype.cleanDOM=function(){this.node.parentNode.removeChild(this.node),this.parent.node.className=this.parent.node.className.replace(this.getHideClass(),"")},n.prototype.getHideClass=function(){return this["PSEUDO_HIDE_ELEMENT_CLASS_"+(this.before?"BEFORE":"AFTER")]},n.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before",n.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after",e.exports=n},{"./nodecontainer":14}],19:[function(t,e,i){function n(t,e,i,n,r){this.width=t,this.height=e,this.images=i,this.options=n,this.document=r}var r=t("./log");n.prototype.renderImage=function(t,e,i,n){var r=t.cssInt("paddingLeft"),a=t.cssInt("paddingTop"),o=t.cssInt("paddingRight"),s=t.cssInt("paddingBottom"),l=i.borders,h=e.width-(l[1].width+l[3].width+r+o),c=e.height-(l[0].width+l[2].width+a+s);this.drawImage(n,0,0,n.image.width||h,n.image.height||c,e.left+r+l[3].width,e.top+a+l[0].width,h,c)},n.prototype.renderBackground=function(t,e,i){e.height>0&&e.width>0&&(this.renderBackgroundColor(t,e),this.renderBackgroundImage(t,e,i))},n.prototype.renderBackgroundColor=function(t,e){var i=t.color("backgroundColor");i.isTransparent()||this.rectangle(e.left,e.top,e.width,e.height,i)},n.prototype.renderBorders=function(t){t.forEach(this.renderBorder,this)},n.prototype.renderBorder=function(t){t.color.isTransparent()||null===t.args||this.drawShape(t.args,t.color)},n.prototype.renderBackgroundImage=function(t,e,i){t.parseBackgroundImages().reverse().forEach(function(n,a,o){switch(n.method){case"url":var s=this.images.get(n.args[0]);s?this.renderBackgroundRepeating(t,e,s,o.length-(a+1),i):r("Error loading background-image",n.args[0]);break;case"linear-gradient":case"gradient":var l=this.images.get(n.value);l?this.renderBackgroundGradient(l,e,i):r("Error loading background-image",n.args[0]);break;case"none":break;default:r("Unknown background-image type",n.args[0])}},this)},n.prototype.renderBackgroundRepeating=function(t,e,i,n,r){var a=t.parseBackgroundSize(e,i.image,n),o=t.parseBackgroundPosition(e,i.image,n,a);switch(t.parseBackgroundRepeat(n)){case"repeat-x":case"repeat no-repeat":this.backgroundRepeatShape(i,o,a,e,e.left+r[3],e.top+o.top+r[0],99999,a.height,r);break;case"repeat-y":case"no-repeat repeat":this.backgroundRepeatShape(i,o,a,e,e.left+o.left+r[3],e.top+r[0],a.width,99999,r);break;case"no-repeat":this.backgroundRepeatShape(i,o,a,e,e.left+o.left+r[3],e.top+o.top+r[0],a.width,a.height,r);break;default:this.renderBackgroundRepeat(i,o,a,{top:e.top,left:e.left},r[3],r[0])}},e.exports=n},{"./log":13}],20:[function(t,e,i){function n(t,e){o.apply(this,arguments),this.canvas=this.options.canvas||this.document.createElement("canvas"),this.options.canvas||(this.canvas.width=t,this.canvas.height=e),this.ctx=this.canvas.getContext("2d"),this.taintCtx=this.document.createElement("canvas").getContext("2d"),this.ctx.textBaseline="bottom",this.variables={},l("Initialized CanvasRenderer with size",t,"x",e)}function a(t){return t.length>0}var o=t("../renderer"),s=t("../lineargradientcontainer"),l=t("../log");n.prototype=Object.create(o.prototype),n.prototype.setFillStyle=function(t){return this.ctx.fillStyle="object"===(void 0===t?"undefined":r(t))&&t.isColor?t.toString():t,this.ctx},n.prototype.rectangle=function(t,e,i,n,r){this.setFillStyle(r).fillRect(t,e,i,n)},n.prototype.circle=function(t,e,i,n){this.setFillStyle(n),this.ctx.beginPath(),this.ctx.arc(t+i/2,e+i/2,i/2,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},n.prototype.circleStroke=function(t,e,i,n,r,a){this.circle(t,e,i,n),this.ctx.strokeStyle=a.toString(),this.ctx.stroke()},n.prototype.drawShape=function(t,e){this.shape(t),this.setFillStyle(e).fill()},n.prototype.taints=function(t){if(null===t.tainted){this.taintCtx.drawImage(t.image,0,0);try{this.taintCtx.getImageData(0,0,1,1),t.tainted=!1}catch(e){this.taintCtx=document.createElement("canvas").getContext("2d"),t.tainted=!0}}return t.tainted},n.prototype.drawImage=function(t,e,i,n,r,a,o,s,l){this.taints(t)&&!this.options.allowTaint||this.ctx.drawImage(t.image,e,i,n,r,a,o,s,l)},n.prototype.clip=function(t,e,i){this.ctx.save(),t.filter(a).forEach(function(t){this.shape(t).clip()},this),e.call(i),this.ctx.restore()},n.prototype.shape=function(t){return this.ctx.beginPath(),t.forEach(function(t,e){"rect"===t[0]?this.ctx.rect.apply(this.ctx,t.slice(1)):this.ctx[0===e?"moveTo":t[0]+"To"].apply(this.ctx,t.slice(1))},this),this.ctx.closePath(),this.ctx},n.prototype.font=function(t,e,i,n,r,a){this.setFillStyle(t).font=[e,i,n,r,a].join(" ").split(",")[0]},n.prototype.fontShadow=function(t,e,i,n){this.setVariable("shadowColor",t.toString()).setVariable("shadowOffsetY",e).setVariable("shadowOffsetX",i).setVariable("shadowBlur",n)},n.prototype.clearShadow=function(){this.setVariable("shadowColor","rgba(0,0,0,0)")},n.prototype.setOpacity=function(t){this.ctx.globalAlpha=t},n.prototype.setTransform=function(t){this.ctx.translate(t.origin[0],t.origin[1]),this.ctx.transform.apply(this.ctx,t.matrix),this.ctx.translate(-t.origin[0],-t.origin[1])},n.prototype.setVariable=function(t,e){return this.variables[t]!==e&&(this.variables[t]=this.ctx[t]=e),this},n.prototype.text=function(t,e,i){this.ctx.fillText(t,e,i)},n.prototype.backgroundRepeatShape=function(t,e,i,n,r,a,o,s,l){var h=[["line",Math.round(r),Math.round(a)],["line",Math.round(r+o),Math.round(a)],["line",Math.round(r+o),Math.round(s+a)],["line",Math.round(r),Math.round(s+a)]];this.clip([h],function(){this.renderBackgroundRepeat(t,e,i,n,l[3],l[0])},this)},n.prototype.renderBackgroundRepeat=function(t,e,i,n,r,a){var o=Math.round(n.left+e.left+r),s=Math.round(n.top+e.top+a);this.setFillStyle(this.ctx.createPattern(this.resizeImage(t,i),"repeat")),this.ctx.translate(o,s),this.ctx.fill(),this.ctx.translate(-o,-s)},n.prototype.renderBackgroundGradient=function(t,e){if(t instanceof s){var i=this.ctx.createLinearGradient(e.left+e.width*t.x0,e.top+e.height*t.y0,e.left+e.width*t.x1,e.top+e.height*t.y1);t.colorStops.forEach(function(t){i.addColorStop(t.stop,t.color.toString())}),this.rectangle(e.left,e.top,e.width,e.height,i)}},n.prototype.resizeImage=function(t,e){var i=t.image;if(i.width===e.width&&i.height===e.height)return i;var n,r=document.createElement("canvas");return r.width=e.width,r.height=e.height,n=r.getContext("2d"),n.drawImage(i,0,0,i.width,i.height,0,0,e.width,e.height),r},e.exports=n},{"../lineargradientcontainer":12,"../log":13,"../renderer":19}],21:[function(t,e,i){function n(t,e,i,n){r.call(this,i,n),this.ownStacking=t,this.contexts=[],this.children=[],this.opacity=(this.parent?this.parent.stack.opacity:1)*e}var r=t("./nodecontainer");n.prototype=Object.create(r.prototype),n.prototype.getParentStack=function(t){var e=this.parent?this.parent.stack:null;return e?e.ownStacking?e:e.getParentStack(t):t.stack},e.exports=n},{"./nodecontainer":14}],22:[function(t,e,i){function n(t){this.rangeBounds=this.testRangeBounds(t),this.cors=this.testCORS(),this.svg=this.testSVG()}n.prototype.testRangeBounds=function(t){var e,i,n,r,a=!1;return t.createRange&&(e=t.createRange(),e.getBoundingClientRect&&(i=t.createElement("boundtest"),i.style.height="123px",i.style.display="block",t.body.appendChild(i),e.selectNode(i),n=e.getBoundingClientRect(),r=n.height,123===r&&(a=!0),t.body.removeChild(i))),a},n.prototype.testCORS=function(){return void 0!==(new Image).crossOrigin},n.prototype.testSVG=function(){var t=new Image,e=document.createElement("canvas"),i=e.getContext("2d");t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{i.drawImage(t,0,0),e.toDataURL()}catch(t){return!1}return!0},e.exports=n},{}],23:[function(t,e,i){function n(t){this.src=t,this.image=null;var e=this;this.promise=this.hasFabric().then(function(){return e.isInline(t)?Promise.resolve(e.inlineFormatting(t)):r(t)}).then(function(t){return new Promise(function(i){window.html2canvas.svg.fabric.loadSVGFromString(t,e.createCanvas.call(e,i))})})}var r=t("./xhr"),a=t("./utils").decode64;n.prototype.hasFabric=function(){return window.html2canvas.svg&&window.html2canvas.svg.fabric?Promise.resolve():Promise.reject(new Error("html2canvas.svg.js is not loaded, cannot render svg"))},n.prototype.inlineFormatting=function(t){return/^data:image\/svg\+xml;base64,/.test(t)?this.decode64(this.removeContentType(t)):this.removeContentType(t)},n.prototype.removeContentType=function(t){return t.replace(/^data:image\/svg\+xml(;base64)?,/,"")},n.prototype.isInline=function(t){return/^data:image\/svg\+xml/i.test(t)},n.prototype.createCanvas=function(t){var e=this;return function(i,n){var r=new window.html2canvas.svg.fabric.StaticCanvas("c");e.image=r.lowerCanvasEl,r.setWidth(n.width).setHeight(n.height).add(window.html2canvas.svg.fabric.util.groupSVGElements(i,n)).renderAll(),t(r.lowerCanvasEl)}},n.prototype.decode64=function(t){return"function"==typeof window.atob?window.atob(t):a(t)},e.exports=n},{"./utils":26,"./xhr":28}],24:[function(t,e,i){function n(t,e){this.src=t,this.image=null;var i=this;this.promise=e?new Promise(function(e,n){i.image=new Image,i.image.onload=e,i.image.onerror=n,i.image.src="data:image/svg+xml,"+(new XMLSerializer).serializeToString(t),!0===i.image.complete&&e(i.image)}):this.hasFabric().then(function(){return new Promise(function(e){window.html2canvas.svg.fabric.parseSVGDocument(t,i.createCanvas.call(i,e))})})}var r=t("./svgcontainer");n.prototype=Object.create(r.prototype),e.exports=n},{"./svgcontainer":23}],25:[function(t,e,i){function n(t,e){a.call(this,t,e)}function r(t,e,i){if(t.length>0)return e+i.toUpperCase()}var a=t("./nodecontainer");n.prototype=Object.create(a.prototype),n.prototype.applyTextTransform=function(){this.node.data=this.transform(this.parent.css("textTransform"))},n.prototype.transform=function(t){var e=this.node.data;switch(t){case"lowercase":return e.toLowerCase();case"capitalize":return e.replace(/(^|\s|:|-|\(|\))([a-z])/g,r);case"uppercase":return e.toUpperCase();default:return e}},e.exports=n},{"./nodecontainer":14}],26:[function(t,e,i){i.smallImage=function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},i.bind=function(t,e){return function(){return t.apply(e,arguments)}},i.decode64=function(t){var e,i,n,r,a,o,s,l,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=t.length,u="";for(e=0;e<c;e+=4)i=h.indexOf(t[e]),n=h.indexOf(t[e+1]),r=h.indexOf(t[e+2]),a=h.indexOf(t[e+3]),o=i<<2|n>>4,s=(15&n)<<4|r>>2,l=(3&r)<<6|a,u+=64===r?String.fromCharCode(o):64===a||-1===a?String.fromCharCode(o,s):String.fromCharCode(o,s,l);return u},i.getBounds=function(t){if(t.getBoundingClientRect){var e=t.getBoundingClientRect(),i=null==t.offsetWidth?e.width:t.offsetWidth;return{top:e.top,bottom:e.bottom||e.top+e.height,right:e.left+i,left:e.left,width:i,height:null==t.offsetHeight?e.height:t.offsetHeight}}return{}},i.offsetBounds=function(t){var e=t.offsetParent?i.offsetBounds(t.offsetParent):{top:0,left:0};return{top:t.offsetTop+e.top,bottom:t.offsetTop+t.offsetHeight+e.top,right:t.offsetLeft+e.left+t.offsetWidth,left:t.offsetLeft+e.left,width:t.offsetWidth,height:t.offsetHeight}},i.parseBackgrounds=function(t){var e,i,n,r,a,o,s,l=" \r\n\t",h=[],c=0,u=0,p=function(){e&&('"'===i.substr(0,1)&&(i=i.substr(1,i.length-2)),i&&s.push(i),"-"===e.substr(0,1)&&(r=e.indexOf("-",1)+1)>0&&(n=e.substr(0,r),e=e.substr(r)),h.push({prefix:n,method:e.toLowerCase(),value:a,args:s,image:null})),s=[],e=n=i=a=""};return s=[],e=n=i=a="",t.split("").forEach(function(t){if(!(0===c&&l.indexOf(t)>-1)){switch(t){case'"':o?o===t&&(o=null):o=t;break;case"(":if(o)break;if(0===c)return c=1,void(a+=t);u++;break;case")":if(o)break;if(1===c){if(0===u)return c=0,a+=t,void p();u--}break;case",":if(o)break;if(0===c)return void p();if(1===c&&0===u&&!e.match(/^url$/i))return s.push(i),i="",void(a+=t)}a+=t,0===c?e+=t:i+=t}}),p(),h}},{}],27:[function(t,e,i){function n(t){r.apply(this,arguments),this.type="linear"===t.args[0]?r.TYPES.LINEAR:r.TYPES.RADIAL}var r=t("./gradientcontainer");n.prototype=Object.create(r.prototype),e.exports=n},{"./gradientcontainer":9}],28:[function(t,e,i){function n(t){return new Promise(function(e,i){var n=new XMLHttpRequest;n.open("GET",t),n.onload=function(){200===n.status?e(n.responseText):i(new Error(n.statusText))},n.onerror=function(){i(new Error("Network Error"))},n.send()})}e.exports=n},{}]},{},[4])(4)})}).call(e,i(56))},function(t,e,i){},function(t,e,i){},function(t,e,i){(function(t){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(r){"use strict";if("object"===n(e)&&"object"===n(t))t.exports=r(i(1));else if("function"==typeof define&&define.amd)define(["chartiq"],r);else{if("undefined"==typeof window&&"undefined"==typeof self)throw new Error("Only CommonJS, RequireJS, and <script> tags supported for addOns.js.");var a="undefined"!=typeof window?window:self;r(a)}}(function(t){var e=t.CIQ;return e.ExtendedHours=function(t){var i=t.stx,n=t.filter;i||(i=t,n=!1);var r={};this.stx=i,this.stx.extendedHours=this,this.prepare=function(t,e){i.layout.extended=t;for(var n in i.layout.marketSessions)r.session={},i.chart.market.disableSession(n);if(i.layout.marketSessions={},t)if(e||(e=["pre","post"]),e.length)for(var a=0;a<e.length;a++)i.layout.marketSessions[e[a]]=!0;else i.layout.marketSessions=e;i.changeOccurred("layout");for(n in i.layout.marketSessions)r.session||(r.session={}),r.session[n]=i.canvasStyle("stx_market_session "+n),i.chart.market.disableSession(n,!0)},this.complete=function(t){if(!i.chart.market.market_def)return void(t&&t());n?(i.createDataSet(),i.draw(),t&&t()):i.newChart(i.chart.symbol,null,null,t)},this.set=function(t,e,i){this.prepare(t,e),this.complete(i)},this.stx.append("createYAxis",function(t){if(this.layout.extended){var i=t.chart;if(!e.ChartEngine.isDailyInterval(this.layout.interval)&&(r.divider=this.canvasStyle("stx_market_session divider"),r.session)){for(var n,a,o=i.market,s=[],l={},h=0;h<i.dataSegment.length;h++){var c=i.dataSegment[h];if(c&&c.DT){var u=null;if(o.market_def&&(!n||n<=c.DT)){a=o.getSession(c.DT,this.dataZone);n=o[!(""===a||this.layout.marketSessions&&this.layout.marketSessions[a])?"getNextOpen":"getNextClose"](c.DT,this.dataZone,this.dataZone)}var p=r.session[a];if(p&&(u=p.backgroundColor),l.color&&l.color!=u&&(s.push({start:l.start,end:l.end,color:l.color}),l={}),u){var d=this.layout.candleWidth;c.candleWidth&&(d=c.candleWidth),l.end=this.pixelFromBar(h,i)+d/2,l.start||0===l.start||(l.start=l.end-d+1),l.color=u}else l={}}}(l.start||0===l.start)&&s.push({start:l.start,end:l.end,color:l.color});var f=e.isTransparent(r.divider.backgroundColor),m=r.divider.width.replace(/px/g,"");for(var g in this.panels){var v=this.panels[g];if(!1!==v.shareChartXAxis&&!v.hidden){for(this.startClip(g),h=0;h<s.length;h++)i.context.fillStyle=s[h].color,!f&&s[h].start>i.left&&this.plotLine(s[h].start,s[h].start,v.bottom,v.top,r.divider.backgroundColor,"line",i.context,v,{pattern:"dashed",lineWidth:m}),i.context.fillRect(s[h].start,v.top,s[h].end-s[h].start,v.bottom-v.top),!f&&s[h].end<i.right&&this.plotLine(s[h].end,s[h].end,v.bottom,v.top,r.divider.backgroundColor,"line",i.context,v,{pattern:"dashed",lineWidth:m});this.endClip()}}}}})},e.Tooltip=function(t){function i(){if(this.huTooltip&&!(r.controls.crossX&&"none"==r.controls.crossX.style.display||r.controls.crossY&&"none"==r.controls.crossY.style.display)){var t=this.barFromPixel(this.cx);if(!this.chart.dataSegment[t])return void this.positionMarkers();if(!e.Marker.Tooltip.sameBar(this.chart.dataSegment[t],this.huTooltip.lastBar)||t==this.chart.dataSegment.length-1){var i=$(this.huTooltip.node);i.find("[auto]").remove(),i.find("stx-hu-tooltip-field-value").html();var h=this.chart.panel,c=h.yAxis,u={},p=[];if(p.push({member:"DT",display:"DT",panel:h,yAxis:c}),p.push({member:"Close",display:"Close",panel:h,yAxis:c}),u.DT=u.Close=1,a&&(p.push({member:"Open",display:"Open",panel:h,yAxis:c}),p.push({member:"High",display:"High",panel:h,yAxis:c}),p.push({member:"Low",display:"Low",panel:h,yAxis:c}),u.Open=u.High=u.Low=1),o&&(p.push({member:"Volume",display:"Volume",panel:null,yAxis:null}),u.Volume=1),s){var d=this.chart.seriesRenderers;for(var f in d){var m=d[f];h=this.panels[m.params.panel],c=m.params.yAxis,!c&&m.params.shareYAxis&&(c=h.yAxis);for(var g=0;g<m.seriesParams.length;g++){var v=m.seriesParams[g];!c&&v.shareYAxis&&(c=h.yAxis);var y=v.symbol,b=v.field;y?b&&y!=b&&(y=e.createObjectChainNames(y,b)[0]):y=b;var x=v.display||v.symbol||v.field;y&&!u[x]&&(p.push({member:y,display:x,panel:h,yAxis:c}),u[x]=1)}}}if(l)for(var w in this.layout.studies){h=this.panels[this.layout.studies[w].panel],c=h.yAxis;for(var C in this.layout.studies[w].outputMap)C&&!u[C]&&(p.push({member:C,display:C,panel:h,yAxis:c}),u[C]=1);u[w+"_hist"]||(p.push({member:w+"_hist",display:w+"_hist",panel:h,yAxis:c}),p.push({member:w+"_hist1",display:w+"_hist1",panel:h,yAxis:c}),p.push({member:w+"_hist2",display:w+"_hist2",panel:h,yAxis:c}),u[w+"_hist"]=1)}for(var S=0;S<p.length;S++){var T=p[S],_=T.member,k=T.display;h=T.panel,c=T.yAxis;var D=null;c&&(h!==h.chart.panel?c.decimalPlaces||0===c.decimalPlaces?D=c.decimalPlaces:(c.maxDecimalPlaces||0===c.maxDecimalPlaces)&&(D=c.maxDecimalPlaces):(D=Math.max(c.printDecimalPlaces,h.chart.decimalPlaces),(c.maxDecimalPlaces||0===c.maxDecimalPlaces)&&(D=Math.min(D,c.maxDecimalPlaces))));var M=k.replace(/^(Result )(.*)/,"$2"),E=this.chart.dataSegment[t][_];if(!E&&0!==E||"object"===(void 0===E?"undefined":n(E))&&"DT"!=_){var A=i.find('stx-hu-tooltip-field[field="'+M+'"]');if(A.length){""!==A.find("stx-hu-tooltip-field-name").html()&&A.find("stx-hu-tooltip-field-value").html("n/a")}}else{var P="";E.constructor==Number?P=c?c.originalPriceFormatter&&c.originalPriceFormatter.func?c.originalPriceFormatter.func(this,h,E,D):c.priceFormatter&&c.priceFormatter!=e.Comparison.priceFormat?c.priceFormatter(this,h,E,D):this.formatYAxisPrice(E,h,D,c):E:this.chart.dataSegment[t][_].constructor==Date?"DT"==_&&this.controls.floatDate&&this.controls.floatDate.innerHTML?P=e.ChartEngine.hideDates()?"N/A":this.controls.floatDate.innerHTML:(P=e.yyyymmdd(E),e.ChartEngine.isDailyInterval(this.layout.interval)||(P+=" "+E.toTimeString().substr(0,8))):P=E;var L=i.find('stx-hu-tooltip-field[field="'+M+'"]');if(L.length){L.find("stx-hu-tooltip-field-value").html(P);var O=L.find("stx-hu-tooltip-field-name");""===O.html()&&O.html(this.translateIf(M))}else $("<stx-hu-tooltip-field auto></stx-hu-tooltip-field>").append($("<stx-hu-tooltip-field-name>"+this.translateIf(M)+"</stx-hu-tooltip-field-name>")).append($("<stx-hu-tooltip-field-value>"+P+"</stx-hu-tooltip-field-value>")).appendTo(i)}}this.huTooltip.render()}}}var r=t.stx,a=t.ohl,o=t.volume,s=t.series,l=t.studies,h=t.showOverBarOnly,c=$(r.chart.container).find("stx-hu-tooltip")[0];c||(c=$("<stx-hu-tooltip></stx-hu-tooltip>").appendTo($(r.chart.container))[0]),e.Marker.Tooltip=function(t){this.className||(this.className="CIQ.Marker.Tooltip"),t.label="tooltip",e.Marker.call(this,t)},e.Marker.Tooltip.ciqInheritsFrom(e.Marker,!1),e.Marker.Tooltip.sameBar=function(t,e){return!(!t||!e)&&(+t.DT==+e.DT&&(t.Close==e.Close&&(t.Open==e.Open&&t.Volume==e.Volume)))},e.Marker.Tooltip.placementFunction=function(t){for(var i=t.stx,n=0;n<t.arr.length;n++){var r,a,o,s=t.arr[n],l=i.barFromPixel(i.cx),c=i.chart.dataSegment[l],u=!0;if("undefined"!=c&&c&&c.DT&&(r=!0,c.High&&(a=i.pixelFromPrice(c.High)),c.Low&&(o=i.pixelFromPrice(c.Low)),i.highLowBars[i.layout.chartType]||c.Close&&(a=i.pixelFromPrice(c.Close)-15,o=i.pixelFromPrice(c.Close)+15),!h||i.cy>=a&&i.cy<=o||(u=!1)),i.controls.crossX&&"none"==i.controls.crossX.style.display||i.controls.crossY&&"none"==i.controls.crossY.style.display||!(e.ChartEngine.insideChart&&i.layout.crosshair&&i.displayCrosshairs)||i.overXAxis||i.overYAxis||i.openDialog||i.activeDrawing||i.grabbingScreen||!r||!u)return s.node.style.left="-50000px",s.node.style.right="auto",void(s.lastBar={});if(e.Marker.Tooltip.sameBar(i.chart.dataSegment[l],s.lastBar)&&l!=i.chart.dataSegment.length-1)return;s.lastBar=i.chart.dataSegment[l],parseInt(getComputedStyle(s.node).width,10)+30<e.ChartEngine.crosshairX?(s.node.style.left="auto",s.node.style.right=Math.round(i.container.clientWidth-i.pixelFromBar(l)+30)+"px"):(s.node.style.left=Math.round(i.pixelFromBar(l)+30)+"px",s.node.style.right="auto"),s.node.style.top=Math.round(e.ChartEngine.crosshairY-i.top-parseInt(getComputedStyle(s.node).height,10)/2)+"px"}i.doDisplayCrosshairs()},e.ChartEngine.prototype.append("undisplayCrosshairs",function(){var t=this.huTooltip;if(t&&t.node){var e=$(t.node);e&&e[0]&&(e[0].style.left="-50000px",e[0].style.right="auto",t.lastBar={})}}),e.ChartEngine.prototype.append("deleteHighlighted",function(){this.huTooltip.lastBar={},this.headsUpHR()}),e.ChartEngine.prototype.append("headsUpHR",i),e.ChartEngine.prototype.append("createDataSegment",i),r.huTooltip=new e.Marker.Tooltip({stx:r,xPositioner:"bar",chartContainer:!0,node:c})},e.InactivityTimer=function(t){t.minutes&&((!t.interval||t.interval<0)&&(t.interval=60),this.stx=t.stx,this.timeout=t.minutes,this.interval=t.interval,this.wakeCB=t.wakeCB,this.sleepCB=t.sleepCB,this.sleepTimer=null,this.sleeping=!1,this.last=(new Date).getTime(),this.wakeChart=function(){window.clearTimeout(this.sleepTimer),this.last=(new Date).getTime(),this.sleeping&&(this.stx.quoteDriver&&this.stx.quoteDriver.updateChartLoop(),this.sleeping=!1,e.unappendClassName(document.body,"ciq-sleeping")),this.sleepTimer=window.setTimeout(this.sleepChart.bind(this),6e4*this.timeout),this.wakeCB&&wakeCB()},this.sleepChart=function(){this.sleeping||(this.stx.quoteDriver&&this.stx.quoteDriver.updateChartLoop(this.interval),this.sleeping=!0,e.appendClassName(document.body,"ciq-sleeping")),this.sleepCB&&sleepCB()},$(document).on("mousemove mousedown touchstart touchmove pointerdown pointermove keydown wheel",$("body"),function(t){return function(e){t.wakeChart()}}(this)),this.wakeChart())},e.Animation=function(t,i,n){function r(){c=!1,u=null}var a={stayPut:!1,ticksFromEdgeOfScreen:5,granularity:1e6};i=e.extend(a,i),a.tension&&(t.chart.tension=i.tension),t.tickAnimator=n||new e.EaseMachine(Math.easeOutCubic,1e3);var o=new e.EaseMachine(Math.easeInOutCubic,200),s=["#0298d3","#19bcfc","#5dcffc","#9ee3ff"],l=0,h=0,c=!1,u=null;t.addEventListener(["symbolChange","layout"],function(t){r()}),t.prepend("appendMasterData",function(t,n,r){var a=this;if(n||(n=a.chart),"ohlc"===this.layout.aggregationType||null===this.layout.aggregationType){var o=function(){n.animatingHorizontalScroll&&(n.animatingHorizontalScroll=!1,a.micropixels=a.nextMicroPixels=a.previousMicroPixels,n.lastTickOffset=0),n.closePendingAnimation&&(n.masterData[n.masterData.length-1].Close=n.closePendingAnimation,n.closePendingAnimation=0)};if(!a.tickAnimator)return void console.error("Animation plug-in can not run because the tickAnimator has not be declared. See instructions in animation.js");var s=a.tickAnimator;if(null===n||void 0===n)return;if(void 0!==r&&r.animationEntry)return;if(this.prevSymbol!=n.symbol&&(this.prevQuote=0,n.closePendingAnimation=0,this.prevSymbol=n.symbol),o(),s.stop(),t.length>2)return;var l=e.clone(r);l||(l={}),l.animationEntry=!0,l.bypassGovernor=!0,l.noCreateDataSet=!1,l.firstLoop=!0;var h=this.chart.symbol,p=this.layout.periodicity,d=this.layout.interval,f=this.layout.timeUnit,m=t[t.length-1];this.prevQuote=this.currentQuote();var g=!1;if(1==p&&2==t.length&&(this.prevQuote=t[0],t.splice(1,1)),!m||!this.prevQuote)return!1;var v=this.dataZone;if(this.extendedHours&&n.market.market_def){var y=m.DT;if(e.ChartEngine.isDailyInterval(d))c=!n.market.isMarketDate(y);else if(!u||u<=y){var b=n.market.getSession(y,v);c=!(""===b||this.layout.marketSessions&&this.layout.marketSessions[b]),u=n.market[c?"getNextOpen":"getNextClose"](y,v,v)}if(c)return this.draw(),!1}var x=p;"second"==d||"second"==f?x*=1e3:"minute"!=d&&"minute"!=f||(x*=6e4),isNaN(d)||(x*=d),g="day"==d||"day"==f?m.DT.getDate()!=this.prevQuote.DT.getDate():"week"==d||"week"==f?m.DT.getDate()>=this.prevQuote.DT.getDate()+7:"month"==d||"month"==f?m.DT.getMonth()!=this.prevQuote.DT.getMonth():m.DT.getTime()>=this.prevQuote.DT.getTime()+x;var w=!this.standaloneBars[this.layout.chartType],C=0;if(g){if(!this.animations.zoom.hasCompleted)return!1;var S=this.layout.candleWidth;if(n.scroll<=n.maxTicks)for(;this.micropixels>0;)n.scroll++,this.micropixels-=S;n.scroll<=n.maxTicks?(this.previousMicroPixels=this.micropixels,this.nextMicroPixels=this.micropixels+S,C=-1*S,n.dataSegment.length<n.maxTicks-i.ticksFromEdgeOfScreen&&!i.stayPut&&(this.nextMicroPixels=this.micropixels,n.scroll++),n.animatingHorizontalScroll=w,n.previousDataSetLength=n.dataSet.length):n.scroll++}n.closePendingAnimation=m.Close;var T=g&&!w?m.Open:this.prevQuote.Close;return s.run(function(t,r,c){return function(u){var m=u.Close;if(!n.dataSet.length||h!=n.symbol||p!=a.layout.periodicity||d!=a.layout.interval||f!=a.layout.timeUnit)return o(),void s.stop();var g=e.clone(t);g.Close=Math.round(m*i.granularity)/i.granularity,c?(g.Open||0===g.Open||(g.Open=g.Close),g.High||0===g.High||(g.High=Math.max(g.Open,g.Close)),g.Low||0===g.Low||(g.Low=Math.min(g.Open,g.Close))):(t.Close>r.High&&(g.High=g.Close),t.Close<r.Low&&(g.Low=g.Close)),n.animatingHorizontalScroll&&(a.micropixels=u.micropixels,n.lastTickOffset=u.lineOffset),l.updateDataSegmentInPlace=!s.hasCompleted,a.appendMasterData([g],n,l),l.firstLoop=!1,s.hasCompleted&&o()}}(m,e.clone(this.prevQuote),g),{Close:T,micropixels:this.nextMicroPixels,lineOffset:C},{Close:m.Close,micropixels:this.micropixels,lineOffset:0}),!0}}),t.prepend("renderYAxis",function(t){if(!this.grabbingScreen){var e,i=t.panel,n=i.yaxisRHS.concat(i.yaxisLHS);for(e=0;e<n.length;e++){var r=n[e],a=null,s=null;if(i.yAxis===r){if(t.prevLowValue||0===t.prevLowValue||(t.prevLowValue=t.animatedLow=t.lowValue),t.prevHighValue||0===t.prevHighValue||(t.prevHighValue=t.animatedHigh=t.highValue),t.prevLowValue!=t.lowValue||t.prevHighValue!=t.highValue){t.animatingVerticalScroll=!0,o.stop();var l=t.prevLowValue,h=t.prevHighValue;return t.prevLowValue=t.lowValue,t.prevHighValue=t.highValue,o.run(function(e){return function(i){t.animatedLow=i.low,t.animatedHigh=i.high,e.draw()}}(this),{low:l,high:h},{low:t.lowValue,high:t.highValue}),!0}t.animatingVerticalScroll=!1,a=t.animatedLow,s=t.animatedHigh}this.calculateYAxisRange(i,r,a,s)}var c={};for(e=0;e<n.length;e++)c.yAxis=n[e],this.createYAxis(i,c),this.drawYAxis(i,c);return this.drawPanels(),!0}}),t.prepend("draw",function(){if(this.chart.animatingVerticalScroll)return this.renderYAxis(this.chart),!0}),t.append("draw",function(){if(!c&&this.chart.dataSet&&this.chart.dataSet.length&&!this.standaloneBars[this.layout.chartType]){h%20==0&&(l++,h=0),h++;var t=this.chart.context,e=this.chart.panel,i=this.currentQuote();if(!i)return;var n=i.Close,r=this.pixelFromTick(i.tick,this.chart);this.chart.lastTickOffset&&(r+=this.chart.lastTickOffset);var a=this.pixelFromPrice(n,e);this.chart.yAxis.left>r&&this.chart.yAxis.top<=a&&this.chart.yAxis.bottom>=a&&(l>=s.length&&(l=0),t.beginPath(),t.moveTo(r,a),t.arc(r,a,2+1.07*l,0,2*Math.PI,!1),t.fillStyle=s[l],t.fill())}})},e.RangeSlider=function(t){var i=t.stx;i.slider=this;var n=t.height?t.height:95,r=t.chartContainer?$(t.chartContainer):$(t.stx.container),a=$('<div class="ciq-slider"></div>'),o=$('<div class="chartContainer" id="sliderContainer"></div>');a.insertAfter(r.parent()).append(o),a.css("height",n+"px").css("padding-top","5px").hide(),o.css("height",a.height()+"px"),o.prop("dimensionlessCanvas",!0);var s=this.slider=new e.ChartEngine({container:o[0],preferences:{labels:!1,whitespace:0}});s.xaxisHeight=30,s.manageTouchAndMouse=!1,s.chart.yAxis.drawCurrentPriceLabel=!1,s.chart.baseline.userLevel=!1,s.initializeChart();var l=s.chart.panel.subholder,h=i.canvasStyle("stx_range_slider shading");this.display=function(t){a[t?"show":"hide"](),i.resizeChart(),t&&(s.resizeChart(),s.initializeChart(),s.draw(),this.drawSlider())},this.setSymbol=function(t){s.chart.symbol=t,s.adjustPanelPositions()},this.acceptLayoutChange=function(t){var n=!1;s.layout.rangeSlider!==t.rangeSlider&&i.slider.display(t.rangeSlider),["chartType","aggregationType","periodicity","interval","timeUnit","chartScale","extended","marketSessions","rangeSlider","kagi","range","renko","priceLines","pandf"].forEach(function(i){e.equals(s.layout[i],t[i])||(s.layout[i]=t[i],n=!0)}),a.is(":visible")&&n&&(s.draw(),this.drawSlider())},this.copyData=function(t){t.dataSet&&(s.chart.symbol=t.symbol,s.masterData=s.chart.masterData=t.masterData,s.chart.dataSet=t.dataSet,s.chart.state=t.state,s.chart.baseline.defaultLevel=t.baseline.actualLevel,s.chart.scroll=s.chart.dataSet.length,s.chart.maxTicks=s.chart.scroll+1,s.layout.candleWidth=t.width/(s.chart.maxTicks+1),s.draw(),this.drawSlider())},this.drawSlider=function(){if(i.chart.dataSet&&i.chart.dataSet.length){var t=i.chart.panel.subholder,e=s.chart.context,n=s.chart.segmentImage,r=s.layout.candleWidth/2,a=s.tickLeft=Math.max(i.tickFromPixel(t.offsetLeft),0),o=s.tickRight=Math.min(a+i.chart.maxTicks-2,i.chart.dataSet.length-1),c=s.pixelLeft=s.pixelFromTick(a)-(n?n[a].candleWidth/2:r),u=s.pixelRight=s.pixelFromTick(o)+(n?n[o].candleWidth/2:r);e.save(),e.beginPath(),e.fillStyle=h.backgroundColor,e.fillRect(l.offsetLeft,l.offsetTop,c-l.offsetLeft,l.offsetHeight),e.fillRect(l.offsetWidth,l.offsetTop,u-l.offsetWidth,l.offsetHeight),e.strokeStyle=h.borderColor,e.lineWidth=parseInt(h.borderWidth,10),e.moveTo(c,l.offsetTop),e.lineTo(c,l.offsetTop+l.offsetHeight),e.moveTo(u,l.offsetTop),e.lineTo(u,l.offsetTop+l.offsetHeight),e.stroke(),e.beginPath(),e.lineWidth=parseInt(h.width,10),e.lineCap="round",e.moveTo(c,l.offsetTop+l.offsetHeight/4),e.lineTo(c,l.offsetTop+3*l.offsetHeight/4),e.moveTo(u,l.offsetTop+l.offsetHeight/4),e.lineTo(u,l.offsetTop+3*l.offsetHeight/4),e.stroke(),e.restore()}},i.addEventListener("layout",function(t){t.stx.slider.acceptLayoutChange(t.stx.layout)}),i.addEventListener("symbolChange",function(t){"master"==t.action&&t.stx.slider.setSymbol(t.symbol)}),i.addEventListener("symbolImport",function(t){"master"==t.action&&t.stx.slider.setSymbol(t.symbol),t.stx.slider.acceptLayoutChange(t.stx.layout)}),i.addEventListener("theme",function(t){s.clearPixelCache(),s.styles={},s.chart.container.style.backgroundColor="";var i=new e.ThemeHelper({stx:t.stx});i.params.stx=s,i.update()}),i.append("createDataSet",function(){this.slider.copyData(this.chart)}),i.append("draw",function(){a.is(":visible")&&s.chart.dataSet&&(s.chart.baseline.defaultLevel=this.chart.baseline.actualLevel,s.draw(),this.slider.drawSlider())}),i.prepend("resizeChart",function(){var t=r.parent(),e=t.height()-r.height();t.height(t.parent().height()-(a.is(":visible")?n:0)),r.height(t.height()-e)}),$(l).on("mousedown touchstart pointerdown",function(t){var i=t.offsetX||t.originalEvent.layerX;if(i||0===i){var n=$(s);n.prop("startDrag",i).prop("startPixelLeft",s.pixelLeft).prop("startPixelRight",s.pixelRight);var r=parseInt(h.borderLeftWidth,10);i<s.pixelRight-r&&n.prop("needsLeft",!0),i>s.pixelLeft+r&&n.prop("needsRight",!0),e.touchDevice||e.appendClassName(t.target,"stx-drag-chart")}}),$(l).on("mouseup mouseout touchend pointerup",function(t){e.unappendClassName(t.target,"stx-drag-chart"),$(s).prop("startDrag",null).prop("needsLeft",!1).prop("needsRight",!1)}),$(l).on("mousemove touchmove pointermove",function(t){var e=$(s),n=e.prop("startDrag");if(n||0===n){var r=t.originalEvent.touches,a=r&&r.length?r[0].pageX-t.target.offsetLeft:t.offsetX;if(a||0===a){a-=n;var o=s.tickLeft,l=s.tickRight,h=e.prop("startPixelLeft"),c=e.prop("startPixelRight"),u=e.prop("needsLeft"),p=e.prop("needsRight");if(u)h+a<0&&(a=-h),o=s.tickFromPixel(h+a),p&&(l=s.tickRight+o-s.tickLeft);else{if(!p)return;l=Math.min(s.tickFromPixel(c+a),i.chart.dataSet.length-1)}var d=i.chart.width/(l-o+1);l>=o&&d>=i.minimumCandleWidth&&(s.tickLeft=o,s.tickRight=l,i.chart.scroll=i.chart.dataSet.length-o,u&&p||i.setCandleWidth(d),i.micropixels=0,i.draw())}}}),this.copyData(i.chart)},t})}).call(e,i(71)(t))},function(t,e,i){(function(t){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(r){"use strict";if("object"===n(e)&&"object"===n(t))t.exports=r(i(1));else if("function"==typeof define&&define.amd)define(["chartiq"],r);else{if("undefined"==typeof window&&"undefined"==typeof self)throw new Error("Only CommonJS, RequireJS, and <script> tags supported for translations.js.");var a="undefined"!=typeof window?window:self;r(a)}}(function(t){var e=t.CIQ;return e.I18N.languages={en:"English",ar:"عربى",fr:"Français",de:"Deutsche",hu:"Magyar",it:"Italiano",pt:"Português",ru:"русский",es:"Español",zh:"中文",ja:"日本語"},e.I18N.csv=e.I18N.hereDoc(function(){}),e.I18N.wordLists={en:{}},t})}).call(e,i(71)(t))},function(t,e,i){(function(t){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(r){if("object"===n(e)&&"object"===n(t))t.exports=r(i(136),i(1));else if("function"==typeof define&&define.amd)define(["thirdparty/iscroll","chartiq"],r);else{if("undefined"==typeof window&&"undefined"==typeof self)throw new Error("Only CommonJS, RequireJS, and <script> tags supported for plugin.js.");var a="undefined"!=typeof window?window:self;r(a,a)}}(function(t,e){var i=e.CIQ,n=e.$$,r=t.IScroll5;return i.iscroll=function(){},i.iscroll.scrollers=[],i.iscroll.newScroller=function(t,e){e||(e={tap:!0,scrollbars:!0,interactiveScrollbars:!0,mouseWheel:!0});var n=new r(t,e);return n.utils=r.utils,i.iscroll.scrollers.push(n),n},i.iscroll.refresh=function(){for(var t=0;t<i.iscroll.scrollers.length;t++){i.iscroll.scrollers[t].refresh()}},i.DialogManager=function(){},i.DialogManager.useOverlay=!1,i.DialogManager.stack=[],i.DialogManager.modalBegin=function(){i.MenuManager&&(i.MenuManager.menusDisabledDialog=!0);for(var t=0;t<i.ChartEngine.registeredContainers.length;t++){i.ChartEngine.registeredContainers[t].stx.modalBegin()}},i.DialogManager.modalEnd=function(){i.MenuManager&&(i.MenuManager.menusDisabledDialog=!1);for(var t=0;t<i.ChartEngine.registeredContainers.length;t++){i.ChartEngine.registeredContainers[t].stx.modalEnd()}},i.DialogManager.displayDialog=function(t){i.hideKeyboard(),i.DialogManager.modalBegin(),i.DialogManager.useOverlay&&!i.DialogManager.bodyOverlay&&(i.DialogManager.bodyOverlay=i.newChild(document.body,"DIV","stxDialogOverlay")),i.DialogManager.useOverlay&&(i.DialogManager.bodyOverlay.style.display="block");var e=t;"string"==typeof t&&(e=n(t)),e.style.display="block",i.DialogManager.stack.push(e)},i.DialogManager.dismissDialog=function(){document.activeElement.blur();var t=i.DialogManager.stack.pop();t&&(t.style.display="none",t.colorPickerDiv&&(t.colorPickerDiv.style.display="none"),i.DialogManager.stack.length||(i.DialogManager.bodyOverlay&&"block"==i.DialogManager.bodyOverlay.style.display&&(i.DialogManager.bodyOverlay.style.display="none"),i.DialogManager.modalEnd()),i.fixScreen())},e})}).call(e,i(71)(t))},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(54),s=i(1),l=(i.n(s),"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}),h=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),c=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},u=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),h(e,[{key:"attachedCallback",value:function(){this.attached||(c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attachedCallback",this).call(this),this.nameValueStore=new s.CIQ.NameValueStore,this.attached=!0)}},{key:"setSleepAmount",value:function(t,e){this.sleepAmount={units:t,unitType:e}}},{key:"setNameValueStore",value:function(t){this.nameValueStore=t}},{key:"makeMarker",value:function(){this.markerExists||(new s.CIQ.Marker({stx:this.context.stx,xPositioner:"none",label:"advertisement",permanent:!0,node:this.node[0]}),this.markerExists=!0)}},{key:"show",value:function(t,e){function i(){r.makeMarker(),r.node.css({display:"block"}),r.node.find(r.selector).addClass("ciq-show"),r.node.css({height:"0px"}),setTimeout(function(){r.node.css({height:r.node[0].scrollHeight+"px"})},0)}if(this.selector){this.node.find(this.selector).removeClass("ciq-show")}if(this.selector=t,!this.selector){var n=this.node.find("div:first-of-type");this.selector="."+n.attr("class")}this.ignoreSleep=e;var r=this;e?i():this.nameValueStore.get("cq-advertisement",function(t,e){if(!t){e&&"object"===(void 0===e?"undefined":l(e))||(e={});var n=e[r.selector];n&&n>Date.now()||i()}})}},{key:"close",value:function(){this.node.css({display:"none"});var t=this;this.nameValueStore.get("cq-advertisement",function(e,i){if(!e){var n=new Date;t.sleepAmount||(t.sleepAmount={units:1,unitType:"day"});var r=t.sleepAmount.units,a=t.sleepAmount.unitType;"minute"===a?n.setMinutes(n.getMinutes()+r):"hour"===a?n.setHours(n.getHours()+r):"day"===a?n.setDate(n.getDate()+r):"week"===a?n.setDate(n.getDate()+7*r):"month"===a&&n.setMonth(n.getMonth()+r);var o=n.getTime();i&&"object"===(void 0===i?"undefined":l(i))||(i={}),i[t.selector]=o,t.nameValueStore.set("cq-advertisement",i)}})}},{key:"watchForRemoteClose",value:function(t){t||(t=1e3);var e=this;setInterval(function(){"none"!==e.node.css("display")&&e.nameValueStore.get("cq-advertisement",function(t,i){if(!t){i&&"object"===(void 0===i?"undefined":l(i))||(i={});var n=i[e.selector];n&&n>Date.now()&&e.close()}})},t)}}]),e}(o.a);document.registerElement("cq-advertisement",u)},function(t,e){/**
 * @license
 * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
 */
!function(){window.WebComponents=window.WebComponents||{flags:{}};var t=document.querySelector('script[src*="webcomponents-lite.js"]'),e={};if(!e.noOpts){if(location.search.slice(1).split("&").forEach(function(t){var i,n=t.split("=");n[0]&&(i=n[0].match(/wc-(.+)/))&&(e[i[1]]=n[1]||!0)}),t)for(var i,n=0;i=t.attributes[n];n++)"src"!==i.name&&(e[i.name]=i.value||!0);if(e.log&&e.log.split){var r=e.log.split(",");e.log={},r.forEach(function(t){e.log[t]=!0})}else e.log={}}e.register&&(window.CustomElements=window.CustomElements||{flags:{}},window.CustomElements.flags.register=e.register),WebComponents.flags=e}(),function(t){"use strict";function e(t){return void 0!==u[t]}function i(){s.call(this),this._isInvalid=!0}function n(t){return""==t&&i.call(this),t.toLowerCase()}function r(t){var e=t.charCodeAt(0);return e>32&&127>e&&-1==[34,35,60,62,63,96].indexOf(e)?t:encodeURIComponent(t)}function a(t){var e=t.charCodeAt(0);return e>32&&127>e&&-1==[34,35,60,62,96].indexOf(e)?t:encodeURIComponent(t)}function o(t,o,s){function l(t){b.push(t)}var h=o||"scheme start",c=0,g="",v=!1,y=!1,b=[];t:for(;(t[c-1]!=d||0==c)&&!this._isInvalid;){var x=t[c];switch(h){case"scheme start":if(!x||!f.test(x)){if(o){l("Invalid scheme.");break t}g="",h="no scheme";continue}g+=x.toLowerCase(),h="scheme";break;case"scheme":if(x&&m.test(x))g+=x.toLowerCase();else{if(":"!=x){if(o){if(d==x)break t;l("Code point not allowed in scheme: "+x);break t}g="",c=0,h="no scheme";continue}if(this._scheme=g,g="",o)break t;e(this._scheme)&&(this._isRelative=!0),h="file"==this._scheme?"relative":this._isRelative&&s&&s._scheme==this._scheme?"relative or authority":this._isRelative?"authority first slash":"scheme data"}break;case"scheme data":"?"==x?(this._query="?",h="query"):"#"==x?(this._fragment="#",h="fragment"):d!=x&&"\t"!=x&&"\n"!=x&&"\r"!=x&&(this._schemeData+=r(x));break;case"no scheme":if(s&&e(s._scheme)){h="relative";continue}l("Missing scheme."),i.call(this);break;case"relative or authority":if("/"!=x||"/"!=t[c+1]){l("Expected /, got: "+x),h="relative";continue}h="authority ignore slashes";break;case"relative":if(this._isRelative=!0,"file"!=this._scheme&&(this._scheme=s._scheme),d==x){this._host=s._host,this._port=s._port,this._path=s._path.slice(),this._query=s._query,this._username=s._username,this._password=s._password;break t}if("/"==x||"\\"==x)"\\"==x&&l("\\ is an invalid code point."),h="relative slash";else if("?"==x)this._host=s._host,this._port=s._port,this._path=s._path.slice(),this._query="?",this._username=s._username,this._password=s._password,h="query";else{if("#"!=x){var w=t[c+1],C=t[c+2];("file"!=this._scheme||!f.test(x)||":"!=w&&"|"!=w||d!=C&&"/"!=C&&"\\"!=C&&"?"!=C&&"#"!=C)&&(this._host=s._host,this._port=s._port,this._username=s._username,this._password=s._password,this._path=s._path.slice(),this._path.pop()),h="relative path";continue}this._host=s._host,this._port=s._port,this._path=s._path.slice(),this._query=s._query,this._fragment="#",this._username=s._username,this._password=s._password,h="fragment"}break;case"relative slash":if("/"!=x&&"\\"!=x){"file"!=this._scheme&&(this._host=s._host,this._port=s._port,this._username=s._username,this._password=s._password),h="relative path";continue}"\\"==x&&l("\\ is an invalid code point."),h="file"==this._scheme?"file host":"authority ignore slashes";break;case"authority first slash":if("/"!=x){l("Expected '/', got: "+x),h="authority ignore slashes";continue}h="authority second slash";break;case"authority second slash":if(h="authority ignore slashes","/"!=x){l("Expected '/', got: "+x);continue}break;case"authority ignore slashes":if("/"!=x&&"\\"!=x){h="authority";continue}l("Expected authority, got: "+x);break;case"authority":if("@"==x){v&&(l("@ already seen."),g+="%40"),v=!0;for(var S=0;S<g.length;S++){var T=g[S];if("\t"!=T&&"\n"!=T&&"\r"!=T)if(":"!=T||null!==this._password){var _=r(T);null!==this._password?this._password+=_:this._username+=_}else this._password="";else l("Invalid whitespace in authority.")}g=""}else{if(d==x||"/"==x||"\\"==x||"?"==x||"#"==x){c-=g.length,g="",h="host";continue}g+=x}break;case"file host":if(d==x||"/"==x||"\\"==x||"?"==x||"#"==x){2!=g.length||!f.test(g[0])||":"!=g[1]&&"|"!=g[1]?0==g.length?h="relative path start":(this._host=n.call(this,g),g="",h="relative path start"):h="relative path";continue}"\t"==x||"\n"==x||"\r"==x?l("Invalid whitespace in file host."):g+=x;break;case"host":case"hostname":if(":"!=x||y){if(d==x||"/"==x||"\\"==x||"?"==x||"#"==x){if(this._host=n.call(this,g),g="",h="relative path start",o)break t;continue}"\t"!=x&&"\n"!=x&&"\r"!=x?("["==x?y=!0:"]"==x&&(y=!1),g+=x):l("Invalid code point in host/hostname: "+x)}else if(this._host=n.call(this,g),g="",h="port","hostname"==o)break t;break;case"port":if(/[0-9]/.test(x))g+=x;else{if(d==x||"/"==x||"\\"==x||"?"==x||"#"==x||o){if(""!=g){var k=parseInt(g,10);k!=u[this._scheme]&&(this._port=k+""),g=""}if(o)break t;h="relative path start";continue}"\t"==x||"\n"==x||"\r"==x?l("Invalid code point in port: "+x):i.call(this)}break;case"relative path start":if("\\"==x&&l("'\\' not allowed in path."),h="relative path","/"!=x&&"\\"!=x)continue;break;case"relative path":if(d!=x&&"/"!=x&&"\\"!=x&&(o||"?"!=x&&"#"!=x))"\t"!=x&&"\n"!=x&&"\r"!=x&&(g+=r(x));else{"\\"==x&&l("\\ not allowed in relative path.");var D;(D=p[g.toLowerCase()])&&(g=D),".."==g?(this._path.pop(),"/"!=x&&"\\"!=x&&this._path.push("")):"."==g&&"/"!=x&&"\\"!=x?this._path.push(""):"."!=g&&("file"==this._scheme&&0==this._path.length&&2==g.length&&f.test(g[0])&&"|"==g[1]&&(g=g[0]+":"),this._path.push(g)),g="","?"==x?(this._query="?",h="query"):"#"==x&&(this._fragment="#",h="fragment")}break;case"query":o||"#"!=x?d!=x&&"\t"!=x&&"\n"!=x&&"\r"!=x&&(this._query+=a(x)):(this._fragment="#",h="fragment");break;case"fragment":d!=x&&"\t"!=x&&"\n"!=x&&"\r"!=x&&(this._fragment+=x)}c++}}function s(){this._scheme="",this._schemeData="",this._username="",this._password=null,this._host="",this._port="",this._path=[],this._query="",this._fragment="",this._isInvalid=!1,this._isRelative=!1}function l(t,e){void 0===e||e instanceof l||(e=new l(String(e))),this._url=t,s.call(this);var i=t.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,"");o.call(this,i,null,e)}var h=!1;if(!t.forceJURL)try{var c=new URL("b","http://a");c.pathname="c%20d",h="http://a/c%20d"===c.href}catch(t){}if(!h){var u=Object.create(null);u.ftp=21,u.file=0,u.gopher=70,u.http=80,u.https=443,u.ws=80,u.wss=443;var p=Object.create(null);p["%2e"]=".",p[".%2e"]="..",p["%2e."]="..",p["%2e%2e"]="..";var d=void 0,f=/[a-zA-Z]/,m=/[a-zA-Z0-9\+\-\.]/;l.prototype={toString:function(){return this.href},get href(){if(this._isInvalid)return this._url;var t="";return""==this._username&&null==this._password||(t=this._username+(null!=this._password?":"+this._password:"")+"@"),this.protocol+(this._isRelative?"//"+t+this.host:"")+this.pathname+this._query+this._fragment},set href(t){s.call(this),o.call(this,t)},get protocol(){return this._scheme+":"},set protocol(t){this._isInvalid||o.call(this,t+":","scheme start")},get host(){return this._isInvalid?"":this._port?this._host+":"+this._port:this._host},set host(t){!this._isInvalid&&this._isRelative&&o.call(this,t,"host")},get hostname(){return this._host},set hostname(t){!this._isInvalid&&this._isRelative&&o.call(this,t,"hostname")},get port(){return this._port},set port(t){!this._isInvalid&&this._isRelative&&o.call(this,t,"port")},get pathname(){return this._isInvalid?"":this._isRelative?"/"+this._path.join("/"):this._schemeData},set pathname(t){!this._isInvalid&&this._isRelative&&(this._path=[],o.call(this,t,"relative path start"))},get search(){return this._isInvalid||!this._query||"?"==this._query?"":this._query},set search(t){!this._isInvalid&&this._isRelative&&(this._query="?","?"==t[0]&&(t=t.slice(1)),o.call(this,t,"query"))},get hash(){return this._isInvalid||!this._fragment||"#"==this._fragment?"":this._fragment},set hash(t){this._isInvalid||(this._fragment="#","#"==t[0]&&(t=t.slice(1)),o.call(this,t,"fragment"))},get origin(){var t;if(this._isInvalid||!this._scheme)return"";switch(this._scheme){case"data":case"file":case"javascript":case"mailto":return"null"}return t=this.host,t?this._scheme+"://"+t:""}};var g=t.URL;g&&(l.createObjectURL=function(t){return g.createObjectURL.apply(g,arguments)},l.revokeObjectURL=function(t){g.revokeObjectURL(t)}),t.URL=l}}(self),"undefined"==typeof WeakMap&&function(){var t=Object.defineProperty,e=Date.now()%1e9,i=function(){this.name="__st"+(1e9*Math.random()>>>0)+e+++"__"};i.prototype={set:function(e,i){var n=e[this.name];return n&&n[0]===e?n[1]=i:t(e,this.name,{value:[e,i],writable:!0}),this},get:function(t){var e;return(e=t[this.name])&&e[0]===t?e[1]:void 0},delete:function(t){var e=t[this.name];return!(!e||e[0]!==t)&&(e[0]=e[1]=void 0,!0)},has:function(t){var e=t[this.name];return!!e&&e[0]===t}},window.WeakMap=i}(),function(t){function e(t){x.push(t),b||(b=!0,m(n))}function i(t){return window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(t)||t}function n(){b=!1;var t=x;x=[],t.sort(function(t,e){return t.uid_-e.uid_});var e=!1;t.forEach(function(t){var i=t.takeRecords();r(t),i.length&&(t.callback_(i,t),e=!0)}),e&&n()}function r(t){t.nodes_.forEach(function(e){var i=g.get(e);i&&i.forEach(function(e){e.observer===t&&e.removeTransientObservers()})})}function a(t,e){for(var i=t;i;i=i.parentNode){var n=g.get(i);if(n)for(var r=0;r<n.length;r++){var a=n[r],o=a.options;if(i===t||o.subtree){var s=e(o);s&&a.enqueue(s)}}}}function o(t){this.callback_=t,this.nodes_=[],this.records_=[],this.uid_=++w}function s(t,e){this.type=t,this.target=e,this.addedNodes=[],this.removedNodes=[],this.previousSibling=null,this.nextSibling=null,this.attributeName=null,this.attributeNamespace=null,this.oldValue=null}function l(t){var e=new s(t.type,t.target);return e.addedNodes=t.addedNodes.slice(),e.removedNodes=t.removedNodes.slice(),e.previousSibling=t.previousSibling,e.nextSibling=t.nextSibling,e.attributeName=t.attributeName,e.attributeNamespace=t.attributeNamespace,e.oldValue=t.oldValue,e}function h(t,e){return C=new s(t,e)}function c(t){return S||(S=l(C),S.oldValue=t,S)}function u(){C=S=void 0}function p(t){return t===S||t===C}function d(t,e){return t===e?t:S&&p(t)?S:null}function f(t,e,i){this.observer=t,this.target=e,this.options=i,this.transientObservedNodes=[]}if(!t.JsMutationObserver){var m,g=new WeakMap;if(/Trident|Edge/.test(navigator.userAgent))m=setTimeout;else if(window.setImmediate)m=window.setImmediate;else{var v=[],y=String(Math.random());window.addEventListener("message",function(t){if(t.data===y){var e=v;v=[],e.forEach(function(t){t()})}}),m=function(t){v.push(t),window.postMessage(y,"*")}}var b=!1,x=[],w=0;o.prototype={observe:function(t,e){if(t=i(t),!e.childList&&!e.attributes&&!e.characterData||e.attributeOldValue&&!e.attributes||e.attributeFilter&&e.attributeFilter.length&&!e.attributes||e.characterDataOldValue&&!e.characterData)throw new SyntaxError;var n=g.get(t);n||g.set(t,n=[]);for(var r,a=0;a<n.length;a++)if(n[a].observer===this){r=n[a],r.removeListeners(),r.options=e;break}r||(r=new f(this,t,e),n.push(r),this.nodes_.push(t)),r.addListeners()},disconnect:function(){this.nodes_.forEach(function(t){for(var e=g.get(t),i=0;i<e.length;i++){var n=e[i];if(n.observer===this){n.removeListeners(),e.splice(i,1);break}}},this),this.records_=[]},takeRecords:function(){var t=this.records_;return this.records_=[],t}};var C,S;f.prototype={enqueue:function(t){var i=this.observer.records_,n=i.length;if(i.length>0){var r=i[n-1],a=d(r,t);if(a)return void(i[n-1]=a)}else e(this.observer);i[n]=t},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(t){var e=this.options;e.attributes&&t.addEventListener("DOMAttrModified",this,!0),e.characterData&&t.addEventListener("DOMCharacterDataModified",this,!0),e.childList&&t.addEventListener("DOMNodeInserted",this,!0),(e.childList||e.subtree)&&t.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(t){var e=this.options;e.attributes&&t.removeEventListener("DOMAttrModified",this,!0),e.characterData&&t.removeEventListener("DOMCharacterDataModified",this,!0),e.childList&&t.removeEventListener("DOMNodeInserted",this,!0),(e.childList||e.subtree)&&t.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(t){if(t!==this.target){this.addListeners_(t),this.transientObservedNodes.push(t);var e=g.get(t);e||g.set(t,e=[]),e.push(this)}},removeTransientObservers:function(){var t=this.transientObservedNodes;this.transientObservedNodes=[],t.forEach(function(t){this.removeListeners_(t);for(var e=g.get(t),i=0;i<e.length;i++)if(e[i]===this){e.splice(i,1);break}},this)},handleEvent:function(t){switch(t.stopImmediatePropagation(),t.type){case"DOMAttrModified":var e=t.attrName,i=t.relatedNode.namespaceURI,n=t.target,r=new h("attributes",n);r.attributeName=e,r.attributeNamespace=i;var o=t.attrChange===MutationEvent.ADDITION?null:t.prevValue;a(n,function(t){return!t.attributes||t.attributeFilter&&t.attributeFilter.length&&-1===t.attributeFilter.indexOf(e)&&-1===t.attributeFilter.indexOf(i)?void 0:t.attributeOldValue?c(o):r});break;case"DOMCharacterDataModified":var n=t.target,r=h("characterData",n),o=t.prevValue;a(n,function(t){return t.characterData?t.characterDataOldValue?c(o):r:void 0});break;case"DOMNodeRemoved":this.addTransientObserver(t.target);case"DOMNodeInserted":var s,l,p=t.target;"DOMNodeInserted"===t.type?(s=[p],l=[]):(s=[],l=[p]);var d=p.previousSibling,f=p.nextSibling,r=h("childList",t.target.parentNode);r.addedNodes=s,r.removedNodes=l,r.previousSibling=d,r.nextSibling=f,a(t.relatedNode,function(t){return t.childList?r:void 0})}u()}},t.JsMutationObserver=o,t.MutationObserver||(t.MutationObserver=o,o._isPolyfilled=!0)}}(self),function(){function t(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case" ":return"&nbsp;"}}function e(e){return e.replace(u,t)}var i="undefined"==typeof HTMLTemplateElement;/Trident/.test(navigator.userAgent)&&function(){var t=document.importNode;document.importNode=function(){var e=t.apply(document,arguments);if(e.nodeType===Node.DOCUMENT_FRAGMENT_NODE){var i=document.createDocumentFragment();return i.appendChild(e),i}return e}}();var n=function(){if(!i){var t=document.createElement("template"),e=document.createElement("template");e.content.appendChild(document.createElement("div")),t.content.appendChild(e);var n=t.cloneNode(!0);return 0===n.content.childNodes.length||0===n.content.firstChild.content.childNodes.length}}(),r="template",a=function(){};if(i){var o=document.implementation.createHTMLDocument("template"),s=!0,l=document.createElement("style");l.textContent=r+"{display:none;}";var h=document.head;h.insertBefore(l,h.firstElementChild),a.prototype=Object.create(HTMLElement.prototype),a.decorate=function(t){if(!t.content){t.content=o.createDocumentFragment();for(var i;i=t.firstChild;)t.content.appendChild(i);if(t.cloneNode=function(t){return a.cloneNode(this,t)},s)try{Object.defineProperty(t,"innerHTML",{get:function(){for(var t="",i=this.content.firstChild;i;i=i.nextSibling)t+=i.outerHTML||e(i.data);return t},set:function(t){for(o.body.innerHTML=t,a.bootstrap(o);this.content.firstChild;)this.content.removeChild(this.content.firstChild);for(;o.body.firstChild;)this.content.appendChild(o.body.firstChild)},configurable:!0})}catch(t){s=!1}a.bootstrap(t.content)}},a.bootstrap=function(t){for(var e,i=t.querySelectorAll(r),n=0,o=i.length;o>n&&(e=i[n]);n++)a.decorate(e)},document.addEventListener("DOMContentLoaded",function(){a.bootstrap(document)});var c=document.createElement;document.createElement=function(){"use strict";var t=c.apply(document,arguments);return"template"===t.localName&&a.decorate(t),t};var u=/[&\u00A0<>]/g}if(i||n){var p=Node.prototype.cloneNode;a.cloneNode=function(t,e){var i=p.call(t,!1);return this.decorate&&this.decorate(i),e&&(i.content.appendChild(p.call(t.content,!0)),this.fixClonedDom(i.content,t.content)),i},a.fixClonedDom=function(t,e){if(e.querySelectorAll)for(var i,n,a=e.querySelectorAll(r),o=t.querySelectorAll(r),s=0,l=o.length;l>s;s++)n=a[s],i=o[s],this.decorate&&this.decorate(n),i.parentNode.replaceChild(n.cloneNode(!0),i)};var d=document.importNode;Node.prototype.cloneNode=function(t){var e=p.call(this,t);return t&&a.fixClonedDom(e,this),e},document.importNode=function(t,e){if(t.localName===r)return a.cloneNode(t,e);var i=d.call(document,t,e);return e&&a.fixClonedDom(i,t),i},n&&(HTMLTemplateElement.prototype.cloneNode=function(t){return a.cloneNode(this,t)})}i&&(window.HTMLTemplateElement=a)}(),function(t){"use strict";if(!window.performance){var e=Date.now();window.performance={now:function(){return Date.now()-e}}}if(window.requestAnimationFrame||(window.requestAnimationFrame=function(){var t=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return t?function(e){return t(function(){e(performance.now())})}:function(t){return window.setTimeout(t,1e3/60)}}()),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(){return window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(t){clearTimeout(t)}}()),!function(){var t=document.createEvent("Event");return t.initEvent("foo",!0,!0),t.preventDefault(),t.defaultPrevented}()){var i=Event.prototype.preventDefault;Event.prototype.preventDefault=function(){this.cancelable&&(i.call(this),Object.defineProperty(this,"defaultPrevented",{get:function(){return!0},configurable:!0}))}}var n=/Trident/.test(navigator.userAgent);if((!window.CustomEvent||n&&"function"!=typeof window.CustomEvent)&&(window.CustomEvent=function(t,e){e=e||{};var i=document.createEvent("CustomEvent");return i.initCustomEvent(t,Boolean(e.bubbles),Boolean(e.cancelable),e.detail),i},window.CustomEvent.prototype=window.Event.prototype),!window.Event||n&&"function"!=typeof window.Event){var r=window.Event;window.Event=function(t,e){e=e||{};var i=document.createEvent("Event");return i.initEvent(t,Boolean(e.bubbles),Boolean(e.cancelable)),i},window.Event.prototype=r.prototype}}(window.WebComponents),window.HTMLImports=window.HTMLImports||{flags:{}},function(t){function e(t,e){e=e||f,n(function(){a(t,e)},e)}function i(t){return"complete"===t.readyState||t.readyState===v}function n(t,e){if(i(e))t&&t();else{var r=function i(){"complete"!==e.readyState&&e.readyState!==v||(e.removeEventListener(y,i),n(t,e))};e.addEventListener(y,r)}}function r(t){t.target.__loaded=!0}function a(t,e){function i(){l==h&&t&&t({allImports:s,loadedImports:c,errorImports:u})}function n(t){r(t),c.push(this),l++,i()}function a(t){u.push(this),l++,i()}var s=e.querySelectorAll("link[rel=import]"),l=0,h=s.length,c=[],u=[];if(h)for(var p,d=0;h>d&&(p=s[d]);d++)o(p)?(c.push(this),l++,i()):(p.addEventListener("load",n),p.addEventListener("error",a));else i()}function o(t){return u?t.__loaded||t.import&&"loading"!==t.import.readyState:t.__importParsed}function s(t){for(var e,i=0,n=t.length;n>i&&(e=t[i]);i++)l(e)&&h(e)}function l(t){return"link"===t.localName&&"import"===t.rel}function h(t){t.import?r({target:t}):(t.addEventListener("load",r),t.addEventListener("error",r))}var c="import",u=Boolean(c in document.createElement("link")),p=Boolean(window.ShadowDOMPolyfill),d=function(t){return p?window.ShadowDOMPolyfill.wrapIfNeeded(t):t},f=d(document),m={get:function(){var t=window.HTMLImports.currentScript||document.currentScript||("complete"!==document.readyState?document.scripts[document.scripts.length-1]:null);return d(t)},configurable:!0};Object.defineProperty(document,"_currentScript",m),Object.defineProperty(f,"_currentScript",m);var g=/Trident/.test(navigator.userAgent),v=g?"complete":"interactive",y="readystatechange";u&&(new MutationObserver(function(t){for(var e,i=0,n=t.length;n>i&&(e=t[i]);i++)e.addedNodes&&s(e.addedNodes)}).observe(document.head,{childList:!0}),function(){if("loading"===document.readyState)for(var t,e=document.querySelectorAll("link[rel=import]"),i=0,n=e.length;n>i&&(t=e[i]);i++)h(t)}()),e(function(t){window.HTMLImports.ready=!0,window.HTMLImports.readyTime=(new Date).getTime();var e=f.createEvent("CustomEvent");e.initCustomEvent("HTMLImportsLoaded",!0,!0,t),f.dispatchEvent(e)}),t.IMPORT_LINK_TYPE=c,t.useNative=u,t.rootDocument=f,t.whenReady=e,t.isIE=g}(window.HTMLImports),function(t){var e=[],i=function(t){e.push(t)},n=function(){e.forEach(function(e){e(t)})};t.addModule=i,t.initializeModules=n}(window.HTMLImports),window.HTMLImports.addModule(function(t){var e=/(url\()([^)]*)(\))/g,i=/(@import[\s]+(?!url\())([^;]*)(;)/g,n={resolveUrlsInStyle:function(t,e){var i=t.ownerDocument,n=i.createElement("a");return t.textContent=this.resolveUrlsInCssText(t.textContent,e,n),t},resolveUrlsInCssText:function(t,n,r){var a=this.replaceUrls(t,r,n,e);return a=this.replaceUrls(a,r,n,i)},replaceUrls:function(t,e,i,n){return t.replace(n,function(t,n,r,a){var o=r.replace(/["']/g,"");return i&&(o=new URL(o,i).href),e.href=o,o=e.href,n+"'"+o+"'"+a})}};t.path=n}),window.HTMLImports.addModule(function(t){var e={async:!0,ok:function(t){return t.status>=200&&t.status<300||304===t.status||0===t.status},load:function(i,n,r){var a=new XMLHttpRequest;return(t.flags.debug||t.flags.bust)&&(i+="?"+Math.random()),a.open("GET",i,e.async),a.addEventListener("readystatechange",function(t){if(4===a.readyState){var i=null;try{var o=a.getResponseHeader("Location");o&&(i="/"===o.substr(0,1)?location.origin+o:o)}catch(t){console.error(t.message)}n.call(r,!e.ok(a)&&a,a.response||a.responseText,i)}}),a.send(),a},loadDocument:function(t,e,i){this.load(t,e,i).responseType="document"}};t.xhr=e}),window.HTMLImports.addModule(function(t){var e=t.xhr,i=t.flags,n=function(t,e){this.cache={},this.onload=t,this.oncomplete=e,this.inflight=0,this.pending={}};n.prototype={addNodes:function(t){this.inflight+=t.length;for(var e,i=0,n=t.length;n>i&&(e=t[i]);i++)this.require(e);this.checkDone()},addNode:function(t){this.inflight++,this.require(t),this.checkDone()},require:function(t){var e=t.src||t.href;t.__nodeUrl=e,this.dedupe(e,t)||this.fetch(e,t)},dedupe:function(t,e){return this.pending[t]?(this.pending[t].push(e),!0):this.cache[t]?(this.onload(t,e,this.cache[t]),this.tail(),!0):(this.pending[t]=[e],!1)},fetch:function(t,n){if(i.load&&console.log("fetch",t,n),t)if(t.match(/^data:/)){var r=t.split(","),a=r[0],o=r[1];o=a.indexOf(";base64")>-1?atob(o):decodeURIComponent(o),setTimeout(function(){this.receive(t,n,null,o)}.bind(this),0)}else{var s=function(e,i,r){this.receive(t,n,e,i,r)}.bind(this);e.load(t,s)}else setTimeout(function(){this.receive(t,n,{error:"href must be specified"},null)}.bind(this),0)},receive:function(t,e,i,n,r){this.cache[t]=n;for(var a,o=this.pending[t],s=0,l=o.length;l>s&&(a=o[s]);s++)this.onload(t,a,n,i,r),this.tail();this.pending[t]=null},tail:function(){--this.inflight,this.checkDone()},checkDone:function(){this.inflight||this.oncomplete()}},t.Loader=n}),window.HTMLImports.addModule(function(t){var e=function(t){this.addCallback=t,this.mo=new MutationObserver(this.handler.bind(this))};e.prototype={handler:function(t){for(var e,i=0,n=t.length;n>i&&(e=t[i]);i++)"childList"===e.type&&e.addedNodes.length&&this.addedNodes(e.addedNodes)},addedNodes:function(t){this.addCallback&&this.addCallback(t);for(var e,i=0,n=t.length;n>i&&(e=t[i]);i++)e.children&&e.children.length&&this.addedNodes(e.children)},observe:function(t){this.mo.observe(t,{childList:!0,subtree:!0})}},t.Observer=e}),window.HTMLImports.addModule(function(t){function e(t){return"link"===t.localName&&t.rel===c}function i(t){var e=n(t);return"data:text/javascript;charset=utf-8,"+encodeURIComponent(e)}function n(t){return t.textContent+r(t)}function r(t){var e=t.ownerDocument;e.__importedScripts=e.__importedScripts||0;var i=t.ownerDocument.baseURI,n=e.__importedScripts?"-"+e.__importedScripts:"";return e.__importedScripts++,"\n//# sourceURL="+i+n+".js\n"}function a(t){var e=t.ownerDocument.createElement("style");return e.textContent=t.textContent,o.resolveUrlsInStyle(e),e}var o=t.path,s=t.rootDocument,l=t.flags,h=t.isIE,c=t.IMPORT_LINK_TYPE,u="link[rel="+c+"]",p={documentSelectors:u,importsSelectors:[u,"link[rel=stylesheet]:not([type])","style:not([type])","script:not([type])",'script[type="application/javascript"]','script[type="text/javascript"]'].join(","),map:{link:"parseLink",script:"parseScript",style:"parseStyle"},dynamicElements:[],parseNext:function(){var t=this.nextToParse();t&&this.parse(t)},parse:function(t){if(this.isParsed(t))return void(l.parse&&console.log("[%s] is already parsed",t.localName));var e=this[this.map[t.localName]];e&&(this.markParsing(t),e.call(this,t))},parseDynamic:function(t,e){this.dynamicElements.push(t),e||this.parseNext()},markParsing:function(t){l.parse&&console.log("parsing",t),this.parsingElement=t},markParsingComplete:function(t){t.__importParsed=!0,this.markDynamicParsingComplete(t),t.__importElement&&(t.__importElement.__importParsed=!0,this.markDynamicParsingComplete(t.__importElement)),this.parsingElement=null,l.parse&&console.log("completed",t)},markDynamicParsingComplete:function(t){var e=this.dynamicElements.indexOf(t);e>=0&&this.dynamicElements.splice(e,1)},parseImport:function(t){if(t.import=t.__doc,window.HTMLImports.__importsParsingHook&&window.HTMLImports.__importsParsingHook(t),t.import&&(t.import.__importParsed=!0),this.markParsingComplete(t),t.__resource&&!t.__error?t.dispatchEvent(new CustomEvent("load",{bubbles:!1})):t.dispatchEvent(new CustomEvent("error",{bubbles:!1})),t.__pending)for(var e;t.__pending.length;)(e=t.__pending.shift())&&e({target:t});this.parseNext()},parseLink:function(t){e(t)?this.parseImport(t):(t.href=t.href,this.parseGeneric(t))},parseStyle:function(t){var e=t;t=a(t),e.__appliedElement=t,t.__importElement=e,this.parseGeneric(t)},parseGeneric:function(t){this.trackElement(t),this.addElementToDocument(t)},rootImportForElement:function(t){for(var e=t;e.ownerDocument.__importLink;)e=e.ownerDocument.__importLink;return e},addElementToDocument:function(t){var e=this.rootImportForElement(t.__importElement||t);e.parentNode.insertBefore(t,e)},trackElement:function(t,e){var i=this,n=function n(r){t.removeEventListener("load",n),t.removeEventListener("error",n),e&&e(r),i.markParsingComplete(t),i.parseNext()};if(t.addEventListener("load",n),t.addEventListener("error",n),h&&"style"===t.localName){var r=!1;if(-1==t.textContent.indexOf("@import"))r=!0;else if(t.sheet){r=!0;for(var a,o=t.sheet.cssRules,s=o?o.length:0,l=0;s>l&&(a=o[l]);l++)a.type===CSSRule.IMPORT_RULE&&(r=r&&Boolean(a.styleSheet))}r&&setTimeout(function(){t.dispatchEvent(new CustomEvent("load",{bubbles:!1}))})}},parseScript:function(e){var n=document.createElement("script");n.__importElement=e,n.src=e.src?e.src:i(e),t.currentScript=e,this.trackElement(n,function(e){n.parentNode&&n.parentNode.removeChild(n),t.currentScript=null}),this.addElementToDocument(n)},nextToParse:function(){return this._mayParse=[],!this.parsingElement&&(this.nextToParseInDoc(s)||this.nextToParseDynamic())},nextToParseInDoc:function(t,i){if(t&&this._mayParse.indexOf(t)<0){this._mayParse.push(t);for(var n,r=t.querySelectorAll(this.parseSelectorsForNode(t)),a=0,o=r.length;o>a&&(n=r[a]);a++)if(!this.isParsed(n))return this.hasResource(n)?e(n)?this.nextToParseInDoc(n.__doc,n):n:void 0}return i},nextToParseDynamic:function(){return this.dynamicElements[0]},parseSelectorsForNode:function(t){return(t.ownerDocument||t)===s?this.documentSelectors:this.importsSelectors},isParsed:function(t){return t.__importParsed},needsDynamicParsing:function(t){return this.dynamicElements.indexOf(t)>=0},hasResource:function(t){return!e(t)||void 0!==t.__doc}};t.parser=p,t.IMPORT_SELECTOR=u}),window.HTMLImports.addModule(function(t){function e(t){return i(t,o)}function i(t,e){return"link"===t.localName&&t.getAttribute("rel")===e}function n(t){return!!Object.getOwnPropertyDescriptor(t,"baseURI")}function r(t,e){var i=document.implementation.createHTMLDocument(o);i._URL=e;var r=i.createElement("base");r.setAttribute("href",e),i.baseURI||n(i)||Object.defineProperty(i,"baseURI",{value:e});var a=i.createElement("meta");return a.setAttribute("charset","utf-8"),i.head.appendChild(a),i.head.appendChild(r),i.body.innerHTML=t,window.HTMLTemplateElement&&HTMLTemplateElement.bootstrap&&HTMLTemplateElement.bootstrap(i),i}var a=t.flags,o=t.IMPORT_LINK_TYPE,s=t.IMPORT_SELECTOR,l=t.rootDocument,h=t.Loader,c=t.Observer,u=t.parser,p={documents:{},documentPreloadSelectors:s,importsPreloadSelectors:[s].join(","),loadNode:function(t){d.addNode(t)},loadSubtree:function(t){var e=this.marshalNodes(t);d.addNodes(e)},marshalNodes:function(t){return t.querySelectorAll(this.loadSelectorsForNode(t))},loadSelectorsForNode:function(t){return(t.ownerDocument||t)===l?this.documentPreloadSelectors:this.importsPreloadSelectors},loaded:function(t,i,n,o,s){if(a.load&&console.log("loaded",t,i),i.__resource=n,i.__error=o,e(i)){var l=this.documents[t];void 0===l&&(l=o?null:r(n,s||t),l&&(l.__importLink=i,this.bootDocument(l)),this.documents[t]=l),i.__doc=l}u.parseNext()},bootDocument:function(t){this.loadSubtree(t),this.observer.observe(t),u.parseNext()},loadedAll:function(){u.parseNext()}},d=new h(p.loaded.bind(p),p.loadedAll.bind(p));if(p.observer=new c,!document.baseURI){var f={get:function(){var t=document.querySelector("base");return t?t.href:window.location.href},configurable:!0};Object.defineProperty(document,"baseURI",f),Object.defineProperty(l,"baseURI",f)}t.importer=p,t.importLoader=d}),window.HTMLImports.addModule(function(t){var e=t.parser,i=t.importer,n={added:function(t){for(var n,r,a,o,s=0,l=t.length;l>s&&(o=t[s]);s++)n||(n=o.ownerDocument,r=e.isParsed(n)),a=this.shouldLoadNode(o),a&&i.loadNode(o),this.shouldParseNode(o)&&r&&e.parseDynamic(o,a)},shouldLoadNode:function(t){return 1===t.nodeType&&r.call(t,i.loadSelectorsForNode(t))},shouldParseNode:function(t){return 1===t.nodeType&&r.call(t,e.parseSelectorsForNode(t))}};i.observer.addCallback=n.added.bind(n);var r=HTMLElement.prototype.matches||HTMLElement.prototype.matchesSelector||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.msMatchesSelector}),function(t){function e(){window.HTMLImports.importer.bootDocument(n)}var i=t.initializeModules;if(t.isIE,!t.useNative){i();var n=t.rootDocument;"complete"===document.readyState||"interactive"===document.readyState&&!window.attachEvent?e():document.addEventListener("DOMContentLoaded",e)}}(window.HTMLImports),window.CustomElements=window.CustomElements||{flags:{}},function(t){var e=t.flags,i=[],n=function(t){i.push(t)},r=function(){i.forEach(function(e){e(t)})};t.addModule=n,t.initializeModules=r,t.hasNative=Boolean(document.registerElement),t.isIE=/Trident/.test(navigator.userAgent),t.useNative=!e.register&&t.hasNative&&!window.ShadowDOMPolyfill&&(!window.HTMLImports||window.HTMLImports.useNative)}(window.CustomElements),window.CustomElements.addModule(function(t){function e(t,e){i(t,function(t){return!!e(t)||void n(t,e)}),n(t,e)}function i(t,e,n){var r=t.firstElementChild;if(!r)for(r=t.firstChild;r&&r.nodeType!==Node.ELEMENT_NODE;)r=r.nextSibling;for(;r;)!0!==e(r,n)&&i(r,e,n),r=r.nextElementSibling;return null}function n(t,i){for(var n=t.shadowRoot;n;)e(n,i),n=n.olderShadowRoot}function r(t,e){a(t,e,[])}function a(t,e,i){if(t=window.wrap(t),!(i.indexOf(t)>=0)){i.push(t);for(var n,r=t.querySelectorAll("link[rel="+o+"]"),s=0,l=r.length;l>s&&(n=r[s]);s++)n.import&&a(n.import,e,i);e(t)}}var o=window.HTMLImports?window.HTMLImports.IMPORT_LINK_TYPE:"none";t.forDocumentTree=r,t.forSubtree=e}),window.CustomElements.addModule(function(t){function e(t,e){return i(t,e)||n(t,e)}function i(e,i){return!!t.upgrade(e,i)||void(i&&o(e))}function n(t,e){b(t,function(t){return!!i(t,e)||void 0})}function r(t){S.push(t),C||(C=!0,setTimeout(a))}function a(){C=!1;for(var t,e=S,i=0,n=e.length;n>i&&(t=e[i]);i++)t();S=[]}function o(t){w?r(function(){s(t)}):s(t)}function s(t){t.__upgraded__&&!t.__attached&&(t.__attached=!0,t.attachedCallback&&t.attachedCallback())}function l(t){h(t),b(t,function(t){h(t)})}function h(t){w?r(function(){c(t)}):c(t)}function c(t){t.__upgraded__&&t.__attached&&(t.__attached=!1,t.detachedCallback&&t.detachedCallback())}function u(t){for(var e=t,i=window.wrap(document);e;){if(e==i)return!0;e=e.parentNode||e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.host}}function p(t){if(t.shadowRoot&&!t.shadowRoot.__watched){y.dom&&console.log("watching shadow-root for: ",t.localName);for(var e=t.shadowRoot;e;)m(e),e=e.olderShadowRoot}}function d(t,i){if(y.dom){var n=i[0];if(n&&"childList"===n.type&&n.addedNodes&&n.addedNodes){for(var r=n.addedNodes[0];r&&r!==document&&!r.host;)r=r.parentNode;var a=r&&(r.URL||r._URL||r.host&&r.host.localName)||"";a=a.split("/?").shift().split("/").pop()}console.group("mutations (%d) [%s]",i.length,a||"")}var o=u(t);i.forEach(function(t){"childList"===t.type&&(T(t.addedNodes,function(t){t.localName&&e(t,o)}),T(t.removedNodes,function(t){t.localName&&l(t)}))}),y.dom&&console.groupEnd()}function f(t){for((t=window.wrap(t))||(t=window.wrap(document));t.parentNode;)t=t.parentNode;var e=t.__observer;e&&(d(t,e.takeRecords()),a())}function m(t){if(!t.__observer){var e=new MutationObserver(d.bind(this,t));e.observe(t,{childList:!0,subtree:!0}),t.__observer=e}}function g(t){t=window.wrap(t),y.dom&&console.group("upgradeDocument: ",t.baseURI.split("/").pop()),e(t,t===window.wrap(document)),m(t),y.dom&&console.groupEnd()}function v(t){x(t,g)}var y=t.flags,b=t.forSubtree,x=t.forDocumentTree,w=window.MutationObserver._isPolyfilled&&y["throttle-attached"];t.hasPolyfillMutations=w,t.hasThrottledAttached=w;var C=!1,S=[],T=Array.prototype.forEach.call.bind(Array.prototype.forEach),_=Element.prototype.createShadowRoot;_&&(Element.prototype.createShadowRoot=function(){var t=_.call(this);return window.CustomElements.watchShadow(this),t}),t.watchShadow=p,t.upgradeDocumentTree=v,t.upgradeDocument=g,t.upgradeSubtree=n,t.upgradeAll=e,t.attached=o,t.takeRecords=f}),window.CustomElements.addModule(function(t){function e(e,n){if("template"===e.localName&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate&&HTMLTemplateElement.decorate(e),!e.__upgraded__&&e.nodeType===Node.ELEMENT_NODE){var r=e.getAttribute("is"),a=t.getRegisteredDefinition(e.localName)||t.getRegisteredDefinition(r);if(a&&(r&&a.tag==e.localName||!r&&!a.extends))return i(e,a,n)}}function i(e,i,r){return o.upgrade&&console.group("upgrade:",e.localName),i.is&&e.setAttribute("is",i.is),n(e,i),e.__upgraded__=!0,a(e),r&&t.attached(e),t.upgradeSubtree(e,r),o.upgrade&&console.groupEnd(),e}function n(t,e){Object.__proto__?t.__proto__=e.prototype:(r(t,e.prototype,e.native),t.__proto__=e.prototype)}function r(t,e,i){for(var n={},r=e;r!==i&&r!==HTMLElement.prototype;){for(var a,o=Object.getOwnPropertyNames(r),s=0;a=o[s];s++)n[a]||(Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(r,a)),n[a]=1);r=Object.getPrototypeOf(r)}}function a(t){t.createdCallback&&t.createdCallback()}var o=t.flags;t.upgrade=e,t.upgradeWithDefinition=i,t.implementPrototype=n}),window.CustomElements.addModule(function(t){function e(e,n){var l=n||{};if(!e)throw new Error("document.registerElement: first argument `name` must not be empty");if(e.indexOf("-")<0)throw new Error("document.registerElement: first argument ('name') must contain a dash ('-'). Argument provided was '"+String(e)+"'.");if(r(e))throw new Error("Failed to execute 'registerElement' on 'Document': Registration failed for type '"+String(e)+"'. The type name is invalid.");if(h(e))throw new Error("DuplicateDefinitionError: a type with name '"+String(e)+"' is already registered");return l.prototype||(l.prototype=Object.create(HTMLElement.prototype)),l.__name=e.toLowerCase(),l.extends&&(l.extends=l.extends.toLowerCase()),l.lifecycle=l.lifecycle||{},l.ancestry=a(l.extends),o(l),s(l),i(l.prototype),c(l.__name,l),l.ctor=u(l),l.ctor.prototype=l.prototype,l.prototype.constructor=l.ctor,t.ready&&g(document),l.ctor}function i(t){if(!t.setAttribute._polyfilled){var e=t.setAttribute;t.setAttribute=function(t,i){n.call(this,t,i,e)};var i=t.removeAttribute;t.removeAttribute=function(t){n.call(this,t,null,i)},t.setAttribute._polyfilled=!0}}function n(t,e,i){t=t.toLowerCase();var n=this.getAttribute(t);i.apply(this,arguments);var r=this.getAttribute(t);this.attributeChangedCallback&&r!==n&&this.attributeChangedCallback(t,n,r)}function r(t){for(var e=0;e<w.length;e++)if(t===w[e])return!0}function a(t){var e=h(t);return e?a(e.extends).concat([e]):[]}function o(t){for(var e,i=t.extends,n=0;e=t.ancestry[n];n++)i=e.is&&e.tag;t.tag=i||t.__name,i&&(t.is=t.__name)}function s(t){if(!Object.__proto__){var e=HTMLElement.prototype;if(t.is){var i=document.createElement(t.tag);e=Object.getPrototypeOf(i)}for(var n,r=t.prototype,a=!1;r;)r==e&&(a=!0),n=Object.getPrototypeOf(r),n&&(r.__proto__=n),r=n;a||console.warn(t.tag+" prototype not found in prototype chain for "+t.is),t.native=e}}function l(t){return y(T(t.tag),t)}function h(t){return t?C[t.toLowerCase()]:void 0}function c(t,e){C[t]=e}function u(t){return function(){return l(t)}}function p(t,e,i){return t===S?d(e,i):_(t,e)}function d(t,e){t&&(t=t.toLowerCase()),e&&(e=e.toLowerCase());var i=h(e||t);if(i){if(t==i.tag&&e==i.is)return new i.ctor;if(!e&&!i.is)return new i.ctor}var n;return e?(n=d(t),n.setAttribute("is",e),n):(n=T(t),t.indexOf("-")>=0&&b(n,HTMLElement),n)}function f(t,e){var i=t[e];t[e]=function(){var t=i.apply(this,arguments);return v(t),t}}var m,g=(t.isIE,t.upgradeDocumentTree),v=t.upgradeAll,y=t.upgradeWithDefinition,b=t.implementPrototype,x=t.useNative,w=["annotation-xml","color-profile","font-face","font-face-src","font-face-uri","font-face-format","font-face-name","missing-glyph"],C={},S="http://www.w3.org/1999/xhtml",T=document.createElement.bind(document),_=document.createElementNS.bind(document);m=Object.__proto__||x?function(t,e){return t instanceof e}:function(t,e){if(t instanceof e)return!0;for(var i=t;i;){if(i===e.prototype)return!0;i=i.__proto__}return!1},f(Node.prototype,"cloneNode"),f(document,"importNode"),document.registerElement=e,document.createElement=d,document.createElementNS=p,t.registry=C,t.instanceof=m,t.reservedTagList=w,t.getRegisteredDefinition=h,document.register=document.registerElement}),function(t){function e(){a(window.wrap(document)),window.CustomElements.ready=!0,(window.requestAnimationFrame||function(t){setTimeout(t,16)})(function(){setTimeout(function(){window.CustomElements.readyTime=Date.now(),window.HTMLImports&&(window.CustomElements.elapsed=window.CustomElements.readyTime-window.HTMLImports.readyTime),document.dispatchEvent(new CustomEvent("WebComponentsReady",{bubbles:!0}))})})}var i=t.useNative,n=t.initializeModules;if(t.isIE,i){var r=function(){};t.watchShadow=r,t.upgrade=r,t.upgradeAll=r,t.upgradeDocumentTree=r,t.upgradeSubtree=r,t.takeRecords=r,t.instanceof=function(t,e){return t instanceof e}}else n();var a=t.upgradeDocumentTree,o=t.upgradeDocument;if(window.wrap||(window.ShadowDOMPolyfill?(window.wrap=window.ShadowDOMPolyfill.wrapIfNeeded,window.unwrap=window.ShadowDOMPolyfill.unwrapIfNeeded):window.wrap=window.unwrap=function(t){return t}),window.HTMLImports&&(window.HTMLImports.__importsParsingHook=function(t){t.import&&o(wrap(t.import))}),"complete"===document.readyState||t.flags.eager)e();else if("interactive"!==document.readyState||window.attachEvent||window.HTMLImports&&!window.HTMLImports.ready){var s=window.HTMLImports&&!window.HTMLImports.ready?"HTMLImportsLoaded":"DOMContentLoaded";window.addEventListener(s,e)}else e()}(window.CustomElements),function(t){var e=document.createElement("style");e.textContent="body {transition: opacity ease-in 0.2s; } \nbody[unresolved] {opacity: 0; display: block; overflow: hidden; position: relative; } \n";var i=document.querySelector("head");i.insertBefore(e,i.firstChild)}(window.WebComponents)},function(t,e,i){"use strict";var n=i(2),r=i.n(n),a=i(1);i.n(a);r.a.fn.extend({stxtap:function(t,e){return this.each(function(){a.CIQ.installTapEvent(this),"string"==typeof t?r()(this).on("stxtap",t,function(t){e.call(this,t)}):r()(this).on("stxtap",function(e){t.call(this,e)})})}}),r.a.fn.extend(r.a.expr[":"],{trulyvisible:function(t,e,i){var n=r()(t).parents();n=n.add(t);for(var a=0;a<n.length;a++){var o=r()(n[a]);if("0"===o.css("opacity"))return!1;if("hidden"===o.css("visibility"))return!1;if("0px"===o.css("height")&&"hidden"===o.css("overflow-y"))return!1;if(!o.is(":visible"))return!1}return!0}}),r.a.fn.extend({parentsAndMe:function(t){var e=r()(this).parents();return e=e.add(r()(this))},cqvirtual:function(t){var e=this.clone();return e.empty(),e.original=this,e},cqrender:function(t){if(this[0].innerHTML===this.original[0].innerHTML)return this.original;this.original.empty();var e=this.children();if(e.length){var i=e.detach();this.original.append(i)}return this.original},guaranteedWidth:function(){for(var t=this,e=t.width();!e;){if(t=t.parent(),"BODY"===t[0].tagName||t[0]===window)return window.innerWidth;e=t.width()}return e},guaranteedHeight:function(){for(var t=this,e=t.height();!e;){if(t=t.parent(),"BODY"===t[0].tagName||t[0]===window)return window.innerHeight;e=t.height()}return e},emptyExceptTemplate:function(){return this.children().not("template").remove(),this},truthyAttr:function(t){var e=this.attr(t);return void 0!==e&&("false"!==e.toLowerCase()&&"0"!==e)},attrBetter:function(t,e){return void 0===e&&(e="true"),this.attr(t)!==e&&(this.attr(t,e),!0)},removeAttrBetter:function(t){var e=this.attr(t);return!(!e&&""!==e)&&(this.removeAttr(t),!0)},textBetter:function(t){return this.text()!==t&&(this.text(t),!0)}}),r.a.queryString=function(t){for(var e=window.location.search.substring(1),i=e.split("&"),n=0;n<i.length;n++){var r=i[n].split("=");if(r[0]===t)return r[1]}return null}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(359),a=(i.n(r),i(1)),o=(i.n(a),i(30)),s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function(){function t(){n(this,t)}return s(t,null,[{key:"containerExecute",value:function(t,e){for(var i=t.node.parents(),n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];for(var o=0;o<i.length;o++){var s=i[o];if(s[e]&&s[e].constructor===Function)return s[e].apply(s,r)}return null}},{key:"animatePrice",value:function(t,e,i){t.removeClass("cq-stable"),e>i?t.addClass("cq-up"):e<i&&t.addClass("cq-down"),setTimeout(function(){t.addClass("cq-stable").removeClass("cq-up").removeClass("cq-down")},0)}},{key:"makeFromTemplate",value:function(t,e){for(var i=$(t)[0].content,n=document.importNode(i,!0),r=null,a=0;a<n.childNodes.length;a++){var o=n.childNodes[a];if(1===o.nodeType){r=$(o),!0===e?$(t).parent().append(n):e&&$(e).append(n);break}}return r}},{key:"splitMethod",value:function(t){if(!t)return null;var e=t.indexOf("("),i=t.lastIndexOf(")");if(-1===e||-1===i)return console.log("malformed stxtap attribute: "+t),null;var n=null,r=void 0,a=t.substring(0,e),o=a.indexOf(".");-1===o?r=a:(n=a.substring(0,o),r=t.substring(o+1,e));var s=t.substring(e+1,i),l=s.match(/('[^']+'|[^,]+)/g),h=new RegExp("^[0-9]+([,.][0-9]+)?$","g"),c=new RegExp("^\\d+$"),u=[];if(l)for(var p=0;p<l.length;p++){for(var d=l[p];" "===d.charAt(0);)d=d.substring(1);if(-1!==d.indexOf('"')||-1!==d.indexOf("'"))u.push(d.substring(1,d.length-1));else if("true"===d)u.push(!0);else if("false"===d)u.push(!1);else if("null"===d)u.push(null);else if(c.test(d))u.push(parseInt(d,10));else if(h.test(d))u.push(parseFloat(d));else{for(var f=d.split("."),m=window,g=0;g<f.length;g++)m=m[f[g]];u.push(m)}}return{helperName:n,functionName:r,args:u}}},{key:"observe",value:function(t){function e(e){var n=!1;if(t.member){if(e.name===t.member)n=!0;else if(t.member.constructor===Array)for(var r=0;r<t.member.length;r++)e.name===t.member[r]&&(n=!0)}else n=!0;if(n){var a=$(t.selector);if(!a.length&&"callback"===t.action)return void t.value.call(i,t);"class"===t.action&&a.removeClass(t.value),a.each(function(){var e=!1;t.member&&(t.condition?t.obj[t.member]===t.condition&&(e=!0):e=t.obj[t.member]),"class"===t.action&&e&&a.addClass(t.value),"callback"===t.action&&t.value.call(i,t,this),"value"===t.action&&(t.value?this.value=t.value:t.obj[t.member]?this.value=t.obj[t.member]:this.value="")})}}var i=this;Object.observe(t.obj,function(t){t.forEach(e)},["update","add","delete"]),e({name:t.member})}},{key:"allContexts",value:function(){return $("cq-context,*[cq-context]")}},{key:"getMyContext",value:function(t){for(var e=$(t).parentsAndMe(),i=0;i<e.length;i++){var n=e[i];if(n.context)return n.context;if(n.CIQ&&n.CIQ.UI)return n.CIQ.UI.context}return null}},{key:"contextsForEach",value:function(t){a.CIQ.UI.allContexts().each(function(){t.apply(this.CIQ.UI.context)})}},{key:"begin",value:function(t){a.CIQ.UI.release=!0,setTimeout(function(){o.a.nextTick(),t&&t()},0)}}]),t}();a.CIQ.UI=l},function(t,e){/*!
 * Object.observe polyfill - v0.2.4
 * by Massimo Artizzu (MaxArt2501)
 *
 * https://github.com/MaxArt2501/object-observe
 *
 * Licensed under the MIT License
 * See LICENSE for details
 */
Object.observe||function(t,e,i,n){"use strict";var r,a,o=["add","update","delete","reconfigure","setPrototype","preventExtensions"],s=e.isArray||function(t){return function(e){return"[object Array]"===t.call(e)}}(t.prototype.toString),l=e.prototype.indexOf?e.indexOf||function(t,i,n){return e.prototype.indexOf.call(t,i,n)}:function(t,e,i){for(var n=i||0;n<t.length;n++)if(t[n]===e)return n;return-1},h=void 0!==i.Map&&Map.prototype.forEach?function(){return new Map}:function(){var t=[],e=[];return{size:0,has:function(e){return l(t,e)>-1},get:function(i){return e[l(t,i)]},set:function(i,n){var r=l(t,i);-1===r?(t.push(i),e.push(n),this.size++):e[r]=n},delete:function(i){var n=l(t,i);n>-1&&(t.splice(n,1),e.splice(n,1),this.size--)},forEach:function(i){for(var n=0;n<t.length;n++)i.call(arguments[1],e[n],t[n],this)}}},c=t.getOwnPropertyNames?function(){var e=t.getOwnPropertyNames;try{arguments.callee}catch(n){var i=(e(l).join(" ")+" ").replace(/prototype |length |name /g,"").slice(0,-1).split(" ");i.length&&(e=function(e){var n=t.getOwnPropertyNames(e);if("function"==typeof e)for(var r,a=0;a<i.length;)(r=l(n,i[a++]))>-1&&n.splice(r,1);return n})}return e}():function(e){var i,n,r=[];if("hasOwnProperty"in e)for(i in e)e.hasOwnProperty(i)&&r.push(i);else{n=t.hasOwnProperty;for(i in e)n.call(e,i)&&r.push(i)}return s(e)&&r.push("length"),r},u=t.getPrototypeOf,p=t.defineProperties&&t.getOwnPropertyDescriptor,d=i.requestAnimationFrame||i.webkitRequestAnimationFrame||function(){var t=+new Date,e=t;return function(i){return setTimeout(function(){i((e=+new Date)-t)},17)}}(),f=function(t,e,i){var n=r.get(t);n?(g(n,t),x(t,n,e,i)):(n=m(t),x(t,n,e,i),1===r.size&&d(v))},m=function(e,i){var n,a=c(e),o=[],s=0,i={handlers:h(),frozen:!!t.isFrozen&&t.isFrozen(e),extensible:!t.isExtensible||t.isExtensible(e),proto:u&&u(e),properties:a,values:o,notifier:b(e,i)};if(p)for(n=i.descriptors=[];s<a.length;)n[s]=p(e,a[s]),o[s]=e[a[s++]];else for(;s<a.length;)o[s]=e[a[s++]];return r.set(e,i),i},g=function(){var e=p?function(t,e,i,n,r){var a=e.properties[i],o=t[a],s=e.values[i],l=e.descriptors[i];"value"in r&&(s===o?0===s&&1/s!=1/o:s===s||o===o)&&(w(t,e,{name:a,type:"update",object:t,oldValue:s},n),e.values[i]=o),!l.configurable||r.configurable&&r.writable===l.writable&&r.enumerable===l.enumerable&&r.get===l.get&&r.set===l.set||(w(t,e,{name:a,type:"reconfigure",object:t,oldValue:s},n),e.descriptors[i]=r)}:function(t,e,i,n){var r=e.properties[i],a=t[r],o=e.values[i];(o===a?0===o&&1/o!=1/a:o===o||a===a)&&(w(t,e,{name:r,type:"update",object:t,oldValue:o},n),e.values[i]=a)},i=p?function(t,i,n,r,a){for(var o,s=i.length;n&&s--;)null!==i[s]&&(o=p(t,i[s]),n--,o?e(t,r,s,a,o):(w(t,r,{name:i[s],type:"delete",object:t,oldValue:r.values[s]},a),r.properties.splice(s,1),r.values.splice(s,1),r.descriptors.splice(s,1)))}:function(t,e,i,n,r){for(var a=e.length;i&&a--;)null!==e[a]&&(w(t,n,{name:e[a],type:"delete",object:t,oldValue:n.values[a]},r),n.properties.splice(a,1),n.values.splice(a,1),i--)};return function(n,r,a){if(n.handlers.size&&!n.frozen){var o,s,h,d,f,m,g,v,y=n.values,b=n.descriptors,x=0;if(n.extensible)if(o=n.properties.slice(),s=o.length,h=c(r),b){for(;x<h.length;)f=h[x++],d=l(o,f),v=p(r,f),-1===d?(w(r,n,{name:f,type:"add",object:r},a),n.properties.push(f),y.push(r[f]),b.push(v)):(o[d]=null,s--,e(r,n,d,a,v));i(r,o,s,n,a),t.isExtensible(r)||(n.extensible=!1,w(r,n,{type:"preventExtensions",object:r},a),n.frozen=t.isFrozen(r))}else{for(;x<h.length;)f=h[x++],d=l(o,f),m=r[f],-1===d?(w(r,n,{name:f,type:"add",object:r},a),n.properties.push(f),y.push(m)):(o[d]=null,s--,e(r,n,d,a));i(r,o,s,n,a)}else if(!n.frozen){for(;x<o.length;x++)f=o[x],e(r,n,x,a,p(r,f));t.isFrozen(r)&&(n.frozen=!0)}u&&(g=u(r))!==n.proto&&(w(r,n,{type:"setPrototype",name:"__proto__",object:r,oldValue:n.proto}),n.proto=g)}}}(),v=function(){r.size&&(r.forEach(g),a.forEach(y),d(v))},y=function(t,e){var i=t.changeRecords;i.length&&(t.changeRecords=[],e(i))},b=function(t,e){return arguments.length<2&&(e=r.get(t)),e&&e.notifier||{notify:function(e){e.type;var i=r.get(t);if(i){var n,a={object:t};for(n in e)"object"!==n&&(a[n]=e[n]);w(t,i,a)}},performChange:function(e,i){if("string"!=typeof e)throw new TypeError("Invalid non-string changeType");if("function"!=typeof i)throw new TypeError("Cannot perform non-function");var n,a,o=r.get(t),s=arguments[2],l=void 0===s?i():i.call(s);if(o&&g(o,t,e),o&&l&&"object"==typeof l){a={object:t,type:e};for(n in l)"object"!==n&&"type"!==n&&(a[n]=l[n]);w(t,o,a)}}}},x=function(t,e,i,n){var r=a.get(i);r||a.set(i,r={observed:h(),changeRecords:[]}),r.observed.set(t,{acceptList:n.slice(),data:e}),e.handlers.set(i,r)},w=function(t,e,i,n){e.handlers.forEach(function(e){var r=e.observed.get(t).acceptList;("string"!=typeof n||-1===l(r,n))&&l(r,i.type)>-1&&e.changeRecords.push(i)})};r=h(),a=h(),t.observe=function(e,i,n){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object.observe cannot observe non-object");if("function"!=typeof i)throw new TypeError("Object.observe cannot deliver to non-function");if(t.isFrozen&&t.isFrozen(i))throw new TypeError("Object.observe cannot deliver to a frozen function object");if(void 0===n)n=o;else if(!n||"object"!=typeof n)throw new TypeError("Third argument to Object.observe must be an array of strings.");return f(e,i,n),e},t.unobserve=function(t,e){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object.unobserve cannot unobserve non-object");if("function"!=typeof e)throw new TypeError("Object.unobserve cannot deliver to non-function");var i,n=a.get(e);return n&&(i=n.observed.get(t))&&(n.observed.forEach(function(t,e){g(t.data,e)}),d(function(){y(n,e)}),1===n.observed.size&&n.observed.has(t)?a.delete(e):n.observed.delete(t),1===i.data.handlers.size?r.delete(t):i.data.handlers.delete(e)),t},t.getNotifier=function(e){if(null===e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object.getNotifier cannot getNotifier non-object");return t.isFrozen&&t.isFrozen(e)?null:b(e)},t.deliverChangeRecords=function(t){if("function"!=typeof t)throw new TypeError("Object.deliverChangeRecords cannot deliver to non-function");var e=a.get(t);e&&(e.observed.forEach(function(t,e){g(t.data,e)}),y(e,t))}}(Object,Array,this)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}()),c=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),h(e,[{key:"createdCallback",value:function(){function t(){e.closeTopMenu()}l.CIQ.installTapEvent(s()("body")[0],{preventUnderlayClick:!1}),this.activeMenuStack=[],this.registeredForResize=[],this.keystrokeHub=null;var e=this;s()("body").on("stxtap",t)}},{key:"attachedCallback",value:function(){var t=this;this.resize=function(){for(var e=t.registeredForResize,i=0;i<e.length;i++)"function"==typeof e[i].resize&&e[i].resize()},window.addEventListener("resize",this.resize)}},{key:"detachedCallback",value:function(){window.removeEventListener("resize",this.resize)}},{key:"openMenu",value:function(t,e){setTimeout(function(){s()(t).find("input[cq-focus]:first-child").focus()},0),this.activeMenuStack.push(t),t.show(e),s()("cq-context,*[cq-context]").each(function(){this.CIQ&&this.CIQ.UI&&this.CIQ.UI.context&&this.CIQ.UI.context.stx&&this.CIQ.UI.context.stx.modalBegin()})}},{key:"topMenu",value:function(){var t=this.activeMenuStack;return t.length?t[t.length-1]:null}},{key:"closeMenu",value:function(t){var e=this.activeMenuStack,i=s()(t).parents("cq-menu"),n=[];if(t){n.push(t);for(var r=0;r<i.length;r++){var a=i[r];a.active&&n.push(a)}}else n=e;for(var o=0;o<n.length;o++)n[o].hide();this.activeMenuStack=e.filter(function(t){return t.active}),this.ifAllClosed()}},{key:"registerForResize",value:function(t){this.registeredForResize.push(t)}},{key:"unregisterForResize",value:function(t){for(var e=this.registeredForResize,i=0;i<e.length;i++)if(e[i]===t)return void e.splice(i,1)}},{key:"ifAllClosed",value:function(){this.activeMenuStack.length||s()("cq-context,*[cq-context]").each(function(){this.CIQ&&this.CIQ.UI&&this.CIQ.UI.context&&this.CIQ.UI.context.stx&&this.CIQ.UI.context.stx.modalEnd()})}},{key:"closeTopMenu",value:function(){var t=this.activeMenuStack;if(t.length){var e=t[t.length-1];if(!e.isDialog||e.active){t.pop(),e.hide();var i=this;setTimeout(function(){i.ifAllClosed()},0)}}}},{key:"findLifts",value:function(t){return s()(t).find("*[cq-lift]").filter(function(){var e=s()(this).closest("cq-menu,cq-dialog");return e.length&&e[0]===t})}},{key:"restoreLift",value:function(t){var e=s()(t);if(e.length){var i=e[0].remember;e.detach(),e.css(i.css),s()(i.parentNode).append(e)}}},{key:"lift",value:function(t){var e=s()(t);if(e.length){var i=s()(e)[0];i.remember={parentNode:i.parentNode,css:{position:i.style.position,display:i.style.display,left:i.style.left,top:i.style.top,height:i.style.height,width:i.style.width,opacity:i.style.opacity}};var n=i.getBoundingClientRect(),r=e.height();e.detach(),e.css({position:"absolute",display:"block",left:n.left+"px",top:n.top+"px",height:r+"px",opacity:1}),s()("body").append(e),void 0!==i.resize&&i.resize(),e.find("cq-scroll").each(function(){this.resize()})}}}]),e}(HTMLElement);document.registerElement("cq-ui-manager",c)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),i(138)),c=i(55),u=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),p=function(t){function e(t,i,a){n(this,e);var o=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,a));return o.params=a||{},void 0===o.params.autoStart&&(o.params.autoStart=!0),o.node=s()(t),o.node.detach(),o.context=i,o.maxVolume={lastCheckDate:null,value:0},o.params.autoStart&&o.begin(),o}return a(e,t),u(e,[{key:"begin",value:function(){var t=void 0;this.params.followMouse?(this.node.css({top:"auto"}),t={stx:this.context.stx,label:"headsup",xPositioner:"bar",chartContainer:!0,x:0,node:this.node[0]},this.marker=new h.a(t,this.params.showClass),this.addInjection("append","handleMouseOut",function(t){return function(){t.followMouse(-1)}}(this))):this.params.staticNode||(this.node.css({top:"",left:""}),t={stx:this.context.stx,label:"headsup",xPositioner:"none",chartContainer:!1,node:this.node[0]},s.a.extend(t,this.params),this.marker=new l.CIQ.Marker(t)),l.CIQ.isMobile&&(this.context.stx.layout.crosshair=!0),this.calculateMaxVolume(),this.addInjection("prepend","headsUpHR",function(t){return function(){t.position()}}(this)),this.addInjection("append","createXAxis",function(t){return function(){t.position()}}(this)),this.addInjection("append","createDataSet",function(t){return function(e,i,n){t.calculateMaxVolume(n.appending)}}(this))}},{key:"end",value:function(){l.CIQ.isMobile&&(this.context.stx.layout.crosshair=!1),this.marker&&this.marker.remove(),this.destroy(),this.marker=null}},{key:"calculateMaxVolume",value:function(t){t||(this.maxVolume={lastCheckDate:null,value:0});var e=this.context.stx.chart.dataSet;if(e&&e.length){for(var i=e.length-1;i>=0;i--){var n=e[i];if(n.DT<this.maxVolume.lastCheckDate)break;n.Volume>this.maxVolume.value&&(this.maxVolume.value=n.Volume)}this.maxVolume.lastCheckDate=e[e.length-1].DT}}},{key:"position",value:function(){function t(){if(s.timeout=null,o.find("cq-hu-price").text(""),o.find("cq-hu-open").text(""),o.find("cq-hu-close").text(""),o.find("cq-hu-high").text(""),o.find("cq-hu-low").text(""),o.find("cq-hu-date").text(""),o.find("cq-hu-volume").text(""),o.find("cq-volume-rollup").text(""),n){if(n.data){o.find("cq-hu-open").text(e.formatPrice(n.data.Open)),o.find("cq-hu-price").text(e.formatPrice(n.data[a])),o.find("cq-hu-close").text(e.formatPrice(n.data.Close)),o.find("cq-hu-high").text(e.formatPrice(n.data.High)),o.find("cq-hu-low").text(e.formatPrice(n.data.Low));var t=l.CIQ.condenseInt(n.data.Volume),i=t.charAt(t.length-1);i>"9"&&(t=t.substring(0,t.length-1),o.find("cq-volume-rollup").text(i.toUpperCase())),o.find("cq-hu-volume").text(t);var h=n.data.displayDate;h||(h=n.data.DT),l.CIQ.ChartEngine.isDailyInterval(e.layout.interval)?o.find("cq-hu-date").text(l.CIQ.mmddyyyy(l.CIQ.yyyymmddhhmm(h))):o.find("cq-hu-date").text(l.CIQ.mmddhhmm(l.CIQ.yyyymmddhhmmssmmm(h)));var c=o.find("cq-volume-visual");if(c.length){var u=s.maxVolume.value?n.data.Volume/s.maxVolume.value:0;c.css({width:Math.round(100*u)+"%"})}}r&&r[a]&&s.tick===e.chart.dataSet.length-1&&o.find("cq-hu-price").text(e.formatPrice(r[a]))}}var e=this.context.stx,i=e.barFromPixel(e.cx);this.tick=e.tickFromPixel(e.cx);var n=e.chart.xaxis[i],r=e.chart.currentQuote,a=e.chart.defaultPlotField;a&&!e.highLowBars[e.layout.chartType]||(a="Close");var o=this.node,s=this;if(this.tick!==this.prevTick||e.chart.dataSegment&&i===e.chart.dataSegment.length-1){this.timeout&&clearTimeout(this.timeout);var h=(this.params.followMouse,0);this.timeout=setTimeout(t,h)}this.prevTick=this.tick,this.params.followMouse&&(e.openDialog&&(this.tick=-1),this.followMouse(this.tick))}},{key:"followMouse",value:function(t){this.marker.params.x=t,this.marker.render()}}]),e}(c.a);e.a=p},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),i(55)),c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=function(t){function e(t,i){n(this,e);var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return a.context=i,a.node=t||i.topNode,a.contextDialog=s()("cq-study-context"),i.advertiseAs(a,"StudyEdit"),a.initialize(),a}return a(e,t),c(e,[{key:"remove",value:function(){l.CIQ.Studies.removeStudy(this.params.stx,this.params.sd),this.contextDialog.each(function(){this.close()})}},{key:"edit",value:function(){this.contextDialog.each(function(){this.close()}),this.editPanel(this.params)}},{key:"editPanel",value:function(t){t.context=this.context,t.x=null,t.y=null,s()("cq-study-dialog").each(function(){this.open(t)})}},{key:"editOverlay",value:function(t){this.params=t,t.context=this.context,t.forceEdit?this.editPanel(t):this.contextDialog.each(function(){t.x=l.CIQ.ChartEngine.crosshairX,t.y=l.CIQ.ChartEngine.crosshairY,this.open(t)})}},{key:"initialize",value:function(){function t(t){return function(){t.apply(i,arguments)}}var e=this.context.stx,i=this;e.callbacks.studyOverlayEdit=t(i.editOverlay),e.callbacks.studyPanelEdit=t(i.editPanel)}}]),e}(h.a);e.a=u},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),i(55)),c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=function(t){function e(t,i){n(this,e);var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return a.params=i||{},a.params.activeClassName||(a.params.activeClassName="ciq-active"),a.context=t,t.advertiseAs(a,"Layout"),a}return a(e,t),c(e,[{key:"getChartType",value:function(t,e){function i(t,i){var r=t.obj;r.aggregationType&&"ohlc"!==r.aggregationType?e!==r.aggregationType?s()(i).removeClass(n):s()(i).addClass(n):e!==r.chartType?s()(i).removeClass(n):s()(i).addClass(n)}var n=this.params.activeClassName;l.CIQ.UI.observe({selector:t,obj:this.context.stx.layout,member:["chartType","aggregationType"],action:"callback",value:i})}},{key:"setChartType",value:function(t,e){!{heikinashi:!0,kagi:!0,linebreak:!0,pandf:!0,rangebars:!0,renko:!0}[e]?this.context.stx.setChartType(e):this.context.stx.setAggregationType(e)}},{key:"getChartScale",value:function(t,e){l.CIQ.UI.observe({selector:t,obj:this.context.stx.layout,member:"chartScale",condition:e,action:"class",value:this.params.activeClassName})}},{key:"setChartScale",value:function(t,e){var i=this.context.stx;i.layout.chartScale===e?i.setChartScale(null):i.setChartScale(e)}},{key:"getExtendedHours",value:function(t){l.CIQ.UI.observe({selector:t,obj:this.context.stx.layout,member:"extended",condition:!0,action:"class",value:this.params.activeClassName})}},{key:"setExtendedHours",value:function(t){var e=this.context.stx;if(e.layout.extended=!e.layout.extended,e.changeOccurred("layout"),e.extendedHours){var i=this.context.loader;i&&i.show(),e.extendedHours.set(e.layout.extended,null,function(){i.hide()})}}},{key:"getRangeSlider",value:function(t){l.CIQ.UI.observe({selector:t,obj:this.context.stx.layout,member:"rangeSlider",condition:!0,action:"class",value:this.params.activeClassName})}},{key:"setRangeSlider",value:function(t){var e=this.context.stx;e.layout.rangeSlider=!e.layout.rangeSlider,e.slider&&e.slider.display(e.layout.rangeSlider),e.changeOccurred("layout")}},{key:"getAggregationType",value:function(t,e){l.CIQ.UI.observe({selector:t,obj:this.context.stx.layout,member:"aggregationType",condition:e,action:"class",value:this.params.activeClassName})}},{key:"setAggregationType",value:function(t,e){this.context.stx.layout.aggregationType===e?this.context.stx.setAggregationType(null):this.context.stx.setAggregationType(e)}},{key:"getAggregationEdit",value:function(t,e){function i(t){var e=t.selector.name,i=t.obj[t.member];!i&&n.chart.defaultChartStyleConfig[e]?s()(t.selector).val(n.chart.defaultChartStyleConfig[e]):s()(t.selector).val(i)}var n=this.context.stx,r=l.CIQ.deriveFromObjectChain(n.layout,e);l.CIQ.UI.observe({selector:t,obj:r.obj,member:r.member,action:"callback",value:i})}},{key:"setAggregationEdit",value:function(t,e){var i=this.context.stx;if("auto"===e)"kagi"===i.layout.aggregationType?i.layout.kagi=null:"renko"===i.layout.aggregationType?i.layout.renko=null:"linebreak"===i.layout.aggregationType?i.layout.priceLines=null:"rangebars"===i.layout.aggregationType?i.layout.range=null:"pandf"===i.layout.aggregationType&&(i.layout.pandf||(i.layout.pandf={box:null,reversal:null}),i.layout.pandf.box=null,i.layout.pandf.reversal=null);else{var n=l.CIQ.deriveFromObjectChain(i.layout,e);n.obj[n.member]=s()(t.node).val()}i.changeOccurred("layout"),i.createDataSet(),i.draw()}},{key:"showAggregationEdit",value:function(t,e){s()("cq-aggregation-dialog")[0].open({context:this.context,aggregationType:e})}},{key:"clearStudies",value:function(t){var e=this.context.stx;for(var i in e.layout.studies){var n=e.layout.studies[i];n.customLegend||l.CIQ.Studies.removeStudy(e,n)}e.draw()}},{key:"setPeriodicity",value:function(t,e,i,n){var r=this;r.context.loader&&r.context.loader.show(),r.context.stx.setPeriodicity({period:e,interval:i,timeUnit:n},function(){r.context.loader&&r.context.loader.hide()})}},{key:"showPeriodicity",value:function(t,e){var i="",n=t.layout.periodicity,r=t.layout.interval,a=t.layout.timeUnit;isNaN(r)&&(a=r,r=1),n*=r,i=n,"day"===a?i+="D":"week"===a?i+="W":"month"===a?i+="M":"tick"===a?i+="T":"second"===a?i+="s":"millisecond"===a?i+="ms":n>=60&&n%15==0?i=n/60+"H":i+="m",s()(e.selector).empty().append(l.CIQ.translatableTextNode(t,i))}},{key:"periodicity",value:function(t){function e(t){i.showPeriodicity(i.context.stx,t)}var i=this;l.CIQ.UI.observe({selector:t,obj:this.context.stx.layout,member:["interval","periodicity","timeUnit"],action:"callback",value:e})}},{key:"setLanguage",value:function(){s()("cq-language-dialog").each(function(){this.open()})}},{key:"getLanguage",value:function(t){function e(t,e){s()(e).find("cq-language-name").text(l.CIQ.I18N.languages[l.CIQ.I18N.language]),s()(e).find("cq-flag").attr("cq-lang",l.CIQ.I18N.language)}l.CIQ.UI.observe({selector:t,obj:l.CIQ.I18N,member:"language",action:"callback",value:e})}}]),e}(h.a);e.a=u},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),i(55)),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),p=function(t){function e(t,i,a){n(this,e);var o=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return o.node=s()(t),o.context=i,o.params=a||{},o.params.template||(o.params.template=".stxTemplate"),o.params.template=o.node.find(o.params.template),o.params.template.detach(),o.alwaysDisplayDialog=!!o.params.alwaysDisplayDialog&&o.params.alwaysDisplayDialog,o.excludedStudies=o.params.excludedStudies,o.excludedStudies||(o.excludedStudies=[]),i.advertiseAs(o,"StudyMenu"),o}return a(e,t),u(e,[{key:"renderMenu",value:function(){var t=this.context.stx,e=[],i=void 0;for(var n in l.CIQ.Studies.studyLibrary)i=l.CIQ.Studies.studyLibrary[n],i.name||(i.name=n),this.excludedStudies[n]||this.excludedStudies[i.name]||e.push(n);e.sort(function(t,e){var i=l.CIQ.Studies.studyLibrary[t],n=l.CIQ.Studies.studyLibrary[e];return i.name<n.name?-1:i.name>n.name?1:0});for(var r=s()(this.node),a=this,o=0;o<e.length;o++){var h=this.params.template.clone();i=l.CIQ.Studies.studyLibrary[e[o]],h.append(l.CIQ.translatableTextNode(t,i.name)),r.append(h),h[0].selectFC=function(t,e){return function(e){a.pickStudy(e.target,t),r.resize()}}(e[o],this.context),h.stxtap(h[0].selectFC)}}},{key:"studyDialog",value:function(t){t.context=this.context,s()("cq-study-dialog").each(function(){this.open(t)})}},{key:"pickStudy",value:function(t,e){function i(t,i){if(!0===t)return r.studyDialog(i),!0;if("object"===(void 0===t?"undefined":c(t)))for(var n in t)if(n===e&&t[n])return r.studyDialog(i),!0}var n=this.context.stx,r=this;if(!i(this.params.dialogBeforeAddingStudy,{stx:n,name:e})){var a=l.CIQ.Studies.addStudy(n,e);i(this.alwaysDisplayDialog,{sd:a,stx:n})}}}]),e}(h.a);e.a=p},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(1),s=(i.n(o),i(55)),l=i(366),h=i(100),c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=function(t){function e(t,i,a){n(this,e);var s=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,a));s.node=t,s.context=i,s.params=a||{},s.uiManager=Object(o.$$$)("cq-ui-manager"),s.uiManager&&(s.uiManager.keystrokeHub=s);var h=s;return s.keystroke=new l.a(t,function(){return function(){h.handler.apply(h,arguments)}}()),s}return a(e,t),c(e,[{key:"setActiveContext",value:function(t){this.context=t}},{key:"processKeyStrokeClaims",value:function(t,e,i,n){for(var r=h.b.length-1;r>-1;r--){var a=h.b[r].helper,o=a.keyStroke(t,e,i,n);if(o)return o.allowDefault||i.preventDefault(),!0}return!1}},{key:"handler",value:function(t){var e=this.context.stx;if(!e.editingAnnotation){var i=t.e,n=t.key,r=t.keystroke,a=t.e.target.tagName;switch(n){case 16:e.shift=r.shift;break;case 17:case 18:e.ctrl=r.ctrl;break;case 91:e.cmd=r.cmd;break;case 20:this.capsLock=!this.capsLock}!o.CIQ.ChartEngine.drawingLine&&this.processKeyStrokeClaims(this,n,i,r)||"escape"!==n&&this.context.isModal()||"INPUT"!==a&&"TEXTAREA"!==a&&this.params.cb&&this.params.cb(n,this)&&i.preventDefault()}}}],[{key:"defaultHotKeys",value:function(t,e){var i=e.context.stx,n=1;switch(t){case"up":i.zoomIn();break;case"down":i.zoomOut();break;case"home":i.home(),i.headsUpHR();break;case"end":i.chart.scroll=i.chart.dataSet.length,i.draw(),i.headsUpHR();break;case"left":i.ctrl?i.zoomOut():(n=1,(i.shift||e.capsLock)&&(n=Math.max(5,5*(8-Math.round(i.layout.candleWidth)))),i.chart.scroll+n>=i.chart.dataSet.length&&(n=i.chart.dataSet.length-i.chart.scroll),i.chart.scroll+=n,i.draw(),i.headsUpHR());break;case"right":i.ctrl?i.zoomIn():(n=1,(i.shift||e.capsLock)&&(n=Math.max(5,5*(8-Math.round(i.layout.candleWidth)))),i.chart.scroll-=n,i.draw(),i.headsUpHR());break;case"delete":case"backspace":if(o.CIQ.ChartEngine.drawingLine)i.undo();else{if(!i.anyHighlighted)return!1;i.deleteHighlighted()}break;case"escape":o.CIQ.ChartEngine.drawingLine?i.undo():e.uiManager&&e.uiManager.closeMenu();break;default:return!1}return!0}}]),e}(s.a);e.a=u},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(1),a=(i.n(r),function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}()),o=function(){function t(e,i){n(this,t),this.node=e,this.cb=i,this.initialize(),this.shift=!1,this.ctrl=!1,this.cmd=!1,this.capsLock=!1,this.downValue=""}return a(t,[{key:"androidWorkaroundKeyup",value:function(t){var e=t.target.value,i=void 0;i=e.length>this.downValue.length?e.charCodeAt(e.length-1):"delete",this.cb({key:i,e:t,keystroke:this})}},{key:"keyup",value:function(t){var e=t.which;if(this.implementAndroidWorkaround)return this.androidWorkaroundKeyup(t),void(this.implementAndroidWorkaround=!1);switch(e){case 16:return this.shift=!1,void this.cb({key:e,e:t,keystroke:this});case 17:case 18:return this.ctrl=!1,void this.cb({key:e,e:t,keystroke:this});case 91:return this.cmd=!1,void this.cb({key:e,e:t,keystroke:this})}this.key&&this.cb({key:this.key,e:t,keystroke:this})}},{key:"keydown",value:function(t){if(!this.noKeyCapture){var e=t.which;if(229===e&&r.CIQ.isAndroid)return void(this.implementAndroidWorkaround=!0);if(this.ctrl||!(91!==e&&e>=48&&e<=222||32===e)){switch(e){case 91:return void(this.cmd=!0);case 16:return void(this.shift=!0);case 17:case 18:return void(this.ctrl=!0);case 20:return void(this.capsLock=!this.capsLock)}8===e&&(e="backspace"),9===e&&(e="tab"),13===e&&(e="enter"),27===e&&(e="escape"),33===e&&(e="page up"),34===e&&(e="page down"),35===e&&(e="end"),36===e&&(e="home"),45===e&&(e="insert"),46===e&&(e="delete"),this.key=e,37!==e&&38!==e&&39!==e&&40!==e||(37===e&&(e="left"),38===e&&(e="up"),39===e&&(e="right"),40===e&&(e="down"),this.key=null,this.cb({key:e,e:t,keystroke:this}))}}}},{key:"keypress",value:function(t){if(!this.noKeyCapture){var e=t.which;e<32||e>222||(this.key=e)}}},{key:"initialize",value:function(){var t=this;this.node.addEventListener("keyup",function(e){t.keyup(e)}),this.node.addEventListener("keydown",function(e){t.downValue=e.target.value,t.keydown(e)}),this.node.addEventListener("keypress",function(e){t.keypress(e)}),window.addEventListener("blur",function(e){t.ctrl=!1,t.cb({key:17,e:e,keystroke:t})})}}]),t}();o.noKeyCapture=!1,e.a=o},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),i(33)),c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},p=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),c(e,[{key:"open",value:function(t){u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"open",this).call(this,arguments);var i=this.context.stx,n=t.aggregationType,r={kagi:{title:"Set Reversal Percentage"},renko:{title:"Set Range"},linebreak:{title:"Set Price Lines"},rangebars:{title:"Set Range"},pandf:{title:"Set Point & Figure Parameters"}};i.layout.aggregationType!==n&&i.setAggregationType(n);var a=r[n],o=this.node;o.find(".title").text(i.translateIf(a.title));for(var h in r)o.find(".ciq"+h).css(n===h?{display:""}:{display:"none"});o.find(".ciq"+n+" input").each(function(){var t=this.name;"box"!==t&&"reversal"!==t||(t="pandf."+t);var e=l.CIQ.deriveFromObjectChain(i.layout,t);e&&!e.obj[e.member]&&i.chart.defaultChartStyleConfig[this.name]&&s()(this).val(i.chart.defaultChartStyleConfig[this.name])})}}]),e}(h.a);document.registerElement("cq-aggregation-dialog",p)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(54),s=i(1),l=(i.n(s),function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}()),h=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},c=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),l(e,[{key:"insert",value:function(t,e){var i=s.CIQ.UI.makeFromTemplate(this.template);return new s.CIQ.Marker({stx:t,node:i[0],xPositioner:"none",yPositioner:"none",label:"attribution",panelName:e}),i}},{key:"attachedCallback",value:function(){this.attached||(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attachedCallback",this).call(this),this.attached=!0)}},{key:"setContext",value:function(t){this.template=this.node.find("template");var e=this.insert(t.stx,"chart"),i=this;this.addInjection("append","createDataSet",function(){var t=void 0,n=void 0;this.chart.attribution&&(t=i.messages.sources[this.chart.attribution.source],n=i.messages.exchanges[this.chart.attribution.exchange],t||(t=""),n||(n=""),t+n!==e.attr("lastAttrib")&&(e.find("cq-attrib-source").html(t),e.find("cq-attrib-quote-type").html(n),s.CIQ.I18N.translateUI(null,e[0]),e.attr("lastAttrib",t+n)));t:for(var r in this.layout.studies){var a=this.layout.studies[r].type;if(i.messages.sources[a]){for(var o=0;o<this.markers.attribution.length;o++)if(this.markers.attribution[o].params.panelName===this.layout.studies[r].panel)continue t;if(!this.panels[r])continue;t=i.messages.sources[a],n=i.messages.exchanges[a],t||(t=""),n||(n="");var l=i.insert(this,r);l.find("cq-attrib-source").html(t),l.find("cq-attrib-quote-type").html(n),s.CIQ.I18N.translateUI(null,l[0])}}})}}]),e}(o.a);c.prototype.messages={sources:{simulator:"Simulated data.",demo:"Demo data.",xignite:'<a target="_blank" href="https://www.xignite.com">Market Data</a> by Xignite.',Twiggs:'Formula courtesy <a target="_blank" href="https://www.incrediblecharts.com/indicators/twiggs_money_flow.php">IncredibleCharts</a>.'},exchanges:{RANDOM:"Data is randomized.","REAL-TIME":"Data is real-time.",DELAYED:"Data delayed 15 min.",BATS:"BATS BZX real-time.",EOD:"End of day data."}},document.registerElement("cq-attribution",c)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(54),h=i(1),c=(i.n(h),function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}()),u=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},p=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),c(e,[{key:"attachedCallback",value:function(){this.attached||(u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attachedCallback",this).call(this),this.attached=!0)}},{key:"setContext",value:function(t){var e=this;h.CIQ.UI.observe({obj:e.context.stx.chart.symbolObject,action:"callback",value:function(){e.context.stx.currentQuote()&&(e.previousClose=e.context.stx.currentQuote().iqPrevClose)}}),this.initialize()}},{key:"begin",value:function(){var t=this;this.addInjection("append","createDataSet",function(){t.update()}),this.update()}},{key:"initialize",value:function(t){this.params=t||{},void 0===this.params.autoStart&&(this.params.autoStart=!0),this.marker=null,this.params.autoStart&&this.begin()}},{key:"update",value:function(){var t=this.context.stx,e=s()(this);t.chart.dataSet&&t.chart.dataSet.length?e.addClass("stx-show"):e.removeClass("stx-show");var i=e.find("cq-symbol"),n=e.find("cq-symbol-description"),r=e.find("cq-current-price"),a=e.find("cq-todays-change"),o=e.find("cq-todays-change-pct"),l=e.find("cq-chart-price"),c=e.find("cq-change"),u=this.node.truthyAttr("cq-browser-tab"),p=l.length,d=t.chart.symbol,f=t.chart.symbolDisplay,m=t.internationalizer,g=!1;i.textBetter(d);var v="",y=0,b="",x="",w=t.currentQuote();if((x=w?w.Close:"")&&p){var C=parseFloat(r.text());r.textBetter(t.formatYAxisPrice(x,t.chart.panel))&&(g=!0,void 0!==r.attr("cq-animate")&&h.CIQ.UI.animatePrice(r,x,C))}if(n.textBetter(f||d),(p||u)&&d&&g){var S=this.previousClose?this.previousClose:w?w.iqPrevClose:null;w&&S?(v=h.CIQ.fixPrice(w.Close-S),y=v/S*100,b=m?m.percent2.format(y/100):y.toFixed(2)+"%",c.css({display:"block"})):c.css({display:"none"});var T=Math.abs(v);T&&a.textBetter(t.formatYAxisPrice(T,t.chart.panel)),o.textBetter(b),""!==b&&y>0?l.removeClass("stx-down").addClass("stx-up"):""!==b&&y<0?l.removeClass("stx-up").addClass("stx-down"):l.removeClass("stx-down").removeClass("stx-up"),this.title=d+" ​ ​ "+x+" ​ ​ ​ ",y>0?this.title+="▲ "+T:y<0&&(this.title+="▼ "+T),u&&(document.title=this.title)}}}]),e}(l.a);p.prototype.previousClose=null,document.registerElement("cq-chart-title",p)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(30),s=i(1),l=(i.n(s),function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}()),h=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},c=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),l(e,[{key:"attachedCallback",value:function(){function t(){i.tap()}if(!this.attached){var i=this;this.addEventListener("stxtap",t),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attachedCallback",this).call(this),this.attached=!0}}},{key:"tap",value:function(){s.CIQ.UI.containerExecute(this,"close")}}]),e}(o.a);document.registerElement("cq-close",c)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),i(372)),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),p=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},d=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),u(e,[{key:"createdCallback",value:function(){p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createdCallback",this).call(this),this.params={colorMap:[["#ffffff","#e1e1e1","#cccccc","#b7b7b7","#a0a0a5","#898989","#707070","#626262","#555555","#464646","#363636","#262626","#1d1d1d","#000000"],["#f4977c","#f7ac84","#fbc58d","#fff69e","#c4de9e","#85c99e","#7fcdc7","#75d0f4","#81a8d7","#8594c8","#8983bc","#a187bd","#bb8dbe","#f29bc1"],["#ef6c53","#f38d5b","#f8ae63","#fff371","#acd277","#43b77a","#2ebbb3","#00bff0","#4a8dc8","#5875b7","#625da6","#8561a7","#a665a7","#ee6fa9"],["#ea1d2c","#ee652e","#f4932f","#fff126","#8ec648","#00a553","#00a99c","#00afed","#0073ba","#0056a4","#323390","#66308f","#912a8e","#e9088c"],["#9b0b16","#9e4117","#a16118","#c6b920","#5a852d","#007238","#00746a","#0077a1","#004c7f","#003570","#1d1762","#441261","#62095f","#9c005d"],["#770001","#792e03","#7b4906","#817a0b","#41661e","#005827","#005951","#003b5c","#001d40","#000e35","#04002c","#19002b","#2c002a","#580028"]]}}},{key:"attachedCallback",value:function(){if(!this.attached){p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attachedCallback",this).call(this);var t=s()(this),i=t.attr("cq-colors");if(i){i=i.split(",");var n=Math.ceil(Math.sqrt(i.length));this.params.colorMap=[],console.log("this.params.colorMap=[]"),console.log(c(this.params.colorMap));for(var r=0,a=[],o=0;o<i.length;o++)r>=n&&(r=0,this.params.colorMap.push(a),a=[]),a.push(i[o]),r++;this.params.colorMap.push(a)}this.cqOverrides=t.find("cq-overrides"),this.template=this.cqOverrides.find("template"),this.initialize(),this.attached=!0}}},{key:"setColors",value:function(t){this.params.colorMap=t,this.initialize()}},{key:"initialize",value:function(){var t=this;this.picker=s()(this),this.colors=this.picker.find("cq-colors"),this.colors.length||(this.colors=this.picker),this.colors.empty();for(var e=0;e<this.params.colorMap.length;e++)for(var i=this.params.colorMap[e],n=s()("<UL></UL>").appendTo(this.colors),r=0;r<i.length;r++){var a=s()("<LI></LI>").appendTo(n),o=s()("<SPAN></SPAN>").appendTo(a);o.css({"background-color":i[r]}),o.stxtap(function(t,e){return function(){t.pickColor(e)}}(t,i[r]))}}},{key:"pickColor",value:function(t){this.callback&&this.callback(t),this.close()}},{key:"resize",value:function(){}},{key:"display",value:function(t){var e=s()(t.node),i=e[0].getBoundingClientRect();this.picker.css({top:"0px",left:"0px"});var n=this.parentNode.getBoundingClientRect(),r=i.left-n.left+e.width()+10,a=i.top-n.top+5,o=s()(document).width(),h=this.picker.width();r+h>o&&(r=o-h-20);var c=s()(document).height(),u=this.picker.height();if(a+u>c&&(a=c-u-20),this.picker.css({left:r+"px",top:a+"px"}),this.cqOverrides.emptyExceptTemplate(),t.overrides&&this.template.length)for(var p=0;p<t.overrides.length;p++){var d=t.overrides[p],f=l.CIQ.UI.makeFromTemplate(this.template,!0);f.text(d),f.stxtap(function(t,e){return function(){t.pickColor(e)}}(this,d))}this.picker.hasClass("stxMenuActive")?this.context.e&&this.context.e.stopPropagation():this.picker[0].open()}}]),e}(h.a);document.registerElement("cq-color-picker",d)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(1),s=(i.n(o),i(72)),l=i(373),h=i(30),c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},p=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),c(e,[{key:"createdCallback",value:function(){u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createdCallback",this).call(this),this.activeAttributes={}}},{key:"attachedCallback",value:function(){if(!this.attached){this.isDialog=!0,u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attachedCallback",this).call(this);var t=this;this.node[0].addEventListener("stxtap",function(e){t.tap(e)});var i=Object(o.$$$)("cq-ui-manager");i.registerForResize(this),this.uiManager=i}}},{key:"detachedCallback",value:function(){Object(o.$$$)("cq-ui-manager").unregisterForResize(this)}},{key:"addActiveAttribute",value:function(t){this.activeAttributes[t]=!0}},{key:"tap",value:function(t){if(this.uiManager.topMenu()===this)return void t.stopPropagation();t.currentTarget.active||t.stopPropagation()}},{key:"resize",value:function(){this.params&&this.params.x?this.stxContextMenu():this.center();var t=Object(o.$$$)("cq-scroll",this.node[0]);t&&t.resize()}},{key:"stxContextMenu",value:function(){var t=this.node[0].parentNode;"BODY"===t.tagName&&(t=window);var e=Object(l.a)(t).guaranteedWidth(),i=Object(l.a)(t).guaranteedHeight(),n=this.node[0].offsetWidth,r=this.node[0].offsetHeight,a=this.params.x,o=this.params.y;a+n>e&&(a=e-n),o+r>i&&(o-=r),o<0&&(o=0),this.node[0].style.top=o+"px",this.node[0].style.left=a+"px"}},{key:"center",value:function(){var t=this.node[0].parentNode;"BODY"===t.tagName&&(t=window);var e=Object(l.a)(t).guaranteedWidth(),i=Object(l.a)(t).guaranteedHeight(),n=this.node[0].offsetWidth,r=this.node[0].offsetHeight,a=e/2-n/2,o=i/2-r/2;a<0&&(a=0),i>2*r&&o+r/2>i/3&&(o=i/3-r/2),o<0&&(o=0),this.node[0].style.top=o+"px",this.node[0].style.left=a+"px"}},{key:"open",value:function(t){this.uiManager.openMenu(this,t)}},{key:"close",value:function(){this.uiManager.closeMenu(this)}},{key:"hide",value:function(){if(!Object(o.$$$)(":invalid",this)){[].forEach.call(this.node[0].children,function(t){"function"==typeof t.hide&&t.hide()}),this.active=!1,this.uiManager.overlay&&Object(l.a)(this.uiManager.overlay).removeAttribute("cq-active"),this.uiManager.overlay=null;for(var t in this.activeAttributes)Object(l.a)(this.node[0]).removeAttribute(t);this.activeAttributes={},this.querySelectorAll("input").forEach(function(t){t===document.activeElement&&t.blur()})}}},{key:"show",value:function(t){this.params=t,t||(t=this.params={});var e=this;this.uiManager.overlay||t.bypassOverlay||(this.uiManager.overlay=Object(s.a)("<cq-dialog-overlay></cq-dialog-overlay>"),document.body.appendChild(this.uiManager.overlay)),setTimeout(function(){e.uiManager.overlay&&!t.bypassOverlay&&Object(l.a)(e.uiManager.overlay).setAttribute("cq-active"),e.activeAttributes["cq-active"]=!0;for(var i in e.activeAttributes)Object(l.a)(e.node[0]).setAttribute(i);e.resize(),e.active=!0})}}]),e}(h.a);p.prototype.activeAttributes=null,document.registerElement("cq-dialog",p),e.a=p},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){return new o(t)}var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=function(){function t(e){n(this,t),this.element=e}return a(t,[{key:"setAttribute",value:function(t,e){void 0===e&&(e="true"),this.element.getAttribute(t)!==e&&this.element.setAttribute(t,e)}},{key:"removeAttribute",value:function(t){var e=this.element.getAttribute(t);(e||""===e)&&this.element.removeAttribute(t)}},{key:"guaranteedWidth",value:function(){for(var t=this.element,e=t.getBoundingClientRect().width;!e;){if(t=t.parentNode,"BODY"===t.tagName||t===window)return window.innerWidth;e=t.getBoundingClientRect().width}return e}},{key:"guaranteedHeight",value:function(){for(var t=this.element,e=t.getBoundingClientRect().height;!e;){if(t=t.parentNode,"BODY"===t.tagName||t===window)return window.innerHeight;e=t.getBoundingClientRect().height}return e}}]),t}();e.a=r},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(54),h=i(1),c=(i.n(h),function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}()),u=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},p=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),c(e,[{key:"attachedCallback",value:function(){this.attached||(u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attachedCallback",this).call(this),this.attached=!0,this.swatchColors=["#8ec648","#00afed","#ee652e","#912a8e","#fff126","#e9088c","#ea1d2c","#00a553","#00a99c","#0056a4","#f4932f","#0073ba","#66308f","#323390"],this.loading=[])}},{key:"removeSeries",value:function(t,e){this.context.stx.removeSeries(t)}},{key:"pickSwatchColor",value:function(){var t=s()(this),e=this.context.stx,i=t.find("cq-swatch");if(i.length){var n=i[0].style.backgroundColor,r={};for(var a in e.chart.series){var o=e.chart.series[a];o.parameters.isComparison&&(r[o.parameters.color]=!0)}if(""===n||r[n])for(var l=0;l<this.swatchColors.length;l++)if(!r[this.swatchColors[l]])return void(i[0].style.backgroundColor=this.swatchColors[l])}}},{key:"renderLegend",value:function(){var t=s()(this),e=t.find("cq-comparison-key").cqvirtual(),i=this.context.stx,n=i.currentQuote();for(var r in i.chart.series){var a=i.chart.series[r];if(a.parameters.isComparison){var o=h.CIQ.UI.makeFromTemplate(this.template),l=o.find("cq-comparison-swatch"),c=o.find("cq-comparison-label"),u=o.find("cq-comparison-description"),p=o.find("cq-comparison-price"),d=o.find("cq-comparison-loader"),f=o.find(".ciq-close");l.css({"background-color":a.parameters.color}),c.text(i.translateIf(a.display)),u.text(i.translateIf(a.description)),o.attr("cq-symbol",r);var m=a.parameters.symbol;p.length&&n&&p.text(i.padOutPrice(n[m])),this.loading[a.parameters.symbolObject.symbol]?d.addClass("stx-show"):d.removeClass("stx-show"),a.parameters.error&&o.attr("cq-error",!0),a.parameters.permanent?f.hide():f.stxtap(function(t,e,i){return function(){t.nomore=!0,t.removeSeries(e,i),t.modalEnd()}}(this,r,a)),e.append(o)}}e.cqrender(),this.pickSwatchColor()}},{key:"updatePrices",value:function(){var t=void 0,e=this.context.stx,i=e.currentQuote();if(i)for(var n in e.chart.series){t||(t=this.node.find("cq-comparison-key"));var r=t.find('cq-comparison-item[cq-symbol="'+n+'"] cq-comparison-price');if(r.length){var a=parseFloat(r.text()),o=e.chart.series[n].parameters.symbol,s=i[o];s||(s=e.chart.series[n].lastQuote),r.text(e.padOutPrice(s)),void 0!==r.attr("cq-animate")&&h.CIQ.UI.animatePrice(r,s,a)}}}},{key:"startPriceTracker",value:function(t){var e=this;this.addInjection("append","createDataSet",function(){t&&e.updatePrices(),this.chart.dataSet&&this.chart.dataSet.length?e.node.attrBetter("cq-show"):e.node.removeAttrBetter("cq-show")})}},{key:"position",value:function(){function t(){var t=void 0;r.timeout=null;for(var i in e.chart.series){t||(t=r.node.find("cq-comparison-key"));var a=t.find('cq-comparison-item[cq-symbol="'+i+'"] cq-comparison-tick-price');if(a.textBetter(""),a.length&&n&&n.data){var o=e.chart.series[i].parameters.symbol;a.textBetter(e.padOutPrice(n.data[o]))}}}var e=this.context.stx,i=e.barFromPixel(e.cx);this.tick=e.tickFromPixel(e.cx);var n=e.chart.xaxis[i],r=this;if(this.tick!==this.prevTick){this.timeout&&clearTimeout(this.timeout);this.timeout=setTimeout(t,0)}this.prevTick=this.tick}},{key:"startTickPriceTracker",value:function(){this.prevTick=null,this.addInjection("prepend","headsUpHR",function(t){return function(){t.position()}}(this))}},{key:"setContext",value:function(t){var e=this.context.stx.chart;this.node.attr("cq-show","true"),this.configureUI();var i=this;h.CIQ.UI.observe({obj:e.series,action:"callback",value:function(){i.renderLegend()}});var n=h.CIQ.UI.makeFromTemplate(this.template);this.startPriceTracker(n.find("cq-comparison-price").length),n.find("cq-comparison-tick-price")&&this.startTickPriceTracker()}},{key:"selectItem",value:function(t,e){function i(t,e){t&&(e.parameters.error=!0),n.loading[e.parameters.symbolObject.symbol]=!1,n.renderLegend()}var n=this,r=this.node.find("cq-swatch"),a="auto",o=null,s=1;if(r[0]){var l=r[0].style;a=l.backgroundColor,o=l.borderTopStyle,s=l.width}var h=t.stx;this.loading[e.symbol]=!0;for(var c={symbolObject:e,isComparison:!0,color:a,pattern:o,width:s,data:{useDefaultQuoteFeed:!0},forceData:!0},u=h.getSeries({symbolObject:e}),p=0;p<u.length;p++)if(u[p].parameters.isComparison)return;t.stx.chart.symbol.toLowerCase()!==e.symbol.toLowerCase()&&e.symbol.trim().length>0&&h.addSeries(e.symbol,c,i)}},{key:"configureUI",value:function(){var t=this.node,e=t.find("cq-accept-btn");this.template=t.find("*[cq-comparison-item]");var i=t.find("cq-swatch").attr("cq-colors");i&&(this.swatchColors=i.split(","));for(var n=0;n<this.swatchColors.length;n++)this.swatchColors[n]=h.CIQ.convertToNativeColor(this.swatchColors[n]);var r=t.find("cq-lookup");r.length&&r[0].setCallback(function(t){return function(){t.selectItem.apply(t,arguments)}}(this)),e.stxtap(function(t){r[0].forceInput(),t.stopPropagation()}),t.find("input").stxtap(function(){this.focus()})}}]),e}(l.a);document.registerElement("cq-comparison",p)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),i(13)),c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},p=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),c(e,[{key:"attachedCallback",value:function(){this.attached||(u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attachedCallback",this).call(this),this.node=s()(this),this.params={toolSelection:this.node.find("*[cq-current-tool]"),lineSelection:this.node.find("*[cq-line-style]"),fontSizeSelection:this.node.find("*[cq-font-size]"),fontFamilySelection:this.node.find("*[cq-font-family]")},this.noToolSelectedText="",this.attached=!0)}},{key:"defaultElements",value:function(t){var e=[];for(var i in t)"color"===i?e.push("cq-line-color"):"fillColor"===i?e.push("cq-fill-color"):"pattern"===i||"lineWidth"===i?e.push("cq-line-style"):"axisLabel"===i?e.push("cq-axis-label"):"font"===i?e.push("cq-annotation"):"parameters"===i&&e.push("cq-clickable");return e}},{key:"setContext",value:function(t){this.noToolSelectedText=s()(this.params.toolSelection).text(),this.sync()}},{key:"sync",value:function(t){var e=this.context.stx;t?e.currentVectorParameters=t:t=e.currentVectorParameters,this.setLine(null,t.lineWidth,t.pattern);var i=e.canvasStyle("stx_annotation"),n=t.annotation.font.size;n||(n=i.fontSize),this.setFontSize(null,n);var r=t.annotation.font.family;r||(r=i.fontFamily),this.setFontFamily(null,r),this.getFillColor({}),this.getLineColor({})}},{key:"emit",value:function(){var t=document.createEvent("Event");t.initEvent("change",!0,!0),this.dispatchEvent(t)}},{key:"noTool",value:function(){var t=this.context.stx;t.changeVectorType(null),t.layout.crosshair&&(t.layout.crosshair=!1,t.changeOccurred("layout"),t.doDisplayCrosshairs()),t.preferences.magnet&&this.toggleMagnet(this),s()(this.params.toolSelection).text(this.noToolSelectedText),this.node.find("*[cq-section]").removeClass("ciq-active"),this.emit()}},{key:"crosshairs",value:function(t){var e=this.context.stx;s()(this.params.toolSelection).text(e.translateIf(s()(t.node).text())),e.changeVectorType(null),e.layout.crosshair=!0,e.doDisplayCrosshairs(),e.findHighlights(!1,!0),e.changeOccurred("layout"),e.draw(),e.updateChartAccessories(),this.node.find("*[cq-section]").removeClass("ciq-active"),this.emit()}},{key:"toggleMagnet",value:function(t){var e=s()(t.node),i=this.context.stx;i.preferences.magnet?(e.removeClass("active"),i.preferences.magnet=!1):(e.addClass("active"),i.preferences.magnet=!0),l.CIQ.clearCanvas(i.chart.tempCanvas,i)}},{key:"clearDrawings",value:function(){this.context.stx.clearDrawings()}},{key:"tool",value:function(t,e){var i=this.context.stx;i.clearMeasure(),i.changeVectorType(e),s()(this.params.toolSelection).text(i.translateIf(s()(t.node).text())),this.node.find("*[cq-section]").removeClass("ciq-active");var n=l.CIQ.Drawing.getDrawingParameters(i,e);if(n){"fibtimezone"===e&&delete n.parameters;for(var r=this.defaultElements(n),a=0;a<r.length;a++)s()(this.node).find(r[a]).addClass("ciq-active")}this.emit()}},{key:"setLine",value:function(t,e,i){var n=this.context.stx;n.currentVectorParameters.lineWidth=e,n.currentVectorParameters.pattern=i,this.setFibs(e,i),this.currentLineSelectedClass&&s()(this.params.lineSelection).removeClass(this.currentLineSelectedClass),this.currentLineSelectedClass="ciq-"+i+"-"+parseInt(e,10),"none"===i?this.currentLineSelectedClass=null:s()(this.params.lineSelection).addClass(this.currentLineSelectedClass),this.emit()}},{key:"setFibs",value:function(t,e){var i=this.context.stx.currentVectorParameters.fibonacci;if(i){for(var n=0;n<i.fibs.length;n++)i.fibs[n].parameters.lineWidth=t,i.fibs[n].parameters.pattern=e;i.timezone.parameters.lineWidth=t,i.timezone.parameters.pattern=e}}},{key:"setFontSize",value:function(t,e){this.context.stx.currentVectorParameters.annotation.font.size=e,s()(this.params.fontSizeSelection).text(e),this.emit()}},{key:"setFontFamily",value:function(t,e){var i=this.context.stx;i.currentVectorParameters.annotation.font.family="Default"===e?null:e,s()(this.params.fontFamilySelection).text(e),this.emit()}},{key:"toggleFontStyle",value:function(t,e){var i=this.context.stx;"italic"===e?"italic"===i.currentVectorParameters.annotation.font.style?(i.currentVectorParameters.annotation.font.style=null,s()(t.node).removeClass("ciq-active")):(i.currentVectorParameters.annotation.font.style="italic",s()(t.node).addClass("ciq-active")):"bold"===e&&("bold"===i.currentVectorParameters.annotation.font.weight?(i.currentVectorParameters.annotation.font.weight=null,s()(t.node).removeClass("ciq-active")):(i.currentVectorParameters.annotation.font.weight="bold",s()(t.node).addClass("ciq-active"))),this.emit()}},{key:"toggleAxisLabel",value:function(t){var e=this.context.stx;!0===e.currentVectorParameters.axisLabel?(e.currentVectorParameters.axisLabel=!1,s()(t.node).removeClass("ciq-active")):(e.currentVectorParameters.axisLabel=!0,s()(t.node).addClass("ciq-active")),this.emit()}},{key:"getFillColor",value:function(t){var e=t.node;e||(e=s()(this).find("cq-fill-color"));var i=this.context.stx.currentVectorParameters.fillColor;s()(e).css({"background-color":i})}},{key:"pickFillColor",value:function(t){var e=t.node,i=s()("cq-color-picker");if(!i.length)return void console.log("DrawingToolbar.prototype.getFillColor: no ColorPicker available");var n=i[0],r=this;n.callback=function(t){r.context.stx.currentVectorParameters.fillColor=t,r.getFillColor({node:e}),r.emit()},n.display({node:e})}},{key:"getLineColor",value:function(t){var e=t.node;e||(e=s()(this).find("cq-line-color"));var i=this.context.stx.currentVectorParameters.currentColor;"transparent"!==i&&"auto"!==i||(i=""),s()(e).css({"background-color":i})}},{key:"pickLineColor",value:function(t){var e=t.node,i=s()("cq-color-picker");if(!i.length)return void console.log("DrawingToolbar.prototype.getFillColor: no ColorPicker available");var n=i[0],r=this;n.callback=function(t){r.context.stx.currentVectorParameters.currentColor=t,r.getLineColor({node:e}),r.emit()};var a=s()(e).attr("cq-overrides");a&&(a=a.split(",")),n.display({node:e,overrides:a})}}]),e}(h.a);document.registerElement("cq-toolbar",p)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(1),s=(i.n(o),i(33)),l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),h=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},c=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),l(e,[{key:"setChangeEvent",value:function(t,e,i){var n=this;t.change(function(){return function(){var t=n.context.stx.currentVectorParameters,e=t.vectorType;if(t.fibonacci&&"fibtimezone"!==e){var r=t.fibonacci.fibs;if("checkbox"===this.type)for(var a in r){var o=r[a];o.level===i&&(o.display=!!this.checked)}}}}())}},{key:"open",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"open",this).call(this,arguments);var i=this.context.stx.currentVectorParameters,n=i.vectorType,r=$(this),a=void 0;if(i.fibonacci&&"fibtimezone"!==n){r.find(".title").text("Fibonacci Settings");var s=i.fibonacci.fibs||{};a=r.find("cq-fibonacci-settings"),a.emptyExceptTemplate();for(var l in s){var c=s[l];if(!("fibarc"===n&&c.level<0)){var u=o.CIQ.UI.makeFromTemplate(this.node.find("template"),a),p=100*c.level;u.find(".ciq-heading").text(p.toFixed(1)+"%");var d=u.find("input");c.display&&d.prop("checked",!0),this.setChangeEvent(d,"fib",c.level),u.find(".stx-data").append(d)}}}else r.find(".title").text("Settings"),a=r.find("cq-fibonacci-settings"),a.emptyExceptTemplate()}}]),e}(s.a);document.registerElement("cq-fib-settings-dialog",c)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),i(33)),c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},p=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),c(e,[{key:"open",value:function(t){u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"open",this).call(this,arguments);var i=this.node.find("cq-languages");i.emptyExceptTemplate();var n=this.node.find("template"),r=l.CIQ.I18N.languages;if(r)for(var a in r){var o=l.CIQ.UI.makeFromTemplate(n,i);o.find("cq-language-name").text(r[a]),o.find("cq-flag").attr("cq-lang",a),o.stxtap(function(t){return function(){l.CIQ.UI.contextsForEach(function(){var e=this.stx;e.preferences.language=t,e.changeOccurred("preferences"),l.CIQ.I18N.localize(e,t),e.draw()})}}(a))}}},{key:"close",value:function(){s()("cq-language-dialog").closest("cq-dialog,cq-menu").each(function(){this.close()})}}]),e}(h.a);document.registerElement("cq-language-dialog",p)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(13),h=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),c=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),h(e,[{key:"setContext",value:function(t){this.context.setLoader(this)}},{key:"show",value:function(){s()(this).addClass("stx-show")}},{key:"hide",value:function(){s()(this).removeClass("stx-show")}}]),e}(l.a);document.registerElement("cq-loader",c)},function(t,e,i){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=i(2),l=i.n(s),h=i(1),c=(i.n(h),i(13)),u=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),p=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},d=function(t){function e(){return r(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"attachedCallback",value:function(){this.attached||(this.usingEmptyDriver=!1,p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attachedCallback",this).call(this),this.attached=!0,this.currentFilter=null,this.params={})}},{key:"setContext",value:function(t){this.initialize()}},{key:"attachDriver",value:function(t){this.driver=t}},{key:"setCallback",value:function(t){this.params.cb=t}},{key:"setDriver",value:function(t){this.params.driver=t}},{key:"initialize",value:function(){var t=l()(this);this.resultList=t.find("cq-scroll"),this.input=t.find("input"),this.input.length||(this.input=t.append(l()("<input type='hidden'>")),this.input[0].value="");var e=this;this.input.on("paste",function(t){var i=t.target;setTimeout(function(){e.acceptText(i.value,e.currentFilter)},0)});var i=t.find("cq-lookup-filters");i&&i.find("cq-filter").stxtap(function(){i.find("cq-filter").removeClass("true");var t=l()(this);t.addClass("true");var n=t.find("translate");n.length?e.currentFilter=n.attr("original"):e.currentFilter=this.innerHTML,e.acceptText(e.input[0].value,e.currentFilter)}),void 0!==t.attr("cq-keystroke-claim")&&this.addClaim(this)}},{key:"selectItem",value:function(t,e){this.params.cb&&this.params.cb(this.context,t,e)}},{key:"open",value:function(){this.node.closest("cq-dialog,cq-menu").each(function(){this.open()})}},{key:"close",value:function(){this.node.closest("cq-dialog,cq-menu").each(function(){this.close()})}},{key:"isActive",value:function(){return""!==this.input[0].value}},{key:"acceptText",value:function(t,e){function i(t){n.results(t)}var n=this;this.params.driver||(this.context.lookupDriver?this.setDriver(this.context.lookupDriver):(this.setDriver(new h.CIQ.UI.Lookup.Driver),this.usingEmptyDriver=!0)),this.params.driver.acceptText(t,e,null,i)}},{key:"forceInput",value:function(){var t=this.input[0];this.selectItem({symbol:t.value}),h.CIQ.blur(this.input),this.close(),t.value=""}},{key:"keyStroke",value:function(t,e,i,r){if(r.ctrl||91===e)return!1;var a=l()(this).parents().addBack(),o=this.input[0],s=!1,c=document.activeElement===o;if(!c&&document.activeElement&&("INPUT"===document.activeElement.tagName||"TEXTAREA"===document.activeElement.tagName))return!1;var u=!1,p=!1;if(a.hasClass("stxMenuActive")&&(p=!0),(c||p)&&(u=!0),!u){if(void 0===this.node.attr("cq-keystroke-default"))return;if(!p&&this.uiManager.topMenu())return}if(32===e&&""===o.value)return!1;var d=this;if(e>=32&&e<=222&&(c||(o.value+=String.fromCharCode(e)),d.acceptText(o.value,d.currentFilter),s=!0),"delete"===e||"backspace"===e){if(this.context.stx.anyHighlighted)return!1;o.value.length&&(window.getSelection().toString()?o.value="":(c||(o.value=o.value.substring(0,o.value.length-1)),o.value.length&&d.acceptText(o.value,d.currentFilter)),s=!0),"backspace"===e&&(s=!0)}if("escape"===e&&p&&(o.value="",this.close(),h.CIQ.blur(o),s=!0),"enter"===e&&""!==o.value&&this.isActive()){var f=this.node.find("cq-scroll");if((c=f.length&&f[0].focused())&&c.selectFC){var m;(m=c).selectFC.apply(m,n({}))}else{var g=o.value;this.node.truthyAttr("cq-uppercase")&&(g=g.toUpperCase()),this.selectItem({symbol:g})}h.CIQ.blur(this.input),this.close(),o.value="",s=!0}return s?(!this.usingEmptyDriver&&(o.value.length||"escape"!==e&&"enter"!==e&&c)?this.open():this.close(),!c||{allowDefault:!0}):void 0}},{key:"results",value:function(t){this.resultList.empty();for(var e=0;e<t.length;e++){for(var i=t[e],n="<cq-item>",r=0;r<i.display.length;r++)n+="<SPAN>"+i.display[r]+"</SPAN>";n+="</cq-item>";var a=l()(n);this.resultList.append(a),a[0].selectFC=function(t,e){return function(i){h.CIQ.blur(t.input),t.selectItem(e),t.input[0].value=""}}(this,i.data),a.stxtap(a[0].selectFC)}var o=this.node.find("cq-scroll");o.length&&o[0].top()}}]),e}(c.a);document.registerElement("cq-lookup",d)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),c=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),h(e,[{key:"createdCallback",value:function(){this.node=s()(this),this.activeClassName="stxMenuActive",this.active=!1}},{key:"attachedCallback",value:function(){function t(t){i.tap(t)}function e(t){i.captureTap(t)}if(!this.attached&&(this.uiManager=s()("cq-ui-manager"),this.uiManager.length>0&&(this.uiManager=this.uiManager[0]),this.attached=!0,!this.node.attr("readonly"))){var i=this,n=this.node[0];this.node.stxtap(t),n.addEventListener("stxtap",e,!0)}}},{key:"open",value:function(t){this.uiManager.openMenu(this,t)}},{key:"close",value:function(){this.uiManager.closeMenu(this)}},{key:"lift",value:function(){for(var t=this.lifts=this.uiManager.findLifts(this),e=0;e<t.length;e++)this.uiManager.lift(t[e])}},{key:"unlift",value:function(){var t=this.lifts;if(t){for(var e=0;e<t.length;e++)this.uiManager.restoreLift(t[e]);this.lifts=null}}},{key:"show",value:function(t){if(!this.active){this.active=!0,this.node.addClass(this.activeClassName),this.lift();this.node.find("cq-scroll").each(function(){this.resize()})}}},{key:"hide",value:function(){this.active&&(this.unlift(),this.node.removeClass(this.activeClassName),this.active=!1,s()(this).find("input").each(function(){this===document.activeElement&&this.blur()}))}},{key:"captureTap",value:function(t){var e=s()(t.target),i=e.parents().addBack();this.noClose=i.filter(function(){var t=s()(this).attr("cq-no-close");return"undefined"!==(void 0===t?"undefined":l(t))&&!1!==t}).length,this.noClose||(this.noClose=i.filter(function(){return s()(this).is("cq-separator,cq-heading")}).length)}},{key:"tap",value:function(t){var e=this.uiManager;if(this.active)t.stopPropagation(),this.noClose||e.closeMenu(this);else if(!this.active){t.stopPropagation();var i=s()(t.target),n=i.parents("cq-menu-dropdown");if(n.length)return;for(var r=!1,a=this.node.parents("cq-menu,cq-dialog"),o=0;o<a.length;o++)a[o].active&&(r=!0);r||e.closeMenu(),this.open()}}}]),e}(HTMLElement);document.registerElement("cq-menu",c)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(100),h=i(13),c=i(139),u=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),p=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),u(e,[{key:"createdCallback",value:function(){if(this.ownerDocument===document){var t=s()(this);h.a.prototype.createdCallback.apply(this),void 0===t.attr("cq-no-scroll")&&c.a.prototype.createdCallback.apply(this)}}},{key:"attachedCallback",value:function(){if(!this.attached){var t=s()(this);this.noMaximize=!0,h.a.prototype.attachedCallback.apply(this),this.attached=!1,void 0===t.attr("cq-no-scroll")&&c.a.prototype.attachedCallback.apply(this),this.attached=!0}}}]),e}(Object(l.a)(h.a,c.a));document.registerElement("cq-menu-dropdown",p)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(13),h=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),c=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},u=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),h(e,[{key:"attachedCallback",value:function(){this.attached||(c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attachedCallback",this).call(this),this.attached=!0)}},{key:"pairUp",value:function(t){this.undo=s()(t)[0],this.undo.redoButton=this;var e=this;this.addEventListener("stxtap",function(){e.undo.redo()})}}]),e}(l.a);document.registerElement("cq-redo",u)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(13),h=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),c=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),h(e,[{key:"tap",value:function(t){var e=this.context;s()("cq-share-dialog").each(function(){this.open({context:e})})}}]),e}(l.a);document.registerElement("cq-share-button",c)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),i(33)),c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},p=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),c(e,[{key:"setState",value:function(t){this.node.find("cq-share-create").css({display:"none"}),this.node.find("cq-share-generating").css({display:"none"}),this.node.find("cq-share-uploading").css({display:"none"}),this.node.find("cq-share-"+t).css({display:"inline-block"})}},{key:"close",value:function(){s()("cq-share-dialog .share-link-div").html(""),u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"close",this).call(this)}},{key:"share",value:function(){var t=this.context.stx,e=this;this.setState("generating"),s()("cq-share-dialog .share-link-div").html(""),l.CIQ.UI.bypassBindings=!0,l.CIQ.Share.createImage(t,{hide:[".stx_chart_controls"]},function(i){l.CIQ.UI.bypassBindings=!1;var n=l.CIQ.uniqueID(),r="https://share.chartiq.com",a=t.getStartDateOffset(),o={layout:t.exportLayout(),drawings:t.exportDrawings(),xOffset:a,startDate:t.chart.dataSegment[a].Date,endDate:t.chart.dataSegment[t.chart.dataSegment.length-1].Date,id:n,symbol:t.chart.symbol},h=r+"/upload/"+n,c={id:n,image:i,config:o};e.setState("uploading"),l.CIQ.Share.uploadImage(i,h,c,function(t,i){e.setState("create"),null!==t?l.CIQ.alert("error: "+t):s()("cq-share-dialog .share-link-div").html(r+i)})})}}]),e}(h.a);document.registerElement("cq-share-dialog",p)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(1),s=(i.n(o),i(13)),l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),h=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),l(e,[{key:"set",value:function(t,e,i,n,r){var a=this;a.context.loader&&a.context.loader.show();var o={multiplier:e,base:i};n&&(o.periodicity={interval:n,period:r||1}),a.context.stx.setSpan(o,function(){a.context.loader&&a.context.loader.hide()})}}]),e}(s.a);document.registerElement("cq-show-range",h)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(13),h=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),c=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},u=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),h(e,[{key:"createdCallback",value:function(){c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createdCallback",this).call(this,arguments),this.callbacks=[]}},{key:"registerCallback",value:function(t){this.callbacks.push(t)}},{key:"open",value:function(t){this.close();var e=this.node.find(t.selector);t.className?(e.addClass(t.className),e.each(function(){this.sidePanelActiveClass=t.className})):(e.attr(t.attribute,"true"),e.each(function(){this.sidePanelActiveAttribute=t.attribute})),this.node.attr("cq-active","true");var i=this;setTimeout(function(){i.resizeMyself()},0)}},{key:"close",value:function(){this.node.removeAttr("cq-active"),this.node.children().each(function(){this.sidePanelActiveClass?s()(this).removeClass(this.sidePanelActiveClass):s()(this).removeAttr(this.sidePanelActiveAttribute)});var t=this;setTimeout(function(){t.resizeMyself()},0)}},{key:"nonAnimatedWidth",value:function(){var t=0;return this.node.children().width(function(e,i){t+=i}),t}},{key:"resizeMyself",value:function(){var t=0;this.node.children().width(function(e,i){t+=i}),this.node.css({width:t+"px"});for(var e=0;e<this.callbacks.length;e++)this.callbacks[e].call(this,t)}}]),e}(l.a);document.registerElement("cq-side-panel",u)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(33),s=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),e}(o.a);document.registerElement("cq-study-context",s)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),i(33)),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),p=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},d=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),u(e,[{key:"setContext",value:function(t){p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setContext",this).call(this,t),t.advertiseAs(this,"StudyDialog")}},{key:"attachedCallback",value:function(){if(!this.attached){p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attachedCallback",this).call(this);var t=s()(this);this.inputTemplate=t.find("template[cq-study-input]"),this.outputTemplate=t.find("template[cq-study-output]"),this.parameterTemplate=t.find("template[cq-study-parameters]"),this.attached=!0,this.queuedUpdates={}}}},{key:"hide",value:function(){l.CIQ.isEmpty(this.queuedUpdates)||(this.helper.updateStudy(this.queuedUpdates),this.queuedUpdates={}),this.node.find("cq-menu").each(function(){this.unlift&&this.unlift()}),this.node.find("cq-swatch").each(function(){this.colorPicker&&this.colorPicker.close()})}},{key:"setChangeEvent",value:function(t,e,i){var n=this;t.change(function(){return function(){var t={};t[e]={},t[e][i]=this.value,"checkbox"!==this.type&&"radio"!==this.type||(t[e][i]=this.checked),n.updateStudy(t)}}())}},{key:"updateStudy",value:function(t){s()(this).find(":invalid").length||(this.helper.libraryEntry.deferUpdate?l.CIQ.extend(this.queuedUpdates,t):this.helper.updateStudy(t))}},{key:"setSelectOption",value:function(t){var e=s()(t.node),i=e.attr("name"),n=e.attr("value"),r=s()(e[0].cqMenuWrapper);r.find("cq-selected").text(this.helper.stx.translateIf(n)),r[0].fieldValue=n;var a={inputs:{}};a.inputs[i]=n,this.updateStudy(a)}},{key:"open",value:function(t){p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"open",this).call(this,arguments),this.helper=new l.CIQ.Studies.DialogHelper(t);var i=s()(this);i.find(".title").text(this.helper.title);var n=this,r=void 0,a=i.find("cq-study-inputs");a.empty();for(var o in this.helper.inputs){var h=this.helper.inputs[o],u=l.CIQ.UI.makeFromTemplate(this.inputTemplate,a);this.menuTemplate=u.find("template[cq-menu]"),u.find(".ciq-heading").text(h.heading),u[0].fieldName=h.name;var d,f=null;if(r=this.helper.attributes[h.name],"number"===h.type){f=s()("<input>"),f.attr("type","number"),f.val(h.value),this.setChangeEvent(f,"inputs",h.name);for(d in r)f.attr(d,r[d])}else if("text"===h.type){f=s()("<input>"),f.attr("type","text"),f.val(h.value),this.setChangeEvent(f,"inputs",h.name);for(d in r)f.attr(d,r[d])}else if("select"===h.type)f=function(t,e,i){var r=l.CIQ.UI.makeFromTemplate(n.menuTemplate),a=r.find("cq-menu-dropdown");a[0].context=n.context;for(var o in i){var h=s()("<cq-item></cq-item>");h.text(i[o]),h.attr("stxtap","StudyDialog.setSelectOption()"),a.append(h),h[0].cqMenuWrapper=a.parents("cq-menu")[0],h.attr("name",t),h.attr("value",o)}return r.find("cq-selected").text(n.helper.stx.translateIf(e)),r}(h.name,h.value,h.options),r&&r.readonly&&f.attr("readonly",r.readonly);else if("checkbox"===h.type){f=s()("<input>"),f.attr("type","checkbox"),h.value&&f.prop("checked",!0),this.setChangeEvent(f,"inputs",h.name);for(d in r)f.attr(d,r[d])}r&&r.hidden&&u.hide(),f&&u.find(".stx-data").append(f)}var m=void 0,g=i.find("cq-study-outputs");g.empty();for(o in this.helper.outputs){var v=this.helper.outputs[o],y=l.CIQ.UI.makeFromTemplate(this.outputTemplate,g);y[0].initialize({studyDialog:this,output:v.name,params:t}),y.find(".ciq-heading").text(v.heading),y.find(".ciq-heading")[0].fieldName=v.name,m=y.find("cq-swatch");var b=v.color;"object"===(void 0===b?"undefined":c(b))&&(b=b.color),m[0].setColor(b,!1)}var x=i.find("cq-study-parameters");x.empty();for(o in this.helper.parameters){var w=this.helper.parameters[o],C=l.CIQ.UI.makeFromTemplate(this.parameterTemplate,x);C.find(".ciq-heading").text(w.heading),m=C.find("cq-swatch");var S,T=s()("<input>");if(r={},w.defaultValue.constructor===Boolean){T.attr("type","checkbox"),w.value&&T.prop("checked",!0),this.setChangeEvent(T,"parameters",w.name+"Enabled"),m.remove(),r=this.helper.attributes[w.name+"Enabled"];for(S in r)T.attr(S,r[S])}else{if(w.defaultValue.constructor!==Number)continue;T.attr("type","number"),T.val(w.value),this.setChangeEvent(T,"parameters",w.name+"Value"),C[0].initialize({studyDialog:this,parameter:w.name+"Color",params:t}),m[0].setColor(w.color,!1),r=this.helper.attributes[w.name+"Value"];for(S in r)T.attr(S,r[S])}r&&r.hidden&&C.hide(),C.find(".stx-data").append(T)}}}]),e}(h.a);document.registerElement("cq-study-dialog",d)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(30),s=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),e}(o.a);document.registerElement("cq-study-input",s)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),i(54)),c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),c(e,[{key:"setContext",value:function(t){this.template=this.node.find("template"),this.previousStudies={},this.begin()}},{key:"begin",value:function(){function t(){e.showHide(),e.renderLegend()}var e=this;this.addInjection("append","createDataSet",t),t()}},{key:"showHide",value:function(){for(var t in this.context.stx.layout.studies)if(!this.context.stx.layout.studies[t].customLegend)return void this.node.css({display:""});this.node.css({display:"none"})}},{key:"renderLegend",value:function(){var t=this.context.stx;if(t.layout.studies){var e=!1,i=void 0;if(l.CIQ.objLength(this.previousStudies)===l.CIQ.objLength(t.layout.studies)){for(i in t.layout.studies)if(!this.previousStudies[i]){e=!0;break}if(!e)return}this.previousStudies=l.CIQ.shallowClone(t.layout.studies),s()(this.template).parent().emptyExceptTemplate();var n=void 0!==this.node.attr("cq-overlays-only"),r=void 0!==this.node.attr("cq-panel-only"),a=void 0!==this.node.attr("cq-custom-removal-only"),o=this.node.parents(".stx-holder"),h=null,c=this.node.attr("cq-marker-label");o.length&&(h=o.attr("cq-panel-name"));for(i in t.layout.studies){var u=t.layout.studies[i];if(!u.customLegend&&((!a||u.study.customRemoval)&&(!r||u.panel===h)&&(!n||u.overlay||u.underlay))){var p=l.CIQ.UI.makeFromTemplate(this.template,!0);p.find("cq-label").html(u.inputs.display);var d=p.find(".ciq-close");u.permanent?d.hide():d.stxtap(function(t,e){return function(i){setTimeout(function(){l.CIQ.Studies.removeStudy(t.context.stx,e),t.node[0].hasAttribute("cq-marker")&&t.context.stx.modalEnd(),t.renderLegend()},0)}}(this,u));var f=p.find(".ciq-edit");f.length||(f=p.find("cq-label")),f.stxtap(function(e,i){return function(n){var r=t.layout.studies[i];if(r.editFunction){n.stopPropagation(),e.uiManager.closeMenu();var a=e.context.getAdvertised("StudyEdit"),o={stx:t,sd:r,inputs:r.inputs,outputs:r.outputs,parameters:r.parameters};a.editPanel(o)}}}(this,i))}}void 0!==c&&this.node[0].childElementCount>1&&this.node.prepend("<cq-marker-label>"+c+"</cq-marker-label>"),l.CIQ.I18N.translateUI(null,this.node[0]),this.showHide()}}}]),e}(h.a);document.registerElement("cq-study-legend",u)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(30),s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),s(e,[{key:"initialize",value:function(t){this.params=t}},{key:"setColor",value:function(t){if(this.params){var e={outputs:{}};e.outputs[this.params.output]={},e.outputs[this.params.output].color=t,this.params.studyDialog.updateStudy(e)}}}]),e}(o.a);document.registerElement("cq-study-output",l)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(30),s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),s(e,[{key:"initialize",value:function(t){this.params=t}},{key:"setColor",value:function(t){if(this.params){var e={parameters:{}};e.parameters[this.params.parameter]=t,this.params.studyDialog.updateStudy(e)}}}]),e}(o.a);document.registerElement("cq-study-parameter",l)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}()),c=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),h(e,[{key:"attachedCallback",value:function(){this.attached||(this.node=s()(this),this.node.stxtap(function(t){return function(e){t.launchColorPicker(),e.stopPropagation()}}(this)),this.attached=!0)}},{key:"getDefaultColor",value:function(){if(this.defaultColor)return this.defaultColor;var t=l.CIQ.UI.getMyContext(this);return t?t.stx.defaultColor:"trasparent"}},{key:"setColor",value:function(t,e){var i=s()(this),n=l.CIQ.getBackgroundColor(this.parentNode),r=l.CIQ.hsl(n);t||(t="transparent");var a=t;"auto"===t&&(a=this.getDefaultColor());var o=l.CIQ.hsl(a);if(Math.abs(r[2]-o[2])<.2||l.CIQ.isTransparent(t)){var h=l.CIQ.chooseForegroundColor(n);i.css({border:"solid "+h+" 1px"})}else i.css({border:""});i.css({"background-color":a}),!1!==e&&l.CIQ.UI.containerExecute(this,"setColor",t)}},{key:"launchColorPicker",value:function(){var t=s()(this),e=s()("cq-color-picker"),i=e[0];i.callback=function(t){return function(e){t.setColor(e,null)}}(this);var n=this.node.attr("cq-overrides");n&&(n=n.split(",")),i.display({node:t,overrides:n}),this.colorPicker=i}}]),e}(HTMLElement);c.prototype.defaultColor=null,document.registerElement("cq-swatch",c)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),i(13)),c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},p=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),c(e,[{key:"attachedCallback",value:function(){this.attached||(u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attachedCallback",this).call(this),this.attached=!0)}},{key:"setContext",value:function(t){this.initialize()}},{key:"start",value:function(){s()(".stx-trade-panel").appendTo(s()("cq-side-panel"));var t=this.context.stx;t.account=new l.CIQ.Account.Demo;var e={stx:t,account:t.account};t.tfc=new l.CIQ.TFC(e);var i=this;s()(".stx-trade-nav .stx-trade-ticket-toggle").stxtap(function(){s()(".stx-trade-nav").removeClass("active"),s()(".stx-trade-info").addClass("active"),s()("cq-side-panel")[0].resizeMyself()}),s()(".stx-trade-info .stx-trade-ticket-toggle").stxtap(function(){s()(".stx-trade-nav").addClass("active"),s()(".stx-trade-info").removeClass("active"),s()("cq-side-panel")[0].resizeMyself()}),t.tfc.selectSymbol=function(t){t=t.toUpperCase(),i.context.changeSymbol({symbol:t})}}},{key:"initialize",value:function(){function t(t){t?console.log(t):l.CIQ.loadScript("plugins/tfc/tfc-demo.js",e.start.bind(e))}var e=this;l.CIQ.loadWidget("plugins/tfc/tfc",t)}}]),e}(h.a);document.registerElement("cq-tfc",p)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),i(33)),c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},p=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),c(e,[{key:"applyChanges",value:function(){var t=this.context.stx;this.helper.update(t),t.changeOccurred("theme")}},{key:"setValue",value:function(t,e,i){t[e]=i,this.applyChanges()}},{key:"close",value:function(){this.helper.settings=this.revert,this.applyChanges(),u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"close",this).call(this)}},{key:"save",value:function(){var t=this.node.find("cq-action input").val(),i={settings:l.CIQ.clone(this.helper.settings),name:t,builtIn:null};l.CIQ.UI.contextsForEach(function(){this.stx.updateListeners("theme")});var n=this;s()("cq-themes").each(function(){i.builtIn=this.currentLoadedBuiltIn,this.addCustom(i,n.initiatingMenu)}),u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"close",this).call(this)}},{key:"open",value:function(t){function i(t,e,i,n){var a=r.node.find('cq-theme-piece[cq-piece="'+t+'"]');a[0].piece={obj:e,field:i},"color"===n&&a.find("cq-swatch")[0].setColor(e[i],!1)}u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"open",this).call(this,arguments);var n=t.themeName;this.initiatingMenu=t.initiatingMenu,this.context=t.context,this.helper=new l.CIQ.ThemeHelper({stx:this.context.stx}),this.revert=l.CIQ.clone(this.helper.settings);var r=this,a=this.helper.settings;i("cu",a.chartTypes["Candle/Bar"].up,"color","color"),i("cd",a.chartTypes["Candle/Bar"].down,"color","color"),i("wu",a.chartTypes["Candle/Bar"].up,"wick","color"),i("wd",a.chartTypes["Candle/Bar"].down,"wick","color"),i("bu",a.chartTypes["Candle/Bar"].up,"border","color"),i("bd",a.chartTypes["Candle/Bar"].down,"border","color"),i("lc",a.chartTypes.Line,"color","color"),i("mc",a.chartTypes.Mountain,"color","color"),i("bg",a.chart.Background,"color","color"),i("gl",a.chart["Grid Lines"],"color","color"),i("dd",a.chart["Grid Dividers"],"color","color"),i("at",a.chart["Axis Text"],"color","color"),n||(n="My Theme"),this.node.find("cq-action input").val(n)}}]),e}(h.a);document.registerElement("cq-theme-dialog",p)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(1),s=(i.n(o),i(30)),l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),h=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),l(e,[{key:"setColor",value:function(t){"Hollow"!==t&&"No Border"!==t||(t="transparent",this.node.find("cq-swatch")[0].setColor("transparent",!1)),o.CIQ.UI.containerExecute(this,"setValue",this.piece.obj,this.piece.field,t)}},{key:"setBoolean",value:function(t){o.CIQ.UI.containerExecute(this,"setValue",this.piece.obj,this.piece.field,t)}}]),e}(s.a);document.registerElement("cq-theme-piece",h)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),i(13)),c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},p=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),c(e,[{key:"attachedCallback",value:function(){this.attached||(u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attachedCallback",this).call(this),this.attached=!0,this.builtInMenu=s()(this).find("cq-themes-builtin"),this.builtInTemplate=this.builtInMenu.find("template"),this.customMenu=s()(this).find("cq-themes-custom"),this.customTemplate=this.customMenu.find("template"))}},{key:"initialize",value:function(t){this.params={},t&&(this.params=t),this.params.customThemes||(this.params.customThemes={}),this.params.builtInThemes||(this.params.builtInThemes={}),this.params.nameValueStore||(this.params.nameValueStore=new l.CIQ.NameValueStore),this.id=t.id?t.id+"-":"";var e=this;this.params.nameValueStore?this.params.nameValueStore.get("CIQ.Themes.prototype.custom",function(t,i){!t&&i&&(e.params.customThemes=i),e.params.nameValueStore.get(e.id+"CIQ.Themes.prototype.current",function(t,i){!t&&i&&i.theme?e.loadTheme(i.theme):e.loadTheme(e.params.defaultTheme),e.configureMenu()})}):this.loadTheme(e.params.defaultTheme)}},{key:"configureMenu",value:function(){this.builtInMenu.emptyExceptTemplate(),this.customMenu.emptyExceptTemplate();var t=void 0,e=void 0,i=this.params.builtInThemes;for(var n in i)t=i[n],e=l.CIQ.UI.makeFromTemplate(this.builtInTemplate),e.text(t),e[0].selectFC=function(t,e){return function(i){t.loadBuiltIn(e),t.params.callback&&t.params.callback({theme:t.currentTheme}),t.persist("current")}}(this,n),e.stxtap(e[0].selectFC),this.builtInMenu.append(e);var r=this.params.customThemes;for(var a in r)t=a,e=l.CIQ.UI.makeFromTemplate(this.customTemplate),e.find("cq-label").text(t),e[0].selectFC=function(t,e){return function(i){t.loadCustom(e),t.params.callback&&t.params.callback({theme:t.currentTheme}),t.persist("current")}}(this,a),e.stxtap(e[0].selectFC),e[0].close=function(t,e){return function(){t.removeTheme(e)}}(this,a),this.customMenu.append(e)}},{key:"removeTheme",value:function(t){var e=!1;s()("cq-themes").each(function(){delete this.params.customThemes[t],this.configureMenu(),e||(this.persist(),e=!0)})}},{key:"persist",value:function(t){this.params.nameValueStore&&(t&&"current"!==t||this.params.nameValueStore.set(this.id+"CIQ.Themes.prototype.current",{theme:this.currentTheme}),t&&"custom"!==t||this.params.nameValueStore.set("CIQ.Themes.prototype.custom",this.params.customThemes))}},{key:"addCustom",value:function(t,e){this.params.customThemes[t.name]=t,e===this&&(this.currentTheme=t.name),this.configureMenu(),this.persist()}},{key:"reinitializeChart",value:function(t){var e=this.context.stx;if(e.styles={},e.chart.container.style.backgroundColor="",t){var i=new l.CIQ.ThemeHelper({stx:e});i.settings=t.settings,i.update()}e.updateListeners("theme"),e.changeOccurred("theme"),e.displayInitialized&&(e.headsUpHR(),e.clearPixelCache(),e.updateListeners("theme"),e.draw())}},{key:"loadTheme",value:function(t){this.params.customThemes[t]?this.loadCustom(t):this.params.builtInThemes[t]?this.loadBuiltIn(t):this.loadBuiltIn(this.params.defaultTheme)}},{key:"loadBuiltIn",value:function(t){this.currentLoadedBuiltIn&&s()(this.context.topNode).removeClass(this.currentLoadedBuiltIn),s()(this.context.topNode).addClass(t),this.currentLoadedBuiltIn=this.currentTheme=t,this.reinitializeChart()}},{key:"loadCustom",value:function(t){this.currentLoadedBuiltIn&&s()(this.context.topNode).removeClass(this.currentLoadedBuiltIn);var e=this.params.customThemes[t];e.builtIn&&s()(this.context.topNode).addClass(e.builtIn),this.currentLoadedBuiltIn=e.builtIn,this.currentTheme=e.name,this.reinitializeChart(e)}},{key:"newTheme",value:function(){var t=this;s()("cq-theme-dialog").each(function(){this.open({context:t.context,initiatingMenu:t})})}}]),e}(h.a);document.registerElement("cq-themes",p)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(1),s=(i.n(o),i(33)),l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),h=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},c=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),l(e,[{key:"removeTimezone",value:function(){o.CIQ.ChartEngine.defaultDisplayTimeZone=null;var t=this.context.stx;t.displayZone=null,t.setTimeZone(),t.displayInitialized&&t.draw(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"close",this).call(this)}},{key:"open",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"open",this).call(this,arguments);var i=this.node;this.context=t.context;var n=this.context.stx,r=i.find("ul"),a=i.find(".ciq-btn");this.template||(this.template=r.find("li#timezoneTemplate")[0].cloneNode(!0)),r.empty();for(var s in o.CIQ.timeZoneMap){var l=s,c=n.translateIf(l),u=this.template.cloneNode(!0);u.style.display="block",u.innerHTML=c,o.CIQ.safeClickTouch(u,setTimezone(l)),r.append(u)}var p=i.find("#currentUserTimeZone");if(n.displayZone){var d=n.displayZone;for(var f in o.CIQ.timeZoneMap)o.CIQ.timeZoneMap[f]===n.displayZone&&(d=f);p.text(n.translateIf("Current TimeZone is")+" "+d),a.show()}else p.text(n.translateIf("Your timezone is your current location")),a.hide()}},{key:"setTimezone",value:function(t){var i=this.context.stx;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"close",this).call(this);var n=o.CIQ.timeZoneMap[t];o.CIQ.ChartEngine.defaultDisplayTimeZone=n,i.setTimeZone(i.dataZone,n),i.chart.symbol&&i.draw()}}]),e}(s.a);document.registerElement("cq-timezone-dialog",c)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(1),s=(i.n(o),i(13)),l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),h=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},c=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),l(e,[{key:"setContext",value:function(t){this.currentValue=!1,this.params.obj=this.context.stx.layout;var e=this.node.attr("cq-member");e&&(this.params.member=e);var i=this.node.attr("cq-action");i&&(this.params.action=i);var n=this.node.attr("cq-value");n&&(this.params.value=n);var r=this.node.attr("cq-toggles");r&&(this.params.toggles=r.split(","));for(var a=0;a<this.params.toggles.length;a++)"null"===this.params.toggles[a]&&(this.params.toggles[a]=null);this.begin()}},{key:"attachedCallback",value:function(){this.attached||(this.params={member:null,obj:null,action:"class",value:"active",toggles:[],callbacks:[]},h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attachedCallback",this).call(this),this.attached=!0)}},{key:"registerCallback",value:function(t,e){!1!==e&&(e=!0),this.params.callbacks.push(t),e&&t.call(this,this.currentValue)}},{key:"updateFromBinding",value:function(t){if(this.currentValue=t.obj[t.member],this.params.callbacks.length)for(var e=0;e<this.params.callbacks.length;e++)this.params.callbacks[e].call(this,this.currentValue);else"class"===this.params.action&&(this.currentValue?this.node.addClass(this.params.value):this.node.removeClass(this.params.value));"crosshair"===t.member&&!1===this.currentValue&&this.context.stx.doDisplayCrosshairs()}},{key:"set",value:function(t){if(this.params.member)this.params.obj[this.params.member]=t;else{this.currentValue=t;for(var e=0;e<this.params.callbacks.length;e++)this.params.callbacks[e].call(this,this.currentValue)}}},{key:"begin",value:function(){var t=this,e=this.context.stx;this.params.member&&o.CIQ.UI.observe({selector:this.node,obj:this.params.obj,member:this.params.member,action:"callback",value:function(e){t.updateFromBinding(e)}}),this.node.stxtap(function(){var i=t.params.toggles,n=t.params.obj;if(i.length>1){for(var r=0;r<i.length;r++){var a=i[r];if(t.currentValue===a){r<i.length-1?t.set(i[r+1]):t.set(i[0]);break}}r===i.length&&t.set(i[0])}else t.currentValue?t.set(!1):t.set(!0);e.draw(),n===e.layout&&e.changeOccurred("layout")})}}]),e}(s.a);document.registerElement("cq-toggle",c)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),i(13)),c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},p=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),c(e,[{key:"createdCallback",value:function(){u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createdCallback",this).call(this),this.redoButton=null,this.undostack=[],this.redostack=[],this.contexts=[]}},{key:"attachedCallback",value:function(){if(!this.attached){u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attachedCallback",this).call(this),this.attached=!0;var t=this;this.addEventListener("stxtap",function(){t.undo()})}}},{key:"setContext",value:function(t){this.manageContext(this.context);var e=this;this.addInjection("append","initializeChart",function(){e.undostack=[],e.redostack=[],e.clear()})}},{key:"handleEvent",value:function(t,e,i){this.undostack.push({context:t,drawings:i.before}),this.redostack=[],this.setButtonStyle()}},{key:"manageContext",value:function(t){this.addClaim(this);var e=this;t.stx.addEventListener("undoStamp",function(i){e.handleEvent(t,"undoStamp",i)}),this.contexts.push(t)}},{key:"keyStroke",value:function(t,e,i,n){return 90===e&&(n.ctrl||n.cmd)?(n.shift?this.redo():this.undo(),!0):89===e&&(n.ctrl||n.cmd)?(this.redo(),!0):void 0}},{key:"undo",value:function(){for(var t=!1,e=0;e<this.contexts.length;e++)this.contexts[e].stx.activeDrawing&&(this.contexts[e].stx.undo(),t=!0);if(!t){var i=this.undostack.pop();if(i){var n=i.context;this.redostack.push({context:n,drawings:l.CIQ.shallowClone(n.stx.drawingObjects)});var r=i.drawings;n.stx.drawingObjects=l.CIQ.shallowClone(r),n.stx.changeOccurred("vector"),n.stx.draw()}this.setButtonStyle()}}},{key:"redo",value:function(){var t=this.redostack.pop();if(t){var e=t.context;this.undostack.push({context:e,drawings:l.CIQ.shallowClone(e.stx.drawingObjects)});var i=t.drawings;e.stx.drawingObjects=l.CIQ.shallowClone(i),e.stx.changeOccurred("vector"),e.stx.draw()}this.setButtonStyle()}},{key:"clear",value:function(t){this.setButtonStyle()}},{key:"setButtonStyle",value:function(){this.undostack.length?s()(this).attr("cq-active","true"):s()(this).removeAttr("cq-active"),this.redoButton&&(this.redostack.length?s()(this.redoButton).attr("cq-active","true"):s()(this.redoButton).removeAttr("cq-active"))}}]),e}(h.a);document.registerElement("cq-undo",p)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(33),h=i(1),c=(i.n(h),function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}()),u=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),c(e,[{key:"save",value:function(){var t=this.node.find("input").val();if(t){var e=!1,i=this.context.stx.exportLayout();s()("cq-views").each(function(){for(var n=this.params.viewObj,r=void 0,a=0;a<n.views.length&&(r=n.views[a],t!==h.CIQ.first(r));a++);a===n.views.length&&(r={},r[t]={},n.views.push(r)),r[t]=i,delete r[t].candleWidth,this.renderMenu(),e||(e=!0,this.params.nameValueStore.set("stx-views",n.views))}),this.close()}}}]),e}(l.a);document.registerElement("cq-view-dialog",u)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(2),s=i.n(o),l=i(1),h=(i.n(l),i(13)),c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},p=function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),c(e,[{key:"attachedCallback",value:function(){this.attached||(u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attachedCallback",this).call(this),this.attached=!0)}},{key:"initialize",value:function(t){this.params=t||{},this.params.viewObj||(this.params.viewObj={views:[]}),this.params.nameValueStore||(this.params.nameValueStore=new l.CIQ.NameValueStore),this.params.template||(this.params.template="template[cq-view]"),this.params.template=this.node.find(this.params.template),this.params.template.detach();var e=this;this.params.nameValueStore.get("stx-views",function(t,i){!t&&i&&(e.params.viewObj.views=i),e.params.cb&&e.params.cb.call(e),e.renderMenu()})}},{key:"renderMenu",value:function(){var t=s()(this.node),e=this,i=e.context.stx;t.find("cq-views-content cq-item").remove();for(var n=0;n<this.params.viewObj.views.length;n++){var r=l.CIQ.first(e.params.viewObj.views[n]);if("recent"!==r){var a=l.CIQ.UI.makeFromTemplate(this.params.template),o=a.find("cq-label"),h=a.find("div");o.length&&(o.addClass("view-name-"+r),o.prepend(r)),h.length&&h.stxtap(function(t){return function(i){i.stopPropagation();var n=!1;s()("cq-views").each(function(){this.params.viewObj.views.splice(t,1),n||(this.params.nameValueStore.set("stx-views",e.params.viewObj.views),n=!0),this.renderMenu()})}}(n)),a.stxtap(function(t){return function(n){function r(){i.importLayout(e.params.viewObj.views[t][a],!0,!0),i.changeCallback&&i.changeCallback(i,"layout"),i.dispatch("layout",{stx:i}),e.context.loader&&e.context.loader.hide()}n.stopPropagation(),e.uiManager.closeMenu(),e.context.loader&&e.context.loader.show();var a=l.CIQ.first(e.params.viewObj.views[t]);setTimeout(r,10)}}(n)),t.find("cq-views-content").append(a)}}var c=t.find("cq-view-save");if(c){var u=this.context;c.stxtap(function(t){s()("cq-view-dialog").each(function(){s()(this).find("input").val(""),this.open({context:u})})})}this.params.renderCB&&this.params.renderCB(t)}}]),e}(h.a);document.registerElement("cq-views",p)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(1),a=(i.n(r),i(404)),o=i.n(a),s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function(){function t(e){var i=this,a=e.stx,o=e.shadeState,s=void 0===o?t.SHADE_NONE:o,l=e.shadeColor,h=void 0===l?t.COLOR_GREEN:l,c=e.lineColor,u=void 0===c?t.COLOR_GREEN:c,p=e.visible,d=void 0===p||p,f=e.pipSize,m=void 0===f?2:f,g=e.price;n(this,t),this._stx=a,this._chart=a.chart,this._price=g,this._pipSize=m,this._line=Object(r.$$$)(".drag-price-line",t.DOM).cloneNode(!0),this._linePrice=Object(r.$$$)(".tfc-price",this._line),this._shade=Object(r.$$$)(".tfc-shade",t.DOM).cloneNode(!0),this.shadeState=s,this.shadeColor=h,this.lineColor=u;var v=this._chart.panel.holder;v.appendChild(this._line),v.appendChild(this._shade),r.CIQ.safeMouseOver(this._line,this._modalBegin.bind(this)),r.CIQ.safeMouseOut(this._line,this._modalEnd.bind(this)),r.CIQ.safeMouseOver(this._linePrice,this._modalBegin.bind(this)),r.CIQ.safeMouseOut(this._linePrice,this._modalEnd.bind(this)),r.CIQ.safeDrag(this._line,function(t){return i._startDrag(t,i._line)},function(t){return i._dragLine(t)},function(t){return i._endDrag(t,i._line)}),this.visible=d,this._draw(),this._drawHook=this._draw.bind(this),this._stx.append("draw",this._drawHook)}return s(t,[{key:"_modalBegin",value:function(){this._stx.grabbingScreen||(this._stx.editingAnnotation=!0,this._stx.modalBegin())}},{key:"_modalEnd",value:function(){this._stx.modalEnd(),this._stx.editingAnnotation=!1}},{key:"_startDrag",value:function(t,e){this._initialPosition=r.CIQ.stripPX(e.style.top),this._stx.modalBegin(),r.CIQ.appendClassName(e,"dragging")}},{key:"_endDrag",value:function(t,e){this._stx.modalEnd(),r.CIQ.unappendClassName(e,"dragging")}},{key:"_snapPrice",value:function(t){var e=this._stx.chart.yAxis.minimumPriceTick;e||(e=1e-8);var i=1/e;return t=Math.round(t*i)/i}},{key:"_locationFromPrice",value:function(t){return this._stx.pixelFromPriceTransform(t,this._chart.panel)-this._chart.panel.top}},{key:"_priceFromLocation",value:function(t){var e=this._stx.valueFromPixelUntransform(t+this._chart.panel.top,this._chart.panel);return this._snapPrice(e)}},{key:"_positionAtPrice",value:function(t,e,i,n,a){i||(i="center");for(var o=this._locationFromPrice(t),s=void 0,l=0;l<e.length;l++){s=e[l];var h=null,c=void 0,u=void 0;if("center"==i)h=o-s.offsetHeight/2;else if("top"==i){if(n)for(c=0;c<n.length;c++){u=n[c];var p=r.CIQ.stripPX(u.style.top)+u.offsetHeight;p>o&&(o=p)}h=Math.round(o)+1}else if("bottom"==i){if(n)for(c=0;c<n.length;c++)u=n[c],h=r.CIQ.stripPX(u.style.top),o>h&&(o=h);h=Math.round(o-s.offsetHeight)}s.removeAttribute("uncentered"),s.removeAttribute("off-screen"),a&&(h<0?(s.setAttribute("uncentered",!0),h<s.offsetHeight/2*-1&&s.setAttribute("off-screen",!0),h=0):h+s.offsetHeight>this._chart.panel.height&&(s.setAttribute("uncentered",!0),h+s.offsetHeight-this._chart.panel.height>s.offsetHeight/2&&s.setAttribute("off-screen",!0),h=this._chart.panel.height-s.offsetHeight)),null!==h&&(s.style.top=h+"px")}}},{key:"_dragLine",value:function(t){var e=this._initialPosition+t.displacementY,i=e+this._line.offsetHeight/2,n=this._priceFromLocation(i);n<0&&(n=0),this.price=this._snapPrice(n),this._draw()}}],[{key:"SHADE_NONE",get:function(){return"SHADE_NONE"}},{key:"SHADE_ABOVE",get:function(){return"SHADE_ABOVE"}},{key:"SHADE_BELOW",get:function(){return"SHADE_BELOW"}},{key:"COLOR_GREEN",get:function(){return"green"}},{key:"COLOR_RED",get:function(){return"red"}},{key:"DOM",get:function(){if(!t._DOM){var e=document.createElement("div");e.innerHTML=o.a,t._DOM=e.firstChild}return t._DOM}}]),s(t,[{key:"_draw",value:function(){this.visible&&(this._positionAtPrice(this.price,[this._line],"center",null,!0),this._linePrice.textContent=this.price.toFixed(this._pipSize),this._shadeState===t.SHADE_ABOVE?(this._shade.style.top="0px",this._shade.style.bottom=this._chart.panel.height-this._locationFromPrice(this.price)+"px"):this._shadeState===t.SHADE_BELOW&&(this._shade.style.bottom="0px",this._shade.style.top=this._locationFromPrice(this.price)+"px"))}},{key:"price",get:function(){return void 0!==this._price&&null!==this._price||(this._price=this._stx.currentQuote().Close),this._price},set:function(t){this._price=t,this._draw()}},{key:"lineColor",get:function(){return this._lineColor},set:function(e){this._lineColor=e,r.CIQ.unappendClassName(this._line,t.COLOR_RED),r.CIQ.unappendClassName(this._line,t.COLOR_GREEN),r.CIQ.appendClassName(this._line,this._lineColor),this._draw()}},{key:"shadeState",get:function(){return this._shadeState},set:function(e){this._shadeState=e,this._shadeState===t.SHADE_NONE?(this._shade.style.display="none",r.CIQ.unappendClassName(this._shade,"shade-above"),r.CIQ.unappendClassName(this._shade,"shade-below"),r.CIQ.appendClassName(this._shade,"tfc-neutral")):(this._shade.style.display="",r.CIQ.unappendClassName(this._shade,"tfc-neutral"),this._shadeState===t.SHADE_ABOVE?r.CIQ.swapClassName(this._shade,"shade-above","shade-below"):r.CIQ.swapClassName(this._shade,"shade-below","shade-above")),this._draw()}},{key:"shadeColor",get:function(){return this._shadeColor},set:function(e){this._shadeColor=e,this._shadeColor===t.COLOR_GREEN?r.CIQ.swapClassName(this._shade,t.COLOR_GREEN,t.COLOR_RED):r.CIQ.swapClassName(this._shade,t.COLOR_RED,t.COLOR_GREEN),this._draw()}},{key:"visible",get:function(){return!!this._visible},set:function(e){this._visible=e,this._visible?(this._line.style.display="",this._linePrice.style.display="",this.shadeState!==t.SHADE_NONE&&(this._shade.style.display="")):(this._line.style.display="none",this._linePrice.style.display="none",this._shade.style.display="none"),this._draw()}}]),t}();e.a=l},function(t,e){t.exports='<div class="tfc container">\n  \x3c!--Add .red or .green to control color--\x3e\n  <div class="tfc drag-price-line red" style="display:none;">\n    <div class="drag-line"></div>\n    <div class="drag-price">\n      <div class="tfc-price-arrow">\n        <span></span>\n      </div>\n      <div class="tfc-price"></div>\n    </div>\n  </div>\n\n  <div class="tfc tfc-shade" style="display:none">\n  </div>\n\n</div>\n'}]);
//# sourceMappingURL=bundle.js.map